based on: blake256/regs
tree mode: Daniel J. Bernstein
