/* ****************************** *
 * Titanium_CCA_med               *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 768=3*256 */
#define N1_768 3
#define N2_768 256

/* 1792=7*256 */
#define N1_1792 7
#define N2_1792 256

/* 2048=8*256 */
#define N1_2048 8
#define N2_2048 256

/* multiplication inverses of 768, 1792, 2048 */
#define INV_768 429521
#define INV_1792 429841
#define INV_2048 429871

/* omega_n: n-th root of unity mod Q */

static const uint32_t w_3[2]={212356,217724};

static const uint32_t w_7[6][6]={{4032,344027,105639,156258,393672,286614},
{344027,156258,286614,4032,105639,393672},
{105639,286614,344027,393672,4032,156258},
{156258,4032,393672,344027,286614,105639},
{393672,105639,4032,286614,156258,344027},
{286614,393672,156258,105639,344027,4032}};

static const uint32_t w_8[7][7]={{91259,116597,321683,430080,338822,313484,108398},
{116597,430080,313484,1,116597,430080,313484},
{321683,313484,91259,430080,108398,116597,338822},
{430080,1,430080,1,430080,1,430080},
{338822,116597,108398,430080,91259,313484,321683},
{313484,430080,116597,1,313484,430080,116597},
{108398,313484,338822,430080,321683,116597,91259}};

/* omega_256,768,1792,2048, respectively */
static const uint32_t omega_256[128]={1,359084,24689,165223,121944,302443,108416,378986,288561,373199,420845,284848,345407,357841,107355,12547,328473,114563,62561,233251,147658,379430,161806,153009,236006,237778,14746,325473,215468,399574,17563,314589,91259,55042,329173,306059,141621,197562,352420,59597,358750,83232,90636,417911,761,161489,294846,151051,331969,65788,359105,254076,253611,150979,282781,8504,75236,75728,411846,86485,90892,306081,300011,310639,116597,161879,131200,317979,256789,315038,39600,388378,110287,8547,32932,277193,205058,169105,193511,237078,253331,246413,251157,194812,337396,117645,161036,200412,149040,320044,305605,118184,170862,175272,177470,245467,321683,63392,155841,20329,53823,428235,315838,12692,355852,253820,365441,281810,133631,186753,64408,276497,159655,188801,29930,90011,62612,53052,116554,204183,359816,94686,174169,212419,108603,4977,174513,304068};
static const uint32_t omega_768[768]={1,15791,338782,359084,107540,204352,24689,210613,403591,165223,165047,396398,121944,145067,141591,302443,257989,177067,108416,274676,41831,378986,420892,263879,288561,388637,141078,373199,215547,41643,420845,381864,278804,284848,247670,230437,345407,34695,375632,357841,263053,147625,107355,293584,141845,12547,292417,207231,328473,140283,291703,114563,143647,82583,62561,4694,149022,233251,52857,307747,147658,198377,291284,379430,120719,154737,161806,397406,126275,153009,400142,322351,236006,118881,376387,237778,145268,305015,14746,180265,288557,325473,76193,227106,215468,84397,322089,399574,384764,54037,17563,365169,287712,314589,239349,8231,91259,299519,103772,55042,404602,216927,329173,11877,34391,306059,157472,342091,141621,346092,99505,197562,324049,384102,352420,246161,56273,59597,78999,238309,358750,424399,162467,83232,419057,102821,90636,353589,212357,417911,69737,209607,761,404764,194583,161489,122550,252631,294846,286361,54917,151051,17115,172097,331969,295251,230501,65788,212693,132634,359105,9070,7397,254076,318548,394173,253611,287110,270189,150979,170406,294410,282781,293829,139911,8504,101392,319590,75236,167954,282168,75728,195668,91484,411846,205385,423795,86485,177460,293145,90892,95275,64187,306081,74793,53837,300011,131486,294439,310639,226644,231403,116597,6466,175409,161879,259906,342744,131200,79023,187212,317979,10714,162941,256789,151431,426642,315038,18131,302756,39600,415907,250567,388378,352019,365185,110287,144048,393640,8547,350324,264462,32932,61283,37603,277193,220326,242657,205058,421110,265669,169105,394207,360424,193511,6696,366691,237078,273674,132246,253331,166440,29049,246413,164876,276623,251157,243286,245734,194812,336980,289048,337396,406889,204140,117645,212356,402120,161036,280604,323302,200412,169894,380957,149040,87408,129799,320044,363054,5984,305605,299735,73980,118184,122085,221193,170862,183729,368294,175272,148917,295520,177470,20974,38064,245467,279425,199196,321683,9562,35111,63392,224585,403890,155841,391830,242264,20329,174813,212225,53823,78937,119429,428235,95322,376283,315838,178582,377326,12692,1626,301387,355852,250667,247154,253820,146781,112262,365441,282054,425959,281810,13603,194554,133631,189735,161139,186753,381287,199098,64408,355244,111521,276497,411896,134773,159655,407364,393488,188801,35099,303981,29930,395692,155604,90011,376077,73459,62612,379954,223664,53052,376425,407755,116554,187615,230537,204183,366577,157228,359816,54365,36039,94686,225070,321067,174169,364765,359363,212419,106710,252,108603,217026,172158,4977,317065,200494,174513,205816,348420,304068,113504,194137,430080,414290,91299,70997,322541,225729,405392,219468,26490,264858,265034,33683,308137,285014,288490,127638,172092,253014,321665,155405,388250,51095,9189,166202,141520,41444,289003,56882,214534,388438,9236,48217,151277,145233,182411,199644,84674,395386,54449,72240,167028,282456,322726,136497,288236,417534,137664,222850,101608,289798,138378,315518,286434,347498,367520,425387,281059,196830,377224,122334,282423,231704,138797,50651,309362,275344,268275,32675,303806,277072,29939,107730,194075,311200,53694,192303,284813,125066,415335,249816,141524,104608,353888,202975,214613,345684,107992,30507,45317,376044,412518,64912,142369,115492,190732,421850,338822,130562,326309,375039,25479,213154,100908,418204,395690,124022,272609,87990,288460,83989,330576,232519,106032,45979,77661,183920,373808,370484,351082,191772,71331,5682,267614,346849,11024,327260,339445,76492,217724,12170,360344,220474,429320,25317,235498,268592,307531,177450,135235,143720,375164,279030,412966,257984,98112,134830,199580,364293,217388,297447,70976,421011,422684,176005,111533,35908,176470,142971,159892,279102,259675,135671,147300,136252,290170,421577,328689,110491,354845,262127,147913,354353,234413,338597,18235,224696,6286,343596,252621,136936,339189,334806,365894,124000,355288,376244,130070,298595,135642,119442,203437,198678,313484,423615,254672,268202,170175,87337,298881,351058,242869,112102,419367,267140,173292,278650,3439,115043,411950,127325,390481,14174,179514,41703,78062,64896,319794,286033,36441,421534,79757,165619,397149,368798,392478,152888,209755,187424,225023,8971,164412,260976,35874,69657,236570,423385,63390,193003,156407,297835,176750,263641,401032,183668,265205,153458,178924,186795,184347,235269,93101,141033,92685,23192,225941,312436,217725,27961,269045,149477,106779,229669,260187,49124,281041,342673,300282,110037,67027,424097,124476,130346,356101,311897,307996,208888,259219,246352,61787,254809,281164,134561,252611,409107,392017,184614,150656,230885,108398,420519,394970,366689,205496,26191,274240,38251,187817,409752,255268,217856,376258,351144,310652,1846,334759,53798,114243,251499,52755,417389,428455,128694,74229,179414,182927,176261,283300,317819,64640,148027,4122,148271,416478,235527,296450,240346,268942,243328,48794,230983,365673,74837,318560,153584,18185,295308,270426,22717,36593,241280,394982,126100,400151,34389,274477,340070,54004,356622,367469,50127,206417,377029,53656,22326,313527,242466,199544,225898,63504,272853,70265,375716,394042,335395,205011,109014,255912,65316,70718,217662,323371,429829,321478,213055,257923,425104,113016,229587,255568,224265,81661,126013,316577,235944};
static const uint32_t omega_1792[1792]={1,235435,369864,689,74178,228344,44640,359084,349451,221209,112301,356460,164327,390890,24689,110000,92504,237562,95744,83268,249438,165223,170879,260463,297263,323518,115230,95651,121944,258566,101146,153621,98440,16472,44943,302443,167102,429976,224023,301651,357736,382849,108416,43691,143308,294611,427510,250663,418828,378986,244326,418222,62187,178943,688,268824,288561,43951,284906,121107,176569,183298,7009,373199,278589,98310,375754,131695,212873,415825,420845,11876,69479,87611,11025,132040,152639,284848,228469,228507,143336,5495,31677,269955,345407,321403,204003,150630,385033,351661,134549,357841,158826,236846,116036,190540,186195,383819,107355,124217,381557,423744,429475,113282,364698,12547,206637,109618,43263,16082,262627,132618,328473,315983,196630,95291,91301,2555,283187,114563,40071,289150,229084,83735,96847,429230,62561,65028,273823,96429,75868,288569,207107,233251,126619,339912,289726,364129,235304,63630,147658,414000,402889,237246,102297,188276,31714,379430,267783,346896,368103,427819,316389,305258,161806,371035,13153,93355,175001,30716,239526,153009,89355,312391,53356,64012,196899,205399,236006,187896,23262,37516,5963,114521,43664,237778,200146,408907,398262,274674,33868,10840,14746,110678,157383,268131,132805,56475,237510,325473,203985,213610,178696,339259,89588,118378,215468,224549,277133,79507,315182,418754,160036,399574,367236,164068,54646,137976,361630,234047,17563,146171,408089,58639,72865,330428,404738,314589,152043,171994,421078,247944,231591,248148,91259,6148,231815,85625,365243,160484,74528,55042,42659,170153,76810,146543,253385,22127,329173,399460,192668,147510,406181,283304,135274,306059,369763,306290,134961,158755,294120,90633,141621,80529,84392,378563,4032,85153,200821,197562,179401,309668,214622,174042,41076,356775,352420,346099,241724,251696,197337,106489,95901,59597,257151,273396,204638,413748,424447,359095,358750,418984,119880,312256,95625,21768,103884,83232,375398,182630,146075,170541,248418,6721,90636,417845,329959,86459,171016,258983,219073,417911,385753,412947,216490,423840,236942,353584,761,252339,193530,94248,108847,17060,424722,161489,142153,178378,305023,315030,329357,281319,294846,274286,292341,150662,177495,145041,156597,151051,154457,375083,424618,190866,383587,106722,331969,221709,417688,353630,78746,62843,225224,65788,290727,350176,169427,323238,425904,183252,359105,132614,246895,126770,193874,228660,38087,254076,137094,7002,15397,270027,93487,286589,253611,330474,52642,125093,183737,143534,172877,150979,406377,409897,375010,11022,285897,333290,282781,5935,403637,9416,218486,273567,36409,8504,112185,141103,268203,310966,21661,287118,75236,301675,417123,227884,124952,103639,32511,75728,13825,35867,136791,63643,197746,61260,411846,341398,60202,338515,398996,191402,132933,86485,271192,413665,236987,196134,301563,283344,90892,47784,397323,262843,237020,224031,34726,306081,388361,271759,150119,70347,156716,212551,300011,26993,220099,268699,104694,259699,198781,310639,18915,194351,280014,130005,152648,253358,116597,234708,380857,340267,3356,61063,49818,161879,354550,348203,143652,429023,356750,57598,131200,224499,117570,79790,280732,150502,355023,317979,46357,324839,176302,113979,171951,189236,256789,201964,69061,164330,237033,274119,112067,315038,62432,229664,300358,7548,398769,77701,39600,360163,205945,189297,425651,399456,111090,388378,403425,416673,82060,127499,223670,198729,110287,139632,158523,293487,298385,411854,74473,8547,344027,132258,297830,59972,378671,56233,32932,275233,37247,325936,399897,288404,67622,277193,12934,142810,30013,309906,337622,35069,205058,377818,78005,218394,117597,415401,375197,169105,207424,32052,391475,128244,149697,65488,193511,351874,392808,3969,305583,123763,154155,237078,116669,412869,346043,389875,183200,158753,253331,211067,140243,362254,57785,289283,146026,246413,188484,403041,326643,411095,293004,124664,251157,171767,307377,154611,75188,182901,296972,194812,5056,325233,40196,42936,13336,169860,337396,156803,51508,222104,86936,222370,350901,117645,104094,65267,202177,327320,240539,383790,161036,150186,361576,422987,258714,108965,273206,200412,242791,293537,27867,411571,108923,276799,149040,213853,188628,329282,257015,80230,222611,320044,228102,270143,308844,182713,333535,333502,305605,142361,119624,252236,28261,275465,37880,118184,129664,294460,143467,311729,314789,360214,170862,128797,30709,311805,144447,84532,223226,175272,181613,263797,339728,407867,261951,108528,177470,280300,371779,133826,20331,257536,168780,245467,248932,167550,104930,341910,180242,43162,321683,323410,63029,147872,47532,418881,384692,63392,24658,122892,238907,216203,376712,315981,155841,215725,89923,284280,256580,25283,182065,20329,216747,289214,244089,100576,140943,15650,53823,341502,30825,97081,40571,164456,226254,428235,198881,199684,18349,263251,386437,170112,315838,34954,225136,421477,428851,289544,92978,12692,368313,409854,143168,19867,256270,154203,355852,236820,15860,35858,168281,175515,191545,253820,77074,369719,269094,204023,128439,40855,365441,327866,193830,191464,107149,223760,313910,281810,201642,383328,200559,15175,43258,129150,133631,129173,387664,34425,403511,20195,64370,186753,151763,52587,78598,55024,105639,393897,64408,101582,13922,78769,316876,130476,81635,276497,11035,335985,410631,291738,110087,361542,159655,155687,85539,331640,178174,15274,126949,188801,201842,161418,199427,152975,256104,209364,29930,122446,174661,407963,69418,348830,243614,90011,358672,118456,85915,258514,330875,274338,62612,29945,213323,131568,418298,321926,333342,53052,315299,9384,426024,50106,14361,215294,116554,2866,389702,310640,254350,134134,280703,204183,380992,297998,45600,154078,171985,22487,359816,225390,10627,186568,34469,10626,381214,94686,9937,307036,296423,395378,378033,377053,174169,265732,20593,9842,304923,425985,329923,212419,188423,234179,129151,369066,68956,388353,108603,201774,64835,423454,106123,372972,164888,4977,219351,66448,418586,174408,194086,251484,174513,400144,379914,246858,17295,271498,203167,304068,406968,205738,53405,418221,256833,239160,430080,194646,60217,429392,355903,201737,385441,70997,80630,208872,317780,73621,265754,39191,405392,320081,337577,192519,334337,346813,180643,264858,259202,169618,132818,106563,314851,334430,308137,171515,328935,276460,331641,413609,385138,127638,262979,105,206058,128430,72345,47232,321665,386390,286773,135470,2571,179418,11253,51095,185755,11859,367894,251138,429393,161257,141520,386130,145175,308974,253512,246783,423072,56882,151492,331771,54327,298386,217208,14256,9236,418205,360602,342470,419056,298041,277442,145233,201612,201574,286745,424586,398404,160126,84674,108678,226078,279451,45048,78420,295532,72240,271255,193235,314045,239541,243886,46262,322726,305864,48524,6337,606,316799,65383,417534,223444,320463,386818,413999,167454,297463,101608,114098,233451,334790,338780,427526,146894,315518,390010,140931,200997,346346,333234,851,367520,365053,156258,333652,354213,141512,222974,196830,303462,90169,140355,65952,194777,366451,282423,16081,27192,192835,327784,241805,398367,50651,162298,83185,61978,2262,113692,124823,268275,59046,416928,336726,255080,399365,190555,277072,340726,117690,376725,366069,233182,224682,194075,242185,406819,392565,424118,315560,386417,192303,229935,21174,31819,155407,396213,419241,415335,319403,272698,161950,297276,373606,192571,104608,226096,216471,251385,90822,340493,311703,214613,205532,152948,350574,114899,11327,270045,30507,62845,266013,375435,292105,68451,196034,412518,283910,21992,371442,357216,99653,25343,115492,278038,258087,9003,182137,198490,181933,338822,423933,198266,344456,64838,269597,355553,375039,387422,259928,353271,283538,176696,407954,100908,30621,237413,282571,23900,146777,294807,124022,60318,123791,295120,271326,135961,339448,288460,349552,345689,51518,426049,344928,229260,232519,250680,120413,215459,256039,389005,73306,77661,83982,188357,178385,232744,323592,334180,370484,172930,156685,225443,16333,5634,70986,71331,11097,310201,117825,334456,408313,326197,346849,54683,247451,284006,259540,181663,423360,339445,12236,100122,343622,259065,171098,211008,12170,44328,17134,213591,6241,193139,76497,429320,177742,236551,335833,321234,413021,5359,268592,287928,251703,125058,115051,100724,148762,135235,155795,137740,279419,252586,285040,273484,279030,275624,54998,5463,239215,46494,323359,98112,208372,12393,76451,351335,367238,204857,364293,139354,79905,260654,106843,4177,246829,70976,297467,183186,303311,236207,201421,391994,176005,292987,423079,414684,160054,336594,143492,176470,99607,377439,304988,246344,286547,257204,279102,23704,20184,55071,419059,144184,96791,147300,424146,26444,420665,211595,156514,393672,421577,317896,288978,161878,119115,408420,142963,354845,128406,12958,202197,305129,326442,397570,354353,416256,394214,293290,366438,232335,368821,18235,88683,369879,91566,31085,238679,297148,343596,158889,16416,193094,233947,128518,146737,339189,382297,32758,167238,193061,206050,395355,124000,41720,158322,279962,359734,273365,217530,130070,403088,209982,161382,325387,170382,231300,119442,411166,235730,150067,300076,277433,176723,313484,195373,49224,89814,426725,369018,380263,268202,75531,81878,286429,1058,73331,372483,298881,205582,312511,350291,149349,279579,75058,112102,383724,105242,253779,316102,258130,240845,173292,228117,361020,265751,193048,155962,318014,115043,367649,200417,129723,422533,31312,352380,390481,69918,224136,240784,4430,30625,318991,41703,26656,13408,348021,302582,206411,231352,319794,290449,271558,136594,131696,18227,355608,421534,86054,297823,132251,370109,51410,373848,397149,154848,392834,104145,30184,141677,362459,152888,417147,287271,400068,120175,92459,395012,225023,52263,352076,211687,312484,14680,54884,260976,222657,398029,38606,301837,280384,364593,236570,78207,37273,426112,124498,306318,275926,193003,313412,17212,84038,40206,246881,271328,176750,219014,289838,67827,372296,140798,284055,183668,241597,27040,103438,18986,137077,305417,178924,258314,122704,275470,354893,247180,133109,235269,425025,104848,389885,387145,416745,260221,92685,273278,378573,207977,343145,207711,79180,312436,325987,364814,227904,102761,189542,46291,269045,279895,68505,7094,171367,321116,156875,229669,187290,136544,402214,18510,321158,153282,281041,216228,241453,100799,173066,349851,207470,110037,201979,159938,121237,247368,96546,96579,124476,287720,310457,177845,401820,154616,392201,311897,300417,135621,286614,118352,115292,69867,259219,301284,399372,118276,285634,345549,206855,254809,248468,166284,90353,22214,168130,321553,252611,149781,58302,296255,409750,172545,261301,184614,181149,262531,325151,88171,249839,386919,108398,106671,367052,282209,382549,11200,45389,366689,405423,307189,191174,213878,53369,114100,274240,214356,340158,145801,173501,404798,248016,409752,213334,140867,185992,329505,289138,414431,376258,88579,399256,333000,389510,265625,203827,1846,231200,230397,411732,166830,43644,259969,114243,395127,204945,8604,1230,140537,337103,417389,61768,20227,286913,410214,173811,275878,74229,193261,414221,394223,261800,254566,238536,176261,353007,60362,160987,226058,301642,389226,64640,102215,236251,238617,322932,206321,116171,148271,228439,46753,229522,414906,386823,300931,296450,300908,42417,395656,26570,409886,365711,243328,278318,377494,351483,375057,324442,36184,365673,328499,416159,351312,113205,299605,348446,153584,419046,94096,19450,138343,319994,68539,270426,274394,344542,98441,251907,414807,303132,241280,228239,268663,230654,277106,173977,220717,400151,307635,255420,22118,360663,81251,186467,340070,71409,311625,344166,171567,99206,155743,367469,400136,216758,298513,11783,108155,96739,377029,114782,420697,4057,379975,415720,214787,313527,427215,40379,119441,175731,295947,149378,225898,49089,132083,384481,276003,258096,407594,70265,204691,419454,243513,395612,419455,48867,335395,420144,123045,133658,34703,52048,53028,255912,164349,409488,420239,125158,4096,100158,217662,241658,195902,300930,61015,361125,41728,321478,228307,365246,6627,323958,57109,265193,425104,210730,363633,11495,255673,235995,178597,255568,29937,50167,183223,412786,158583,226914,126013,23113,224343,376676,11860,173248,190921};
static const uint32_t omega_2048[2048]={1,92,8464,348607,245850,253988,142522,209594,359084,349572,334630,250209,224935,50132,311334,257382,24689,120983,378411,407332,57497,128752,232997,361755,165223,147681,254141,156598,214343,365911,117494,57423,121944,36742,369697,35725,276133,29457,129558,307149,302443,299572,35440,249913,197703,125274,343102,169471,108416,82409,270251,348475,233706,426983,145065,13469,378986,30151,193406,160031,100098,177315,399983,241551,288561,312671,380386,158951,738,67896,225298,83528,373199,357909,241472,281293,74096,365617,90446,149493,420845,10450,101238,282195,157080,258687,144749,414478,284848,401156,349467,324970,221651,178085,40742,307616,345407,381531,264291,230236,107743,20493,165032,130109,357841,235216,135822,23275,420976,22502,349860,361126,107355,414878,321648,346108,15942,176421,317735,416193,12547,294162,397882,48259,139018,317307,376817,260684,328473,113846,151888,211104,67923,227782,312056,323806,114563,217852,258658,142081,169022,67108,152802,295192,62561,164559,86593,225098,65128,400723,309631,100706,233251,385123,164674,97173,338296,157400,288127,272743,147658,252025,392007,367921,302414,296904,220065,32173,379430,70999,80693,112379,16924,266765,27763,403791,161806,263398,148080,290849,93086,392373,401593,389671,153009,314236,94285,72600,227985,330732,321674,348500,236006,208502,258620,138585,277471,152553,272284,105430,237778,371526,203993,273873,251618,354563,363721,346095,14746,66389,86654,230710,151351,161700,253646,111058,325473,267927,134667,347096,106838,367314,246570,320228,215468,39330,177712,6426,161111,199458,286734,144587,399574,203923,267433,89219,36609,357461,200256,360150,17563,325553,275287,381706,280391,421193,42466,36143,314589,126761,49825,283090,239420,92509,339289,248756,91259,224289,420781,4562,419704,335559,335677,346533,55042,332973,97765,392760,7116,224591,18484,410285,329173,178246,55554,380077,130523,395929,298664,381985,306059,202163,105513,245414,213876,322947,35535,258653,141621,126702,44397,213795,315495,210113,406832,11497,197562,112302,9840,45118,280127,396905,388456,41229,352420,166565,271145,642,59064,272916,163574,426054,59597,321952,374076,8512,353023,222041,213965,331135,358750,318844,88140,367422,256506,374178,17896,356189,83232,345967,2970,273240,193382,157823,327043,412367,90636,166973,308681,13306,363990,370843,141157,84014,417911,170603,212560,201875,79017,388268,23933,51431,761,70012,419970,360031,6615,178499,78830,371064,161489,234234,45478,313247,3297,303324,380624,180847,294846,30729,246582,321332,317036,351885,117345,43715,151051,134100,294932,38641,114324,195864,386167,260722,331969,5397,66443,91622,257685,52565,105089,206406,65788,31362,304818,87991,353714,285613,41455,373212,359105,351504,82293,259579,226813,222908,293729,358046,254076,150618,94264,70668,50241,321362,319796,175724,253611,107838,29233,108950,131537,59136,279540,342901,150979,127476,115605,313716,46445,402211,16446,222789,282781,210992,57619,139976,405443,313790,53253,168385,8504,352287,154329,5595,84659,47170,38830,131712,75236,40416,277624,166629,277033,112257,5700,94319,75728,85680,141102,78954,382472,350863,23321,425208,411846,42704,58039,178616,89594,71109,90813,183257,86485,215162,11178,168214,422853,195186,323791,113183,90892,190525,325060,229931,79683,19459,69904,410034,306081,204187,291721,173310,31523,319630,160452,138830,300011,75828,94880,127340,103093,22774,374884,82848,310639,193442,163343,404802,254818,218882,353418,258381,116597,404980,271194,5150,43719,151419,167956,399117,161879,270114,335871,364381,406815,9933,53674,207117,131200,28132,7658,274455,305162,119639,254763,213822,317979,8560,357439,198232,173942,89667,77825,278604,256789,400214,262803,93340,415741,401044,339163,237164,315038,168069,409513,258149,95253,161656,249598,168723,39600,202552,141301,97262,346484,50534,348318,219262,388378,34053,122309,70322,18409,403385,124454,267662,110287,254541,193398,159295,32386,399026,153507,360052,8547,356243,88200,372942,334265,216629,146142,112553,32932,19177,43960,173591,57375,117528,60551,409720,277193,126977,69697,390990,274357,296146,150329,67676,205058,371853,234077,31034,274642,322366,412164,71960,169105,74744,425233,414146,254304,171594,303732,418160,193511,169691,128656,224165,409373,245269,200536,385910,237078,307126,300327,104900,189018,186416,377113,287916,253331,82078,239799,127377,106497,335942,370913,147597,246413,305784,176863,358399,286552,127843,149369,409437,251157,312151,332546,58481,219280,390034,186405,376101,194812,289383,388295,26417,279959,381449,256747,396350,337396,74600,411985,55492,374373,35836,286345,108799,117645,71315,109765,206517,76000,110704,292905,282238,161036,192558,82015,234003,24226,78387,330308,282666,200412,374502,47704,87958,350678,6301,149611,1620,149040,379169,46987,21994,303124,362224,208371,246568,320044,198540,202278,116093,358612,306148,210351,428728,305605,160395,133586,247644,419036,274103,272778,150878,118184,120903,371051,160293,124202,244478,127764,142101,170862,236388,243646,51220,411430,4432,407744,95401,175272,212027,152839,298596,375729,160588,151342,160872,177470,414243,263228,132440,142212,181074,315730,231733,245467,218752,341458,18223,386273,270474,368991,400854,321683,349328,312182,335398,320865,274072,269926,318575,63392,241011,238881,42921,78003,294980,43057,90515,155841,144699,409878,291729,174046,99235,97919,406928,20329,149944,32256,387066,343430,199647,304122,23959,53823,220825,102093,360855,82423,271539,36890,383313,428235,260249,288453,302735,326436,356523,113960,162376,315838,241669,299417,21180,228236,353824,295733,112333,12692,307502,334919,276797,90545,158601,398619,116063,355852,52228,74085,364605,427423,185545,296981,227149,253820,127066,77885,284124,334548,242665,391049,279785,365441,74254,380153,137515,179031,127774,143021,255502,281810,121660,10614,116326,380048,127855,150473,80924,133631,251784,369835,48421,153922,398232,80459,90851,186753,408117,129717,321777,357976,247636,418300,206391,64408,334483,236685,270970,414623,298188,338193,147924,276497,62945,199887,326202,334995,283789,303728,417792,159655,65506,5418,68375,269366,267055,54443,277865,188801,166452,260749,334453,233925,17050,278357,234065,29930,173074,9811,42450,34671,179165,140102,417035,90011,109473,179653,184998,246657,328232,91674,262469,62612,169251,88176,370734,131129,21600,266876,37975,53052,149893,27564,385483,197794,133646,253164,66714,116554,401024,337323,67884,224194,412041,60644,418276,204183,291353,139454,357419,196392,4662,428904,321797,359816,416916,79063,392500,413277,174356,127755,141273,94686,109492,181401,345814,418975,268491,186555,389901,174169,110551,278829,277489,154209,424636,359222,362268,212419,188903,175836,263915,195644,365927,118966,192847,108603,99613,132695,165672,188989,183748,131657,70176,4977,27803,407471,70285,15005,90217,128425,202913,174513,142199,179878,205698,652,59984,357556,208996,304068,18991,26848,319611,158704,408095,127693,135569,430080,429989,421617,81474,184231,176093,287559,220487,70997,80509,95451,179872,205146,379949,118747,172699,405392,309098,51670,22749,372584,301329,197084,68326,264858,282400,175940,273483,215738,64170,312587,372658,308137,393339,60384,394356,153948,400624,300523,122932,127638,130509,394641,180168,232378,304807,86979,260610,321665,347672,159830,81606,196375,3098,285016,416612,51095,399930,236675,270050,329983,252766,30098,188530,141520,117410,49695,271130,429343,362185,204783,346553,56882,72172,188609,148788,355985,64464,339635,280588,9236,419631,328843,147886,273001,171394,285332,15603,145233,28925,80614,105111,208430,251996,389339,122465,84674,48550,165790,199845,322338,409588,265049,299972,72240,194865,294259,406806,9105,407579,80221,68955,322726,15203,108433,83973,414139,253660,112346,13888,417534,135919,32199,381822,291063,112774,53264,169397,101608,316235,278193,218977,362158,202299,118025,106275,315518,212229,171423,288000,261059,362973,277279,134889,367520,265522,343488,204983,364953,29358,120450,329375,196830,44958,265407,332908,91785,272681,141954,157338,282423,178056,38074,62160,127667,133177,210016,397908,50651,359082,349388,317702,413157,163316,402318,26290,268275,166683,282001,139232,336995,37708,28488,40410,277072,115845,335796,357481,202096,99349,108407,81581,194075,221579,171461,291496,152610,277528,157797,324651,192303,58555,226088,156208,178463,75518,66360,83986,415335,363692,343427,199371,278730,268381,176435,319023,104608,162154,295414,82985,323243,62767,183511,109853,214613,390751,252369,423655,268970,230623,143347,285494,30507,226158,162648,340862,393472,72620,229825,69931,412518,104528,154794,48375,149690,8888,387615,393938,115492,303320,380256,146991,190661,337572,90792,181325,338822,205792,9300,425519,10377,94522,94404,83548,375039,97108,332316,37321,422965,205490,411597,19796,100908,251835,374527,50004,299558,34152,131417,48096,124022,227918,324568,184667,216205,107134,394546,171428,288460,303379,385684,216286,114586,219968,23249,418584,232519,317779,420241,384963,149954,33176,41625,388852,77661,263516,158936,429439,371017,157165,266507,4027,370484,108129,56005,421569,77058,208040,216116,98946,71331,111237,341941,62659,173575,55903,412185,73892,346849,84114,427111,156841,236699,272258,103038,17714,339445,263108,121400,416775,66091,59238,288924,346067,12170,259478,217521,228206,351064,41813,406148,378650,429320,360069,10111,70050,423466,251582,351251,59017,268592,195847,384603,116834,426784,126757,49457,249234,135235,399352,183499,108749,113045,78196,312736,386366,279030,295981,135149,391440,315757,234217,43914,169359,98112,424684,363638,338459,172396,377516,324992,223675,364293,398719,125263,342090,76367,144468,388626,56869,70976,78577,347788,170502,203268,207173,136352,72035,176005,279463,335817,359413,379840,108719,110285,254357,176470,322243,400848,321131,298544,370945,150541,87180,279102,302605,314476,116365,383636,27870,413635,207292,147300,219089,372462,290105,24638,116291,376828,261696,421577,77794,275752,424486,345422,382911,391251,298369,354845,389665,152457,263452,153048,317824,424381,335762,354353,344401,288979,351127,47609,79218,406760,4873,18235,387377,372042,251465,340487,358972,339268,246824,343596,214919,418903,261867,7228,234895,106290,316898,339189,239556,105021,200150,350398,410622,360177,20047,124000,225894,138360,256771,398558,110451,269629,291251,130070,354253,335201,302741,326988,407307,55197,347233,119442,236639,266738,25279,175263,211199,76663,171700,313484,25101,158887,424931,386362,278662,262125,30964,268202,159967,94210,65700,23266,420148,376407,222964,298881,401949,422423,155626,124919,310442,175318,216259,112102,421521,72642,231849,256139,340414,352256,151477,173292,29867,167278,336741,14340,29037,90918,192917,115043,262012,20568,171932,334828,268425,180483,261358,390481,227529,288780,332819,83597,379547,81763,210819,41703,396028,307772,359759,411672,26696,305627,162419,319794,175540,236683,270786,397695,31055,276574,70029,421534,73838,341881,57139,95816,213452,283939,317528,397149,410904,386121,256490,372706,312553,369530,20361,152888,303104,360384,39091,155724,133935,279752,362405,225023,58228,196004,399047,155439,107715,17917,358121,260976,355337,4848,15935,175777,258487,126349,11921,236570,260390,301425,205916,20708,184812,229545,44171,193003,122955,129754,325181,241063,243665,52968,142165,176750,348003,190282,302704,323584,94139,59168,282484,183668,124297,253218,71682,143529,302238,280712,20644,178924,117930,97535,371600,210801,40047,243676,53980,235269,140698,41786,403664,150122,48632,173334,33731,92685,355481,18096,374589,55708,394245,143736,321282,312436,358766,320316,223564,354081,319377,137176,147843,269045,237523,348066,196078,405855,351694,99773,147415,229669,55579,382377,342123,79403,423780,280470,428461,281041,50912,383094,408087,126957,67857,221710,183513,110037,231541,227803,313988,71469,123933,219730,1353,124476,269686,296495,182437,11045,155978,157303,279203,311897,309178,59030,269788,305879,185603,302317,287980,259219,193693,186435,378861,18651,425649,22337,334680,254809,218054,277242,131485,54352,269493,278739,269209,252611,15838,166853,297641,287869,249007,114351,198348,184614,211329,88623,411858,43808,159607,61090,29227,108398,80753,117899,94683,109216,156009,160155,111506,366689,189070,191200,387160,352078,135101,387024,339566,274240,285382,20203,138352,256035,330846,332162,23153,409752,280137,397825,43015,86651,230434,125959,406122,376258,209256,327988,69226,347658,158542,393191,46768,1846,169832,141628,127346,103645,73558,316121,267705,114243,188412,130664,408901,201845,76257,134348,317748,417389,122579,95162,153284,339536,271480,31462,314018,74229,377853,355996,65476,2658,244536,133100,202932,176261,303015,352196,145957,95533,187416,39032,150296,64640,355827,49928,292566,251050,302307,287060,174579,148271,308421,419467,313755,50033,302226,279608,349157,296450,178297,60246,381660,276159,31849,349622,339230,243328,21964,300364,108304,72105,182445,11781,223690,365673,95598,193396,159111,15458,131893,91888,282157,153584,367136,230194,103879,95086,146292,126353,12289,270426,364575,424663,361706,160715,163026,375638,152216,241280,263629,169332,95628,196156,413031,151724,196016,400151,257007,420270,387631,395410,250916,289979,13046,340070,320608,250428,245083,183424,101849,338407,167612,367469,260830,341905,59347,298952,408481,163205,392106,377029,280188,402517,44598,232287,296435,176917,363367,313527,29057,92758,362197,205887,18040,369437,11805,225898,138728,290627,72662,233689,425419,1177,108284,70265,13165,351018,37581,16804,255725,302326,288808,335395,320589,248680,84267,11106,161590,243526,40180,255912,319530,151252,152592,275872,5445,70859,67813,217662,241178,254245,166166,234437,64154,311115,237234,321478,330468,297386,264409,241092,246333,298424,359905,425104,402278,22610,359796,415076,339864,301656,227168,255568,287882,250203,224383,429429,370097,72525,221085,126013,411090,403233,110470,271377,21986,302388,294512};

/* multiplication inverses of omega */
static const uint32_t w_3_inv[2]={217724,212356};

static const uint32_t w_7_inv[6][6]={{286614,393672,156258,105639,344027,4032},
{393672,105639,4032,286614,156258,344027},
{156258,4032,393672,344027,286614,105639},
{105639,286614,344027,393672,4032,156258},
{344027,156258,286614,4032,105639,393672},
{4032,344027,105639,156258,393672,286614}};

static const uint32_t omega_256_inv[128]={1,126013,255568,425104,321478,217662,255912,335395,70265,225898,313527,377029,367469,340070,400151,241280,270426,153584,365673,243328,296450,148271,64640,176261,74229,417389,114243,1846,376258,409752,274240,366689,108398,184614,252611,254809,259219,311897,124476,110037,281041,229669,269045,312436,92685,235269,178924,183668,176750,193003,236570,260976,225023,152888,397149,421534,319794,41703,390481,115043,173292,112102,298881,268202,313484,119442,130070,124000,339189,343596,18235,354353,354845,421577,147300,279102,176470,176005,70976,364293,98112,279030,135235,268592,429320,12170,339445,346849,71331,370484,77661,232519,288460,124022,100908,375039,338822,115492,412518,30507,214613,104608,415335,192303,194075,277072,268275,50651,282423,196830,367520,315518,101608,417534,322726,72240,84674,145233,9236,56882,141520,51095,321665,127638,308137,264858,405392,70997};
static const uint32_t omega_768_inv[768]={1,235944,316577,126013,81661,224265,255568,229587,113016,425104,257923,213055,321478,429829,323371,217662,70718,65316,255912,109014,205011,335395,394042,375716,70265,272853,63504,225898,199544,242466,313527,22326,53656,377029,206417,50127,367469,356622,54004,340070,274477,34389,400151,126100,394982,241280,36593,22717,270426,295308,18185,153584,318560,74837,365673,230983,48794,243328,268942,240346,296450,235527,416478,148271,4122,148027,64640,317819,283300,176261,182927,179414,74229,128694,428455,417389,52755,251499,114243,53798,334759,1846,310652,351144,376258,217856,255268,409752,187817,38251,274240,26191,205496,366689,394970,420519,108398,230885,150656,184614,392017,409107,252611,134561,281164,254809,61787,246352,259219,208888,307996,311897,356101,130346,124476,424097,67027,110037,300282,342673,281041,49124,260187,229669,106779,149477,269045,27961,217725,312436,225941,23192,92685,141033,93101,235269,184347,186795,178924,153458,265205,183668,401032,263641,176750,297835,156407,193003,63390,423385,236570,69657,35874,260976,164412,8971,225023,187424,209755,152888,392478,368798,397149,165619,79757,421534,36441,286033,319794,64896,78062,41703,179514,14174,390481,127325,411950,115043,3439,278650,173292,267140,419367,112102,242869,351058,298881,87337,170175,268202,254672,423615,313484,198678,203437,119442,135642,298595,130070,376244,355288,124000,365894,334806,339189,136936,252621,343596,6286,224696,18235,338597,234413,354353,147913,262127,354845,110491,328689,421577,290170,136252,147300,135671,259675,279102,159892,142971,176470,35908,111533,176005,422684,421011,70976,297447,217388,364293,199580,134830,98112,257984,412966,279030,375164,143720,135235,177450,307531,268592,235498,25317,429320,220474,360344,12170,217724,76492,339445,327260,11024,346849,267614,5682,71331,191772,351082,370484,373808,183920,77661,45979,106032,232519,330576,83989,288460,87990,272609,124022,395690,418204,100908,213154,25479,375039,326309,130562,338822,421850,190732,115492,142369,64912,412518,376044,45317,30507,107992,345684,214613,202975,353888,104608,141524,249816,415335,125066,284813,192303,53694,311200,194075,107730,29939,277072,303806,32675,268275,275344,309362,50651,138797,231704,282423,122334,377224,196830,281059,425387,367520,347498,286434,315518,138378,289798,101608,222850,137664,417534,288236,136497,322726,282456,167028,72240,54449,395386,84674,199644,182411,145233,151277,48217,9236,388438,214534,56882,289003,41444,141520,166202,9189,51095,388250,155405,321665,253014,172092,127638,288490,285014,308137,33683,265034,264858,26490,219468,405392,225729,322541,70997,91299,414290,430080,194137,113504,304068,348420,205816,174513,200494,317065,4977,172158,217026,108603,252,106710,212419,359363,364765,174169,321067,225070,94686,36039,54365,359816,157228,366577,204183,230537,187615,116554,407755,376425,53052,223664,379954,62612,73459,376077,90011,155604,395692,29930,303981,35099,188801,393488,407364,159655,134773,411896,276497,111521,355244,64408,199098,381287,186753,161139,189735,133631,194554,13603,281810,425959,282054,365441,112262,146781,253820,247154,250667,355852,301387,1626,12692,377326,178582,315838,376283,95322,428235,119429,78937,53823,212225,174813,20329,242264,391830,155841,403890,224585,63392,35111,9562,321683,199196,279425,245467,38064,20974,177470,295520,148917,175272,368294,183729,170862,221193,122085,118184,73980,299735,305605,5984,363054,320044,129799,87408,149040,380957,169894,200412,323302,280604,161036,402120,212356,117645,204140,406889,337396,289048,336980,194812,245734,243286,251157,276623,164876,246413,29049,166440,253331,132246,273674,237078,366691,6696,193511,360424,394207,169105,265669,421110,205058,242657,220326,277193,37603,61283,32932,264462,350324,8547,393640,144048,110287,365185,352019,388378,250567,415907,39600,302756,18131,315038,426642,151431,256789,162941,10714,317979,187212,79023,131200,342744,259906,161879,175409,6466,116597,231403,226644,310639,294439,131486,300011,53837,74793,306081,64187,95275,90892,293145,177460,86485,423795,205385,411846,91484,195668,75728,282168,167954,75236,319590,101392,8504,139911,293829,282781,294410,170406,150979,270189,287110,253611,394173,318548,254076,7397,9070,359105,132634,212693,65788,230501,295251,331969,172097,17115,151051,54917,286361,294846,252631,122550,161489,194583,404764,761,209607,69737,417911,212357,353589,90636,102821,419057,83232,162467,424399,358750,238309,78999,59597,56273,246161,352420,384102,324049,197562,99505,346092,141621,342091,157472,306059,34391,11877,329173,216927,404602,55042,103772,299519,91259,8231,239349,314589,287712,365169,17563,54037,384764,399574,322089,84397,215468,227106,76193,325473,288557,180265,14746,305015,145268,237778,376387,118881,236006,322351,400142,153009,126275,397406,161806,154737,120719,379430,291284,198377,147658,307747,52857,233251,149022,4694,62561,82583,143647,114563,291703,140283,328473,207231,292417,12547,141845,293584,107355,147625,263053,357841,375632,34695,345407,230437,247670,284848,278804,381864,420845,41643,215547,373199,141078,388637,288561,263879,420892,378986,41831,274676,108416,177067,257989,302443,141591,145067,121944,396398,165047,165223,403591,210613,24689,204352,107540,359084,338782,15791};
static const uint32_t omega_1792_inv[1792]={1,190921,173248,11860,376676,224343,23113,126013,226914,158583,412786,183223,50167,29937,255568,178597,235995,255673,11495,363633,210730,425104,265193,57109,323958,6627,365246,228307,321478,41728,361125,61015,300930,195902,241658,217662,100158,4096,125158,420239,409488,164349,255912,53028,52048,34703,133658,123045,420144,335395,48867,419455,395612,243513,419454,204691,70265,407594,258096,276003,384481,132083,49089,225898,149378,295947,175731,119441,40379,427215,313527,214787,415720,379975,4057,420697,114782,377029,96739,108155,11783,298513,216758,400136,367469,155743,99206,171567,344166,311625,71409,340070,186467,81251,360663,22118,255420,307635,400151,220717,173977,277106,230654,268663,228239,241280,303132,414807,251907,98441,344542,274394,270426,68539,319994,138343,19450,94096,419046,153584,348446,299605,113205,351312,416159,328499,365673,36184,324442,375057,351483,377494,278318,243328,365711,409886,26570,395656,42417,300908,296450,300931,386823,414906,229522,46753,228439,148271,116171,206321,322932,238617,236251,102215,64640,389226,301642,226058,160987,60362,353007,176261,238536,254566,261800,394223,414221,193261,74229,275878,173811,410214,286913,20227,61768,417389,337103,140537,1230,8604,204945,395127,114243,259969,43644,166830,411732,230397,231200,1846,203827,265625,389510,333000,399256,88579,376258,414431,289138,329505,185992,140867,213334,409752,248016,404798,173501,145801,340158,214356,274240,114100,53369,213878,191174,307189,405423,366689,45389,11200,382549,282209,367052,106671,108398,386919,249839,88171,325151,262531,181149,184614,261301,172545,409750,296255,58302,149781,252611,321553,168130,22214,90353,166284,248468,254809,206855,345549,285634,118276,399372,301284,259219,69867,115292,118352,286614,135621,300417,311897,392201,154616,401820,177845,310457,287720,124476,96579,96546,247368,121237,159938,201979,110037,207470,349851,173066,100799,241453,216228,281041,153282,321158,18510,402214,136544,187290,229669,156875,321116,171367,7094,68505,279895,269045,46291,189542,102761,227904,364814,325987,312436,79180,207711,343145,207977,378573,273278,92685,260221,416745,387145,389885,104848,425025,235269,133109,247180,354893,275470,122704,258314,178924,305417,137077,18986,103438,27040,241597,183668,284055,140798,372296,67827,289838,219014,176750,271328,246881,40206,84038,17212,313412,193003,275926,306318,124498,426112,37273,78207,236570,364593,280384,301837,38606,398029,222657,260976,54884,14680,312484,211687,352076,52263,225023,395012,92459,120175,400068,287271,417147,152888,362459,141677,30184,104145,392834,154848,397149,373848,51410,370109,132251,297823,86054,421534,355608,18227,131696,136594,271558,290449,319794,231352,206411,302582,348021,13408,26656,41703,318991,30625,4430,240784,224136,69918,390481,352380,31312,422533,129723,200417,367649,115043,318014,155962,193048,265751,361020,228117,173292,240845,258130,316102,253779,105242,383724,112102,75058,279579,149349,350291,312511,205582,298881,372483,73331,1058,286429,81878,75531,268202,380263,369018,426725,89814,49224,195373,313484,176723,277433,300076,150067,235730,411166,119442,231300,170382,325387,161382,209982,403088,130070,217530,273365,359734,279962,158322,41720,124000,395355,206050,193061,167238,32758,382297,339189,146737,128518,233947,193094,16416,158889,343596,297148,238679,31085,91566,369879,88683,18235,368821,232335,366438,293290,394214,416256,354353,397570,326442,305129,202197,12958,128406,354845,142963,408420,119115,161878,288978,317896,421577,393672,156514,211595,420665,26444,424146,147300,96791,144184,419059,55071,20184,23704,279102,257204,286547,246344,304988,377439,99607,176470,143492,336594,160054,414684,423079,292987,176005,391994,201421,236207,303311,183186,297467,70976,246829,4177,106843,260654,79905,139354,364293,204857,367238,351335,76451,12393,208372,98112,323359,46494,239215,5463,54998,275624,279030,273484,285040,252586,279419,137740,155795,135235,148762,100724,115051,125058,251703,287928,268592,5359,413021,321234,335833,236551,177742,429320,76497,193139,6241,213591,17134,44328,12170,211008,171098,259065,343622,100122,12236,339445,423360,181663,259540,284006,247451,54683,346849,326197,408313,334456,117825,310201,11097,71331,70986,5634,16333,225443,156685,172930,370484,334180,323592,232744,178385,188357,83982,77661,73306,389005,256039,215459,120413,250680,232519,229260,344928,426049,51518,345689,349552,288460,339448,135961,271326,295120,123791,60318,124022,294807,146777,23900,282571,237413,30621,100908,407954,176696,283538,353271,259928,387422,375039,355553,269597,64838,344456,198266,423933,338822,181933,198490,182137,9003,258087,278038,115492,25343,99653,357216,371442,21992,283910,412518,196034,68451,292105,375435,266013,62845,30507,270045,11327,114899,350574,152948,205532,214613,311703,340493,90822,251385,216471,226096,104608,192571,373606,297276,161950,272698,319403,415335,419241,396213,155407,31819,21174,229935,192303,386417,315560,424118,392565,406819,242185,194075,224682,233182,366069,376725,117690,340726,277072,190555,399365,255080,336726,416928,59046,268275,124823,113692,2262,61978,83185,162298,50651,398367,241805,327784,192835,27192,16081,282423,366451,194777,65952,140355,90169,303462,196830,222974,141512,354213,333652,156258,365053,367520,851,333234,346346,200997,140931,390010,315518,146894,427526,338780,334790,233451,114098,101608,297463,167454,413999,386818,320463,223444,417534,65383,316799,606,6337,48524,305864,322726,46262,243886,239541,314045,193235,271255,72240,295532,78420,45048,279451,226078,108678,84674,160126,398404,424586,286745,201574,201612,145233,277442,298041,419056,342470,360602,418205,9236,14256,217208,298386,54327,331771,151492,56882,423072,246783,253512,308974,145175,386130,141520,161257,429393,251138,367894,11859,185755,51095,11253,179418,2571,135470,286773,386390,321665,47232,72345,128430,206058,105,262979,127638,385138,413609,331641,276460,328935,171515,308137,334430,314851,106563,132818,169618,259202,264858,180643,346813,334337,192519,337577,320081,405392,39191,265754,73621,317780,208872,80630,70997,385441,201737,355903,429392,60217,194646,430080,239160,256833,418221,53405,205738,406968,304068,203167,271498,17295,246858,379914,400144,174513,251484,194086,174408,418586,66448,219351,4977,164888,372972,106123,423454,64835,201774,108603,388353,68956,369066,129151,234179,188423,212419,329923,425985,304923,9842,20593,265732,174169,377053,378033,395378,296423,307036,9937,94686,381214,10626,34469,186568,10627,225390,359816,22487,171985,154078,45600,297998,380992,204183,280703,134134,254350,310640,389702,2866,116554,215294,14361,50106,426024,9384,315299,53052,333342,321926,418298,131568,213323,29945,62612,274338,330875,258514,85915,118456,358672,90011,243614,348830,69418,407963,174661,122446,29930,209364,256104,152975,199427,161418,201842,188801,126949,15274,178174,331640,85539,155687,159655,361542,110087,291738,410631,335985,11035,276497,81635,130476,316876,78769,13922,101582,64408,393897,105639,55024,78598,52587,151763,186753,64370,20195,403511,34425,387664,129173,133631,129150,43258,15175,200559,383328,201642,281810,313910,223760,107149,191464,193830,327866,365441,40855,128439,204023,269094,369719,77074,253820,191545,175515,168281,35858,15860,236820,355852,154203,256270,19867,143168,409854,368313,12692,92978,289544,428851,421477,225136,34954,315838,170112,386437,263251,18349,199684,198881,428235,226254,164456,40571,97081,30825,341502,53823,15650,140943,100576,244089,289214,216747,20329,182065,25283,256580,284280,89923,215725,155841,315981,376712,216203,238907,122892,24658,63392,384692,418881,47532,147872,63029,323410,321683,43162,180242,341910,104930,167550,248932,245467,168780,257536,20331,133826,371779,280300,177470,108528,261951,407867,339728,263797,181613,175272,223226,84532,144447,311805,30709,128797,170862,360214,314789,311729,143467,294460,129664,118184,37880,275465,28261,252236,119624,142361,305605,333502,333535,182713,308844,270143,228102,320044,222611,80230,257015,329282,188628,213853,149040,276799,108923,411571,27867,293537,242791,200412,273206,108965,258714,422987,361576,150186,161036,383790,240539,327320,202177,65267,104094,117645,350901,222370,86936,222104,51508,156803,337396,169860,13336,42936,40196,325233,5056,194812,296972,182901,75188,154611,307377,171767,251157,124664,293004,411095,326643,403041,188484,246413,146026,289283,57785,362254,140243,211067,253331,158753,183200,389875,346043,412869,116669,237078,154155,123763,305583,3969,392808,351874,193511,65488,149697,128244,391475,32052,207424,169105,375197,415401,117597,218394,78005,377818,205058,35069,337622,309906,30013,142810,12934,277193,67622,288404,399897,325936,37247,275233,32932,56233,378671,59972,297830,132258,344027,8547,74473,411854,298385,293487,158523,139632,110287,198729,223670,127499,82060,416673,403425,388378,111090,399456,425651,189297,205945,360163,39600,77701,398769,7548,300358,229664,62432,315038,112067,274119,237033,164330,69061,201964,256789,189236,171951,113979,176302,324839,46357,317979,355023,150502,280732,79790,117570,224499,131200,57598,356750,429023,143652,348203,354550,161879,49818,61063,3356,340267,380857,234708,116597,253358,152648,130005,280014,194351,18915,310639,198781,259699,104694,268699,220099,26993,300011,212551,156716,70347,150119,271759,388361,306081,34726,224031,237020,262843,397323,47784,90892,283344,301563,196134,236987,413665,271192,86485,132933,191402,398996,338515,60202,341398,411846,61260,197746,63643,136791,35867,13825,75728,32511,103639,124952,227884,417123,301675,75236,287118,21661,310966,268203,141103,112185,8504,36409,273567,218486,9416,403637,5935,282781,333290,285897,11022,375010,409897,406377,150979,172877,143534,183737,125093,52642,330474,253611,286589,93487,270027,15397,7002,137094,254076,38087,228660,193874,126770,246895,132614,359105,183252,425904,323238,169427,350176,290727,65788,225224,62843,78746,353630,417688,221709,331969,106722,383587,190866,424618,375083,154457,151051,156597,145041,177495,150662,292341,274286,294846,281319,329357,315030,305023,178378,142153,161489,424722,17060,108847,94248,193530,252339,761,353584,236942,423840,216490,412947,385753,417911,219073,258983,171016,86459,329959,417845,90636,6721,248418,170541,146075,182630,375398,83232,103884,21768,95625,312256,119880,418984,358750,359095,424447,413748,204638,273396,257151,59597,95901,106489,197337,251696,241724,346099,352420,356775,41076,174042,214622,309668,179401,197562,200821,85153,4032,378563,84392,80529,141621,90633,294120,158755,134961,306290,369763,306059,135274,283304,406181,147510,192668,399460,329173,22127,253385,146543,76810,170153,42659,55042,74528,160484,365243,85625,231815,6148,91259,248148,231591,247944,421078,171994,152043,314589,404738,330428,72865,58639,408089,146171,17563,234047,361630,137976,54646,164068,367236,399574,160036,418754,315182,79507,277133,224549,215468,118378,89588,339259,178696,213610,203985,325473,237510,56475,132805,268131,157383,110678,14746,10840,33868,274674,398262,408907,200146,237778,43664,114521,5963,37516,23262,187896,236006,205399,196899,64012,53356,312391,89355,153009,239526,30716,175001,93355,13153,371035,161806,305258,316389,427819,368103,346896,267783,379430,31714,188276,102297,237246,402889,414000,147658,63630,235304,364129,289726,339912,126619,233251,207107,288569,75868,96429,273823,65028,62561,429230,96847,83735,229084,289150,40071,114563,283187,2555,91301,95291,196630,315983,328473,132618,262627,16082,43263,109618,206637,12547,364698,113282,429475,423744,381557,124217,107355,383819,186195,190540,116036,236846,158826,357841,134549,351661,385033,150630,204003,321403,345407,269955,31677,5495,143336,228507,228469,284848,152639,132040,11025,87611,69479,11876,420845,415825,212873,131695,375754,98310,278589,373199,7009,183298,176569,121107,284906,43951,288561,268824,688,178943,62187,418222,244326,378986,418828,250663,427510,294611,143308,43691,108416,382849,357736,301651,224023,429976,167102,302443,44943,16472,98440,153621,101146,258566,121944,95651,115230,323518,297263,260463,170879,165223,249438,83268,95744,237562,92504,110000,24689,390890,164327,356460,112301,221209,349451,359084,44640,228344,74178,689,369864,235435};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = barrett_4q2((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = barrett_4q2((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n)
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = barrett_2q2((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 5*256-->8*256 */
static void ntt_butterfly_1280_2048(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f;
	
	b = a[n2];
	c = a[N2_2048 + n2];
	d = a[N2_2048 * 2 + n2];
	e = a[N2_2048 * 3 + n2];
	f = a[N2_2048 * 4 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f);
	a[N2_2048 + n2] = (b + c * w_8[0][0] + d * w_8[0][1] + e * w_8[0][2] + f * w_8[0][3]) % Q;
	a[N2_2048 * 2 + n2] = (b + c * w_8[1][0] + d * w_8[1][1] + e * w_8[1][2] + f * w_8[1][3]) % Q;
	a[N2_2048 * 3 + n2] = (b + c * w_8[2][0] + d * w_8[2][1] + e * w_8[2][2] + f * w_8[2][3]) % Q;
	a[N2_2048 * 4 + n2] = (b + c * w_8[3][0] + d * w_8[3][1] + e * w_8[3][2] + f * w_8[3][3]) % Q;
	a[N2_2048 * 5 + n2] = (b + c * w_8[4][0] + d * w_8[4][1] + e * w_8[4][2] + f * w_8[4][3]) % Q;
	a[N2_2048 * 6 + n2] = (b + c * w_8[5][0] + d * w_8[5][1] + e * w_8[5][2] + f * w_8[5][3]) % Q;
	a[N2_2048 * 7 + n2] = (b + c * w_8[6][0] + d * w_8[6][1] + e * w_8[6][2] + f * w_8[6][3]) % Q;
}

/* 8*256-->3*256 */
static void ntt_butterfly_2048_768(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i;
	
	b = a[n2];
	c = a[N2_2048 + n2];
	d = a[N2_2048 * 2 + n2];
	e = a[N2_2048 * 3 + n2];
	f = a[N2_2048 * 4 + n2];
	g = a[N2_2048 * 5 + n2];
	h = a[N2_2048 * 6 + n2];
	i = a[N2_2048 * 7 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h + i);
	a[N2_2048 + n2] = (b + c * w_8[0][0] + d * w_8[0][1] + e * w_8[0][2] + f * w_8[0][3] + g * w_8[0][4] + h * w_8[0][5] + i * w_8[0][6]) % Q;
	a[N2_2048 * 2 + n2] = (b + c * w_8[1][0] + d * w_8[1][1] + e * w_8[1][2] + f * w_8[1][3] + g * w_8[1][4] + h * w_8[1][5] + i * w_8[1][6]) % Q;
}

/* 2*256-->7*256 */
static void ntt_butterfly_512_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_1792 + n2] = (b + c * w_7[0][0]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0]) % Q;
}

/* 5*256-->7*256 */
static void ntt_butterfly_1280_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2] + f * w_7[0][3]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2] + f * w_7[1][3]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0] + d * w_7[2][1] + e * w_7[2][2] + f * w_7[2][3]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0] + d * w_7[3][1] + e * w_7[3][2] + f * w_7[3][3]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0] + d * w_7[4][1] + e * w_7[4][2] + f * w_7[4][3]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0] + d * w_7[5][1] + e * w_7[5][2] + f * w_7[5][3]) % Q;
}

/* 7*256-->7*256 */
static void ntt_butterfly_1792_1792_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	g = a[N2_1792 * 5 + n2];
	h = a[N2_1792 * 6 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h);
	a[N2_1792 + n2] = (b + c * w_7_inv[0][0] + d * w_7_inv[0][1] + e * w_7_inv[0][2] + f * w_7_inv[0][3] + g * w_7_inv[0][4] + h * w_7_inv[0][5]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7_inv[1][0] + d * w_7_inv[1][1] + e * w_7_inv[1][2] + f * w_7_inv[1][3] + g * w_7_inv[1][4] + h * w_7_inv[1][5]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7_inv[2][0] + d * w_7_inv[2][1] + e * w_7_inv[2][2] + f * w_7_inv[2][3] + g * w_7_inv[2][4] + h * w_7_inv[2][5]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7_inv[3][0] + d * w_7_inv[3][1] + e * w_7_inv[3][2] + f * w_7_inv[3][3] + g * w_7_inv[3][4] + h * w_7_inv[3][5]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7_inv[4][0] + d * w_7_inv[4][1] + e * w_7_inv[4][2] + f * w_7_inv[4][3] + g * w_7_inv[4][4] + h * w_7_inv[4][5]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7_inv[5][0] + d * w_7_inv[5][1] + e * w_7_inv[5][2] + f * w_7_inv[5][3] + g * w_7_inv[5][4] + h * w_7_inv[5][5]) % Q;
}

/* 3*256-->3*256 */
static void ntt_butterfly_768_768_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_768 + n2];
	d = a[N2_768 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_768 + n2] = (b + c * w_3_inv[0] + d * w_3_inv[1]) % Q;
	a[N2_768 * 2 + n2] = (b + c * w_3_inv[1] + d * w_3_inv[0]) % Q;
}

/* 2*256-->3*256 */
static void ntt_butterfly_512_768(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_768 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_768 + n2] = (b + c * w_3[0]) % Q;
	a[N2_768 * 2 + n2] = (b + c * w_3[1]) % Q;
}

/* 3*256-->1*256 */
static void ntt_butterfly_768_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_8q(a[n2] + a[N2_768 + n2] + a[N2_768 * 2 + n2]);
}

/* 7*256-->8*256 */
static void ntt_butterfly_1792_2048(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h;
	
	b = a[n2];
	c = a[N2_2048 + n2];
	d = a[N2_2048 * 2 + n2];
	e = a[N2_2048 * 3 + n2];
	f = a[N2_2048 * 4 + n2];
	g = a[N2_2048 * 5 + n2];
	h = a[N2_2048 * 6 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h);
	a[N2_2048 + n2] = (b + c * w_8[0][0] + d * w_8[0][1] + e * w_8[0][2] + f * w_8[0][3] + g * w_8[0][4] + h * w_8[0][5]) % Q;
	a[N2_2048 * 2 + n2] = (b + c * w_8[1][0] + d * w_8[1][1] + e * w_8[1][2] + f * w_8[1][3] + g * w_8[1][4] + h * w_8[1][5]) % Q;
	a[N2_2048 * 3 + n2] = (b + c * w_8[2][0] + d * w_8[2][1] + e * w_8[2][2] + f * w_8[2][3] + g * w_8[2][4] + h * w_8[2][5]) % Q;
	a[N2_2048 * 4 + n2] = (b + c * w_8[3][0] + d * w_8[3][1] + e * w_8[3][2] + f * w_8[3][3] + g * w_8[3][4] + h * w_8[3][5]) % Q;
	a[N2_2048 * 5 + n2] = (b + c * w_8[4][0] + d * w_8[4][1] + e * w_8[4][2] + f * w_8[4][3] + g * w_8[4][4] + h * w_8[4][5]) % Q;
	a[N2_2048 * 6 + n2] = (b + c * w_8[5][0] + d * w_8[5][1] + e * w_8[5][2] + f * w_8[5][3] + g * w_8[5][4] + h * w_8[5][5]) % Q;
	a[N2_2048 * 7 + n2] = (b + c * w_8[6][0] + d * w_8[6][1] + e * w_8[6][2] + f * w_8[6][3] + g * w_8[6][4] + h * w_8[6][5]) % Q;
}

/* 8*256-->1*256 */
static void ntt_butterfly_2048_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_16q(a[n2] + a[N2_2048 + n2] + a[N2_2048 * 2 + n2] + a[N2_2048 * 3 + n2] + a[N2_2048 * 4 + n2] + a[N2_2048 * 5 + n2] + a[N2_2048 * 6 + n2] + a[N2_2048 * 7 + n2]);	
}

void ntt_1280_2048(uint32_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1280_2048);
}

void intt_2048_768(uint32_t *a)
{
	intt_core(a, N1_2048, N2_2048, 768, omega_256, omega_2048, ntt_butterfly_2048_768, INV_2048);
}

void ntt_512_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_512_1792);
}

void ntt_1280_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1280_1792);
}

void intt_1792_1792_inv(uint32_t *a)
{
	intt_core(a, N1_1792, N2_1792, 1792, omega_256_inv, omega_1792_inv, ntt_butterfly_1792_1792_inv, INV_1792);
}

void ntt_768_768_inv(uint32_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256_inv, omega_768_inv, ntt_butterfly_768_768_inv);
}

void ntt_512_768(uint32_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256, omega_768, ntt_butterfly_512_768);
}

void intt_768_256(uint32_t *a)
{
	intt_core(a, N1_768, N2_768, 256, omega_256, omega_768, ntt_butterfly_768_256, INV_768);
}

void ntt_1792_2048(uint32_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1792_2048);
}

void intt_2048_256(uint32_t *a)
{
	intt_core(a, N1_2048, N2_2048, 256, omega_256, omega_2048, ntt_butterfly_2048_256, INV_2048);
}
