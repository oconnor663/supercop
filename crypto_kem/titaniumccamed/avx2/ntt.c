/* ****************************** *
 * Titanium_CCA_med               *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>
#include <x86intrin.h>

/* 768=3*256 */
#define N1_768 3
#define N2_768 256

/* 1792=7*256 */
#define N1_1792 7
#define N2_1792 256

/* 2048=8*256 */
#define N1_2048 8
#define N2_2048 256

/* multiplication inverses of 768, 1792, 2048 (in Montgomery form) */
#define INV_768 146091
#define INV_1792 308371
#define INV_2048 1024

/* omega_n: n-th root of unity mod Q */
static const __m256i w_3[2]={{212356,212356,212356,212356},{217724,217724,217724,217724}};

static const __m256i w_7[6][6]={{{4032,4032,4032,4032},{344027,344027,344027,344027},{105639,105639,105639,105639},{156258,156258,156258,156258},{393672,393672,393672,393672},{286614,286614,286614,286614}},
{{344027,344027,344027,344027},{156258,156258,156258,156258},{286614,286614,286614,286614},{4032,4032,4032,4032},{105639,105639,105639,105639},{393672,393672,393672,393672}},
{{105639,105639,105639,105639},{286614,286614,286614,286614},{344027,344027,344027,344027},{393672,393672,393672,393672},{4032,4032,4032,4032},{156258,156258,156258,156258}},
{{156258,156258,156258,156258},{4032,4032,4032,4032},{393672,393672,393672,393672},{344027,344027,344027,344027},{286614,286614,286614,286614},{105639,105639,105639,105639}},
{{393672,393672,393672,393672},{105639,105639,105639,105639},{4032,4032,4032,4032},{286614,286614,286614,286614},{156258,156258,156258,156258},{344027,344027,344027,344027}},
{{286614,286614,286614,286614},{393672,393672,393672,393672},{156258,156258,156258,156258},{105639,105639,105639,105639},{344027,344027,344027,344027},{4032,4032,4032,4032}}};

static const __m256i w_8[7][7]={{{91259,91259,91259,91259},{116597,116597,116597,116597},{321683,321683,321683,321683},{430080,430080,430080,430080},{338822,338822,338822,338822},{313484,313484,313484,313484},{108398,108398,108398,108398}},
{{116597,116597,116597,116597},{430080,430080,430080,430080},{313484,313484,313484,313484},{1,1,1,1},{116597,116597,116597,116597},{430080,430080,430080,430080},{313484,313484,313484,313484}},
{{321683,321683,321683,321683},{313484,313484,313484,313484},{91259,91259,91259,91259},{430080,430080,430080,430080},{108398,108398,108398,108398},{116597,116597,116597,116597},{338822,338822,338822,338822}},
{{430080,430080,430080,430080},{1,1,1,1},{430080,430080,430080,430080},{1,1,1,1},{430080,430080,430080,430080},{1,1,1,1},{430080,430080,430080,430080}},
{{338822,338822,338822,338822},{116597,116597,116597,116597},{108398,108398,108398,108398},{430080,430080,430080,430080},{91259,91259,91259,91259},{313484,313484,313484,313484},{321683,321683,321683,321683}},
{{313484,313484,313484,313484},{430080,430080,430080,430080},{116597,116597,116597,116597},{1,1,1,1},{313484,313484,313484,313484},{430080,430080,430080,430080},{116597,116597,116597,116597}},
{{108398,108398,108398,108398},{313484,313484,313484,313484},{338822,338822,338822,338822},{430080,430080,430080,430080},{321683,321683,321683,321683},{116597,116597,116597,116597},{91259,91259,91259,91259}}};

/* omega_256,768,1792,2048, respectively (in Montgomery form) */
static const uint64_t omega_256[128]={376828,391251,424381,406760,339268,106290,360177,269629,55197,76663,262125,376407,175318,352256,90918,180483,81763,305627,276574,283939,369530,279752,17917,126349,229545,52968,59168,280712,243676,173334,143736,137176,99773,280470,221710,219730,157303,302317,22337,278739,114351,61090,160155,387024,332162,125959,393191,316121,134348,31462,133100,39032,287060,279608,349622,11781,91888,126353,375638,151724,289979,338407,163205,176917,369437,1177,302326,243526,70859,311115,298424,301656,72525,302388,142522,311334,232997,117494,129558,343102,145065,399983,225298,90446,144749,40742,165032,349860,317735,376817,312056,152802,309631,288127,220065,27763,401593,321674,272284,363721,253646,246570,286734,200256,42466,339289,335677,18484,298664,35535,406832,388456,163574,213965,17896,327043,141157,23933,78830,380624,117345,386167,105089,41455,293729,319796,279540,16446};
static const uint64_t omega_768[768]={376828,320313,310023,391251,130976,412568,424381,308310,6290,406760,317506,283029,339268,292052,34569,106290,249328,176974,360177,163863,193337,269629,339720,118207,55197,271721,258255,76663,337499,313038,262125,116331,106870,376407,123517,39612,175318,15141,396576,352256,236923,406555,90918,75760,270899,180483,290347,206017,81763,16371,35780,305627,217056,215807,276574,337560,416127,283939,86324,215595,369530,339303,414656,279752,201881,142499,17917,364130,223941,126349,31300,95231,229545,22427,188094,52968,340224,335413,59168,185956,268209,280712,308406,231983,243676,383090,284925,173334,81710,39610,143736,197739,108489,137176,258300,357177,99773,128740,370534,280470,357713,392210,221710,163270,291056,219730,293003,429056,157303,253898,88236,302317,418728,68554,22337,57147,98339,278739,118595,160971,114351,236603,84326,61090,507,264579,160155,131325,332574,387024,44974,120703,332162,332347,243115,125959,324025,5118,393191,229765,55799,316121,346625,344569,134348,329776,72068,31462,72887,61861,133100,406334,41755,39032,48239,68598,287060,340801,415119,279608,78382,387125,349622,361286,42761,11781,238779,39062,91888,340195,307555,126353,94464,160116,375638,22506,145340,151724,322514,229453,289979,416063,133477,338407,28512,368266,163205,124803,133031,176917,320252,206934,369437,160983,303843,1177,92524,61327,302326,130766,107025,243526,164845,217183,70859,293788,352642,311115,1702,211260,298424,15867,248655,301656,302821,205853,72525,366653,67101,302388,249646,37540,142522,381110,414658,311334,19283,505,232997,342753,273319,117494,408401,425677,129558,385142,1901,343102,193325,80137,145065,110009,54960,399983,392068,129793,225298,50686,1885,90446,363866,355927,144749,281025,90017,40742,385827,66711,165032,159533,201186,349860,248815,247730,317735,28439,75685,376817,146612,24069,312056,238279,315101,152802,141972,297680,309631,222313,223461,288127,416639,197392,220065,422016,379642,27763,152994,163277,401593,10718,226105,321674,297524,426721,272284,116887,285046,363721,216637,50593,253646,409714,85291,246570,63577,135353,286734,353907,72923,200256,286984,847,42466,84327,76881,339289,193582,267695,335677,357263,167556,18484,285926,67128,298664,365059,271026,35535,307561,221099,406832,164215,160716,388456,293474,125159,163574,360629,420099,213965,4979,348647,17896,32519,420896,327043,353446,104649,141157,330445,314303,23933,314885,182594,78830,150116,305365,380624,51609,384305,117345,205947,266636,386167,274679,89204,105089,207901,156418,41455,32623,342836,293729,281135,106703,319796,317615,283924,279540,294837,144242,16446,359943,339498,53253,109768,120058,38830,299105,17513,5700,121771,423791,23321,112575,147052,90813,138029,395512,323791,180753,253107,69904,266218,236744,160452,90361,311874,374884,158360,171826,353418,92582,117043,167956,313750,323211,53674,306564,390469,254763,414940,33505,77825,193158,23526,339163,354321,159182,249598,139734,224064,348318,413710,394301,124454,213025,214274,153507,92521,13954,146142,343757,214486,60551,90778,15425,150329,228200,287582,412164,65951,206140,303732,398781,334850,200536,407654,241987,377113,89857,94668,370913,244125,161872,149369,121675,198098,186405,46991,145156,256747,348371,390471,286345,232342,321592,292905,171781,72904,330308,301341,59547,149611,72368,37871,208371,266811,139025,210351,137078,1025,272778,176183,341845,127764,11353,361527,407744,372934,331742,151342,311486,269110,315730,193478,345755,368991,429574,165502,269926,298756,97507,43057,385107,309378,97919,97734,186966,304122,106056,424963,36890,200316,374282,113960,83456,85512,295733,100305,358013,398619,357194,368220,296981,23747,388326,391049,381842,361483,143021,89280,14962,150473,351699,42956,80459,68795,387320,418300,191302,391019,338193,89886,122526,303728,335617,269965,54443,407575,284741,278357,107567,200628,140102,14018,296604,91674,401569,61815,266876,305278,297050,253164,109829,223147,60644,269098,126238,428904,337557,368754,127755,299315,323056,186555,265236,212898,359222,136293,77439,118966,428379,218821,131657,414214,181426,128425,127260,224228,357556,63428,362980,127693,180435,392541,287559,48971,15423,118747,410798,429576,197084,87328,156762,312587,21680,4404,300523,44939,428180,86979,236756,349944,285016,320072,375121,30098,38013,300288,204783,379395,428196,339635,66215,74154,285332,149056,340064,389339,44254,363370,265049,270548,228895,80221,181266,182351,112346,401642,354396,53264,283469,406012,118025,191802,114980,277279,288109,132401,120450,207768,206620,141954,13442,232689,210016,8065,50439,402318,277087,266804,28488,419363,203976,108407,132557,3360,157797,313194,145035,66360,213444,379488,176435,20367,344790,183511,366504,294728,143347,76174,357158,229825,143097,429234,387615,345754,353200,90792,236499,162386,94404,72818,262525,411597,144155,362953,131417,65022,159055,394546,122520,208982,23249,265866,269365,41625,136607,304922,266507,69452,9982,216116,425102,81434,412185,397562,9185,103038,76635,325432,288924,99636,115778,406148,115196,247487,351251,279965,124716,49457,378472,45776,312736,224134,163445,43914,155402,340877,324992,222180,273663,388626,397458,87245,136352,148946,323378,110285,112466,146157,150541,135244,285839,413635,70138,90583};
static const uint64_t omega_1792[1792]={376828,101257,51965,295649,92951,107162,273848,391251,290767,305794,341233,350798,382457,285311,424381,303301,32262,373510,385104,294387,159952,406760,264492,106192,274909,310725,52518,176661,339268,58098,6506,221669,31989,181824,51186,106290,123165,512,120040,134728,352768,132008,360177,61387,206421,5216,147705,297339,153176,269629,148015,168419,409470,53138,348902,421775,55197,408280,298300,183605,31946,380063,60031,76663,374159,73583,350925,177032,379210,81803,262125,216523,21656,400186,376321,298230,46233,376407,331833,28543,5580,259926,312482,403972,175318,259598,74301,371422,379407,13750,11563,352256,11968,225449,138700,74413,75120,86318,90918,147960,121924,280757,15243,139841,335204,180483,12305,2059,59378,306606,128408,53747,81763,306507,44717,424177,13552,274262,232954,305627,160959,85093,267394,369934,138061,159798,276574,76128,86,33603,412391,59254,358174,283939,398392,345473,377197,100410,196104,119809,369530,70222,402930,428299,213886,216525,62445,279752,377699,16505,72840,35606,189839,297364,17917,54447,165240,302545,96936,308976,294301,126349,424450,205238,178099,421051,342414,137126,229545,238858,292075,316778,282220,391848,208975,52968,322485,336721,368148,270369,187110,336263,59168,324571,301629,339138,417380,93258,132099,280712,172693,269120,304199,283121,58769,143664,243676,64227,65866,161174,384141,223169,87988,173334,224524,412392,294689,297957,284628,42489,143736,421837,29413,115474,341018,51750,426682,137176,389108,238575,326525,154949,87233,43362,99773,322278,200829,360718,127746,315180,377965,280470,398196,218880,137461,395447,279970,92809,221710,223042,293413,79435,137021,23487,110428,219730,269546,390636,5458,352283,347579,319914,157303,356895,219274,1355,324404,121355,73433,302317,177881,275860,137209,417005,401819,349262,22337,311208,226239,337358,241974,189349,195922,278739,146918,374905,235045,157467,260945,235549,114351,17247,152724,83016,270996,287072,427332,61090,385429,256344,373153,200604,287806,344060,160155,30993,82709,246059,280208,215809,82737,387024,314456,235101,9316,329441,274133,397590,332162,72078,407994,56526,202427,264973,239124,125959,212053,35413,339470,307058,315021,360847,393191,288645,36765,387650,178983,386387,10549,316121,504,386965,186383,347256,398746,253749,134348,344316,220175,98357,259093,312063,245256,31462,400988,389632,173268,168730,85904,249215,133100,266759,106816,98647,152364,52373,14985,39032,388274,2721,228026,10404,154445,130349,287060,182598,353613,377161,226370,213511,95005,279608,21377,86133,403705,105999,424540,320419,349622,52980,137138,44198,376416,300343,346752,11781,67366,217173,375651,396507,394090,344858,91888,146899,202450,88925,144376,141806,197823,126353,75947,394451,180855,287682,395628,315686,375638,346419,316749,335901,417817,188994,52211,151724,332404,276656,28153,223264,90101,43772,289979,147925,53238,237947,421209,124097,84622,338407,346795,243623,58521,246800,124657,323436,163205,302554,65446,197104,300502,363870,329141,176917,399288,125462,182890,287673,427118,427558,369437,108898,412058,364222,196628,54502,211735,1177,134831,87956,380872,1063,390344,71398,302326,146391,163988,143410,224445,306510,320941,243526,15619,66715,57824,9466,378049,273284,70859,276756,347279,222698,159001,150195,330086,311115,264915,346486,177897,172091,33899,428029,298424,132037,306496,35418,226402,5973,318466,301656,244668,81764,111861,414581,424866,87730,72525,277594,234630,80329,306302,379695,296313,302388,120607,301263,186128,92590,271165,78054,142522,177531,19081,139190,175855,244379,423928,311334,215460,61393,328788,73995,151839,312326,232997,107388,152114,114720,16400,296863,337257,117494,250132,126333,98138,308548,167075,94365,129558,283048,75254,238695,193379,240286,169913,343102,405950,88025,282809,146900,7804,28708,145065,215984,426167,170993,4950,313821,402064,399983,322007,49932,336447,371108,426749,428405,225298,284738,135479,401162,67546,17454,288616,90446,413619,159002,385630,269869,311804,339093,144749,222537,101094,383350,219157,410725,58416,40742,426308,251091,115973,410970,109137,340412,165032,361299,149723,165664,348193,369788,171031,349860,175980,428246,208180,397459,25928,219047,317735,231071,395033,8186,77949,366545,49101,376817,91958,284271,288070,137155,175864,212889,312056,317535,22900,396165,300467,295184,286331,152802,383544,304961,340814,192082,238601,426701,309631,105147,251666,15583,192675,75231,414743,288127,224439,184143,252162,239392,632,416975,220065,5367,1667,236273,257215,288401,221479,27763,10867,350357,205143,175986,120532,276959,401593,40915,298868,155494,235170,341334,45197,321674,354900,174901,141671,240092,84109,413013,272284,320247,282416,88360,18630,188012,238619,363721,85887,117549,296627,255046,136033,87528,253646,399160,95452,149208,199481,394116,14953,246570,164813,410754,4735,14773,16208,251848,286734,415287,200629,152547,128878,177380,165119,200256,71816,225607,350464,21909,183982,194255,42466,319784,86504,13566,129704,250078,315273,339289,271342,32192,236138,299484,246157,128464,335677,150259,345091,327956,309011,362987,169159,18484,220982,428681,263127,7924,325643,230402,298664,295826,47089,200778,395801,188246,280041,35535,247113,271961,399079,378862,295894,143672,406832,12572,71378,324517,60488,150208,380174,388456,273872,20557,135802,322330,401181,240001,163574,301707,209585,21264,147000,326930,28142,213965,322407,36193,334183,216627,422360,158752,17896,271284,139554,288076,259522,244643,217023,327043,397356,290740,400264,246768,332195,99975,141157,79263,69815,58867,422001,363544,131749,23933,174674,27970,146759,357787,347766,47916,78830,55657,327968,123664,70464,177427,48458,380624,104199,271325,330607,399665,287771,275374,117345,6878,66965,425558,8051,120218,324301,386167,254650,231350,279005,410883,270180,418319,105089,359028,67521,152713,73717,73221,279493,41455,129792,324470,177149,399921,347791,342738,293729,72882,32013,241211,326302,122826,183113,319796,331238,151124,137972,280052,44834,14807,279540,354875,310160,356853,222867,380064,295466,16446,374848,147761,149188,221672,308213,1173,53253,328824,378116,134432,337130,322919,156233,38830,139314,124287,88848,79283,47624,144770,5700,126780,397819,56571,44977,135694,270129,23321,165589,323889,155172,119356,377563,253420,90813,371983,423575,208412,398092,248257,378895,323791,306916,429569,310041,295353,77313,298073,69904,368694,223660,424865,282376,132742,276905,160452,282066,261662,20611,376943,81179,8306,374884,21801,131781,246476,398135,50018,370050,353418,55922,356498,79156,253049,50871,348278,167956,213558,408425,29895,53760,131851,383848,53674,98248,401538,424501,170155,117599,26109,254763,170483,355780,58659,50674,416331,418518,77825,418113,204632,291381,355668,354961,343763,339163,282121,308157,149324,414838,290240,94877,249598,417776,428022,370703,123475,301673,376334,348318,123574,385364,5904,416529,155819,197127,124454,269122,344988,162687,60147,292020,270283,153507,353953,429995,396478,17690,370827,71907,146142,31689,84608,52884,329671,233977,310272,60551,359859,27151,1782,216195,213556,367636,150329,52382,413576,357241,394475,240242,132717,412164,375634,264841,127536,333145,121105,135780,303732,5631,224843,251982,9030,87667,292955,200536,191223,138006,113303,147861,38233,221106,377113,107596,93360,61933,159712,242971,93818,370913,105510,128452,90943,12701,336823,297982,149369,257388,160961,125882,146960,371312,286417,186405,365854,364215,268907,45940,206912,342093,256747,205557,17689,135392,132124,145453,387592,286345,8244,400668,314607,89063,378331,3399,292905,40973,191506,103556,275132,342848,386719,330308,107803,229252,69363,302335,114901,52116,149611,31885,211201,292620,34634,150111,337272,208371,207039,136668,350646,293060,406594,319653,210351,160535,39445,424623,77798,82502,110167,272778,73186,210807,428726,105677,308726,356648,127764,252200,154221,292872,13076,28262,80819,407744,118873,203842,92723,188107,240732,234159,151342,283163,55176,195036,272614,169136,194532,315730,412834,277357,347065,159085,143009,2749,368991,44652,173737,56928,229477,142275,86021,269926,399088,347372,184022,149873,214272,347344,43057,115625,194980,420765,100640,155948,32491,97919,358003,22087,373555,227654,165108,190957,304122,218028,394668,90611,123023,115060,69234,36890,141436,393316,42431,251098,43694,419532,113960,429577,43116,243698,82825,31335,176332,295733,85765,209906,331724,170988,118018,184825,398619,29093,40449,256813,261351,344177,180866,296981,163322,323265,331434,277717,377708,415096,391049,41807,427360,202055,419677,275636,299732,143021,247483,76468,52920,203711,216570,335076,150473,408704,343948,26376,324082,5541,109662,80459,377101,292943,385883,53665,129738,83329,418300,362715,212908,54430,33574,35991,85223,338193,283182,227631,341156,285705,288275,232258,303728,354134,35630,249226,142399,34453,114395,54443,83662,113332,94180,12264,241087,377870,278357,97677,153425,401928,206817,339980,386309,140102,282156,376843,192134,8872,305984,345459,91674,83286,186458,371560,183281,305424,106645,266876,127527,364635,232977,129579,66211,100940,253164,30793,304619,247191,142408,2963,2523,60644,321183,18023,65859,233453,375579,218346,428904,295250,342125,49209,429018,39737,358683,127755,283690,266093,286671,205636,123571,109140,186555,414462,363366,372257,420615,52032,156797,359222,153325,82802,207383,271080,279886,99995,118966,165166,83595,252184,257990,396182,2052,131657,298044,123585,394663,203679,424108,111615,128425,185413,348317,318220,15500,5215,342351,357556,152487,195451,349752,123779,50386,133768,127693,309474,128818,243953,337491,158916,352027,287559,252550,411000,290891,254226,185702,6153,118747,214621,368688,101293,356086,278242,117755,197084,322693,277967,315361,413681,133218,92824,312587,179949,303748,331943,121533,263006,335716,300523,147033,354827,191386,236702,189795,260168,86979,24131,342056,147272,283181,422277,401373,285016,214097,3914,259088,425131,116260,28017,30098,108074,380149,93634,58973,3332,1676,204783,145343,294602,28919,362535,412627,141465,339635,16462,271079,44451,160212,118277,90988,285332,207544,328987,46731,210924,19356,371665,389339,3773,178990,314108,19111,320944,89669,265049,68782,280358,264417,81888,60293,259050,80221,254101,1835,221901,32622,404153,211034,112346,199010,35048,421895,352132,63536,380980,53264,338123,145810,142011,292926,254217,217192,118025,112546,407181,33916,129614,134897,143750,277279,46537,125120,89267,237999,191480,3380,120450,324934,178415,414498,237406,354850,15338,141954,205642,245938,177919,190689,429449,13106,210016,424714,428414,193808,172866,141680,208602,402318,419214,79724,224938,254095,309549,153122,28488,389166,131213,274587,194911,88747,384884,108407,75181,255180,288410,189989,345972,17068,157797,109834,147665,341721,411451,242069,191462,66360,344194,312532,133454,175035,294048,342553,176435,30921,334629,280873,230600,35965,415128,183511,265268,19327,425346,415308,413873,178233,143347,14794,229452,277534,301203,252701,264962,229825,358265,204474,79617,408172,246099,235826,387615,110297,343577,416515,300377,180003,114808,90792,158739,397889,193943,130597,183924,301617,94404,279822,84990,102125,121070,67094,260922,411597,209099,1400,166954,422157,104438,199679,131417,134255,382992,229303,34280,241835,150040,394546,182968,158120,31002,51219,134187,286409,23249,417509,358703,105564,369593,279873,49907,41625,156209,409524,294279,107751,28900,190080,266507,128374,220496,408817,283081,103151,401939,216116,107674,393888,95898,213454,7721,271329,412185,158797,290527,142005,170559,185438,213058,103038,32725,139341,29817,183313,97886,330106,288924,350818,360266,371214,8080,66537,298332,406148,255407,402111,283322,72294,82315,382165,351251,374424,102113,306417,359617,252654,381623,49457,325882,158756,99474,30416,142310,154707,312736,423203,363116,4523,422030,309863,105780,43914,175431,198731,151076,19198,159901,11762,324992,71053,362560,277368,356364,356860,150588,388626,300289,105611,252932,30160,82290,87343,136352,357199,398068,188870,103779,307255,246968,110285,98843,278957,292109,150029,385247,415274,150541,75206,119921,73228,207214,50017,134615,413635,55233,282320,280893,208409,121868,428908};
static const uint64_t omega_2048[2048]={376828,261696,421577,77794,275752,424486,345422,382911,391251,298369,354845,389665,152457,263452,153048,317824,424381,335762,354353,344401,288979,351127,47609,79218,406760,4873,18235,387377,372042,251465,340487,358972,339268,246824,343596,214919,418903,261867,7228,234895,106290,316898,339189,239556,105021,200150,350398,410622,360177,20047,124000,225894,138360,256771,398558,110451,269629,291251,130070,354253,335201,302741,326988,407307,55197,347233,119442,236639,266738,25279,175263,211199,76663,171700,313484,25101,158887,424931,386362,278662,262125,30964,268202,159967,94210,65700,23266,420148,376407,222964,298881,401949,422423,155626,124919,310442,175318,216259,112102,421521,72642,231849,256139,340414,352256,151477,173292,29867,167278,336741,14340,29037,90918,192917,115043,262012,20568,171932,334828,268425,180483,261358,390481,227529,288780,332819,83597,379547,81763,210819,41703,396028,307772,359759,411672,26696,305627,162419,319794,175540,236683,270786,397695,31055,276574,70029,421534,73838,341881,57139,95816,213452,283939,317528,397149,410904,386121,256490,372706,312553,369530,20361,152888,303104,360384,39091,155724,133935,279752,362405,225023,58228,196004,399047,155439,107715,17917,358121,260976,355337,4848,15935,175777,258487,126349,11921,236570,260390,301425,205916,20708,184812,229545,44171,193003,122955,129754,325181,241063,243665,52968,142165,176750,348003,190282,302704,323584,94139,59168,282484,183668,124297,253218,71682,143529,302238,280712,20644,178924,117930,97535,371600,210801,40047,243676,53980,235269,140698,41786,403664,150122,48632,173334,33731,92685,355481,18096,374589,55708,394245,143736,321282,312436,358766,320316,223564,354081,319377,137176,147843,269045,237523,348066,196078,405855,351694,99773,147415,229669,55579,382377,342123,79403,423780,280470,428461,281041,50912,383094,408087,126957,67857,221710,183513,110037,231541,227803,313988,71469,123933,219730,1353,124476,269686,296495,182437,11045,155978,157303,279203,311897,309178,59030,269788,305879,185603,302317,287980,259219,193693,186435,378861,18651,425649,22337,334680,254809,218054,277242,131485,54352,269493,278739,269209,252611,15838,166853,297641,287869,249007,114351,198348,184614,211329,88623,411858,43808,159607,61090,29227,108398,80753,117899,94683,109216,156009,160155,111506,366689,189070,191200,387160,352078,135101,387024,339566,274240,285382,20203,138352,256035,330846,332162,23153,409752,280137,397825,43015,86651,230434,125959,406122,376258,209256,327988,69226,347658,158542,393191,46768,1846,169832,141628,127346,103645,73558,316121,267705,114243,188412,130664,408901,201845,76257,134348,317748,417389,122579,95162,153284,339536,271480,31462,314018,74229,377853,355996,65476,2658,244536,133100,202932,176261,303015,352196,145957,95533,187416,39032,150296,64640,355827,49928,292566,251050,302307,287060,174579,148271,308421,419467,313755,50033,302226,279608,349157,296450,178297,60246,381660,276159,31849,349622,339230,243328,21964,300364,108304,72105,182445,11781,223690,365673,95598,193396,159111,15458,131893,91888,282157,153584,367136,230194,103879,95086,146292,126353,12289,270426,364575,424663,361706,160715,163026,375638,152216,241280,263629,169332,95628,196156,413031,151724,196016,400151,257007,420270,387631,395410,250916,289979,13046,340070,320608,250428,245083,183424,101849,338407,167612,367469,260830,341905,59347,298952,408481,163205,392106,377029,280188,402517,44598,232287,296435,176917,363367,313527,29057,92758,362197,205887,18040,369437,11805,225898,138728,290627,72662,233689,425419,1177,108284,70265,13165,351018,37581,16804,255725,302326,288808,335395,320589,248680,84267,11106,161590,243526,40180,255912,319530,151252,152592,275872,5445,70859,67813,217662,241178,254245,166166,234437,64154,311115,237234,321478,330468,297386,264409,241092,246333,298424,359905,425104,402278,22610,359796,415076,339864,301656,227168,255568,287882,250203,224383,429429,370097,72525,221085,126013,411090,403233,110470,271377,21986,302388,294512,1,92,8464,348607,245850,253988,142522,209594,359084,349572,334630,250209,224935,50132,311334,257382,24689,120983,378411,407332,57497,128752,232997,361755,165223,147681,254141,156598,214343,365911,117494,57423,121944,36742,369697,35725,276133,29457,129558,307149,302443,299572,35440,249913,197703,125274,343102,169471,108416,82409,270251,348475,233706,426983,145065,13469,378986,30151,193406,160031,100098,177315,399983,241551,288561,312671,380386,158951,738,67896,225298,83528,373199,357909,241472,281293,74096,365617,90446,149493,420845,10450,101238,282195,157080,258687,144749,414478,284848,401156,349467,324970,221651,178085,40742,307616,345407,381531,264291,230236,107743,20493,165032,130109,357841,235216,135822,23275,420976,22502,349860,361126,107355,414878,321648,346108,15942,176421,317735,416193,12547,294162,397882,48259,139018,317307,376817,260684,328473,113846,151888,211104,67923,227782,312056,323806,114563,217852,258658,142081,169022,67108,152802,295192,62561,164559,86593,225098,65128,400723,309631,100706,233251,385123,164674,97173,338296,157400,288127,272743,147658,252025,392007,367921,302414,296904,220065,32173,379430,70999,80693,112379,16924,266765,27763,403791,161806,263398,148080,290849,93086,392373,401593,389671,153009,314236,94285,72600,227985,330732,321674,348500,236006,208502,258620,138585,277471,152553,272284,105430,237778,371526,203993,273873,251618,354563,363721,346095,14746,66389,86654,230710,151351,161700,253646,111058,325473,267927,134667,347096,106838,367314,246570,320228,215468,39330,177712,6426,161111,199458,286734,144587,399574,203923,267433,89219,36609,357461,200256,360150,17563,325553,275287,381706,280391,421193,42466,36143,314589,126761,49825,283090,239420,92509,339289,248756,91259,224289,420781,4562,419704,335559,335677,346533,55042,332973,97765,392760,7116,224591,18484,410285,329173,178246,55554,380077,130523,395929,298664,381985,306059,202163,105513,245414,213876,322947,35535,258653,141621,126702,44397,213795,315495,210113,406832,11497,197562,112302,9840,45118,280127,396905,388456,41229,352420,166565,271145,642,59064,272916,163574,426054,59597,321952,374076,8512,353023,222041,213965,331135,358750,318844,88140,367422,256506,374178,17896,356189,83232,345967,2970,273240,193382,157823,327043,412367,90636,166973,308681,13306,363990,370843,141157,84014,417911,170603,212560,201875,79017,388268,23933,51431,761,70012,419970,360031,6615,178499,78830,371064,161489,234234,45478,313247,3297,303324,380624,180847,294846,30729,246582,321332,317036,351885,117345,43715,151051,134100,294932,38641,114324,195864,386167,260722,331969,5397,66443,91622,257685,52565,105089,206406,65788,31362,304818,87991,353714,285613,41455,373212,359105,351504,82293,259579,226813,222908,293729,358046,254076,150618,94264,70668,50241,321362,319796,175724,253611,107838,29233,108950,131537,59136,279540,342901,150979,127476,115605,313716,46445,402211,16446,222789,282781,210992,57619,139976,405443,313790,53253,168385,8504,352287,154329,5595,84659,47170,38830,131712,75236,40416,277624,166629,277033,112257,5700,94319,75728,85680,141102,78954,382472,350863,23321,425208,411846,42704,58039,178616,89594,71109,90813,183257,86485,215162,11178,168214,422853,195186,323791,113183,90892,190525,325060,229931,79683,19459,69904,410034,306081,204187,291721,173310,31523,319630,160452,138830,300011,75828,94880,127340,103093,22774,374884,82848,310639,193442,163343,404802,254818,218882,353418,258381,116597,404980,271194,5150,43719,151419,167956,399117,161879,270114,335871,364381,406815,9933,53674,207117,131200,28132,7658,274455,305162,119639,254763,213822,317979,8560,357439,198232,173942,89667,77825,278604,256789,400214,262803,93340,415741,401044,339163,237164,315038,168069,409513,258149,95253,161656,249598,168723,39600,202552,141301,97262,346484,50534,348318,219262,388378,34053,122309,70322,18409,403385,124454,267662,110287,254541,193398,159295,32386,399026,153507,360052,8547,356243,88200,372942,334265,216629,146142,112553,32932,19177,43960,173591,57375,117528,60551,409720,277193,126977,69697,390990,274357,296146,150329,67676,205058,371853,234077,31034,274642,322366,412164,71960,169105,74744,425233,414146,254304,171594,303732,418160,193511,169691,128656,224165,409373,245269,200536,385910,237078,307126,300327,104900,189018,186416,377113,287916,253331,82078,239799,127377,106497,335942,370913,147597,246413,305784,176863,358399,286552,127843,149369,409437,251157,312151,332546,58481,219280,390034,186405,376101,194812,289383,388295,26417,279959,381449,256747,396350,337396,74600,411985,55492,374373,35836,286345,108799,117645,71315,109765,206517,76000,110704,292905,282238,161036,192558,82015,234003,24226,78387,330308,282666,200412,374502,47704,87958,350678,6301,149611,1620,149040,379169,46987,21994,303124,362224,208371,246568,320044,198540,202278,116093,358612,306148,210351,428728,305605,160395,133586,247644,419036,274103,272778,150878,118184,120903,371051,160293,124202,244478,127764,142101,170862,236388,243646,51220,411430,4432,407744,95401,175272,212027,152839,298596,375729,160588,151342,160872,177470,414243,263228,132440,142212,181074,315730,231733,245467,218752,341458,18223,386273,270474,368991,400854,321683,349328,312182,335398,320865,274072,269926,318575,63392,241011,238881,42921,78003,294980,43057,90515,155841,144699,409878,291729,174046,99235,97919,406928,20329,149944,32256,387066,343430,199647,304122,23959,53823,220825,102093,360855,82423,271539,36890,383313,428235,260249,288453,302735,326436,356523,113960,162376,315838,241669,299417,21180,228236,353824,295733,112333,12692,307502,334919,276797,90545,158601,398619,116063,355852,52228,74085,364605,427423,185545,296981,227149,253820,127066,77885,284124,334548,242665,391049,279785,365441,74254,380153,137515,179031,127774,143021,255502,281810,121660,10614,116326,380048,127855,150473,80924,133631,251784,369835,48421,153922,398232,80459,90851,186753,408117,129717,321777,357976,247636,418300,206391,64408,334483,236685,270970,414623,298188,338193,147924,276497,62945,199887,326202,334995,283789,303728,417792,159655,65506,5418,68375,269366,267055,54443,277865,188801,166452,260749,334453,233925,17050,278357,234065,29930,173074,9811,42450,34671,179165,140102,417035,90011,109473,179653,184998,246657,328232,91674,262469,62612,169251,88176,370734,131129,21600,266876,37975,53052,149893,27564,385483,197794,133646,253164,66714,116554,401024,337323,67884,224194,412041,60644,418276,204183,291353,139454,357419,196392,4662,428904,321797,359816,416916,79063,392500,413277,174356,127755,141273,94686,109492,181401,345814,418975,268491,186555,389901,174169,110551,278829,277489,154209,424636,359222,362268,212419,188903,175836,263915,195644,365927,118966,192847,108603,99613,132695,165672,188989,183748,131657,70176,4977,27803,407471,70285,15005,90217,128425,202913,174513,142199,179878,205698,652,59984,357556,208996,304068,18991,26848,319611,158704,408095,127693,135569,430080,429989,421617,81474,184231,176093,287559,220487,70997,80509,95451,179872,205146,379949,118747,172699,405392,309098,51670,22749,372584,301329,197084,68326,264858,282400,175940,273483,215738,64170,312587,372658,308137,393339,60384,394356,153948,400624,300523,122932,127638,130509,394641,180168,232378,304807,86979,260610,321665,347672,159830,81606,196375,3098,285016,416612,51095,399930,236675,270050,329983,252766,30098,188530,141520,117410,49695,271130,429343,362185,204783,346553,56882,72172,188609,148788,355985,64464,339635,280588,9236,419631,328843,147886,273001,171394,285332,15603,145233,28925,80614,105111,208430,251996,389339,122465,84674,48550,165790,199845,322338,409588,265049,299972,72240,194865,294259,406806,9105,407579,80221,68955,322726,15203,108433,83973,414139,253660,112346,13888,417534,135919,32199,381822,291063,112774,53264,169397,101608,316235,278193,218977,362158,202299,118025,106275,315518,212229,171423,288000,261059,362973,277279,134889,367520,265522,343488,204983,364953,29358,120450,329375,196830,44958,265407,332908,91785,272681,141954,157338,282423,178056,38074,62160,127667,133177,210016,397908,50651,359082,349388,317702,413157,163316,402318,26290,268275,166683,282001,139232,336995,37708,28488,40410,277072,115845,335796,357481,202096,99349,108407,81581,194075,221579,171461,291496,152610,277528,157797,324651,192303,58555,226088,156208,178463,75518,66360,83986,415335,363692,343427,199371,278730,268381,176435,319023,104608,162154,295414,82985,323243,62767,183511,109853,214613,390751,252369,423655,268970,230623,143347,285494,30507,226158,162648,340862,393472,72620,229825,69931,412518,104528,154794,48375,149690,8888,387615,393938,115492,303320,380256,146991,190661,337572,90792,181325,338822,205792,9300,425519,10377,94522,94404,83548,375039,97108,332316,37321,422965,205490,411597,19796,100908,251835,374527,50004,299558,34152,131417,48096,124022,227918,324568,184667,216205,107134,394546,171428,288460,303379,385684,216286,114586,219968,23249,418584,232519,317779,420241,384963,149954,33176,41625,388852,77661,263516,158936,429439,371017,157165,266507,4027,370484,108129,56005,421569,77058,208040,216116,98946,71331,111237,341941,62659,173575,55903,412185,73892,346849,84114,427111,156841,236699,272258,103038,17714,339445,263108,121400,416775,66091,59238,288924,346067,12170,259478,217521,228206,351064,41813,406148,378650,429320,360069,10111,70050,423466,251582,351251,59017,268592,195847,384603,116834,426784,126757,49457,249234,135235,399352,183499,108749,113045,78196,312736,386366,279030,295981,135149,391440,315757,234217,43914,169359,98112,424684,363638,338459,172396,377516,324992,223675,364293,398719,125263,342090,76367,144468,388626,56869,70976,78577,347788,170502,203268,207173,136352,72035,176005,279463,335817,359413,379840,108719,110285,254357,176470,322243,400848,321131,298544,370945,150541,87180,279102,302605,314476,116365,383636,27870,413635,207292,147300,219089,372462,290105,24638,116291};

/* multiplication inverses of omega */
static const __m256i w_3_inv[2]={{217724,217724,217724,217724},{212356,212356,212356,212356}};

static const __m256i w_7_inv[6][6]={{{286614,286614,286614,286614},{393672,393672,393672,393672},{156258,156258,156258,156258},{105639,105639,105639,105639},{344027,344027,344027,344027},{4032,4032,4032,4032}},
{{393672,393672,393672,393672},{105639,105639,105639,105639},{4032,4032,4032,4032},{286614,286614,286614,286614},{156258,156258,156258,156258},{344027,344027,344027,344027}},
{{156258,156258,156258,156258},{4032,4032,4032,4032},{393672,393672,393672,393672},{344027,344027,344027,344027},{286614,286614,286614,286614},{105639,105639,105639,105639}},
{{105639,105639,105639,105639},{286614,286614,286614,286614},{344027,344027,344027,344027},{393672,393672,393672,393672},{4032,4032,4032,4032},{156258,156258,156258,156258}},
{{344027,344027,344027,344027},{156258,156258,156258,156258},{286614,286614,286614,286614},{4032,4032,4032,4032},{105639,105639,105639,105639},{393672,393672,393672,393672}},
{{4032,4032,4032,4032},{344027,344027,344027,344027},{105639,105639,105639,105639},{156258,156258,156258,156258},{393672,393672,393672,393672},{286614,286614,286614,286614}}};

/* (in Montgomery form) */
static const uint64_t omega_256_inv[128]={376828,413635,150541,110285,136352,388626,324992,43914,312736,49457,351251,406148,288924,103038,412185,216116,266507,41625,23249,394546,131417,411597,94404,90792,387615,229825,143347,183511,176435,66360,157797,108407,28488,402318,210016,141954,120450,277279,118025,53264,112346,80221,265049,389339,285332,339635,204783,30098,285016,86979,300523,312587,197084,118747,287559,127693,357556,128425,131657,118966,359222,186555,127755,428904,60644,253164,266876,91674,140102,278357,54443,303728,338193,418300,80459,150473,143021,391049,296981,398619,295733,113960,36890,304122,97919,43057,269926,368991,315730,151342,407744,127764,272778,210351,208371,149611,330308,292905,286345,256747,186405,149369,370913,377113,200536,303732,412164,150329,60551,146142,153507,124454,348318,249598,339163,77825,254763,53674,167956,353418,374884,160452,69904,323791,90813,23321,5700,38830};
static const uint64_t omega_768_inv[768]={376828,90583,70138,413635,285839,135244,150541,146157,112466,110285,323378,148946,136352,87245,397458,388626,273663,222180,324992,340877,155402,43914,163445,224134,312736,45776,378472,49457,124716,279965,351251,247487,115196,406148,115778,99636,288924,325432,76635,103038,9185,397562,412185,81434,425102,216116,9982,69452,266507,304922,136607,41625,269365,265866,23249,208982,122520,394546,159055,65022,131417,362953,144155,411597,262525,72818,94404,162386,236499,90792,353200,345754,387615,429234,143097,229825,357158,76174,143347,294728,366504,183511,344790,20367,176435,379488,213444,66360,145035,313194,157797,3360,132557,108407,203976,419363,28488,266804,277087,402318,50439,8065,210016,232689,13442,141954,206620,207768,120450,132401,288109,277279,114980,191802,118025,406012,283469,53264,354396,401642,112346,182351,181266,80221,228895,270548,265049,363370,44254,389339,340064,149056,285332,74154,66215,339635,428196,379395,204783,300288,38013,30098,375121,320072,285016,349944,236756,86979,428180,44939,300523,4404,21680,312587,156762,87328,197084,429576,410798,118747,15423,48971,287559,392541,180435,127693,362980,63428,357556,224228,127260,128425,181426,414214,131657,218821,428379,118966,77439,136293,359222,212898,265236,186555,323056,299315,127755,368754,337557,428904,126238,269098,60644,223147,109829,253164,297050,305278,266876,61815,401569,91674,296604,14018,140102,200628,107567,278357,284741,407575,54443,269965,335617,303728,122526,89886,338193,391019,191302,418300,387320,68795,80459,42956,351699,150473,14962,89280,143021,361483,381842,391049,388326,23747,296981,368220,357194,398619,358013,100305,295733,85512,83456,113960,374282,200316,36890,424963,106056,304122,186966,97734,97919,309378,385107,43057,97507,298756,269926,165502,429574,368991,345755,193478,315730,269110,311486,151342,331742,372934,407744,361527,11353,127764,341845,176183,272778,1025,137078,210351,139025,266811,208371,37871,72368,149611,59547,301341,330308,72904,171781,292905,321592,232342,286345,390471,348371,256747,145156,46991,186405,198098,121675,149369,161872,244125,370913,94668,89857,377113,241987,407654,200536,334850,398781,303732,206140,65951,412164,287582,228200,150329,15425,90778,60551,214486,343757,146142,13954,92521,153507,214274,213025,124454,394301,413710,348318,224064,139734,249598,159182,354321,339163,23526,193158,77825,33505,414940,254763,390469,306564,53674,323211,313750,167956,117043,92582,353418,171826,158360,374884,311874,90361,160452,236744,266218,69904,253107,180753,323791,395512,138029,90813,147052,112575,23321,423791,121771,5700,17513,299105,38830,120058,109768,53253,339498,359943,16446,144242,294837,279540,283924,317615,319796,106703,281135,293729,342836,32623,41455,156418,207901,105089,89204,274679,386167,266636,205947,117345,384305,51609,380624,305365,150116,78830,182594,314885,23933,314303,330445,141157,104649,353446,327043,420896,32519,17896,348647,4979,213965,420099,360629,163574,125159,293474,388456,160716,164215,406832,221099,307561,35535,271026,365059,298664,67128,285926,18484,167556,357263,335677,267695,193582,339289,76881,84327,42466,847,286984,200256,72923,353907,286734,135353,63577,246570,85291,409714,253646,50593,216637,363721,285046,116887,272284,426721,297524,321674,226105,10718,401593,163277,152994,27763,379642,422016,220065,197392,416639,288127,223461,222313,309631,297680,141972,152802,315101,238279,312056,24069,146612,376817,75685,28439,317735,247730,248815,349860,201186,159533,165032,66711,385827,40742,90017,281025,144749,355927,363866,90446,1885,50686,225298,129793,392068,399983,54960,110009,145065,80137,193325,343102,1901,385142,129558,425677,408401,117494,273319,342753,232997,505,19283,311334,414658,381110,142522,37540,249646,302388,67101,366653,72525,205853,302821,301656,248655,15867,298424,211260,1702,311115,352642,293788,70859,217183,164845,243526,107025,130766,302326,61327,92524,1177,303843,160983,369437,206934,320252,176917,133031,124803,163205,368266,28512,338407,133477,416063,289979,229453,322514,151724,145340,22506,375638,160116,94464,126353,307555,340195,91888,39062,238779,11781,42761,361286,349622,387125,78382,279608,415119,340801,287060,68598,48239,39032,41755,406334,133100,61861,72887,31462,72068,329776,134348,344569,346625,316121,55799,229765,393191,5118,324025,125959,243115,332347,332162,120703,44974,387024,332574,131325,160155,264579,507,61090,84326,236603,114351,160971,118595,278739,98339,57147,22337,68554,418728,302317,88236,253898,157303,429056,293003,219730,291056,163270,221710,392210,357713,280470,370534,128740,99773,357177,258300,137176,108489,197739,143736,39610,81710,173334,284925,383090,243676,231983,308406,280712,268209,185956,59168,335413,340224,52968,188094,22427,229545,95231,31300,126349,223941,364130,17917,142499,201881,279752,414656,339303,369530,215595,86324,283939,416127,337560,276574,215807,217056,305627,35780,16371,81763,206017,290347,180483,270899,75760,90918,406555,236923,352256,396576,15141,175318,39612,123517,376407,106870,116331,262125,313038,337499,76663,258255,271721,55197,118207,339720,269629,193337,163863,360177,176974,249328,106290,34569,292052,339268,283029,317506,406760,6290,308310,424381,412568,130976,391251,310023,320313};
static const uint64_t omega_1792_inv[1792]={376828,428908,121868,208409,280893,282320,55233,413635,134615,50017,207214,73228,119921,75206,150541,415274,385247,150029,292109,278957,98843,110285,246968,307255,103779,188870,398068,357199,136352,87343,82290,30160,252932,105611,300289,388626,150588,356860,356364,277368,362560,71053,324992,11762,159901,19198,151076,198731,175431,43914,105780,309863,422030,4523,363116,423203,312736,154707,142310,30416,99474,158756,325882,49457,381623,252654,359617,306417,102113,374424,351251,382165,82315,72294,283322,402111,255407,406148,298332,66537,8080,371214,360266,350818,288924,330106,97886,183313,29817,139341,32725,103038,213058,185438,170559,142005,290527,158797,412185,271329,7721,213454,95898,393888,107674,216116,401939,103151,283081,408817,220496,128374,266507,190080,28900,107751,294279,409524,156209,41625,49907,279873,369593,105564,358703,417509,23249,286409,134187,51219,31002,158120,182968,394546,150040,241835,34280,229303,382992,134255,131417,199679,104438,422157,166954,1400,209099,411597,260922,67094,121070,102125,84990,279822,94404,301617,183924,130597,193943,397889,158739,90792,114808,180003,300377,416515,343577,110297,387615,235826,246099,408172,79617,204474,358265,229825,264962,252701,301203,277534,229452,14794,143347,178233,413873,415308,425346,19327,265268,183511,415128,35965,230600,280873,334629,30921,176435,342553,294048,175035,133454,312532,344194,66360,191462,242069,411451,341721,147665,109834,157797,17068,345972,189989,288410,255180,75181,108407,384884,88747,194911,274587,131213,389166,28488,153122,309549,254095,224938,79724,419214,402318,208602,141680,172866,193808,428414,424714,210016,13106,429449,190689,177919,245938,205642,141954,15338,354850,237406,414498,178415,324934,120450,3380,191480,237999,89267,125120,46537,277279,143750,134897,129614,33916,407181,112546,118025,217192,254217,292926,142011,145810,338123,53264,380980,63536,352132,421895,35048,199010,112346,211034,404153,32622,221901,1835,254101,80221,259050,60293,81888,264417,280358,68782,265049,89669,320944,19111,314108,178990,3773,389339,371665,19356,210924,46731,328987,207544,285332,90988,118277,160212,44451,271079,16462,339635,141465,412627,362535,28919,294602,145343,204783,1676,3332,58973,93634,380149,108074,30098,28017,116260,425131,259088,3914,214097,285016,401373,422277,283181,147272,342056,24131,86979,260168,189795,236702,191386,354827,147033,300523,335716,263006,121533,331943,303748,179949,312587,92824,133218,413681,315361,277967,322693,197084,117755,278242,356086,101293,368688,214621,118747,6153,185702,254226,290891,411000,252550,287559,352027,158916,337491,243953,128818,309474,127693,133768,50386,123779,349752,195451,152487,357556,342351,5215,15500,318220,348317,185413,128425,111615,424108,203679,394663,123585,298044,131657,2052,396182,257990,252184,83595,165166,118966,99995,279886,271080,207383,82802,153325,359222,156797,52032,420615,372257,363366,414462,186555,109140,123571,205636,286671,266093,283690,127755,358683,39737,429018,49209,342125,295250,428904,218346,375579,233453,65859,18023,321183,60644,2523,2963,142408,247191,304619,30793,253164,100940,66211,129579,232977,364635,127527,266876,106645,305424,183281,371560,186458,83286,91674,345459,305984,8872,192134,376843,282156,140102,386309,339980,206817,401928,153425,97677,278357,377870,241087,12264,94180,113332,83662,54443,114395,34453,142399,249226,35630,354134,303728,232258,288275,285705,341156,227631,283182,338193,85223,35991,33574,54430,212908,362715,418300,83329,129738,53665,385883,292943,377101,80459,109662,5541,324082,26376,343948,408704,150473,335076,216570,203711,52920,76468,247483,143021,299732,275636,419677,202055,427360,41807,391049,415096,377708,277717,331434,323265,163322,296981,180866,344177,261351,256813,40449,29093,398619,184825,118018,170988,331724,209906,85765,295733,176332,31335,82825,243698,43116,429577,113960,419532,43694,251098,42431,393316,141436,36890,69234,115060,123023,90611,394668,218028,304122,190957,165108,227654,373555,22087,358003,97919,32491,155948,100640,420765,194980,115625,43057,347344,214272,149873,184022,347372,399088,269926,86021,142275,229477,56928,173737,44652,368991,2749,143009,159085,347065,277357,412834,315730,194532,169136,272614,195036,55176,283163,151342,234159,240732,188107,92723,203842,118873,407744,80819,28262,13076,292872,154221,252200,127764,356648,308726,105677,428726,210807,73186,272778,110167,82502,77798,424623,39445,160535,210351,319653,406594,293060,350646,136668,207039,208371,337272,150111,34634,292620,211201,31885,149611,52116,114901,302335,69363,229252,107803,330308,386719,342848,275132,103556,191506,40973,292905,3399,378331,89063,314607,400668,8244,286345,387592,145453,132124,135392,17689,205557,256747,342093,206912,45940,268907,364215,365854,186405,286417,371312,146960,125882,160961,257388,149369,297982,336823,12701,90943,128452,105510,370913,93818,242971,159712,61933,93360,107596,377113,221106,38233,147861,113303,138006,191223,200536,292955,87667,9030,251982,224843,5631,303732,135780,121105,333145,127536,264841,375634,412164,132717,240242,394475,357241,413576,52382,150329,367636,213556,216195,1782,27151,359859,60551,310272,233977,329671,52884,84608,31689,146142,71907,370827,17690,396478,429995,353953,153507,270283,292020,60147,162687,344988,269122,124454,197127,155819,416529,5904,385364,123574,348318,376334,301673,123475,370703,428022,417776,249598,94877,290240,414838,149324,308157,282121,339163,343763,354961,355668,291381,204632,418113,77825,418518,416331,50674,58659,355780,170483,254763,26109,117599,170155,424501,401538,98248,53674,383848,131851,53760,29895,408425,213558,167956,348278,50871,253049,79156,356498,55922,353418,370050,50018,398135,246476,131781,21801,374884,8306,81179,376943,20611,261662,282066,160452,276905,132742,282376,424865,223660,368694,69904,298073,77313,295353,310041,429569,306916,323791,378895,248257,398092,208412,423575,371983,90813,253420,377563,119356,155172,323889,165589,23321,270129,135694,44977,56571,397819,126780,5700,144770,47624,79283,88848,124287,139314,38830,156233,322919,337130,134432,378116,328824,53253,1173,308213,221672,149188,147761,374848,16446,295466,380064,222867,356853,310160,354875,279540,14807,44834,280052,137972,151124,331238,319796,183113,122826,326302,241211,32013,72882,293729,342738,347791,399921,177149,324470,129792,41455,279493,73221,73717,152713,67521,359028,105089,418319,270180,410883,279005,231350,254650,386167,324301,120218,8051,425558,66965,6878,117345,275374,287771,399665,330607,271325,104199,380624,48458,177427,70464,123664,327968,55657,78830,47916,347766,357787,146759,27970,174674,23933,131749,363544,422001,58867,69815,79263,141157,99975,332195,246768,400264,290740,397356,327043,217023,244643,259522,288076,139554,271284,17896,158752,422360,216627,334183,36193,322407,213965,28142,326930,147000,21264,209585,301707,163574,240001,401181,322330,135802,20557,273872,388456,380174,150208,60488,324517,71378,12572,406832,143672,295894,378862,399079,271961,247113,35535,280041,188246,395801,200778,47089,295826,298664,230402,325643,7924,263127,428681,220982,18484,169159,362987,309011,327956,345091,150259,335677,128464,246157,299484,236138,32192,271342,339289,315273,250078,129704,13566,86504,319784,42466,194255,183982,21909,350464,225607,71816,200256,165119,177380,128878,152547,200629,415287,286734,251848,16208,14773,4735,410754,164813,246570,14953,394116,199481,149208,95452,399160,253646,87528,136033,255046,296627,117549,85887,363721,238619,188012,18630,88360,282416,320247,272284,413013,84109,240092,141671,174901,354900,321674,45197,341334,235170,155494,298868,40915,401593,276959,120532,175986,205143,350357,10867,27763,221479,288401,257215,236273,1667,5367,220065,416975,632,239392,252162,184143,224439,288127,414743,75231,192675,15583,251666,105147,309631,426701,238601,192082,340814,304961,383544,152802,286331,295184,300467,396165,22900,317535,312056,212889,175864,137155,288070,284271,91958,376817,49101,366545,77949,8186,395033,231071,317735,219047,25928,397459,208180,428246,175980,349860,171031,369788,348193,165664,149723,361299,165032,340412,109137,410970,115973,251091,426308,40742,58416,410725,219157,383350,101094,222537,144749,339093,311804,269869,385630,159002,413619,90446,288616,17454,67546,401162,135479,284738,225298,428405,426749,371108,336447,49932,322007,399983,402064,313821,4950,170993,426167,215984,145065,28708,7804,146900,282809,88025,405950,343102,169913,240286,193379,238695,75254,283048,129558,94365,167075,308548,98138,126333,250132,117494,337257,296863,16400,114720,152114,107388,232997,312326,151839,73995,328788,61393,215460,311334,423928,244379,175855,139190,19081,177531,142522,78054,271165,92590,186128,301263,120607,302388,296313,379695,306302,80329,234630,277594,72525,87730,424866,414581,111861,81764,244668,301656,318466,5973,226402,35418,306496,132037,298424,428029,33899,172091,177897,346486,264915,311115,330086,150195,159001,222698,347279,276756,70859,273284,378049,9466,57824,66715,15619,243526,320941,306510,224445,143410,163988,146391,302326,71398,390344,1063,380872,87956,134831,1177,211735,54502,196628,364222,412058,108898,369437,427558,427118,287673,182890,125462,399288,176917,329141,363870,300502,197104,65446,302554,163205,323436,124657,246800,58521,243623,346795,338407,84622,124097,421209,237947,53238,147925,289979,43772,90101,223264,28153,276656,332404,151724,52211,188994,417817,335901,316749,346419,375638,315686,395628,287682,180855,394451,75947,126353,197823,141806,144376,88925,202450,146899,91888,344858,394090,396507,375651,217173,67366,11781,346752,300343,376416,44198,137138,52980,349622,320419,424540,105999,403705,86133,21377,279608,95005,213511,226370,377161,353613,182598,287060,130349,154445,10404,228026,2721,388274,39032,14985,52373,152364,98647,106816,266759,133100,249215,85904,168730,173268,389632,400988,31462,245256,312063,259093,98357,220175,344316,134348,253749,398746,347256,186383,386965,504,316121,10549,386387,178983,387650,36765,288645,393191,360847,315021,307058,339470,35413,212053,125959,239124,264973,202427,56526,407994,72078,332162,397590,274133,329441,9316,235101,314456,387024,82737,215809,280208,246059,82709,30993,160155,344060,287806,200604,373153,256344,385429,61090,427332,287072,270996,83016,152724,17247,114351,235549,260945,157467,235045,374905,146918,278739,195922,189349,241974,337358,226239,311208,22337,349262,401819,417005,137209,275860,177881,302317,73433,121355,324404,1355,219274,356895,157303,319914,347579,352283,5458,390636,269546,219730,110428,23487,137021,79435,293413,223042,221710,92809,279970,395447,137461,218880,398196,280470,377965,315180,127746,360718,200829,322278,99773,43362,87233,154949,326525,238575,389108,137176,426682,51750,341018,115474,29413,421837,143736,42489,284628,297957,294689,412392,224524,173334,87988,223169,384141,161174,65866,64227,243676,143664,58769,283121,304199,269120,172693,280712,132099,93258,417380,339138,301629,324571,59168,336263,187110,270369,368148,336721,322485,52968,208975,391848,282220,316778,292075,238858,229545,137126,342414,421051,178099,205238,424450,126349,294301,308976,96936,302545,165240,54447,17917,297364,189839,35606,72840,16505,377699,279752,62445,216525,213886,428299,402930,70222,369530,119809,196104,100410,377197,345473,398392,283939,358174,59254,412391,33603,86,76128,276574,159798,138061,369934,267394,85093,160959,305627,232954,274262,13552,424177,44717,306507,81763,53747,128408,306606,59378,2059,12305,180483,335204,139841,15243,280757,121924,147960,90918,86318,75120,74413,138700,225449,11968,352256,11563,13750,379407,371422,74301,259598,175318,403972,312482,259926,5580,28543,331833,376407,46233,298230,376321,400186,21656,216523,262125,81803,379210,177032,350925,73583,374159,76663,60031,380063,31946,183605,298300,408280,55197,421775,348902,53138,409470,168419,148015,269629,153176,297339,147705,5216,206421,61387,360177,132008,352768,134728,120040,512,123165,106290,51186,181824,31989,221669,6506,58098,339268,176661,52518,310725,274909,106192,264492,406760,159952,294387,385104,373510,32262,303301,424381,285311,382457,350798,341233,305794,290767,391251,273848,107162,92951,295649,51965,101257};

static const __m256i V_B4Q_B4Q_B4Q_B4Q = {BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q};
static const __m256i V_B8Q_B8Q_B8Q_B8Q = {BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q};
static const __m256i V_B16Q_B16Q_B16Q_B16Q = {BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q};
static const __m256i V_Q_Q_Q_Q = {Q, Q, Q, Q};
static const __m256i V_Q2_Q2_Q2_Q2 = {Q2, Q2, Q2, Q2};
static const __m256i V_MM_MM_MM_MM = {MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK};
static const __m256i V_MF_MF_MF_MF = {MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint64_t *a)
{
uint64_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint64_t *a, uint32_t n, const uint64_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	__m256i u, v, t, t1, o, u1, v1, r1, r2;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			j_omega = 0;

			for (j = j1; j < j2; j += 4)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = _mm256_loadu_si256((__m256i *)(a + j));
				v = _mm256_loadu_si256((__m256i *)(a + j + d));
				
				t = _mm256_add_epi64(u, v);
				t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
				t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				r1 = _mm256_sub_epi64(t, t1);
				
				t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
				t = _mm256_sub_epi64(t, v);
				o = _mm256_set_epi64x(omega[j_omega + num_of_problems * 3], omega[j_omega + num_of_problems * 2], omega[j_omega + num_of_problems], omega[j_omega]);
				t = _mm256_mul_epu32(t, o);
				t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
				t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				t1 = _mm256_add_epi64(t, t1);
				r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);

				_mm256_storeu_si256((__m256i *)(a + j), r1);
				_mm256_storeu_si256((__m256i *)(a + j + d), r2);

				j_omega += num_of_problems * 4;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k += 2)
	{
		j = k << 2;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);
		
		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		o = _mm256_set_epi64x(omega[num_of_problems], omega[0], omega[num_of_problems], omega[0]);
		t = _mm256_mul_epu32(t, o);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
		
		u = _mm256_permute2f128_si256(r1, r2, 0x20);
		v = _mm256_permute2f128_si256(r1, r2, 0x31);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
	
	for (k = 0; k < (n >> 1); k += 4)
	{
		j = k << 1;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u1 = _mm256_permute4x64_epi64(u1, 0xD8);
		v1 = _mm256_permute4x64_epi64(v1, 0xD8);
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);

		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r2 = _mm256_sub_epi64(t, t1);

		u1 = _mm256_permute2f128_si256(r1, r2, 0x20);
		v1 = _mm256_permute2f128_si256(r1, r2, 0x31);
		u = _mm256_permute4x64_epi64(u1, 0xD8);
		v = _mm256_permute4x64_epi64(v1, 0xD8);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint64_t *a, uint32_t N1, uint32_t N2, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t))
{
	uint32_t n1, n2;
	__m256i u, v, t, t1;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint64_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t), uint64_t inv_n)
{
	uint32_t i, n1, n2;
	__m256i u, v, t, t1;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i += 4)
	{
		u = _mm256_loadu_si256((__m256i *)(a + i));
		v = _mm256_set1_epi64x(inv_n);
		
		t = _mm256_mul_epu32(u, v);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
		_mm256_storeu_si256((__m256i *)(a + i), u);
	}
}

/* 5*256-->8*256 */
static void ntt_butterfly_1280_2048(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, c1, d1, e1, f1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_8[0][0]);
	d1 = _mm256_mul_epu32(d, w_8[0][1]);
	e1 = _mm256_mul_epu32(e, w_8[0][2]);
	f1 = _mm256_mul_epu32(f, w_8[0][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 + n2), t);
	a[N2_2048 + n2] %= Q;
	a[N2_2048 + n2 + 1] %= Q;
	a[N2_2048 + n2 + 2] %= Q;
	a[N2_2048 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_8[1][0]);
	d1 = _mm256_mul_epu32(d, w_8[1][1]);
	e1 = _mm256_mul_epu32(e, w_8[1][2]);
	f1 = _mm256_mul_epu32(f, w_8[1][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 2 + n2), t);
	a[N2_2048 * 2 + n2] %= Q;
	a[N2_2048 * 2 + n2 + 1] %= Q;
	a[N2_2048 * 2 + n2 + 2] %= Q;
	a[N2_2048 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[2][0]);
	d1 = _mm256_mul_epu32(d, w_8[2][1]);
	e1 = _mm256_mul_epu32(e, w_8[2][2]);
	f1 = _mm256_mul_epu32(f, w_8[2][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 3 + n2), t);
	a[N2_2048 * 3 + n2] %= Q;
	a[N2_2048 * 3 + n2 + 1] %= Q;
	a[N2_2048 * 3 + n2 + 2] %= Q;
	a[N2_2048 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[3][0]);
	d1 = _mm256_mul_epu32(d, w_8[3][1]);
	e1 = _mm256_mul_epu32(e, w_8[3][2]);
	f1 = _mm256_mul_epu32(f, w_8[3][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 4 + n2), t);
	a[N2_2048 * 4 + n2] %= Q;
	a[N2_2048 * 4 + n2 + 1] %= Q;
	a[N2_2048 * 4 + n2 + 2] %= Q;
	a[N2_2048 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[4][0]);
	d1 = _mm256_mul_epu32(d, w_8[4][1]);
	e1 = _mm256_mul_epu32(e, w_8[4][2]);
	f1 = _mm256_mul_epu32(f, w_8[4][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 5 + n2), t);
	a[N2_2048 * 5 + n2] %= Q;
	a[N2_2048 * 5 + n2 + 1] %= Q;
	a[N2_2048 * 5 + n2 + 2] %= Q;
	a[N2_2048 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[5][0]);
	d1 = _mm256_mul_epu32(d, w_8[5][1]);
	e1 = _mm256_mul_epu32(e, w_8[5][2]);
	f1 = _mm256_mul_epu32(f, w_8[5][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 6 + n2), t);
	a[N2_2048 * 6 + n2] %= Q;
	a[N2_2048 * 6 + n2 + 1] %= Q;
	a[N2_2048 * 6 + n2 + 2] %= Q;
	a[N2_2048 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[6][0]);
	d1 = _mm256_mul_epu32(d, w_8[6][1]);
	e1 = _mm256_mul_epu32(e, w_8[6][2]);
	f1 = _mm256_mul_epu32(f, w_8[6][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 7 + n2), t);
	a[N2_2048 * 7 + n2] %= Q;
	a[N2_2048 * 7 + n2 + 1] %= Q;
	a[N2_2048 * 7 + n2 + 2] %= Q;
	a[N2_2048 * 7 + n2 + 3] %= Q;
}

/* 8*256-->3*256 */
static void ntt_butterfly_2048_768(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, c1, d1, e1, f1, g1, h1, i1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 7 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_8[0][0]);
	d1 = _mm256_mul_epu32(d, w_8[0][1]);
	e1 = _mm256_mul_epu32(e, w_8[0][2]);
	f1 = _mm256_mul_epu32(f, w_8[0][3]);
	g1 = _mm256_mul_epu32(g, w_8[0][4]);
	h1 = _mm256_mul_epu32(h, w_8[0][5]);
	i1 = _mm256_mul_epu32(i, w_8[0][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 + n2), t);
	a[N2_2048 + n2] %= Q;
	a[N2_2048 + n2 + 1] %= Q;
	a[N2_2048 + n2 + 2] %= Q;
	a[N2_2048 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_8[1][0]);
	d1 = _mm256_mul_epu32(d, w_8[1][1]);
	e1 = _mm256_mul_epu32(e, w_8[1][2]);
	f1 = _mm256_mul_epu32(f, w_8[1][3]);
	g1 = _mm256_mul_epu32(g, w_8[1][4]);
	h1 = _mm256_mul_epu32(h, w_8[1][5]);
	i1 = _mm256_mul_epu32(i, w_8[1][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 2 + n2), t);
	a[N2_2048 * 2 + n2] %= Q;
	a[N2_2048 * 2 + n2 + 1] %= Q;
	a[N2_2048 * 2 + n2 + 2] %= Q;
	a[N2_2048 * 2 + n2 + 3] %= Q;
}

/* 2*256-->7*256 */
static void ntt_butterfly_512_1792(uint64_t *a, uint32_t n2)
{
	__m256i b, c, c1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1792 + n2));
	
	t = _mm256_add_epi64(b, c);
	t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_7[0][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 + n2), t);
	a[N2_1792 + n2] %= Q;
	a[N2_1792 + n2 + 1] %= Q;
	a[N2_1792 + n2 + 2] %= Q;
	a[N2_1792 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[1][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 2 + n2), t);
	a[N2_1792 * 2 + n2] %= Q;
	a[N2_1792 * 2 + n2 + 1] %= Q;
	a[N2_1792 * 2 + n2 + 2] %= Q;
	a[N2_1792 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[2][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 3 + n2), t);
	a[N2_1792 * 3 + n2] %= Q;
	a[N2_1792 * 3 + n2 + 1] %= Q;
	a[N2_1792 * 3 + n2 + 2] %= Q;
	a[N2_1792 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[3][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 4 + n2), t);
	a[N2_1792 * 4 + n2] %= Q;
	a[N2_1792 * 4 + n2 + 1] %= Q;
	a[N2_1792 * 4 + n2 + 2] %= Q;
	a[N2_1792 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[4][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 5 + n2), t);
	a[N2_1792 * 5 + n2] %= Q;
	a[N2_1792 * 5 + n2 + 1] %= Q;
	a[N2_1792 * 5 + n2 + 2] %= Q;
	a[N2_1792 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[5][0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 6 + n2), t);
	a[N2_1792 * 6 + n2] %= Q;
	a[N2_1792 * 6 + n2 + 1] %= Q;
	a[N2_1792 * 6 + n2 + 2] %= Q;
	a[N2_1792 * 6 + n2 + 3] %= Q;
}

/* 5*256-->7*256 */
static void ntt_butterfly_1280_1792(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, c1, d1, e1, f1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1792 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 4 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_7[0][0]);
	d1 = _mm256_mul_epu32(d, w_7[0][1]);
	e1 = _mm256_mul_epu32(e, w_7[0][2]);
	f1 = _mm256_mul_epu32(f, w_7[0][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 + n2), t);
	a[N2_1792 + n2] %= Q;
	a[N2_1792 + n2 + 1] %= Q;
	a[N2_1792 + n2 + 2] %= Q;
	a[N2_1792 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_7[1][0]);
	d1 = _mm256_mul_epu32(d, w_7[1][1]);
	e1 = _mm256_mul_epu32(e, w_7[1][2]);
	f1 = _mm256_mul_epu32(f, w_7[1][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 2 + n2), t);
	a[N2_1792 * 2 + n2] %= Q;
	a[N2_1792 * 2 + n2 + 1] %= Q;
	a[N2_1792 * 2 + n2 + 2] %= Q;
	a[N2_1792 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[2][0]);
	d1 = _mm256_mul_epu32(d, w_7[2][1]);
	e1 = _mm256_mul_epu32(e, w_7[2][2]);
	f1 = _mm256_mul_epu32(f, w_7[2][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 3 + n2), t);
	a[N2_1792 * 3 + n2] %= Q;
	a[N2_1792 * 3 + n2 + 1] %= Q;
	a[N2_1792 * 3 + n2 + 2] %= Q;
	a[N2_1792 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[3][0]);
	d1 = _mm256_mul_epu32(d, w_7[3][1]);
	e1 = _mm256_mul_epu32(e, w_7[3][2]);
	f1 = _mm256_mul_epu32(f, w_7[3][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 4 + n2), t);
	a[N2_1792 * 4 + n2] %= Q;
	a[N2_1792 * 4 + n2 + 1] %= Q;
	a[N2_1792 * 4 + n2 + 2] %= Q;
	a[N2_1792 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[4][0]);
	d1 = _mm256_mul_epu32(d, w_7[4][1]);
	e1 = _mm256_mul_epu32(e, w_7[4][2]);
	f1 = _mm256_mul_epu32(f, w_7[4][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 5 + n2), t);
	a[N2_1792 * 5 + n2] %= Q;
	a[N2_1792 * 5 + n2 + 1] %= Q;
	a[N2_1792 * 5 + n2 + 2] %= Q;
	a[N2_1792 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7[5][0]);
	d1 = _mm256_mul_epu32(d, w_7[5][1]);
	e1 = _mm256_mul_epu32(e, w_7[5][2]);
	f1 = _mm256_mul_epu32(f, w_7[5][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 6 + n2), t);
	a[N2_1792 * 6 + n2] %= Q;
	a[N2_1792 * 6 + n2 + 1] %= Q;
	a[N2_1792 * 6 + n2 + 2] %= Q;
	a[N2_1792 * 6 + n2 + 3] %= Q;
}

/* 7*256-->7*256 */
static void ntt_butterfly_1792_1792_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, c1, d1, e1, f1, g1, h1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1792 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_1792 * 6 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_7_inv[0][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[0][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[0][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[0][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[0][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[0][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 + n2), t);
	a[N2_1792 + n2] %= Q;
	a[N2_1792 + n2 + 1] %= Q;
	a[N2_1792 + n2 + 2] %= Q;
	a[N2_1792 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_7_inv[1][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[1][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[1][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[1][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[1][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[1][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 2 + n2), t);
	a[N2_1792 * 2 + n2] %= Q;
	a[N2_1792 * 2 + n2 + 1] %= Q;
	a[N2_1792 * 2 + n2 + 2] %= Q;
	a[N2_1792 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[2][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[2][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[2][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[2][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[2][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[2][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 3 + n2), t);
	a[N2_1792 * 3 + n2] %= Q;
	a[N2_1792 * 3 + n2 + 1] %= Q;
	a[N2_1792 * 3 + n2 + 2] %= Q;
	a[N2_1792 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[3][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[3][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[3][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[3][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[3][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[3][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 4 + n2), t);
	a[N2_1792 * 4 + n2] %= Q;
	a[N2_1792 * 4 + n2 + 1] %= Q;
	a[N2_1792 * 4 + n2 + 2] %= Q;
	a[N2_1792 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[4][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[4][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[4][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[4][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[4][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[4][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 5 + n2), t);
	a[N2_1792 * 5 + n2] %= Q;
	a[N2_1792 * 5 + n2 + 1] %= Q;
	a[N2_1792 * 5 + n2 + 2] %= Q;
	a[N2_1792 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_7_inv[5][0]);
	d1 = _mm256_mul_epu32(d, w_7_inv[5][1]);
	e1 = _mm256_mul_epu32(e, w_7_inv[5][2]);
	f1 = _mm256_mul_epu32(f, w_7_inv[5][3]);
	g1 = _mm256_mul_epu32(g, w_7_inv[5][4]);
	h1 = _mm256_mul_epu32(h, w_7_inv[5][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_1792 * 6 + n2), t);
	a[N2_1792 * 6 + n2] %= Q;
	a[N2_1792 * 6 + n2 + 1] %= Q;
	a[N2_1792 * 6 + n2 + 2] %= Q;
	a[N2_1792 * 6 + n2 + 3] %= Q;
}

/* 3*256-->3*256 */
static void ntt_butterfly_768_768_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, c1, d1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_768 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_768 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_3_inv[0]);
	d1 = _mm256_mul_epu32(d, w_3_inv[1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 + n2), t);
	a[N2_768 + n2] %= Q;
	a[N2_768 + n2 + 1] %= Q;
	a[N2_768 + n2 + 2] %= Q;
	a[N2_768 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_3_inv[1]);
	d1 = _mm256_mul_epu32(d, w_3_inv[0]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 * 2 + n2), t);
	a[N2_768 * 2 + n2] %= Q;
	a[N2_768 * 2 + n2 + 1] %= Q;
	a[N2_768 * 2 + n2 + 2] %= Q;
	a[N2_768 * 2 + n2 + 3] %= Q;
}

/* 2*256-->3*256 */
static void ntt_butterfly_512_768(uint64_t *a, uint32_t n2)
{
	__m256i b, c, c1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_768 + n2));
	
	t = _mm256_add_epi64(b, c);
	t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_3[0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 + n2), t);
	a[N2_768 + n2] %= Q;
	a[N2_768 + n2 + 1] %= Q;
	a[N2_768 + n2 + 2] %= Q;
	a[N2_768 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_3[1]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_768 * 2 + n2), t);
	a[N2_768 * 2 + n2] %= Q;
	a[N2_768 * 2 + n2 + 1] %= Q;
	a[N2_768 * 2 + n2 + 2] %= Q;
	a[N2_768 * 2 + n2 + 3] %= Q;	
}

/* 3*256-->1*256 */
static void ntt_butterfly_768_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_768 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_768 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

/* 7*256-->8*256 */
static void ntt_butterfly_1792_2048(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, c1, d1, e1, f1, g1, h1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 6 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_8[0][0]);
	d1 = _mm256_mul_epu32(d, w_8[0][1]);
	e1 = _mm256_mul_epu32(e, w_8[0][2]);
	f1 = _mm256_mul_epu32(f, w_8[0][3]);
	g1 = _mm256_mul_epu32(g, w_8[0][4]);
	h1 = _mm256_mul_epu32(h, w_8[0][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 + n2), t);
	a[N2_2048 + n2] %= Q;
	a[N2_2048 + n2 + 1] %= Q;
	a[N2_2048 + n2 + 2] %= Q;
	a[N2_2048 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[1][0]);
	d1 = _mm256_mul_epu32(d, w_8[1][1]);
	e1 = _mm256_mul_epu32(e, w_8[1][2]);
	f1 = _mm256_mul_epu32(f, w_8[1][3]);
	g1 = _mm256_mul_epu32(g, w_8[1][4]);
	h1 = _mm256_mul_epu32(h, w_8[1][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 2 + n2), t);
	a[N2_2048 * 2 + n2] %= Q;
	a[N2_2048 * 2 + n2 + 1] %= Q;
	a[N2_2048 * 2 + n2 + 2] %= Q;
	a[N2_2048 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[2][0]);
	d1 = _mm256_mul_epu32(d, w_8[2][1]);
	e1 = _mm256_mul_epu32(e, w_8[2][2]);
	f1 = _mm256_mul_epu32(f, w_8[2][3]);
	g1 = _mm256_mul_epu32(g, w_8[2][4]);
	h1 = _mm256_mul_epu32(h, w_8[2][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 3 + n2), t);
	a[N2_2048 * 3 + n2] %= Q;
	a[N2_2048 * 3 + n2 + 1] %= Q;
	a[N2_2048 * 3 + n2 + 2] %= Q;
	a[N2_2048 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[3][0]);
	d1 = _mm256_mul_epu32(d, w_8[3][1]);
	e1 = _mm256_mul_epu32(e, w_8[3][2]);
	f1 = _mm256_mul_epu32(f, w_8[3][3]);
	g1 = _mm256_mul_epu32(g, w_8[3][4]);
	h1 = _mm256_mul_epu32(h, w_8[3][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 4 + n2), t);
	a[N2_2048 * 4 + n2] %= Q;
	a[N2_2048 * 4 + n2 + 1] %= Q;
	a[N2_2048 * 4 + n2 + 2] %= Q;
	a[N2_2048 * 4 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_8[4][0]);
	d1 = _mm256_mul_epu32(d, w_8[4][1]);
	e1 = _mm256_mul_epu32(e, w_8[4][2]);
	f1 = _mm256_mul_epu32(f, w_8[4][3]);
	g1 = _mm256_mul_epu32(g, w_8[4][4]);
	h1 = _mm256_mul_epu32(h, w_8[4][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 5 + n2), t);
	a[N2_2048 * 5 + n2] %= Q;
	a[N2_2048 * 5 + n2 + 1] %= Q;
	a[N2_2048 * 5 + n2 + 2] %= Q;
	a[N2_2048 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[5][0]);
	d1 = _mm256_mul_epu32(d, w_8[5][1]);
	e1 = _mm256_mul_epu32(e, w_8[5][2]);
	f1 = _mm256_mul_epu32(f, w_8[5][3]);
	g1 = _mm256_mul_epu32(g, w_8[5][4]);
	h1 = _mm256_mul_epu32(h, w_8[5][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 6 + n2), t);
	a[N2_2048 * 6 + n2] %= Q;
	a[N2_2048 * 6 + n2 + 1] %= Q;
	a[N2_2048 * 6 + n2 + 2] %= Q;
	a[N2_2048 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_8[6][0]);
	d1 = _mm256_mul_epu32(d, w_8[6][1]);
	e1 = _mm256_mul_epu32(e, w_8[6][2]);
	f1 = _mm256_mul_epu32(f, w_8[6][3]);
	g1 = _mm256_mul_epu32(g, w_8[6][4]);
	h1 = _mm256_mul_epu32(h, w_8[6][5]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	_mm256_storeu_si256((__m256i *)(a + N2_2048 * 7 + n2), t);
	a[N2_2048 * 7 + n2] %= Q;
	a[N2_2048 * 7 + n2 + 1] %= Q;
	a[N2_2048 * 7 + n2 + 2] %= Q;
	a[N2_2048 * 7 + n2 + 3] %= Q;
}

/* 8*256-->1*256 */
static void ntt_butterfly_2048_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2048 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2048 * 7 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

void ntt_1280_2048(uint64_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1280_2048);
}

void intt_2048_768(uint64_t *a)
{
	intt_core(a, N1_2048, N2_2048, 768, omega_256, omega_2048, ntt_butterfly_2048_768, INV_2048);
}

void ntt_512_1792(uint64_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_512_1792);
}

void ntt_1280_1792(uint64_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1280_1792);
}

void intt_1792_1792_inv(uint64_t *a)
{
	intt_core(a, N1_1792, N2_1792, 1792, omega_256_inv, omega_1792_inv, ntt_butterfly_1792_1792_inv, INV_1792);
}

void ntt_768_768_inv(uint64_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256_inv, omega_768_inv, ntt_butterfly_768_768_inv);
}

void ntt_512_768(uint64_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256, omega_768, ntt_butterfly_512_768);
}

void intt_768_256(uint64_t *a)
{
	intt_core(a, N1_768, N2_768, 256, omega_256, omega_768, ntt_butterfly_768_256, INV_768);
}

void ntt_1792_2048(uint64_t *a)
{
	ntt_core(a, N1_2048, N2_2048, omega_256, omega_2048, ntt_butterfly_1792_2048);
}

void intt_2048_256(uint64_t *a)
{
	intt_core(a, N1_2048, N2_2048, 256, omega_256, omega_2048, ntt_butterfly_2048_256, INV_2048);
}
