/* ****************************** *
 * Titanium_CCA_hi                *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>
#include <x86intrin.h>

/* 1024=4*256 */
#define N1_1024 4
#define N2_1024 256

/* 2304=9*256 */
#define N1_2304 9
#define N2_2304 256

/* 2560=10*256 */
#define N1_2560 10
#define N2_2560 256

/* multiplication inverses of 1024, 2304, 2560 (in Montgomery form) */
#define INV_1024 4096
#define INV_2304 437021
#define INV_2560 471655

/* omega_n: n-th root of unity mod Q */
static const __m256i w_4[3][3]={{{623211,623211,623211,623211},{783360,783360,783360,783360},{160150,160150,160150,160150}},
{{783360,783360,783360,783360},{1,1,1,1},{783360,783360,783360,783360}},
{{160150,160150,160150,160150},{783360,783360,783360,783360},{623211,623211,623211,623211}}};

static const __m256i w_9[8][8]={{{9672,9672,9672,9672},{327625,327625,327625,327625},{93755,93755,93755,93755},{449683,449683,449683,449683},{113704,113704,113704,113704},{689605,689605,689605,689605},{324006,324006,324006,324006},{342032,342032,342032,342032},},
{{327625,327625,327625,327625},{449683,449683,449683,449683},{689605,689605,689605,689605},{342032,342032,342032,342032},{9672,9672,9672,9672},{93755,93755,93755,93755},{113704,113704,113704,113704},{324006,324006,324006,324006}},
{{93755,93755,93755,93755},{689605,689605,689605,689605},{1,1,1,1},{93755,93755,93755,93755},{689605,689605,689605,689605},{1,1,1,1},{93755,93755,93755,93755},{689605,689605,689605,689605}},
{{449683,449683,449683,449683},{342032,342032,342032,342032},{93755,93755,93755,93755},{324006,324006,324006,324006},{327625,327625,327625,327625},{689605,689605,689605,689605},{9672,9672,9672,9672},{113704,113704,113704,113704}},
{{113704,113704,113704,113704},{9672,9672,9672,9672},{689605,689605,689605,689605},{327625,327625,327625,327625},{324006,324006,324006,324006},{93755,93755,93755,93755},{342032,342032,342032,342032},{449683,449683,449683,449683}},
{{689605,689605,689605,689605},{93755,93755,93755,93755},{1,1,1,1},{689605,689605,689605,689605},{93755,93755,93755,93755},{1,1,1,1},{689605,689605,689605,689605},{93755,93755,93755,93755}},
{{324006,324006,324006,324006},{113704,113704,113704,113704},{93755,93755,93755,93755},{9672,9672,9672,9672},{342032,342032,342032,342032},{689605,689605,689605,689605},{449683,449683,449683,449683},{327625,327625,327625,327625}},
{{342032,342032,342032,342032},{324006,324006,324006,324006},{689605,689605,689605,689605},{113704,113704,113704,113704},{449683,449683,449683,449683},{93755,93755,93755,93755},{327625,327625,327625,327625},{9672,9672,9672,9672}}};

static const __m256i w_10[9][9]={{{442872,442872,442872,442872},{31287,31287,31287,31287},{46896,46896,46896,46896},{458480,458480,458480,458480},{783360,783360,783360,783360},{340489,340489,340489,340489},{752074,752074,752074,752074},{736465,736465,736465,736465},{324881,324881,324881,324881}},
{{31287,31287,31287,31287},{458480,458480,458480,458480},{340489,340489,340489,340489},{736465,736465,736465,736465},{1,1,1,1},{31287,31287,31287,31287},{458480,458480,458480,458480},{340489,340489,340489,340489},{736465,736465,736465,736465}},
{{46896,46896,46896,46896},{340489,340489,340489,340489},{324881,324881,324881,324881},{31287,31287,31287,31287},{783360,783360,783360,783360},{736465,736465,736465,736465},{442872,442872,442872,442872},{458480,458480,458480,458480},{752074,752074,752074,752074}},
{{458480,458480,458480,458480},{736465,736465,736465,736465},{31287,31287,31287,31287},{340489,340489,340489,340489},{1,1,1,1},{458480,458480,458480,458480},{736465,736465,736465,736465},{31287,31287,31287,31287},{340489,340489,340489,340489}},
{{783360,783360,783360,783360},{1,1,1,1},{783360,783360,783360,783360},{1,1,1,1},{783360,783360,783360,783360},{1,1,1,1},{783360,783360,783360,783360},{1,1,1,1},{783360,783360,783360,783360}},
{{340489,340489,340489,340489},{31287,31287,31287,31287},{736465,736465,736465,736465},{458480,458480,458480,458480},{1,1,1,1},{340489,340489,340489,340489},{31287,31287,31287,31287},{736465,736465,736465,736465},{458480,458480,458480,458480}},
{{752074,752074,752074,752074},{458480,458480,458480,458480},{442872,442872,442872,442872},{736465,736465,736465,736465},{783360,783360,783360,783360},{31287,31287,31287,31287},{324881,324881,324881,324881},{340489,340489,340489,340489},{46896,46896,46896,46896}},
{{736465,736465,736465,736465},{340489,340489,340489,340489},{458480,458480,458480,458480},{31287,31287,31287,31287},{1,1,1,1},{736465,736465,736465,736465},{340489,340489,340489,340489},{458480,458480,458480,458480},{31287,31287,31287,31287}},
{{324881,324881,324881,324881},{736465,736465,736465,736465},{752074,752074,752074,752074},{340489,340489,340489,340489},{783360,783360,783360,783360},{458480,458480,458480,458480},{46896,46896,46896,46896},{31287,31287,31287,31287},{442872,442872,442872,442872}}};

/* omega_256,1024,2304,2560, respectively (in Montgomery form) */
static const uint64_t omega_256[128]={277499,460685,63621,220411,354343,60986,151860,30945,213443,300307,30476,661745,192801,464008,431605,187069,487910,88126,755357,277492,747983,436159,390569,631515,177820,608203,142738,198541,671309,461235,95767,381560,637649,217294,260469,433847,158587,464000,200402,500918,10924,404894,329338,351392,651929,83402,143119,340450,314349,264384,676911,401249,643286,287540,512020,272398,213820,718295,222121,226401,148968,662368,474192,209288,171402,586313,273377,208371,206112,37048,629967,483297,627507,282545,390991,97857,660387,309982,667168,541095,689889,436237,98875,509091,519948,653159,183778,261377,432794,179651,550002,281840,677373,240245,339969,24166,235971,394964,646261,390206,422292,24460,703231,415588,549874,499397,215430,442079,708091,258111,635010,424822,485676,347811,465418,642202,685654,345385,659758,51029,569754,51878,528221,527096,34055,594615,299984,193907};
static const uint64_t omega_1024[1024]={277499,475577,472968,542785,460685,774497,86474,375620,63621,769484,405278,133800,220411,715769,460028,200279,354343,268187,170499,177536,60986,33216,46427,625787,151860,337631,545758,709004,30945,411656,224645,499480,213443,109264,710055,166158,300307,42383,224775,613100,30476,1750,746139,369134,661745,244712,20735,105087,192801,85459,271871,256871,464008,545355,356782,49790,431605,426129,340271,503035,187069,559218,722629,188780,487910,284956,726107,95108,88126,252746,775563,234797,755357,592056,438684,346287,277492,469459,609363,681143,747983,414068,766011,503320,436159,489520,125374,689697,390569,595271,115150,370892,631515,457966,748174,581002,177820,309202,766364,28481,608203,450664,633114,288770,142738,198613,464981,612396,198541,402053,448594,390656,671309,770038,106113,306164,461235,471836,336778,583597,95767,664092,729268,507739,381560,555015,182651,614691,637649,335555,298056,425092,217294,341594,92615,259327,260469,475216,157454,526621,433847,35554,523117,504795,158587,733502,291450,134975,464000,538363,512662,767457,200402,461845,221615,201343,500918,686894,290830,376456,10924,147244,220052,402003,404894,581545,652402,695901,329338,347925,142382,670830,351392,39096,485381,424693,651929,282499,145411,184732,83402,40775,386105,610540,143119,531607,91445,20108,340450,659481,616059,266559,314349,564676,9394,376746,264384,763482,643057,361981,676911,182659,621683,481769,401249,529259,389376,335950,643286,562127,131651,692268,287540,634440,664333,156541,512020,206349,175996,281748,272398,717469,379106,760302,213820,438762,414459,324384,718295,317669,332912,338157,222121,643587,41840,533554,226401,467502,465667,428599,148968,160106,494386,461453,662368,5853,415356,325001,474192,45839,111875,641986,209288,394599,200686,710061,171402,183397,483334,202337,586313,119468,228019,314912,273377,6393,103955,770155,208371,376502,51128,34295,206112,752219,199527,480456,37048,262151,378562,284846,629967,671736,359875,402989,483297,169999,523897,403154,627507,88418,507954,569470,282545,185615,71783,69462,390991,180738,509451,311126,97857,140669,740390,44674,660387,624542,630452,312265,309982,664723,497401,746480,667168,284248,107315,573351,541095,550347,19624,700795,689889,558377,770956,125084,436237,557692,172266,155172,98875,247040,488685,178945,509091,779847,62208,317883,519948,85172,21033,365539,653159,574158,463052,493172,183778,32967,612162,777386,261377,485447,482377,149280,432794,681954,673436,278953,179651,342774,340574,767857,550002,501455,372871,11078,281840,352806,491571,351226,677373,586447,236584,750473,240245,33382,191511,524721,339969,239087,588012,37672,24166,753698,708812,646498,235971,214711,434135,287266,394964,519696,648285,231087,646261,28833,132490,642193,390206,278009,137956,719311,422292,120177,64324,600545,24460,227293,463749,318989,703231,468870,94577,407393,415588,527769,653838,384243,549874,389583,516868,526696,499397,140901,159797,224320,215430,279180,378049,619845,442079,180073,711602,734875,708091,16344,184158,365087,258111,764407,668146,355659,635010,379152,17145,100871,424822,764675,119017,617206,485676,682523,387381,159042,347811,42746,542037,590294,465418,210973,300567,269623,642202,398072,102644,407702,685654,773792,253665,12047,345385,272505,27626,644294,659758,74796,352741,434761,51029,731130,568405,135096,569754,530761,135402,53837,51878,689795,476221,252463,528221,265525,193994,344780,527096,65636,180511,311053,34055,779713,728453,578790,594615,325167,619276,728134,299984,543442,251542,506628,193907,268742,655569,330415,505862,307784,310393,240576,322676,8864,696887,407741,719740,13877,378083,649561,562950,67592,323333,583082,429018,515174,612862,605825,722375,750145,736934,157574,631501,445730,237603,74357,752416,371705,558716,283881,569918,674097,73306,617203,483054,740978,558586,170261,752885,781611,37222,414227,121616,538649,762626,678274,590560,697902,511490,526490,319353,238006,426579,733571,351756,357232,443090,280326,596292,224143,60732,594581,295451,498405,57254,688253,695235,530615,7798,548564,28004,191305,344677,437074,505869,313902,173998,102218,35378,369293,17350,280041,347202,293841,657987,93664,392792,188090,668211,412469,151846,325395,35187,202359,605541,474159,16997,754880,175158,332697,150247,494591,640623,584748,318380,170965,584820,381308,334767,392705,112052,13323,677248,477197,322126,311525,446583,199764,687594,119269,54093,275622,401801,228346,600710,168670,145712,447806,485305,358269,566067,441767,690746,524034,522892,308145,625907,256740,349514,747807,260244,278566,624774,49859,491911,648386,319361,244998,270699,15904,582959,321516,561746,582018,282443,96467,492531,406905,772437,636117,563309,381358,378467,201816,130959,87460,454023,435436,640979,112531,431969,744265,297980,358668,131432,500862,637950,598629,699959,742586,397256,172821,640242,251754,691916,763253,442911,123880,167302,516802,469012,218685,773967,406615,518977,19879,140304,421380,106450,600702,161678,301592,382112,254102,393985,447411,140075,221234,651710,91093,495821,148921,119028,626820,271341,577012,607365,501613,510963,65892,404255,23059,569541,344599,368902,458977,65066,465692,450449,445204,561240,139774,741521,249807,556960,315859,317694,354762,634393,623255,288975,321908,120993,777508,368005,458360,309169,737522,671486,141375,574073,388762,582675,73300,611959,599964,300027,581024,197048,663893,555342,468449,509984,776968,679406,13206,574990,406859,732233,749066,577249,31142,583834,302905,746313,521210,404799,498515,153394,111625,423486,380372,300064,613362,259464,380207,155854,694943,275407,213891,500816,597746,711578,713899,392370,602623,273910,472235,685504,642692,42971,738687,122974,158819,152909,471096,473379,118638,285960,36881,116193,499113,676046,210010,242266,233014,763737,82566,93472,224984,12405,658277,347124,225669,611095,628189,684486,536321,294676,604416,274270,3514,721153,465478,263413,698189,762328,417822,130202,209203,320309,290189,599583,750394,171199,5975,521984,297914,300984,634081,350567,101407,109925,504408,603710,440587,442787,15504,233359,281906,410490,772283,501521,430555,291790,432135,105988,196914,546777,32888,543116,749979,591850,258640,443392,544274,195349,745689,759195,29663,74549,136863,547390,568650,349226,496095,388397,263665,135076,552274,137100,754528,650871,141168,393155,505352,645405,64050,361069,663184,719037,182816,758901,556068,319612,464372,80130,314491,688784,375968,367773,255592,129523,399118,233487,393778,266493,256665,283964,642460,623564,559041,567931,504181,405312,163516,341282,603288,71759,48486,75270,767017,599203,418274,525250,18954,115215,427702,148351,404209,766216,682490,358539,18686,664344,166155,297685,100838,395980,624319,435550,740615,241324,193067,317943,572388,482794,513738,141159,385289,680717,375659,97707,9569,529696,771314,437976,510856,755735,139067,123603,708565,430620,348600,732332,52231,214956,648265,213607,252600,647959,729524,731483,93566,307140,530898,255140,517836,589367,438581,256265,717725,602850,472308,749306,3648,54908,204571,188746,458194,164085,55227,483377,239919,531819,276733,589454,514619,127792,452946};
static const uint64_t omega_2304[2304]={277499,36836,719278,273256,36030,757896,518388,255219,630048,460685,378295,723954,138630,781263,705051,220151,483072,180384,63621,575005,732335,154992,273331,137403,282175,685571,681150,220411,521154,202388,68724,641516,43397,469066,394657,216022,354343,59926,124189,720917,639862,126533,317035,488737,317159,60986,460222,629850,600408,36142,219922,142212,389986,200734,151860,489485,137477,570203,101300,616318,76643,722778,303830,30945,465039,27782,200610,579611,346422,351974,430017,695008,213443,753934,552714,245308,269071,176288,42165,119892,615788,300307,376631,323557,467821,121915,592725,555877,509737,500603,30476,269802,36297,272754,516881,317705,767647,193086,405558,661745,782783,566133,710341,633422,508959,13047,181564,718523,192801,333685,276074,460832,357645,230223,560312,707389,152838,464008,545642,306183,297251,507503,739821,371686,533274,290356,431605,397326,251423,230723,452771,147119,222910,170104,425932,187069,169019,56108,697830,674986,4522,409248,479114,251451,487910,358727,376651,507262,288738,62049,236290,81072,473638,88126,639109,456129,48429,470945,615640,507612,761812,453221,755357,502028,389841,631435,79330,531833,567388,683255,558858,277492,560060,742789,215873,748303,336557,21838,438754,64514,747983,530721,537083,613249,283947,511253,324944,86466,275453,436159,317141,287332,73044,370385,529519,71786,174075,278433,390569,268048,767630,232777,126930,634295,498232,773877,623521,631515,30789,598862,327924,40876,226360,133096,476874,43877,177820,13470,345960,416874,415021,41174,221801,363195,681576,608203,545155,337292,701949,320182,606202,378613,119739,189646,142738,129581,112681,770795,123896,575562,169152,298545,251121,198541,571833,581079,513232,681091,266002,383592,614001,141006,671309,110721,1647,440088,175542,631898,611136,655379,669876,461235,338336,107657,59037,771313,573370,402470,498689,75530,95767,125274,307380,129101,403927,368621,777319,513031,597418,381560,750237,475208,16790,289911,456814,660958,408400,523632,637649,362801,587712,140997,1121,700493,263595,12963,193364,217294,287566,263990,703533,769120,209982,494064,91083,186418,260469,675909,61377,330690,771406,448397,313927,141976,572350,433847,231590,778613,256649,56138,581707,14681,698084,266276,158587,588983,260875,96635,264461,525460,194344,601868,129470,464000,472160,221144,7853,650077,146382,699470,71576,203575,200402,235801,485491,661236,220136,149453,118856,500201,646491,500918,769587,778529,268449,338270,676472,728347,342182,574564,10924,69463,575007,359025,372092,737361,493440,626375,603625,404894,46266,774795,46929,10207,729728,297396,76802,28990,329338,103363,177304,757408,736152,551367,210712,540728,213122,351392,176048,187788,702166,550819,660722,590764,756745,717379,651929,706884,410293,481528,98856,101675,339822,48121,775332,83402,332843,767384,714969,57904,743958,573897,738771,519186,143119,299877,735459,648717,188218,343338,225659,156964,369341,340450,332931,8964,83676,107838,742366,51477,266591,114337,314349,493027,162151,424052,152741,552240,199985,518197,655079,264384,14036,452965,754016,130863,529437,493637,673307,53867,676911,256346,210611,592219,216626,418707,605163,39630,140273,401249,446393,707350,382134,147363,114028,22030,635600,538728,643286,242389,679121,580043,397645,243914,390289,46261,141348,287540,416854,231316,220257,281667,719630,373020,644302,174271,512020,515622,308050,408011,279854,713193,195481,665964,563143,272398,380376,58594,423212,270741,240116,364274,604608,229503,213820,104128,741292,761892,404680,39025,262564,530823,298937,718295,448647,651837,645202,607386,286895,171735,719056,192533,222121,169031,166331,433708,325722,574022,124365,770799,160637,226401,313851,227258,156160,34649,19321,232789,237153,370173,148968,560016,338638,139839,723336,337353,283048,674844,658619,662368,434146,40376,333901,693366,406802,337781,297530,132584,474192,84908,457012,521235,750553,244303,634067,754078,308668,209288,778069,743400,540374,486668,309381,295643,621480,97563,171402,206291,79989,513865,32626,42384,760580,104047,193127,586313,412129,111705,422962,716192,520251,329238,751560,289358,273377,168244,575309,391207,253030,303401,203118,115388,763555,208371,384645,689897,73450,574472,732603,266556,380374,431904,206112,590072,667440,20074,686554,505759,387965,633848,113390,37048,316468,568387,654828,113129,185621,185914,331269,18618,629967,695881,202716,731403,211310,158300,107059,441465,94015,483297,484503,203180,293193,443406,492803,454738,393043,666568,627507,34274,295817,261311,184599,590601,630431,257671,434812,282545,558989,109878,679612,585675,427147,575934,452621,727734,390991,619099,357431,222982,48081,407922,441568,452575,696893,97857,130102,2190,139992,366117,494922,530098,102359,355645,660387,451309,427101,545093,159487,238737,35750,536109,675467,309982,136611,57706,100320,231744,234739,522768,535203,578921,667168,655130,145311,66559,535315,40947,290992,6536,499358,541095,646505,237831,722565,109934,410625,397587,102850,361277,689889,783329,489433,443205,409130,570296,759688,527775,503291,436237,641910,137261,152911,155330,636182,9336,367145,537027,98875,472035,52189,539601,632559,219858,337717,493035,235633,509091,442139,409666,10063,190413,333416,351165,245239,614490,519948,483711,762072,491303,777361,507131,456352,725858,393404,653159,646007,755423,716574,503892,277205,78136,140018,213253,183778,295600,30674,130079,378450,776786,513299,708982,488603,261377,399145,704652,276201,256477,42997,711771,59512,629981,432794,155694,62808,353486,217617,316798,74395,441722,692062,179651,576922,127316,654677,97038,245152,402894,476430,665792,550002,402462,425207,773852,589730,267848,497302,456885,725590,281840,546116,351506,48125,28712,517602,477542,696097,620008,677373,191446,225607,462692,208268,26085,476301,460096,647550,240245,569970,507060,391720,69057,370920,155941,177322,531062,339969,27471,281601,505084,258969,215171,175465,120474,86396,24166,671269,526672,359813,559820,105051,14786,683334,696972,235971,88581,314072,494636,644880,391499,585040,665561,582452,394964,98290,778031,2680,332279,287069,594927,22731,611732,646261,346713,87278,683627,58966,706681,699930,379986,1471,390206,654767,532030,614320,133497,47514,487572,779237,504718,422292,437282,644324,768027,550037,136425,307652,277406,161809,24460,629969,322571,419816,412072,567347,502500,25113,165209,703231,736938,329044,144663,381405,697405,100539,89071,506359,415588,744885,667493,311052,172816,268778,30933,354816,291904,549874,10111,631305,60289,520831,173156,258319,119966,120455,499397,311799,179789,669445,223357,554946,379400,494122,232147,215430,400202,33928,642845,304339,593592,98358,619267,333831,442079,641912,547312,370011,619360,208858,353536,285199,260771,708091,725676,680091,481084,720771,473857,728814,127368,348949,258111,559517,259524,25298,101918,417595,574858,752985,648723,635010,211277,51027,441714,618580,94612,287524,269890,61238,424822,566815,316113,245227,504267,709,49614,192572,776186,485676,597945,717861,770734,542797,220900,116735,14790,720075,347811,380670,17294,219111,330744,92368,43209,308961,354643,465418,571388,606288,776864,54707,558911,568470,46322,505808,642202,469271,515071,534664,132397,127432,153444,155062,524618,685654,72644,613090,194374,485745,252526,374201,329188,683978,345385,423042,667651,587280,89774,109181,740221,128981,85058,659758,353154,301558,312804,598154,91655,740215,465550,217119,51029,68404,52319,558642,643561,614090,762653,148566,392670,569754,89768,445750,88921,303613,583669,410519,598992,346965,51878,620592,558032,132405,200914,238483,444460,382044,495732,528221,291427,281155,716948,414051,140133,682036,133252,343051,527096,337554,366721,559286,291974,17800,558362,421774,771169,34055,438490,773052,291779,380919,541859,613787,133765,159078,594615,290377,428655,326793,423572,443987,150066,70047,455666,299984,347399,513152,729632,198973,623056,473019,473504,32344,193907,700559,478141,127014,622495,216100,679112,693216,204056,505862,746525,64083,510105,747331,25465,264973,528142,153313,322676,405066,59407,644731,2098,78310,563210,300289,602977,719740,208356,51026,628369,510030,645958,501186,97790,102211,562950,262207,580973,714637,141845,739964,314295,388704,567339,429018,723435,659172,62444,143499,656828,466326,294624,466202,722375,323139,153511,182953,747219,563439,641149,393375,582627,631501,293876,645884,213158,682061,167043,706718,60583,479531,752416,318322,755579,582751,203750,436939,431387,353344,88353,569918,29427,230647,538053,514290,607073,741196,663469,167573,483054,406730,459804,315540,661446,190636,227484,273624,282758,752885,513559,747064,510607,266480,465656,15714,590275,377803,121616,578,217228,73020,149939,274402,770314,601797,64838,590560,449676,507287,322529,425716,553138,223049,75972,630523,319353,237719,477178,486110,275858,43540,411675,250087,493005,351756,386035,531938,552638,330590,636242,560451,613257,357429,596292,614342,727253,85531,108375,778839,374113,304247,531910,295451,424634,406710,276099,494623,721312,547071,702289,309723,695235,144252,327232,734932,312416,167721,275749,21549,330140,28004,281333,393520,151926,704031,251528,215973,100106,224503,505869,223301,40572,567488,35058,446804,761523,344607,718847,35378,252640,246278,170112,499414,272108,458417,696895,507908,347202,466220,496029,710317,412976,253842,711575,609286,504928,392792,515313,15731,550584,656431,149066,285129,9484,159840,151846,752572,184499,455437,742485,557001,650265,306487,739484,605541,769891,437401,366487,368340,742187,561560,420166,101785,175158,238206,446069,81412,463179,177159,404748,663622,593715,640623,653780,670680,12566,659465,207799,614209,484816,532240,584820,211528,202282,270129,102270,517359,399769,169360,642355,112052,672640,781714,343273,607819,151463,172225,127982,113485,322126,445025,675704,724324,12048,209991,380891,284672,707831,687594,658087,475981,654260,379434,414740,6042,270330,185943,401801,33124,308153,766571,493450,326547,122403,374961,259729,145712,420560,195649,642364,782240,82868,519766,770398,589997,566067,495795,519371,79828,14241,573379,289297,692278,596943,522892,107452,721984,452671,11955,334964,469434,641385,211011,349514,551771,4748,526712,727223,201654,768680,85277,517085,624774,194378,522486,686726,518900,257901,589017,181493,653891,319361,311201,562217,775508,133284,636979,83891,711785,579786,582959,547560,297870,122125,563225,633908,664505,283160,136870,282443,13774,4832,514912,445091,106889,55014,441179,208797,772437,713898,208354,424336,411269,46000,289921,156986,179736,378467,737095,8566,736432,773154,53633,485965,706559,754371,454023,679998,606057,25953,47209,231994,572649,242633,570239,431969,607313,595573,81195,232542,122639,192597,26616,65982,131432,76477,373068,301833,684505,681686,443539,735240,8029,699959,450518,15977,68392,725457,39403,209464,44590,264175,640242,483484,47902,134644,595143,440023,557702,626397,414020,442911,450430,774397,699685,675523,40995,731884,516770,669024,469012,290334,621210,359309,630620,231121,583376,265164,128282,518977,769325,330396,29345,652498,253924,289724,110054,729494,106450,527015,572750,191142,566735,364654,178198,743731,643088,382112,336968,76011,401227,635998,669333,761331,147761,244633,140075,540972,104240,203318,385716,539447,393072,737100,642013,495821,366507,552045,563104,501694,63731,410341,139059,609090,271341,267739,475311,375350,503507,70168,587880,117397,220218,510963,402985,724767,360149,512620,543245,419087,178753,553858,569541,679233,42069,21469,378681,744336,520797,252538,484424,65066,334714,131524,138159,175975,496466,611626,64305,590828,561240,614330,617030,349653,457639,209339,658996,12562,622724,556960,469510,556103,627201,748712,764040,550572,546208,413188,634393,223345,444723,643522,60025,446008,500313,108517,124742,120993,349215,742985,449460,89995,376559,445580,485831,650777,309169,698453,326349,262126,32808,539058,149294,29283,474693,574073,5292,39961,242987,296693,473980,487718,161881,685798,611959,577070,703372,269496,750735,740977,22781,679314,590234,197048,371232,671656,360399,67169,263110,454123,31801,494003,509984,615117,208052,392154,530331,479960,580243,667973,19806,574990,398716,93464,709911,208889,50758,516805,402987,351457,577249,193289,115921,763287,96807,277602,395396,149513,669971,746313,466893,214974,128533,670232,597740,597447,452092,764743,153394,87480,580645,51958,572051,625061,676302,341896,689346,300064,298858,580181,490168,339955,290558,328623,390318,116793,155854,749087,487544,522050,598762,192760,152930,525690,348549,500816,224372,673483,103749,197686,356214,207427,330740,55627,392370,164262,425930,560379,735280,375439,341793,330786,86468,685504,653259,781171,643369,417244,288439,253263,681002,427716,122974,332052,356260,238268,623874,544624,747611,247252,107894,473379,646750,725655,683041,551617,548622,260593,248158,204440,116193,128231,638050,716802,248046,742414,492369,776825,284003,242266,136856,545530,60796,673427,372736,385774,680511,422084,93472,32,293928,340156,374231,213065,23673,255586,280070,347124,141451,646100,630450,628031,147179,774025,416216,246334,684486,311326,731172,243760,150802,563503,445644,290326,547728,274270,341222,373695,773298,592948,449945,432196,538122,168871,263413,299650,21289,292058,6000,276230,327009,57503,389957,130202,137354,27938,66787,279469,506156,705225,643343,570108,599583,487761,752687,653282,404911,6575,270062,74379,294758,521984,384216,78709,507160,526884,740364,71590,723849,153380,350567,627667,720553,429875,565744,466563,708966,341639,91299,603710,206439,656045,128684,686323,538209,380467,306931,117569,233359,380899,358154,9509,193631,515513,286059,326476,57771,501521,237245,431855,735236,754649,265759,305819,87264,163353,105988,591915,557754,320669,575093,757276,307060,323265,135811,543116,213391,276301,391641,714304,412441,627420,606039,252299,443392,755890,501760,278277,524392,568190,607896,662887,696965,759195,112092,256689,423548,223541,678310,768575,100027,86389,547390,694780,469289,288725,138481,391862,198321,117800,200909,388397,685071,5330,780681,451082,496292,188434,760630,171629,137100,436648,696083,99734,724395,76680,83431,403375,781890,393155,128594,251331,169041,649864,735847,295789,4124,278643,361069,346079,139037,15334,233324,646936,475709,505955,621552,758901,153392,460790,363545,371289,216014,280861,758248,618152,80130,46423,454317,638698,401956,85956,682822,694290,277002,367773,38476,115868,472309,610545,514583,752428,428545,491457,233487,773250,152056,723072,262530,610205,525042,663395,662906,283964,471562,603572,113916,560004,228415,403961,289239,551214,567931,383159,749433,140516,479022,189769,685003,164094,449530,341282,141449,236049,413350,164001,574503,429825,498162,522590,75270,57685,103270,302277,62590,309504,54547,655993,434412,525250,223844,523837,758063,681443,365766,208503,30376,134638,148351,572084,732334,341647,164781,688749,495837,513471,722123,358539,216546,467248,538134,279094,782652,733747,590789,7175,297685,185416,65500,12627,240564,562461,666626,768571,63286,435550,402691,766067,564250,452617,690993,740152,474400,428718,317943,211973,177073,6497,728654,224450,214891,737039,277553,141159,314090,268290,248697,650964,655929,629917,628299,258743,97707,710717,170271,588987,297616,530835,409160,454173,99383,437976,360319,115710,196081,693587,674180,43140,654380,698303,123603,430207,481803,470557,185207,691706,43146,317811,566242,732332,714957,731042,224719,139800,169271,20708,634795,390691,213607,693593,337611,694440,479748,199692,372842,184369,436396,731483,162769,225329,650956,582447,544878,338901,401317,287629,255140,491934,502206,66413,369310,643228,101325,650109,440310,256265,445807,416640,224075,491387,765561,224999,361587,12192,749306,344871,10309,491582,402442,241502,169574,649596,624283,188746,492984,354706,456568,359789,339374,633295,713314,327695,483377,435962,270209,53729,584388,160305,310342,309857,751017,589454,82802,305220,656347,160866,567261,104249,90145,579305};
static const uint64_t omega_2560[2560]={277499,759196,385707,31986,243061,310393,728297,718822,475215,626340,460685,282530,535351,237255,253881,696887,419303,79159,300414,729931,63621,447086,758667,293398,3219,378083,496390,604425,674813,53335,220411,883,171851,16920,495789,323333,754674,431821,674580,40813,354343,353559,735045,177081,129890,612862,220481,162662,501441,650620,60986,120561,773825,499493,199637,736934,614807,630958,144041,539580,151860,357983,149096,639783,228319,237603,252411,432972,548162,88596,30945,287977,444811,592696,548777,558716,17002,36231,373698,42195,213443,705628,152774,165035,423886,73306,392669,29590,10070,443687,300307,68578,7454,373700,69199,558586,611825,319405,204005,178234,30476,222427,586641,263711,250177,37222,437043,679534,344036,626703,661745,648785,352368,321383,276687,762626,479268,514676,743282,155793,192801,90499,657699,71602,102730,511490,27404,262416,782390,206695,464008,498099,178513,664090,193174,426579,399586,202965,236652,729146,431605,108231,366697,301374,374714,443090,73223,55364,198334,377770,187069,249774,79443,218177,388494,60732,607858,25519,662059,188247,487910,478171,586841,614028,296593,57254,649562,659729,63027,260508,88126,735254,648916,554408,602461,7798,318222,681720,91690,288000,755357,253355,645084,516570,465157,344677,664514,434495,744322,97375,277492,664682,352748,751977,51533,173998,21357,85366,287701,635064,747983,176454,281107,122669,251684,17350,34761,109783,171054,222880,436159,494181,546225,569496,646777,657987,43373,451579,320995,521438,390569,659747,306063,233351,27260,668211,216285,693623,216991,42342,631515,614406,700183,270318,154737,35187,378108,50579,610227,677317,177820,707536,63677,419837,238978,16997,752082,685882,668383,188546,608203,766904,272110,66130,639081,150247,513365,276102,697566,186829,142738,180416,507483,760160,84498,318380,464953,723713,711173,602069,198541,39240,266444,333176,483490,334767,31064,327993,221753,103264,671309,527348,284567,621290,427992,677248,29543,158837,558117,546275,461235,658381,662995,292343,642468,446583,234049,51324,485524,380200,95767,500384,479504,567704,735384,54093,271234,772154,655120,501189,381560,441184,189324,145705,289439,600710,649987,131191,161661,303076,637649,399408,149692,70004,460642,485305,556706,295617,196439,642393,217294,216643,43812,112069,485547,690746,539787,596691,437358,232498,260469,344909,663534,519672,46867,625907,97846,370046,84634,587930,433847,611997,291666,118585,728147,260244,440403,611316,497136,493224,158587,316061,488255,436195,196892,491911,447764,512691,576086,321803,464000,390083,364663,255941,310011,270699,598833,374285,134259,67664,200402,98910,635676,394236,36477,561746,193290,426089,50494,245918,500918,639323,284287,757535,676354,492531,202033,186564,481513,275587,10924,223980,404500,749469,656401,563309,146169,287479,771064,38438,404894,585730,497165,101421,71314,130959,162641,217899,551743,654237,329338,364640,728756,649352,174392,640979,709491,609174,560209,591463,351392,460568,269518,320191,632884,297980,767225,689447,234631,75878,651929,501162,17006,90239,280623,637950,546705,207,444831,79375,83402,404047,116590,425931,267261,397256,77745,9250,339101,580018,143119,624512,63220,516311,101583,691916,669907,398208,397873,574869,340450,776913,675536,414949,43526,167302,481841,4077,212384,507508,314349,90300,320884,589438,427477,773967,66694,420599,343809,695193,264384,720052,632094,598454,740554,140304,217710,349948,547705,185070,676911,179535,362636,305022,278267,161678,532610,46240,777124,391014,401249,722683,121250,676371,722065,393985,564280,722835,606832,272965,643286,524165,392556,70586,485196,651710,677668,216856,569655,443512,287540,27964,773287,285666,576129,119028,442645,331721,422105,310435,512020,133215,72074,208786,495694,607365,419282,578978,201537,539821,272398,37901,204569,743113,224038,404255,574923,286197,695442,492938,213820,312355,584947,108792,107709,368902,305566,573106,37254,85746,718295,409910,159355,501904,635158,450449,730955,572532,120716,516552,222121,371834,725380,501538,393592,741521,662962,630138,39455,35930,226401,191680,621977,303534,554677,317694,602913,627175,767801,632989,148968,478249,73275,757468,555081,288975,602670,479633,742740,671319,662368,443560,152275,477786,88737,368005,728048,490268,198086,162718,474192,130931,567946,86063,298263,671486,567119,670324,545015,682657,209288,223449,285187,375559,101865,582675,766688,489122,392014,586112,171402,221410,172244,623040,555662,300027,204823,255816,188983,241689,586313,535221,48717,537055,527194,555342,679553,600574,380437,162297,273377,722583,337772,653163,712049,679406,182502,471659,398249,168094,208371,375891,667724,691060,79249,732233,594146,542652,111871,162234,206112,425952,550803,496133,267855,583834,748286,350755,476765,403693,37048,437778,419811,671287,230304,404799,86401,161773,248578,381632,629967,80696,685602,21267,436908,423486,156033,299837,772887,368393,483297,78964,17607,371331,200762,259464,92536,743638,262339,526097,627507,550299,741374,244890,721360,275407,714008,495550,229799,636538,282545,737881,84064,725400,771578,711578,586852,762550,236477,716379,390991,90703,278663,24943,718517,273910,85539,273464,330535,75953,97857,518568,24518,463694,175276,42971,507302,666381,575177,582261,660387,330372,225210,561379,721583,152909,421083,611889,400172,281527,309982,662502,686106,559387,459873,285960,628912,719945,754102,542287,667168,234197,482898,175193,489027,676046,250720,318559,531728,671252,541095,240004,552912,770855,349964,763737,596131,709848,729222,674396,689889,718988,366464,288852,508646,12405,636417,215525,615796,667299,436237,763976,689665,44623,95137,611095,646638,347931,731806,312319,98875,163106,229441,502988,387467,294676,24833,16658,91709,544538,509091,537268,269676,103424,481546,721153,613937,634633,412148,609113,519948,639975,470620,470169,647655,762328,372477,6834,619431,395326,653159,658041,772481,370108,138397,320309,659398,294031,716375,336983,183778,466269,475042,640577,765214,171199,613948,783155,352032,484877,261377,70949,686256,234604,494685,300984,592461,509251,347505,463481,432794,494889,705309,545802,341677,109925,521616,443842,43034,574567,179651,362146,739291,321220,425944,442787,682283,643067,700671,592406,550002,648085,301300,158927,206575,410490,156905,323166,66562,205057,281840,619303,233792,498115,394545,291790,226111,192905,711346,587832,677373,150571,187847,570637,385339,546777,188990,336203,619272,598591,240245,673450,450773,405437,83706,591850,93139,268373,527621,53808,339969,549339,313230,648782,311862,195349,25711,120999,420813,99793,24166,411156,532266,101718,164603,74549,725074,286731,71900,209521,235971,151255,22883,322032,422514,349226,199593,142846,71910,344541,394964,465601,72677,516882,760976,135076,131744,578018,556754,160352,646261,741204,299633,368562,415052,650871,316544,742833,360283,652617,390206,458687,723169,416334,726493,645405,150546,633658,564835,382835,422292,485226,273409,371286,376533,719037,244701,519565,168875,569740,24460,463939,349822,413175,375169,319612,648836,257609,113878,626474,703231,689642,517438,434478,514788,688784,683137,423360,21503,489936,415588,54333,378270,671181,365814,129523,357794,730662,533251,84051,549874,486551,146256,678792,509245,266493,211413,714203,778357,588399,499397,470167,620651,417185,466280,623564,580461,640978,695989,44922,215430,116467,331907,583394,290933,405312,746039,562840,80619,429309,442079,523199,666761,222410,357107,71759,655822,579261,105798,417493,708091,507038,235297,451239,430481,599203,669859,533473,731412,476058,258111,624994,304296,659508,212529,115215,661345,731512,259536,281319,635010,18875,257925,463705,323798,766216,383066,407810,6151,14536,424822,177402,547227,781363,440639,664344,489238,391524,237020,214355,485676,82421,475722,421605,609684,395980,83135,715818,649979,23175,347811,678288,754486,243528,348939,241324,358249,607184,325503,286296,465418,735255,662418,335299,163879,482794,337707,558894,70275,202879,642202,771856,548329,776708,257709,680717,649682,713247,404221,115855,685654,723371,10294,334691,571634,529696,652823,38174,757171,461792,345385,40237,410801,439222,332674,755735,656945,74787,21745,623976,659758,454585,173235,686385,409640,430620,125898,764787,672733,170171,51029,419239,781753,222892,598183,214956,766768,2560,97236,750797,569754,213488,529857,476562,12870,647959,166770,349026,632637,96430,51878,132022,414769,746610,438872,307140,674507,621889,682080,252244,528221,321398,479217,609435,167426,589367,252196,663486,654937,380406,527096,15507,218127,496755,49128,602850,559910,471170,62659,775299,34055,761064,539891,434177,367491,54908,308310,21266,423406,642595,594615,608202,753402,491219,504712,164085,130762,636191,297517,782687,299984,407598,277171,247345,184247,531819,333212,186201,280453,692693,193907,139852,381694,683730,596436,127792,486662,78256,641884,395025,505862,24165,397654,751375,540300,472968,55064,64539,308146,157021,322676,500831,248010,546106,529480,86474,364058,704202,482947,53430,719740,336275,24694,489963,780142,405278,286971,178936,108548,730026,562950,782478,611510,766441,287572,460028,28687,351540,108781,742548,429018,429802,48316,606280,653471,170499,562880,620699,281920,132741,722375,662800,9536,283868,583724,46427,168554,152403,639320,243781,631501,425378,634265,143578,555042,545758,530950,350389,235199,694765,752416,495384,338550,190665,234584,224645,766359,747130,409663,741166,569918,77733,630587,618326,359475,710055,390692,753771,773291,339674,483054,714783,775907,409661,714162,224775,171536,463956,579356,605127,752885,560934,196720,519650,533184,746139,346318,103827,439325,156658,121616,134576,430993,461978,506674,20735,304093,268685,40079,627568,590560,692862,125662,711759,680631,271871,755957,520945,971,576666,319353,285262,604848,119271,590187,356782,383775,580396,546709,54215,351756,675130,416664,481987,408647,340271,710138,727997,585027,405591,596292,533587,703918,565184,394867,722629,175503,757842,121302,595114,295451,305190,196520,169333,486768,726107,133799,123632,720334,522853,695235,48107,134445,228953,180900,775563,465139,101641,691671,495361,28004,530006,138277,266791,318204,438684,118847,348866,39039,685986,505869,118679,430613,31384,731828,609363,762004,697995,495660,148297,35378,606907,502254,660692,531677,766011,748600,673578,612307,560481,347202,289180,237136,213865,136584,125374,739988,331782,462366,261923,392792,123614,477298,550010,756101,115150,567076,89738,566370,741019,151846,168955,83178,513043,628624,748174,405253,732782,173134,106044,605541,75825,719684,363524,544383,766364,31279,97479,114978,594815,175158,16457,511251,717231,144280,633114,269996,507259,85795,596532,640623,602945,275878,23201,698863,464981,318408,59648,72188,181292,584820,744121,516917,450185,299871,448594,752297,455368,561608,680097,112052,256013,498794,162071,355369,106113,753818,624524,225244,237086,322126,124980,120366,491018,140893,336778,549312,732037,297837,403161,687594,282977,303857,215657,47977,729268,512127,11207,128241,282172,401801,342177,594037,637656,493922,182651,133374,652170,621700,480285,145712,383953,633669,713357,322719,298056,226655,487744,586922,140968,566067,566718,739549,671292,297814,92615,243574,186670,346003,550863,522892,438452,119827,263689,736494,157454,685515,413315,698727,195431,349514,171364,491695,664776,55214,523117,342958,172045,286225,290137,624774,467300,295106,347166,586469,291450,335597,270670,207275,461558,319361,393278,418698,527420,473350,512662,184528,409076,649102,715697,582959,684451,147685,389125,746884,221615,590071,357272,732867,537443,282443,144038,499074,25826,107007,290830,581328,596797,301848,507774,772437,559381,378861,33892,126960,220052,637192,495882,12297,744923,378467,197631,286196,681940,712047,652402,620720,565462,231618,129124,454023,418721,54605,134009,608969,142382,73870,174187,223152,191898,431969,322793,513843,463170,150477,485381,16136,93914,548730,707483,131432,282199,766355,693122,502738,145411,236656,783154,338530,703986,699959,379314,666771,357430,516100,386105,705616,774111,444260,203343,640242,158849,720141,267050,681778,91445,113454,385153,385488,208492,442911,6448,107825,368412,739835,616059,301520,779284,570977,275853,469012,693061,462477,193923,355884,9394,716667,362762,439552,88168,518977,63309,151267,184907,42807,643057,565651,433413,235656,598291,106450,603826,420725,478339,505094,621683,250751,737121,6237,392347,382112,60678,662111,106990,61296,389376,219081,60526,176529,510396,140075,259196,390805,712775,298165,131651,105693,566505,213706,339849,495821,755397,10074,497695,207232,664333,340716,451640,361256,472926,271341,650146,711287,574575,287667,175996,364079,204383,581824,243540,510963,745460,578792,40248,559323,379106,208438,497164,87919,290423,569541,471006,198414,674569,675652,414459,477795,210255,746107,697615,65066,373451,624006,281457,148203,332912,52406,210829,662645,266809,561240,411527,57981,281823,389769,41840,120399,153223,743906,747431,556960,591681,161384,479827,228684,465667,180448,156186,15560,150372,634393,305112,710086,25893,228280,494386,180691,303728,40621,112042,120993,339801,631086,305575,694624,415356,55313,293093,585275,620643,309169,652430,215415,697298,485098,111875,216242,113037,238346,100704,574073,559912,498174,407802,681496,200686,16673,294239,391347,197249,611959,561951,611117,160321,227699,483334,578538,527545,594378,541672,197048,248140,734644,246306,256167,228019,103808,182787,402924,621064,509984,60778,445589,130198,71312,103955,600859,311702,385112,615267,574990,407470,115637,92301,704112,51128,189215,240709,671490,621127,577249,357409,232558,287228,515506,199527,35075,432606,306596,379668,746313,345583,363550,112074,553057,378562,696960,621588,534783,401729,153394,702665,97759,762094,346453,359875,627328,483524,10474,414968,300064,704397,765754,412030,582599,523897,690825,39723,521022,257264,155854,233062,41987,538471,62001,507954,69353,287811,553562,146823,500816,45480,699297,57961,11783,71783,196509,20811,546884,66982,392370,692658,504698,758418,64844,509451,697822,509897,452826,707408,685504,264793,758843,319667,608085,740390,276059,116980,208184,201100,122974,452989,558151,221982,61778,630452,362278,171472,383189,501834,473379,120859,97255,223974,323488,497401,154449,63416,29259,241074,116193,549164,300463,608168,294334,107315,532641,464802,251633,112109,242266,543357,230449,12506,433397,19624,187230,73513,54139,108965,93472,64373,416897,494509,274715,770956,146944,567836,167565,116062,347124,19385,93696,738738,688224,172266,136723,435430,51555,471042,684486,620255,553920,280373,395894,488685,758528,766703,691652,238823,274270,246093,513685,679937,301815,62208,169424,148728,371213,174248,263413,143386,312741,313192,135706,21033,410884,776527,163930,388035,130202,125320,10880,413253,644964,463052,123963,489330,66986,446378,599583,317092,308319,142784,18147,612162,169413,206,431329,298484,521984,712412,97105,548757,288676,482377,190900,274110,435856,319880,350567,288472,78052,237559,441684,673436,261745,339519,740327,208794,603710,421215,44070,462141,357417,340574,101078,140294,82690,190955,233359,135276,482061,624434,576786,372871,626456,460195,716799,578304,501521,164058,549569,285246,388816,491571,557250,590456,72015,195529,105988,632790,595514,212724,398022,236584,594371,447158,164089,184770,543116,109911,332588,377924,699655,191511,690222,514988,255740,729553,443392,234022,470131,134579,471499,588012,757650,662362,362548,683568,759195,372205,251095,681643,618758,708812,58287,496630,711461,573840,547390,632106,760478,461329,360847,434135,583768,640515,711451,438820,388397,317760,710684,266479,22385,648285,651617,205343,226607,623009,137100,42157,483728,414799,368309,132490,466817,40528,423078,130744,393155,324674,60192,367027,56868,137956,632815,149703,218526,400526,361069,298135,509952,412075,406828,64324,538660,263796,614486,213621,758901,319422,433539,370186,408192,463749,134525,525752,669483,156887,80130,93719,265923,348883,268573,94577,100224,360001,761858,293425,367773,729028,405091,112180,417547,653838,425567,52699,250110,699310,233487,296810,637105,104569,274116,516868,571948,69158,5004,194962,283964,313194,162710,366176,317081,159797,202900,142383,87372,738439,567931,666894,451454,199967,492428,378049,37322,220521,702742,354052,341282,260162,116600,560951,426254,711602,127539,204100,677563,365868,75270,276323,548064,332122,352880,184158,113502,249888,51949,307303,525250,158367,479065,123853,570832,668146,122016,51849,523825,502042,148351,764486,525436,319656,459563,17145,400295,375551,777210,768825,358539,605959,236134,1998,342722,119017,294123,391837,546341,569006,297685,700940,307639,361756,173677,387381,700226,67543,133382,760186,435550,105073,28875,539833,434422,542037,425112,176177,457858,497065,317943,48106,120943,448062,619482,300567,445654,224467,713086,580482,141159,11505,235032,6653,525652,102644,133679,70114,379140,667506,97707,59990,773067,448670,211727,253665,130538,745187,26190,321569,437976,743124,372560,344139,450687,27626,126416,708574,761616,159385,123603,328776,610126,96976,373721,352741,657463,18574,110628,613190,732332,364122,1608,560469,185178,568405,16593,780801,686125,32564,213607,569873,253504,306799,770491,135402,616591,434335,150724,686931,731483,651339,368592,36751,344489,476221,108854,161472,101281,531117,255140,461963,304144,173926,615935,193994,531165,119875,128424,402955,256265,767854,565234,286606,734233,180511,223451,312191,720702,8062,749306,22297,243470,349184,415870,728453,475051,762095,359955,140766,188746,175159,29959,292142,278649,619276,652599,147170,485844,674,483377,375763,506190,536016,599114,251542,450149,597160,502908,90668,589454,643509,401667,99631,186925,655569,296699,705105,141477,388336};

/* multiplication inverses of omega */
static const __m256i w_4_inv[3][3]={{{160150,160150,160150,160150},{783360,783360,783360,783360},{623211,623211,623211,623211}},
{{783360,783360,783360,783360},{1,1,1,1},{783360,783360,783360,783360}},
{{623211,623211,623211,623211},{783360,783360,783360,783360},{160150,160150,160150,160150}}};

static const __m256i w_9_inv[8][8]={{{342032,342032,342032,342032},{324006,324006,324006,324006},{689605,689605,689605,689605},{113704,113704,113704,113704},{449683,449683,449683,449683},{93755,93755,93755,93755},{327625,327625,327625,327625},{9672,9672,9672,9672}},
{{324006,324006,324006,324006},{113704,113704,113704,113704},{93755,93755,93755,93755},{9672,9672,9672,9672},{342032,342032,342032,342032},{689605,689605,689605,689605},{449683,449683,449683,449683},{327625,327625,327625,327625}},
{{689605,689605,689605,689605},{93755,93755,93755,93755},{1,1,1,1},{689605,689605,689605,689605},{93755,93755,93755,93755},{1,1,1,1},{689605,689605,689605,689605},{93755,93755,93755,93755}},
{{113704,113704,113704,113704},{9672,9672,9672,9672},{689605,689605,689605,689605},{327625,327625,327625,327625},{324006,324006,324006,324006},{93755,93755,93755,93755},{342032,342032,342032,342032},{449683,449683,449683,449683}},
{{449683,449683,449683,449683},{342032,342032,342032,342032},{93755,93755,93755,93755},{324006,324006,324006,324006},{327625,327625,327625,327625},{689605,689605,689605,689605},{9672,9672,9672,9672},{113704,113704,113704,113704}},
{{93755,93755,93755,93755},{689605,689605,689605,689605},{1,1,1,1},{93755,93755,93755,93755},{689605,689605,689605,689605},{1,1,1,1},{93755,93755,93755,93755},{689605,689605,689605,689605}},
{{327625,327625,327625,327625},{449683,449683,449683,449683},{689605,689605,689605,689605},{342032,342032,342032,342032},{9672,9672,9672,9672},{93755,93755,93755,93755},{113704,113704,113704,113704},{324006,324006,324006,324006}},
{{9672,9672,9672,9672},{327625,327625,327625,327625},{93755,93755,93755,93755},{449683,449683,449683,449683},{113704,113704,113704,113704},{689605,689605,689605,689605},{324006,324006,324006,324006},{342032,342032,342032,342032}}};

/* (in Montgomery form) */
static const uint64_t omega_256_inv[128]={277499,589454,483377,188746,749306,256265,255140,731483,213607,732332,123603,437976,97707,141159,317943,435550,297685,358539,148351,525250,75270,341282,567931,283964,233487,367773,80130,758901,361069,393155,137100,388397,547390,759195,443392,543116,105988,501521,233359,603710,350567,521984,599583,130202,263413,274270,684486,347124,93472,242266,116193,473379,122974,685504,392370,500816,155854,300064,153394,746313,577249,574990,509984,197048,611959,574073,309169,120993,634393,556960,561240,65066,569541,510963,271341,495821,140075,382112,106450,518977,469012,442911,640242,699959,131432,431969,454023,378467,772437,282443,582959,319361,624774,349514,522892,566067,145712,401801,687594,322126,112052,584820,640623,175158,605541,151846,392792,347202,35378,505869,28004,695235,295451,596292,351756,319353,590560,121616,752885,483054,569918,752416,631501,722375,429018,562950,719740,322676};
static const uint64_t omega_1024_inv[1024]={277499,452946,127792,514619,589454,276733,531819,239919,483377,55227,164085,458194,188746,204571,54908,3648,749306,472308,602850,717725,256265,438581,589367,517836,255140,530898,307140,93566,731483,729524,647959,252600,213607,648265,214956,52231,732332,348600,430620,708565,123603,139067,755735,510856,437976,771314,529696,9569,97707,375659,680717,385289,141159,513738,482794,572388,317943,193067,241324,740615,435550,624319,395980,100838,297685,166155,664344,18686,358539,682490,766216,404209,148351,427702,115215,18954,525250,418274,599203,767017,75270,48486,71759,603288,341282,163516,405312,504181,567931,559041,623564,642460,283964,256665,266493,393778,233487,399118,129523,255592,367773,375968,688784,314491,80130,464372,319612,556068,758901,182816,719037,663184,361069,64050,645405,505352,393155,141168,650871,754528,137100,552274,135076,263665,388397,496095,349226,568650,547390,136863,74549,29663,759195,745689,195349,544274,443392,258640,591850,749979,543116,32888,546777,196914,105988,432135,291790,430555,501521,772283,410490,281906,233359,15504,442787,440587,603710,504408,109925,101407,350567,634081,300984,297914,521984,5975,171199,750394,599583,290189,320309,209203,130202,417822,762328,698189,263413,465478,721153,3514,274270,604416,294676,536321,684486,628189,611095,225669,347124,658277,12405,224984,93472,82566,763737,233014,242266,210010,676046,499113,116193,36881,285960,118638,473379,471096,152909,158819,122974,738687,42971,642692,685504,472235,273910,602623,392370,713899,711578,597746,500816,213891,275407,694943,155854,380207,259464,613362,300064,380372,423486,111625,153394,498515,404799,521210,746313,302905,583834,31142,577249,749066,732233,406859,574990,13206,679406,776968,509984,468449,555342,663893,197048,581024,300027,599964,611959,73300,582675,388762,574073,141375,671486,737522,309169,458360,368005,777508,120993,321908,288975,623255,634393,354762,317694,315859,556960,249807,741521,139774,561240,445204,450449,465692,65066,458977,368902,344599,569541,23059,404255,65892,510963,501613,607365,577012,271341,626820,119028,148921,495821,91093,651710,221234,140075,447411,393985,254102,382112,301592,161678,600702,106450,421380,140304,19879,518977,406615,773967,218685,469012,516802,167302,123880,442911,763253,691916,251754,640242,172821,397256,742586,699959,598629,637950,500862,131432,358668,297980,744265,431969,112531,640979,435436,454023,87460,130959,201816,378467,381358,563309,636117,772437,406905,492531,96467,282443,582018,561746,321516,582959,15904,270699,244998,319361,648386,491911,49859,624774,278566,260244,747807,349514,256740,625907,308145,522892,524034,690746,441767,566067,358269,485305,447806,145712,168670,600710,228346,401801,275622,54093,119269,687594,199764,446583,311525,322126,477197,677248,13323,112052,392705,334767,381308,584820,170965,318380,584748,640623,494591,150247,332697,175158,754880,16997,474159,605541,202359,35187,325395,151846,412469,668211,188090,392792,93664,657987,293841,347202,280041,17350,369293,35378,102218,173998,313902,505869,437074,344677,191305,28004,548564,7798,530615,695235,688253,57254,498405,295451,594581,60732,224143,596292,280326,443090,357232,351756,733571,426579,238006,319353,526490,511490,697902,590560,678274,762626,538649,121616,414227,37222,781611,752885,170261,558586,740978,483054,617203,73306,674097,569918,283881,558716,371705,752416,74357,237603,445730,631501,157574,736934,750145,722375,605825,612862,515174,429018,583082,323333,67592,562950,649561,378083,13877,719740,407741,696887,8864,322676,240576,310393,307784,505862,330415,655569,268742,193907,506628,251542,543442,299984,728134,619276,325167,594615,578790,728453,779713,34055,311053,180511,65636,527096,344780,193994,265525,528221,252463,476221,689795,51878,53837,135402,530761,569754,135096,568405,731130,51029,434761,352741,74796,659758,644294,27626,272505,345385,12047,253665,773792,685654,407702,102644,398072,642202,269623,300567,210973,465418,590294,542037,42746,347811,159042,387381,682523,485676,617206,119017,764675,424822,100871,17145,379152,635010,355659,668146,764407,258111,365087,184158,16344,708091,734875,711602,180073,442079,619845,378049,279180,215430,224320,159797,140901,499397,526696,516868,389583,549874,384243,653838,527769,415588,407393,94577,468870,703231,318989,463749,227293,24460,600545,64324,120177,422292,719311,137956,278009,390206,642193,132490,28833,646261,231087,648285,519696,394964,287266,434135,214711,235971,646498,708812,753698,24166,37672,588012,239087,339969,524721,191511,33382,240245,750473,236584,586447,677373,351226,491571,352806,281840,11078,372871,501455,550002,767857,340574,342774,179651,278953,673436,681954,432794,149280,482377,485447,261377,777386,612162,32967,183778,493172,463052,574158,653159,365539,21033,85172,519948,317883,62208,779847,509091,178945,488685,247040,98875,155172,172266,557692,436237,125084,770956,558377,689889,700795,19624,550347,541095,573351,107315,284248,667168,746480,497401,664723,309982,312265,630452,624542,660387,44674,740390,140669,97857,311126,509451,180738,390991,69462,71783,185615,282545,569470,507954,88418,627507,403154,523897,169999,483297,402989,359875,671736,629967,284846,378562,262151,37048,480456,199527,752219,206112,34295,51128,376502,208371,770155,103955,6393,273377,314912,228019,119468,586313,202337,483334,183397,171402,710061,200686,394599,209288,641986,111875,45839,474192,325001,415356,5853,662368,461453,494386,160106,148968,428599,465667,467502,226401,533554,41840,643587,222121,338157,332912,317669,718295,324384,414459,438762,213820,760302,379106,717469,272398,281748,175996,206349,512020,156541,664333,634440,287540,692268,131651,562127,643286,335950,389376,529259,401249,481769,621683,182659,676911,361981,643057,763482,264384,376746,9394,564676,314349,266559,616059,659481,340450,20108,91445,531607,143119,610540,386105,40775,83402,184732,145411,282499,651929,424693,485381,39096,351392,670830,142382,347925,329338,695901,652402,581545,404894,402003,220052,147244,10924,376456,290830,686894,500918,201343,221615,461845,200402,767457,512662,538363,464000,134975,291450,733502,158587,504795,523117,35554,433847,526621,157454,475216,260469,259327,92615,341594,217294,425092,298056,335555,637649,614691,182651,555015,381560,507739,729268,664092,95767,583597,336778,471836,461235,306164,106113,770038,671309,390656,448594,402053,198541,612396,464981,198613,142738,288770,633114,450664,608203,28481,766364,309202,177820,581002,748174,457966,631515,370892,115150,595271,390569,689697,125374,489520,436159,503320,766011,414068,747983,681143,609363,469459,277492,346287,438684,592056,755357,234797,775563,252746,88126,95108,726107,284956,487910,188780,722629,559218,187069,503035,340271,426129,431605,49790,356782,545355,464008,256871,271871,85459,192801,105087,20735,244712,661745,369134,746139,1750,30476,613100,224775,42383,300307,166158,710055,109264,213443,499480,224645,411656,30945,709004,545758,337631,151860,625787,46427,33216,60986,177536,170499,268187,354343,200279,460028,715769,220411,133800,405278,769484,63621,375620,86474,774497,460685,542785,472968,475577};
static const uint64_t omega_2304_inv[2304]={277499,579305,90145,104249,567261,160866,656347,305220,82802,589454,751017,309857,310342,160305,584388,53729,270209,435962,483377,327695,713314,633295,339374,359789,456568,354706,492984,188746,624283,649596,169574,241502,402442,491582,10309,344871,749306,12192,361587,224999,765561,491387,224075,416640,445807,256265,440310,650109,101325,643228,369310,66413,502206,491934,255140,287629,401317,338901,544878,582447,650956,225329,162769,731483,436396,184369,372842,199692,479748,694440,337611,693593,213607,390691,634795,20708,169271,139800,224719,731042,714957,732332,566242,317811,43146,691706,185207,470557,481803,430207,123603,698303,654380,43140,674180,693587,196081,115710,360319,437976,99383,454173,409160,530835,297616,588987,170271,710717,97707,258743,628299,629917,655929,650964,248697,268290,314090,141159,277553,737039,214891,224450,728654,6497,177073,211973,317943,428718,474400,740152,690993,452617,564250,766067,402691,435550,63286,768571,666626,562461,240564,12627,65500,185416,297685,7175,590789,733747,782652,279094,538134,467248,216546,358539,722123,513471,495837,688749,164781,341647,732334,572084,148351,134638,30376,208503,365766,681443,758063,523837,223844,525250,434412,655993,54547,309504,62590,302277,103270,57685,75270,522590,498162,429825,574503,164001,413350,236049,141449,341282,449530,164094,685003,189769,479022,140516,749433,383159,567931,551214,289239,403961,228415,560004,113916,603572,471562,283964,662906,663395,525042,610205,262530,723072,152056,773250,233487,491457,428545,752428,514583,610545,472309,115868,38476,367773,277002,694290,682822,85956,401956,638698,454317,46423,80130,618152,758248,280861,216014,371289,363545,460790,153392,758901,621552,505955,475709,646936,233324,15334,139037,346079,361069,278643,4124,295789,735847,649864,169041,251331,128594,393155,781890,403375,83431,76680,724395,99734,696083,436648,137100,171629,760630,188434,496292,451082,780681,5330,685071,388397,200909,117800,198321,391862,138481,288725,469289,694780,547390,86389,100027,768575,678310,223541,423548,256689,112092,759195,696965,662887,607896,568190,524392,278277,501760,755890,443392,252299,606039,627420,412441,714304,391641,276301,213391,543116,135811,323265,307060,757276,575093,320669,557754,591915,105988,163353,87264,305819,265759,754649,735236,431855,237245,501521,57771,326476,286059,515513,193631,9509,358154,380899,233359,117569,306931,380467,538209,686323,128684,656045,206439,603710,91299,341639,708966,466563,565744,429875,720553,627667,350567,153380,723849,71590,740364,526884,507160,78709,384216,521984,294758,74379,270062,6575,404911,653282,752687,487761,599583,570108,643343,705225,506156,279469,66787,27938,137354,130202,389957,57503,327009,276230,6000,292058,21289,299650,263413,168871,538122,432196,449945,592948,773298,373695,341222,274270,547728,290326,445644,563503,150802,243760,731172,311326,684486,246334,416216,774025,147179,628031,630450,646100,141451,347124,280070,255586,23673,213065,374231,340156,293928,32,93472,422084,680511,385774,372736,673427,60796,545530,136856,242266,284003,776825,492369,742414,248046,716802,638050,128231,116193,204440,248158,260593,548622,551617,683041,725655,646750,473379,107894,247252,747611,544624,623874,238268,356260,332052,122974,427716,681002,253263,288439,417244,643369,781171,653259,685504,86468,330786,341793,375439,735280,560379,425930,164262,392370,55627,330740,207427,356214,197686,103749,673483,224372,500816,348549,525690,152930,192760,598762,522050,487544,749087,155854,116793,390318,328623,290558,339955,490168,580181,298858,300064,689346,341896,676302,625061,572051,51958,580645,87480,153394,764743,452092,597447,597740,670232,128533,214974,466893,746313,669971,149513,395396,277602,96807,763287,115921,193289,577249,351457,402987,516805,50758,208889,709911,93464,398716,574990,19806,667973,580243,479960,530331,392154,208052,615117,509984,494003,31801,454123,263110,67169,360399,671656,371232,197048,590234,679314,22781,740977,750735,269496,703372,577070,611959,685798,161881,487718,473980,296693,242987,39961,5292,574073,474693,29283,149294,539058,32808,262126,326349,698453,309169,650777,485831,445580,376559,89995,449460,742985,349215,120993,124742,108517,500313,446008,60025,643522,444723,223345,634393,413188,546208,550572,764040,748712,627201,556103,469510,556960,622724,12562,658996,209339,457639,349653,617030,614330,561240,590828,64305,611626,496466,175975,138159,131524,334714,65066,484424,252538,520797,744336,378681,21469,42069,679233,569541,553858,178753,419087,543245,512620,360149,724767,402985,510963,220218,117397,587880,70168,503507,375350,475311,267739,271341,609090,139059,410341,63731,501694,563104,552045,366507,495821,642013,737100,393072,539447,385716,203318,104240,540972,140075,244633,147761,761331,669333,635998,401227,76011,336968,382112,643088,743731,178198,364654,566735,191142,572750,527015,106450,729494,110054,289724,253924,652498,29345,330396,769325,518977,128282,265164,583376,231121,630620,359309,621210,290334,469012,669024,516770,731884,40995,675523,699685,774397,450430,442911,414020,626397,557702,440023,595143,134644,47902,483484,640242,264175,44590,209464,39403,725457,68392,15977,450518,699959,8029,735240,443539,681686,684505,301833,373068,76477,131432,65982,26616,192597,122639,232542,81195,595573,607313,431969,570239,242633,572649,231994,47209,25953,606057,679998,454023,754371,706559,485965,53633,773154,736432,8566,737095,378467,179736,156986,289921,46000,411269,424336,208354,713898,772437,208797,441179,55014,106889,445091,514912,4832,13774,282443,136870,283160,664505,633908,563225,122125,297870,547560,582959,579786,711785,83891,636979,133284,775508,562217,311201,319361,653891,181493,589017,257901,518900,686726,522486,194378,624774,517085,85277,768680,201654,727223,526712,4748,551771,349514,211011,641385,469434,334964,11955,452671,721984,107452,522892,596943,692278,289297,573379,14241,79828,519371,495795,566067,589997,770398,519766,82868,782240,642364,195649,420560,145712,259729,374961,122403,326547,493450,766571,308153,33124,401801,185943,270330,6042,414740,379434,654260,475981,658087,687594,707831,284672,380891,209991,12048,724324,675704,445025,322126,113485,127982,172225,151463,607819,343273,781714,672640,112052,642355,169360,399769,517359,102270,270129,202282,211528,584820,532240,484816,614209,207799,659465,12566,670680,653780,640623,593715,663622,404748,177159,463179,81412,446069,238206,175158,101785,420166,561560,742187,368340,366487,437401,769891,605541,739484,306487,650265,557001,742485,455437,184499,752572,151846,159840,9484,285129,149066,656431,550584,15731,515313,392792,504928,609286,711575,253842,412976,710317,496029,466220,347202,507908,696895,458417,272108,499414,170112,246278,252640,35378,718847,344607,761523,446804,35058,567488,40572,223301,505869,224503,100106,215973,251528,704031,151926,393520,281333,28004,330140,21549,275749,167721,312416,734932,327232,144252,695235,309723,702289,547071,721312,494623,276099,406710,424634,295451,531910,304247,374113,778839,108375,85531,727253,614342,596292,357429,613257,560451,636242,330590,552638,531938,386035,351756,493005,250087,411675,43540,275858,486110,477178,237719,319353,630523,75972,223049,553138,425716,322529,507287,449676,590560,64838,601797,770314,274402,149939,73020,217228,578,121616,377803,590275,15714,465656,266480,510607,747064,513559,752885,282758,273624,227484,190636,661446,315540,459804,406730,483054,167573,663469,741196,607073,514290,538053,230647,29427,569918,88353,353344,431387,436939,203750,582751,755579,318322,752416,479531,60583,706718,167043,682061,213158,645884,293876,631501,582627,393375,641149,563439,747219,182953,153511,323139,722375,466202,294624,466326,656828,143499,62444,659172,723435,429018,567339,388704,314295,739964,141845,714637,580973,262207,562950,102211,97790,501186,645958,510030,628369,51026,208356,719740,602977,300289,563210,78310,2098,644731,59407,405066,322676,153313,528142,264973,25465,747331,510105,64083,746525,505862,204056,693216,679112,216100,622495,127014,478141,700559,193907,32344,473504,473019,623056,198973,729632,513152,347399,299984,455666,70047,150066,443987,423572,326793,428655,290377,594615,159078,133765,613787,541859,380919,291779,773052,438490,34055,771169,421774,558362,17800,291974,559286,366721,337554,527096,343051,133252,682036,140133,414051,716948,281155,291427,528221,495732,382044,444460,238483,200914,132405,558032,620592,51878,346965,598992,410519,583669,303613,88921,445750,89768,569754,392670,148566,762653,614090,643561,558642,52319,68404,51029,217119,465550,740215,91655,598154,312804,301558,353154,659758,85058,128981,740221,109181,89774,587280,667651,423042,345385,683978,329188,374201,252526,485745,194374,613090,72644,685654,524618,155062,153444,127432,132397,534664,515071,469271,642202,505808,46322,568470,558911,54707,776864,606288,571388,465418,354643,308961,43209,92368,330744,219111,17294,380670,347811,720075,14790,116735,220900,542797,770734,717861,597945,485676,776186,192572,49614,709,504267,245227,316113,566815,424822,61238,269890,287524,94612,618580,441714,51027,211277,635010,648723,752985,574858,417595,101918,25298,259524,559517,258111,348949,127368,728814,473857,720771,481084,680091,725676,708091,260771,285199,353536,208858,619360,370011,547312,641912,442079,333831,619267,98358,593592,304339,642845,33928,400202,215430,232147,494122,379400,554946,223357,669445,179789,311799,499397,120455,119966,258319,173156,520831,60289,631305,10111,549874,291904,354816,30933,268778,172816,311052,667493,744885,415588,506359,89071,100539,697405,381405,144663,329044,736938,703231,165209,25113,502500,567347,412072,419816,322571,629969,24460,161809,277406,307652,136425,550037,768027,644324,437282,422292,504718,779237,487572,47514,133497,614320,532030,654767,390206,1471,379986,699930,706681,58966,683627,87278,346713,646261,611732,22731,594927,287069,332279,2680,778031,98290,394964,582452,665561,585040,391499,644880,494636,314072,88581,235971,696972,683334,14786,105051,559820,359813,526672,671269,24166,86396,120474,175465,215171,258969,505084,281601,27471,339969,531062,177322,155941,370920,69057,391720,507060,569970,240245,647550,460096,476301,26085,208268,462692,225607,191446,677373,620008,696097,477542,517602,28712,48125,351506,546116,281840,725590,456885,497302,267848,589730,773852,425207,402462,550002,665792,476430,402894,245152,97038,654677,127316,576922,179651,692062,441722,74395,316798,217617,353486,62808,155694,432794,629981,59512,711771,42997,256477,276201,704652,399145,261377,488603,708982,513299,776786,378450,130079,30674,295600,183778,213253,140018,78136,277205,503892,716574,755423,646007,653159,393404,725858,456352,507131,777361,491303,762072,483711,519948,614490,245239,351165,333416,190413,10063,409666,442139,509091,235633,493035,337717,219858,632559,539601,52189,472035,98875,537027,367145,9336,636182,155330,152911,137261,641910,436237,503291,527775,759688,570296,409130,443205,489433,783329,689889,361277,102850,397587,410625,109934,722565,237831,646505,541095,499358,6536,290992,40947,535315,66559,145311,655130,667168,578921,535203,522768,234739,231744,100320,57706,136611,309982,675467,536109,35750,238737,159487,545093,427101,451309,660387,355645,102359,530098,494922,366117,139992,2190,130102,97857,696893,452575,441568,407922,48081,222982,357431,619099,390991,727734,452621,575934,427147,585675,679612,109878,558989,282545,434812,257671,630431,590601,184599,261311,295817,34274,627507,666568,393043,454738,492803,443406,293193,203180,484503,483297,94015,441465,107059,158300,211310,731403,202716,695881,629967,18618,331269,185914,185621,113129,654828,568387,316468,37048,113390,633848,387965,505759,686554,20074,667440,590072,206112,431904,380374,266556,732603,574472,73450,689897,384645,208371,763555,115388,203118,303401,253030,391207,575309,168244,273377,289358,751560,329238,520251,716192,422962,111705,412129,586313,193127,104047,760580,42384,32626,513865,79989,206291,171402,97563,621480,295643,309381,486668,540374,743400,778069,209288,308668,754078,634067,244303,750553,521235,457012,84908,474192,132584,297530,337781,406802,693366,333901,40376,434146,662368,658619,674844,283048,337353,723336,139839,338638,560016,148968,370173,237153,232789,19321,34649,156160,227258,313851,226401,160637,770799,124365,574022,325722,433708,166331,169031,222121,192533,719056,171735,286895,607386,645202,651837,448647,718295,298937,530823,262564,39025,404680,761892,741292,104128,213820,229503,604608,364274,240116,270741,423212,58594,380376,272398,563143,665964,195481,713193,279854,408011,308050,515622,512020,174271,644302,373020,719630,281667,220257,231316,416854,287540,141348,46261,390289,243914,397645,580043,679121,242389,643286,538728,635600,22030,114028,147363,382134,707350,446393,401249,140273,39630,605163,418707,216626,592219,210611,256346,676911,53867,673307,493637,529437,130863,754016,452965,14036,264384,655079,518197,199985,552240,152741,424052,162151,493027,314349,114337,266591,51477,742366,107838,83676,8964,332931,340450,369341,156964,225659,343338,188218,648717,735459,299877,143119,519186,738771,573897,743958,57904,714969,767384,332843,83402,775332,48121,339822,101675,98856,481528,410293,706884,651929,717379,756745,590764,660722,550819,702166,187788,176048,351392,213122,540728,210712,551367,736152,757408,177304,103363,329338,28990,76802,297396,729728,10207,46929,774795,46266,404894,603625,626375,493440,737361,372092,359025,575007,69463,10924,574564,342182,728347,676472,338270,268449,778529,769587,500918,646491,500201,118856,149453,220136,661236,485491,235801,200402,203575,71576,699470,146382,650077,7853,221144,472160,464000,129470,601868,194344,525460,264461,96635,260875,588983,158587,266276,698084,14681,581707,56138,256649,778613,231590,433847,572350,141976,313927,448397,771406,330690,61377,675909,260469,186418,91083,494064,209982,769120,703533,263990,287566,217294,193364,12963,263595,700493,1121,140997,587712,362801,637649,523632,408400,660958,456814,289911,16790,475208,750237,381560,597418,513031,777319,368621,403927,129101,307380,125274,95767,75530,498689,402470,573370,771313,59037,107657,338336,461235,669876,655379,611136,631898,175542,440088,1647,110721,671309,141006,614001,383592,266002,681091,513232,581079,571833,198541,251121,298545,169152,575562,123896,770795,112681,129581,142738,189646,119739,378613,606202,320182,701949,337292,545155,608203,681576,363195,221801,41174,415021,416874,345960,13470,177820,43877,476874,133096,226360,40876,327924,598862,30789,631515,623521,773877,498232,634295,126930,232777,767630,268048,390569,278433,174075,71786,529519,370385,73044,287332,317141,436159,275453,86466,324944,511253,283947,613249,537083,530721,747983,64514,438754,21838,336557,748303,215873,742789,560060,277492,558858,683255,567388,531833,79330,631435,389841,502028,755357,453221,761812,507612,615640,470945,48429,456129,639109,88126,473638,81072,236290,62049,288738,507262,376651,358727,487910,251451,479114,409248,4522,674986,697830,56108,169019,187069,425932,170104,222910,147119,452771,230723,251423,397326,431605,290356,533274,371686,739821,507503,297251,306183,545642,464008,152838,707389,560312,230223,357645,460832,276074,333685,192801,718523,181564,13047,508959,633422,710341,566133,782783,661745,405558,193086,767647,317705,516881,272754,36297,269802,30476,500603,509737,555877,592725,121915,467821,323557,376631,300307,615788,119892,42165,176288,269071,245308,552714,753934,213443,695008,430017,351974,346422,579611,200610,27782,465039,30945,303830,722778,76643,616318,101300,570203,137477,489485,151860,200734,389986,142212,219922,36142,600408,629850,460222,60986,317159,488737,317035,126533,639862,720917,124189,59926,354343,216022,394657,469066,43397,641516,68724,202388,521154,220411,681150,685571,282175,137403,273331,154992,732335,575005,63621,180384,483072,220151,705051,781263,138630,723954,378295,460685,630048,255219,518388,757896,36030,273256,719278,36836};

static const __m256i V_B4Q_B4Q_B4Q_B4Q = {BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q};
static const __m256i V_B8Q_B8Q_B8Q_B8Q = {BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q};
static const __m256i V_B16Q_B16Q_B16Q_B16Q = {BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q};
static const __m256i V_B32Q_B32Q_B32Q_B32Q = {BARRETT_FACTOR_32Q, BARRETT_FACTOR_32Q, BARRETT_FACTOR_32Q, BARRETT_FACTOR_32Q};
static const __m256i V_Q_Q_Q_Q = {Q, Q, Q, Q};
static const __m256i V_Q2_Q2_Q2_Q2 = {Q2, Q2, Q2, Q2};
static const __m256i V_MM_MM_MM_MM = {MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK};
static const __m256i V_MF_MF_MF_MF = {MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint64_t *a)
{
uint64_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint64_t *a, uint32_t n, const uint64_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	__m256i u, v, t, t1, o, u1, v1, r1, r2;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			j_omega = 0;

			for (j = j1; j < j2; j += 4)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = _mm256_loadu_si256((__m256i *)(a + j));
				v = _mm256_loadu_si256((__m256i *)(a + j + d));
				
				t = _mm256_add_epi64(u, v);
				t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
				t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				r1 = _mm256_sub_epi64(t, t1);
				
				t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
				t = _mm256_sub_epi64(t, v);
				o = _mm256_set_epi64x(omega[j_omega + num_of_problems * 3], omega[j_omega + num_of_problems * 2], omega[j_omega + num_of_problems], omega[j_omega]);
				t = _mm256_mul_epu32(t, o);
				t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
				t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				t1 = _mm256_add_epi64(t, t1);
				r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);

				_mm256_storeu_si256((__m256i *)(a + j), r1);
				_mm256_storeu_si256((__m256i *)(a + j + d), r2);

				j_omega += num_of_problems * 4;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k += 2)
	{
		j = k << 2;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);
		
		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		o = _mm256_set_epi64x(omega[num_of_problems], omega[0], omega[num_of_problems], omega[0]);
		t = _mm256_mul_epu32(t, o);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
		
		u = _mm256_permute2f128_si256(r1, r2, 0x20);
		v = _mm256_permute2f128_si256(r1, r2, 0x31);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
	
	for (k = 0; k < (n >> 1); k += 4)
	{
		j = k << 1;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u1 = _mm256_permute4x64_epi64(u1, 0xD8);
		v1 = _mm256_permute4x64_epi64(v1, 0xD8);
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);

		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r2 = _mm256_sub_epi64(t, t1);

		u1 = _mm256_permute2f128_si256(r1, r2, 0x20);
		v1 = _mm256_permute2f128_si256(r1, r2, 0x31);
		u = _mm256_permute4x64_epi64(u1, 0xD8);
		v = _mm256_permute4x64_epi64(v1, 0xD8);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint64_t *a, uint32_t N1, uint32_t N2, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t))
{
	uint32_t n1, n2;
	__m256i u, v, t, t1;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint64_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t), uint64_t inv_n)
{
	uint32_t i, n1, n2;
	__m256i u, v, t, t1;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i += 4)
	{
		u = _mm256_loadu_si256((__m256i *)(a + i));
		v = _mm256_set1_epi64x(inv_n);
		
		t = _mm256_mul_epu32(u, v);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
		_mm256_storeu_si256((__m256i *)(a + i), u);
	}
}

/* 256 * 6 --> 256 * 10 */
static void ntt_butterfly_1536_2560(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, c1, d1, e1, f1, g1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2560 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 5 + n2));	

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_10[0][0]);
	d1 = _mm256_mul_epu32(d, w_10[0][1]);
	e1 = _mm256_mul_epu32(e, w_10[0][2]);
	f1 = _mm256_mul_epu32(f, w_10[0][3]);
	g1 = _mm256_mul_epu32(g, w_10[0][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 + n2), t);
	a[N2_2560 + n2] %= Q;
	a[N2_2560 + n2 + 1] %= Q;
	a[N2_2560 + n2 + 2] %= Q;
	a[N2_2560 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_10[1][0]);
	d1 = _mm256_mul_epu32(d, w_10[1][1]);
	e1 = _mm256_mul_epu32(e, w_10[1][2]);
	f1 = _mm256_mul_epu32(f, w_10[1][3]);
	g1 = _mm256_mul_epu32(g, w_10[1][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 2 + n2), t);
	a[N2_2560 * 2 + n2] %= Q;
	a[N2_2560 * 2 + n2 + 1] %= Q;
	a[N2_2560 * 2 + n2 + 2] %= Q;
	a[N2_2560 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[2][0]);
	d1 = _mm256_mul_epu32(d, w_10[2][1]);
	e1 = _mm256_mul_epu32(e, w_10[2][2]);
	f1 = _mm256_mul_epu32(f, w_10[2][3]);
	g1 = _mm256_mul_epu32(g, w_10[2][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 3 + n2), t);
	a[N2_2560 * 3 + n2] %= Q;
	a[N2_2560 * 3 + n2 + 1] %= Q;
	a[N2_2560 * 3 + n2 + 2] %= Q;
	a[N2_2560 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[3][0]);
	d1 = _mm256_mul_epu32(d, w_10[3][1]);
	e1 = _mm256_mul_epu32(e, w_10[3][2]);
	f1 = _mm256_mul_epu32(f, w_10[3][3]);
	g1 = _mm256_mul_epu32(g, w_10[3][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 4 + n2), t);
	a[N2_2560 * 4 + n2] %= Q;
	a[N2_2560 * 4 + n2 + 1] %= Q;
	a[N2_2560 * 4 + n2 + 2] %= Q;
	a[N2_2560 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[4][0]);
	d1 = _mm256_mul_epu32(d, w_10[4][1]);
	e1 = _mm256_mul_epu32(e, w_10[4][2]);
	f1 = _mm256_mul_epu32(f, w_10[4][3]);
	g1 = _mm256_mul_epu32(g, w_10[4][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 5 + n2), t);
	a[N2_2560 * 5 + n2] %= Q;
	a[N2_2560 * 5 + n2 + 1] %= Q;
	a[N2_2560 * 5 + n2 + 2] %= Q;
	a[N2_2560 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[5][0]);
	d1 = _mm256_mul_epu32(d, w_10[5][1]);
	e1 = _mm256_mul_epu32(e, w_10[5][2]);
	f1 = _mm256_mul_epu32(f, w_10[5][3]);
	g1 = _mm256_mul_epu32(g, w_10[5][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 6 + n2), t);
	a[N2_2560 * 6 + n2] %= Q;
	a[N2_2560 * 6 + n2 + 1] %= Q;
	a[N2_2560 * 6 + n2 + 2] %= Q;
	a[N2_2560 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[6][0]);
	d1 = _mm256_mul_epu32(d, w_10[6][1]);
	e1 = _mm256_mul_epu32(e, w_10[6][2]);
	f1 = _mm256_mul_epu32(f, w_10[6][3]);
	g1 = _mm256_mul_epu32(g, w_10[6][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 7 + n2), t);
	a[N2_2560 * 7 + n2] %= Q;
	a[N2_2560 * 7 + n2 + 1] %= Q;
	a[N2_2560 * 7 + n2 + 2] %= Q;
	a[N2_2560 * 7 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[7][0]);
	d1 = _mm256_mul_epu32(d, w_10[7][1]);
	e1 = _mm256_mul_epu32(e, w_10[7][2]);
	f1 = _mm256_mul_epu32(f, w_10[7][3]);
	g1 = _mm256_mul_epu32(g, w_10[7][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 8 + n2), t);
	a[N2_2560 * 8 + n2] %= Q;
	a[N2_2560 * 8 + n2 + 1] %= Q;
	a[N2_2560 * 8 + n2 + 2] %= Q;
	a[N2_2560 * 8 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[8][0]);
	d1 = _mm256_mul_epu32(d, w_10[8][1]);
	e1 = _mm256_mul_epu32(e, w_10[8][2]);
	f1 = _mm256_mul_epu32(f, w_10[8][3]);
	g1 = _mm256_mul_epu32(g, w_10[8][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 9 + n2), t);
	a[N2_2560 * 9 + n2] %= Q;
	a[N2_2560 * 9 + n2 + 1] %= Q;
	a[N2_2560 * 9 + n2 + 2] %= Q;
	a[N2_2560 * 9 + n2 + 3] %= Q;
}

/* 256 * 10 --> 256 * 4 */
static void ntt_butterfly_2560_1024(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, k, c1, d1, e1, f1, g1, h1, i1, j1, k1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2560 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 7 + n2));	
	j = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 8 + n2));	
	k = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 9 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t = _mm256_add_epi64(t, k);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_10[0][0]);
	d1 = _mm256_mul_epu32(d, w_10[0][1]);
	e1 = _mm256_mul_epu32(e, w_10[0][2]);
	f1 = _mm256_mul_epu32(f, w_10[0][3]);
	g1 = _mm256_mul_epu32(g, w_10[0][4]);
	h1 = _mm256_mul_epu32(h, w_10[0][5]);
	i1 = _mm256_mul_epu32(i, w_10[0][6]);
	j1 = _mm256_mul_epu32(j, w_10[0][7]);
	k1 = _mm256_mul_epu32(k, w_10[0][8]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 + n2), t);
	a[N2_2560 + n2] %= Q;
	a[N2_2560 + n2 + 1] %= Q;
	a[N2_2560 + n2 + 2] %= Q;
	a[N2_2560 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_10[1][0]);
	d1 = _mm256_mul_epu32(d, w_10[1][1]);
	e1 = _mm256_mul_epu32(e, w_10[1][2]);
	f1 = _mm256_mul_epu32(f, w_10[1][3]);
	g1 = _mm256_mul_epu32(g, w_10[1][4]);
	h1 = _mm256_mul_epu32(h, w_10[1][5]);
	i1 = _mm256_mul_epu32(i, w_10[1][6]);
	j1 = _mm256_mul_epu32(j, w_10[1][7]);
	k1 = _mm256_mul_epu32(k, w_10[1][8]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 2 + n2), t);
	a[N2_2560 * 2 + n2] %= Q;
	a[N2_2560 * 2 + n2 + 1] %= Q;
	a[N2_2560 * 2 + n2 + 2] %= Q;
	a[N2_2560 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[2][0]);
	d1 = _mm256_mul_epu32(d, w_10[2][1]);
	e1 = _mm256_mul_epu32(e, w_10[2][2]);
	f1 = _mm256_mul_epu32(f, w_10[2][3]);
	g1 = _mm256_mul_epu32(g, w_10[2][4]);
	h1 = _mm256_mul_epu32(h, w_10[2][5]);
	i1 = _mm256_mul_epu32(i, w_10[2][6]);
	j1 = _mm256_mul_epu32(j, w_10[2][7]);
	k1 = _mm256_mul_epu32(k, w_10[2][8]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 3 + n2), t);
	a[N2_2560 * 3 + n2] %= Q;
	a[N2_2560 * 3 + n2 + 1] %= Q;
	a[N2_2560 * 3 + n2 + 2] %= Q;
	a[N2_2560 * 3 + n2 + 3] %= Q;
}

/* 256 * 3 --> 256 * 9 */
static void ntt_butterfly_768_2304(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, c1, d1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_2304 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_9[0][0]);
	d1 = _mm256_mul_epu32(d, w_9[0][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 + n2), t);
	a[N2_2304 + n2] %= Q;
	a[N2_2304 + n2 + 1] %= Q;
	a[N2_2304 + n2 + 2] %= Q;
	a[N2_2304 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[1][0]);
	d1 = _mm256_mul_epu32(d, w_9[1][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 2 + n2), t);
	a[N2_2304 * 2 + n2] %= Q;
	a[N2_2304 * 2 + n2 + 1] %= Q;
	a[N2_2304 * 2 + n2 + 2] %= Q;
	a[N2_2304 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[2][0]);
	d1 = _mm256_mul_epu32(d, w_9[2][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 3 + n2), t);
	a[N2_2304 * 3 + n2] %= Q;
	a[N2_2304 * 3 + n2 + 1] %= Q;
	a[N2_2304 * 3 + n2 + 2] %= Q;
	a[N2_2304 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[3][0]);
	d1 = _mm256_mul_epu32(d, w_9[3][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 4 + n2), t);
	a[N2_2304 * 4 + n2] %= Q;
	a[N2_2304 * 4 + n2 + 1] %= Q;
	a[N2_2304 * 4 + n2 + 2] %= Q;
	a[N2_2304 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[4][0]);
	d1 = _mm256_mul_epu32(d, w_9[4][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 5 + n2), t);
	a[N2_2304 * 5 + n2] %= Q;
	a[N2_2304 * 5 + n2 + 1] %= Q;
	a[N2_2304 * 5 + n2 + 2] %= Q;
	a[N2_2304 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[5][0]);
	d1 = _mm256_mul_epu32(d, w_9[5][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 6 + n2), t);
	a[N2_2304 * 6 + n2] %= Q;
	a[N2_2304 * 6 + n2 + 1] %= Q;
	a[N2_2304 * 6 + n2 + 2] %= Q;
	a[N2_2304 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[6][0]);
	d1 = _mm256_mul_epu32(d, w_9[6][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 7 + n2), t);
	a[N2_2304 * 7 + n2] %= Q;
	a[N2_2304 * 7 + n2 + 1] %= Q;
	a[N2_2304 * 7 + n2 + 2] %= Q;
	a[N2_2304 * 7 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[7][0]);
	d1 = _mm256_mul_epu32(d, w_9[7][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 8 + n2), t);
	a[N2_2304 * 8 + n2] %= Q;
	a[N2_2304 * 8 + n2 + 1] %= Q;
	a[N2_2304 * 8 + n2 + 2] %= Q;
	a[N2_2304 * 8 + n2 + 3] %= Q;
}

/* 256 * 6 --> 256 * 9 */
static void ntt_butterfly_1536_2304(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, c1, d1, e1, f1, g1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_2304 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 5 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_9[0][0]);
	d1 = _mm256_mul_epu32(d, w_9[0][1]);
	e1 = _mm256_mul_epu32(e, w_9[0][2]);
	f1 = _mm256_mul_epu32(f, w_9[0][3]);
	g1 = _mm256_mul_epu32(g, w_9[0][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 + n2), t);
	a[N2_2304 + n2] %= Q;
	a[N2_2304 + n2 + 1] %= Q;
	a[N2_2304 + n2 + 2] %= Q;
	a[N2_2304 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_9[1][0]);
	d1 = _mm256_mul_epu32(d, w_9[1][1]);
	e1 = _mm256_mul_epu32(e, w_9[1][2]);
	f1 = _mm256_mul_epu32(f, w_9[1][3]);
	g1 = _mm256_mul_epu32(g, w_9[1][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 2 + n2), t);
	a[N2_2304 * 2 + n2] %= Q;
	a[N2_2304 * 2 + n2 + 1] %= Q;
	a[N2_2304 * 2 + n2 + 2] %= Q;
	a[N2_2304 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[2][0]);
	d1 = _mm256_mul_epu32(d, w_9[2][1]);
	e1 = _mm256_mul_epu32(e, w_9[2][2]);
	f1 = _mm256_mul_epu32(f, w_9[2][3]);
	g1 = _mm256_mul_epu32(g, w_9[2][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 3 + n2), t);
	a[N2_2304 * 3 + n2] %= Q;
	a[N2_2304 * 3 + n2 + 1] %= Q;
	a[N2_2304 * 3 + n2 + 2] %= Q;
	a[N2_2304 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[3][0]);
	d1 = _mm256_mul_epu32(d, w_9[3][1]);
	e1 = _mm256_mul_epu32(e, w_9[3][2]);
	f1 = _mm256_mul_epu32(f, w_9[3][3]);
	g1 = _mm256_mul_epu32(g, w_9[3][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 4 + n2), t);
	a[N2_2304 * 4 + n2] %= Q;
	a[N2_2304 * 4 + n2 + 1] %= Q;
	a[N2_2304 * 4 + n2 + 2] %= Q;
	a[N2_2304 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[4][0]);
	d1 = _mm256_mul_epu32(d, w_9[4][1]);
	e1 = _mm256_mul_epu32(e, w_9[4][2]);
	f1 = _mm256_mul_epu32(f, w_9[4][3]);
	g1 = _mm256_mul_epu32(g, w_9[4][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 5 + n2), t);
	a[N2_2304 * 5 + n2] %= Q;
	a[N2_2304 * 5 + n2 + 1] %= Q;
	a[N2_2304 * 5 + n2 + 2] %= Q;
	a[N2_2304 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[5][0]);
	d1 = _mm256_mul_epu32(d, w_9[5][1]);
	e1 = _mm256_mul_epu32(e, w_9[5][2]);
	f1 = _mm256_mul_epu32(f, w_9[5][3]);
	g1 = _mm256_mul_epu32(g, w_9[5][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 6 + n2), t);
	a[N2_2304 * 6 + n2] %= Q;
	a[N2_2304 * 6 + n2 + 1] %= Q;
	a[N2_2304 * 6 + n2 + 2] %= Q;
	a[N2_2304 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[6][0]);
	d1 = _mm256_mul_epu32(d, w_9[6][1]);
	e1 = _mm256_mul_epu32(e, w_9[6][2]);
	f1 = _mm256_mul_epu32(f, w_9[6][3]);
	g1 = _mm256_mul_epu32(g, w_9[6][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 7 + n2), t);
	a[N2_2304 * 7 + n2] %= Q;
	a[N2_2304 * 7 + n2 + 1] %= Q;
	a[N2_2304 * 7 + n2 + 2] %= Q;
	a[N2_2304 * 7 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9[7][0]);
	d1 = _mm256_mul_epu32(d, w_9[7][1]);
	e1 = _mm256_mul_epu32(e, w_9[7][2]);
	f1 = _mm256_mul_epu32(f, w_9[7][3]);
	g1 = _mm256_mul_epu32(g, w_9[7][4]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 8 + n2), t);
	a[N2_2304 * 8 + n2] %= Q;
	a[N2_2304 * 8 + n2 + 1] %= Q;
	a[N2_2304 * 8 + n2 + 2] %= Q;
	a[N2_2304 * 8 + n2 + 3] %= Q;
}

/* 256 * 9 --> 256 * 9 */
static void ntt_butterfly_2304_2304_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, c1, d1, e1, f1, g1, h1, i1, j1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_2304 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 6 + n2));
	i = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 7 + n2));
	j = _mm256_loadu_si256((__m256i *)(a + N2_2304 * 8 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_9_inv[0][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[0][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[0][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[0][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[0][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[0][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[0][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[0][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 + n2), t);
	a[N2_2304 + n2] %= Q;
	a[N2_2304 + n2 + 1] %= Q;
	a[N2_2304 + n2 + 2] %= Q;
	a[N2_2304 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_9_inv[1][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[1][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[1][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[1][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[1][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[1][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[1][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[1][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 2 + n2), t);
	a[N2_2304 * 2 + n2] %= Q;
	a[N2_2304 * 2 + n2 + 1] %= Q;
	a[N2_2304 * 2 + n2 + 2] %= Q;
	a[N2_2304 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9_inv[2][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[2][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[2][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[2][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[2][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[2][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[2][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[2][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 3 + n2), t);
	a[N2_2304 * 3 + n2] %= Q;
	a[N2_2304 * 3 + n2 + 1] %= Q;
	a[N2_2304 * 3 + n2 + 2] %= Q;
	a[N2_2304 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9_inv[3][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[3][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[3][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[3][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[3][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[3][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[3][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[3][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 4 + n2), t);
	a[N2_2304 * 4 + n2] %= Q;
	a[N2_2304 * 4 + n2 + 1] %= Q;
	a[N2_2304 * 4 + n2 + 2] %= Q;
	a[N2_2304 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9_inv[4][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[4][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[4][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[4][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[4][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[4][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[4][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[4][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 5 + n2), t);
	a[N2_2304 * 5 + n2] %= Q;
	a[N2_2304 * 5 + n2 + 1] %= Q;
	a[N2_2304 * 5 + n2 + 2] %= Q;
	a[N2_2304 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9_inv[5][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[5][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[5][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[5][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[5][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[5][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[5][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[5][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 6 + n2), t);
	a[N2_2304 * 6 + n2] %= Q;
	a[N2_2304 * 6 + n2 + 1] %= Q;
	a[N2_2304 * 6 + n2 + 2] %= Q;
	a[N2_2304 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9_inv[6][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[6][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[6][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[6][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[6][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[6][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[6][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[6][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 7 + n2), t);
	a[N2_2304 * 7 + n2] %= Q;
	a[N2_2304 * 7 + n2 + 1] %= Q;
	a[N2_2304 * 7 + n2 + 2] %= Q;
	a[N2_2304 * 7 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_9_inv[7][0]);
	d1 = _mm256_mul_epu32(d, w_9_inv[7][1]);
	e1 = _mm256_mul_epu32(e, w_9_inv[7][2]);
	f1 = _mm256_mul_epu32(f, w_9_inv[7][3]);
	g1 = _mm256_mul_epu32(g, w_9_inv[7][4]);
	h1 = _mm256_mul_epu32(h, w_9_inv[7][5]);
	i1 = _mm256_mul_epu32(i, w_9_inv[7][6]);
	j1 = _mm256_mul_epu32(j, w_9_inv[7][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2304 * 8 + n2), t);
	a[N2_2304 * 8 + n2] %= Q;
	a[N2_2304 * 8 + n2 + 1] %= Q;
	a[N2_2304 * 8 + n2 + 2] %= Q;
	a[N2_2304 * 8 + n2 + 3] %= Q;
}

/* 256 * 4 --> 256 * 4 */
static void ntt_butterfly_1024_1024_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, c1, d1, e1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1024 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1024 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1024 * 3 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_4_inv[0][0]);
	d1 = _mm256_mul_epu32(d, w_4_inv[0][1]);
	e1 = _mm256_mul_epu32(e, w_4_inv[0][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1024 + n2), t);
	a[N2_1024 + n2] %= Q;
	a[N2_1024 + n2 + 1] %= Q;
	a[N2_1024 + n2 + 2] %= Q;
	a[N2_1024 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_4_inv[1][0]);
	d1 = _mm256_mul_epu32(d, w_4_inv[1][1]);
	e1 = _mm256_mul_epu32(e, w_4_inv[1][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1024 * 2 + n2), t);
	a[N2_1024 * 2 + n2] %= Q;
	a[N2_1024 * 2 + n2 + 1] %= Q;
	a[N2_1024 * 2 + n2 + 2] %= Q;
	a[N2_1024 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_4_inv[2][0]);
	d1 = _mm256_mul_epu32(d, w_4_inv[2][1]);
	e1 = _mm256_mul_epu32(e, w_4_inv[2][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1024 * 3 + n2), t);
	a[N2_1024 * 3 + n2] %= Q;
	a[N2_1024 * 3 + n2 + 1] %= Q;
	a[N2_1024 * 3 + n2 + 2] %= Q;
	a[N2_1024 * 3 + n2 + 3] %= Q;
}

/* 256 * 3 --> 256 * 4 */
static void ntt_butterfly_768_1024(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, c1, d1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1024 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1024 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_4[0][0]);
	d1 = _mm256_mul_epu32(d, w_4[0][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_1024 + n2), t);
	a[N2_1024 + n2] %= Q;
	a[N2_1024 + n2 + 1] %= Q;
	a[N2_1024 + n2 + 2] %= Q;
	a[N2_1024 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_4[1][0]);
	d1 = _mm256_mul_epu32(d, w_4[1][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_1024 * 2 + n2), t);
	a[N2_1024 * 2 + n2] %= Q;
	a[N2_1024 * 2 + n2 + 1] %= Q;
	a[N2_1024 * 2 + n2 + 2] %= Q;
	a[N2_1024 * 2 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_4[2][0]);
	d1 = _mm256_mul_epu32(d, w_4[2][1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_1024 * 3 + n2), t);
	a[N2_1024 * 3 + n2] %= Q;
	a[N2_1024 * 3 + n2 + 1] %= Q;
	a[N2_1024 * 3 + n2 + 2] %= Q;
	a[N2_1024 * 3 + n2 + 3] %= Q;
}

/* 256 * 4 --> 256 * 1 */
static void ntt_butterfly_1024_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1024 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1024 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1024 * 3 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

/* 256 * 9 --> 256 * 10 */
static void ntt_butterfly_2304_2560(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, c1, d1, e1, f1, g1, h1, i1, j1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2560 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 7 + n2));	
	j = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 8 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_10[0][0]);
	d1 = _mm256_mul_epu32(d, w_10[0][1]);
	e1 = _mm256_mul_epu32(e, w_10[0][2]);
	f1 = _mm256_mul_epu32(f, w_10[0][3]);
	g1 = _mm256_mul_epu32(g, w_10[0][4]);
	h1 = _mm256_mul_epu32(h, w_10[0][5]);
	i1 = _mm256_mul_epu32(i, w_10[0][6]);
	j1 = _mm256_mul_epu32(j, w_10[0][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 + n2), t);
	a[N2_2560 + n2] %= Q;
	a[N2_2560 + n2 + 1] %= Q;
	a[N2_2560 + n2 + 2] %= Q;
	a[N2_2560 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[1][0]);
	d1 = _mm256_mul_epu32(d, w_10[1][1]);
	e1 = _mm256_mul_epu32(e, w_10[1][2]);
	f1 = _mm256_mul_epu32(f, w_10[1][3]);
	g1 = _mm256_mul_epu32(g, w_10[1][4]);
	h1 = _mm256_mul_epu32(h, w_10[1][5]);
	i1 = _mm256_mul_epu32(i, w_10[1][6]);
	j1 = _mm256_mul_epu32(j, w_10[1][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 2 + n2), t);
	a[N2_2560 * 2 + n2] %= Q;
	a[N2_2560 * 2 + n2 + 1] %= Q;
	a[N2_2560 * 2 + n2 + 2] %= Q;
	a[N2_2560 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[2][0]);
	d1 = _mm256_mul_epu32(d, w_10[2][1]);
	e1 = _mm256_mul_epu32(e, w_10[2][2]);
	f1 = _mm256_mul_epu32(f, w_10[2][3]);
	g1 = _mm256_mul_epu32(g, w_10[2][4]);
	h1 = _mm256_mul_epu32(h, w_10[2][5]);
	i1 = _mm256_mul_epu32(i, w_10[2][6]);
	j1 = _mm256_mul_epu32(j, w_10[2][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 3 + n2), t);
	a[N2_2560 * 3 + n2] %= Q;
	a[N2_2560 * 3 + n2 + 1] %= Q;
	a[N2_2560 * 3 + n2 + 2] %= Q;
	a[N2_2560 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[3][0]);
	d1 = _mm256_mul_epu32(d, w_10[3][1]);
	e1 = _mm256_mul_epu32(e, w_10[3][2]);
	f1 = _mm256_mul_epu32(f, w_10[3][3]);
	g1 = _mm256_mul_epu32(g, w_10[3][4]);
	h1 = _mm256_mul_epu32(h, w_10[3][5]);
	i1 = _mm256_mul_epu32(i, w_10[3][6]);
	j1 = _mm256_mul_epu32(j, w_10[3][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 4 + n2), t);
	a[N2_2560 * 4 + n2] %= Q;
	a[N2_2560 * 4 + n2 + 1] %= Q;
	a[N2_2560 * 4 + n2 + 2] %= Q;
	a[N2_2560 * 4 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_10[4][0]);
	d1 = _mm256_mul_epu32(d, w_10[4][1]);
	e1 = _mm256_mul_epu32(e, w_10[4][2]);
	f1 = _mm256_mul_epu32(f, w_10[4][3]);
	g1 = _mm256_mul_epu32(g, w_10[4][4]);
	h1 = _mm256_mul_epu32(h, w_10[4][5]);
	i1 = _mm256_mul_epu32(i, w_10[4][6]);
	j1 = _mm256_mul_epu32(j, w_10[4][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 5 + n2), t);
	a[N2_2560 * 5 + n2] %= Q;
	a[N2_2560 * 5 + n2 + 1] %= Q;
	a[N2_2560 * 5 + n2 + 2] %= Q;
	a[N2_2560 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[5][0]);
	d1 = _mm256_mul_epu32(d, w_10[5][1]);
	e1 = _mm256_mul_epu32(e, w_10[5][2]);
	f1 = _mm256_mul_epu32(f, w_10[5][3]);
	g1 = _mm256_mul_epu32(g, w_10[5][4]);
	h1 = _mm256_mul_epu32(h, w_10[5][5]);
	i1 = _mm256_mul_epu32(i, w_10[5][6]);
	j1 = _mm256_mul_epu32(j, w_10[5][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 6 + n2), t);
	a[N2_2560 * 6 + n2] %= Q;
	a[N2_2560 * 6 + n2 + 1] %= Q;
	a[N2_2560 * 6 + n2 + 2] %= Q;
	a[N2_2560 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_10[6][0]);
	d1 = _mm256_mul_epu32(d, w_10[6][1]);
	e1 = _mm256_mul_epu32(e, w_10[6][2]);
	f1 = _mm256_mul_epu32(f, w_10[6][3]);
	g1 = _mm256_mul_epu32(g, w_10[6][4]);
	h1 = _mm256_mul_epu32(h, w_10[6][5]);
	i1 = _mm256_mul_epu32(i, w_10[6][6]);
	j1 = _mm256_mul_epu32(j, w_10[6][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 7 + n2), t);
	a[N2_2560 * 7 + n2] %= Q;
	a[N2_2560 * 7 + n2 + 1] %= Q;
	a[N2_2560 * 7 + n2 + 2] %= Q;
	a[N2_2560 * 7 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_10[7][0]);
	d1 = _mm256_mul_epu32(d, w_10[7][1]);
	e1 = _mm256_mul_epu32(e, w_10[7][2]);
	f1 = _mm256_mul_epu32(f, w_10[7][3]);
	g1 = _mm256_mul_epu32(g, w_10[7][4]);
	h1 = _mm256_mul_epu32(h, w_10[7][5]);
	i1 = _mm256_mul_epu32(i, w_10[7][6]);
	j1 = _mm256_mul_epu32(j, w_10[7][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 8 + n2), t);
	a[N2_2560 * 8 + n2] %= Q;
	a[N2_2560 * 8 + n2 + 1] %= Q;
	a[N2_2560 * 8 + n2 + 2] %= Q;
	a[N2_2560 * 8 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_10[8][0]);
	d1 = _mm256_mul_epu32(d, w_10[8][1]);
	e1 = _mm256_mul_epu32(e, w_10[8][2]);
	f1 = _mm256_mul_epu32(f, w_10[8][3]);
	g1 = _mm256_mul_epu32(g, w_10[8][4]);
	h1 = _mm256_mul_epu32(h, w_10[8][5]);
	i1 = _mm256_mul_epu32(i, w_10[8][6]);
	j1 = _mm256_mul_epu32(j, w_10[8][7]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	_mm256_storeu_si256((__m256i *)(a + N2_2560 * 9 + n2), t);
	a[N2_2560 * 9 + n2] %= Q;
	a[N2_2560 * 9 + n2 + 1] %= Q;
	a[N2_2560 * 9 + n2 + 2] %= Q;
	a[N2_2560 * 9 + n2 + 3] %= Q;
}

/* 256 * 10 --> 256 * 1 */
static void ntt_butterfly_2560_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, k, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));	
	c = _mm256_loadu_si256((__m256i *)(a + N2_2560 + n2));	
	d = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 2 + n2));	
	e = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 3 + n2));	
	f = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 4 + n2));	
	g = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 5 + n2));	
	h = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 6 + n2));	
	i = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 7 + n2));	
	j = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 8 + n2));	
	k = _mm256_loadu_si256((__m256i *)(a + N2_2560 * 9 + n2));	
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t = _mm256_add_epi64(t, k);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);	
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

void ntt_1536_2560(uint64_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_1536_2560);
}

void intt_2560_1024(uint64_t *a)
{
	intt_core(a, N1_2560, N2_2560, 1024, omega_256, omega_2560, ntt_butterfly_2560_1024, INV_2560);
}

void ntt_768_2304(uint64_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_768_2304);
}

void ntt_1536_2304(uint64_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_1536_2304);
}

void intt_2304_2304_inv(uint64_t *a)
{
	intt_core(a, N1_2304, N2_2304, 2304, omega_256_inv, omega_2304_inv, ntt_butterfly_2304_2304_inv, INV_2304);
}

void ntt_1024_1024_inv(uint64_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256_inv, omega_1024_inv, ntt_butterfly_1024_1024_inv);
}

void ntt_768_1024(uint64_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256, omega_1024, ntt_butterfly_768_1024);
}

void intt_1024_256(uint64_t *a)
{
	intt_core(a, N1_1024, N2_1024, 256, omega_256, omega_1024, ntt_butterfly_1024_256, INV_1024);
}

void ntt_2304_2560(uint64_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_2304_2560);
}

void intt_2560_256(uint64_t *a)
{
	intt_core(a, N1_2560, N2_2560, 256, omega_256, omega_2560, ntt_butterfly_2560_256, INV_2560);
}
