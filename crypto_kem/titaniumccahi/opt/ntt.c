/* ****************************** *
 * Titanium_CCA_hi                *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 1024=4*256 */
#define N1_1024 4
#define N2_1024 256

/* 2304=9*256 */
#define N1_2304 9
#define N2_2304 256

/* 2560=10*256 */
#define N1_2560 10
#define N2_2560 256

/* multiplication inverses of 1024, 2304, 2560 */
#define INV_1024 782596
#define INV_2304 783021
#define INV_2560 783055

/* omega_n: n-th root of unity mod Q */

static const uint32_t w_4[3][3]={{623211,783360,160150},
{783360,1,783360},
{160150,783360,623211}};

static const uint32_t w_9[8][8]={{9672,327625,93755,449683,113704,689605,324006,342032},
{327625,449683,689605,342032,9672,93755,113704,324006},
{93755,689605,1,93755,689605,1,93755,689605},
{449683,342032,93755,324006,327625,689605,9672,113704},
{113704,9672,689605,327625,324006,93755,342032,449683},
{689605,93755,1,689605,93755,1,689605,93755},
{324006,113704,93755,9672,342032,689605,449683,327625},
{342032,324006,689605,113704,449683,93755,327625,9672}};

static const uint32_t w_10[9][9]={{442872,31287,46896,458480,783360,340489,752074,736465,324881},
{31287,458480,340489,736465,1,31287,458480,340489,736465},
{46896,340489,324881,31287,783360,736465,442872,458480,752074},
{458480,736465,31287,340489,1,458480,736465,31287,340489},
{783360,1,783360,1,783360,1,783360,1,783360},
{340489,31287,736465,458480,1,340489,31287,736465,458480},
{752074,458480,442872,736465,783360,31287,324881,340489,46896},
{736465,340489,458480,31287,1,736465,340489,458480,31287},
{324881,736465,752074,340489,783360,458480,46896,31287,442872}};

/* omega_256,1024,2304,2560, respectively */
static const uint32_t omega_256[128]={1,518501,58689,647144,743765,542853,382443,207847,337855,618452,721824,80854,532578,422829,366342,101423,119632,437569,601166,346739,35295,396474,221771,490803,758565,553297,232294,567461,271083,692436,311638,741168,593315,722505,667585,548376,95650,35740,37924,487463,193035,372287,64333,430092,622778,211246,160504,345308,686592,232142,91409,750687,246673,63342,480417,430693,464201,232090,546992,48942,279708,555612,453057,127682,623211,680933,505289,115422,775466,279191,400057,661923,49381,726957,469170,189230,762341,10573,150795,96885,378538,449627,682083,643718,238726,14755,178729,342290,222491,148326,713151,397182,707531,524482,670332,720325,725328,294199,154891,185310,276855,257827,652594,207727,3254,626021,617283,132208,409181,747968,492254,293595,324687,771760,299018,672981,214280,303650,584787,235461,735472,482589,141747,248866,479224,714190,167353,583244};
static const uint32_t omega_1024[1024]={1,874,763876,204052,518501,387216,14832,429392,58689,375721,151895,368221,647144,17214,161177,647079,743765,644341,700836,725723,542853,520117,232878,644873,382443,543396,211338,619577,207847,701887,77575,431504,337855,741534,261169,303655,618452,7958,688404,43848,721824,268571,506115,528906,80854,163906,682142,54387,532578,156738,684198,284609,422829,589515,567933,505929,366342,571620,594923,594359,101423,123909,192648,735098,119632,371355,252816,53382,437569,155138,69159,126169,601166,567214,660884,275559,346739,672540,279210,404269,35295,296751,67883,577667,396474,272714,210292,488734,221771,337687,594702,401205,490803,463355,757994,546711,758565,262404,599684,55307,553297,247841,405398,238680,232294,134457,11268,447900,567461,93401,162930,612479,271083,351520,150968,341384,692436,434372,494404,477185,311638,545345,348042,244640,741168,724646,384916,354715,593315,755689,98863,236552,722505,80404,553967,50060,667585,648706,599041,276686,548376,647053,721041,367590,95650,561834,658930,134485,35740,685681,14029,510931,37924,244414,543644,428090,487463,677639,35570,537101,193035,289975,412547,220018,372287,284023,694026,257310,64333,608411,632456,497039,430092,670489,53358,416593,622778,655438,215921,708314,211246,539169,433745,729767,160504,58877,540033,405520,345308,205207,744610,599510,686592,26882,777399,272739,232142,1609,622905,766436,91409,772005,258549,363858,750687,427281,563758,773784,246673,167927,279691,41302,63342,525638,358066,388645,480417,2962,238705,254144,430693,412402,93288,64168,464201,714037,512982,263776,232090,739522,69403,339425,546992,220798,270646,752943,48942,473814,498828,426956,279708,56160,515458,77717,555612,704429,732561,252377,453057,374513,662825,405271,127682,356806,70766,747326,623211,250519,395887,543037,680933,564443,589113,216585,505289,590343,508244,39569,115422,608620,31761,341479,775466,150019,295319,383037,279191,387663,405510,336568,400057,270812,114666,731237,661923,400284,469210,391737,49381,74139,561884,702630,726957,54647,759818,574165,469170,356777,45420,529030,189230,97849,133677,112909,762341,429184,660258,511796,10573,623831,9038,65602,150795,190182,146536,384621,96885,74502,95785,679824,378538,263870,314246,474654,449627,510137,127329,48284,682083,2821,115471,651446,643718,156334,331102,322939,238726,272498,21508,780689,14755,362094,775673,330937,178729,320307,288441,638553,342290,700919,14904,492320,222491,183606,666000,46777,148326,382359,469980,281356,713151,521979,293544,398409,397182,108145,515410,35765,707531,310265,128704,466673,524482,131083,195836,387966,670332,699501,342294,704415,720325,525167,729773,165748,725328,197623,383082,318521,294199,187518,168283,590835,154891,636642,238798,335426,185310,588574,528860,40650,276855,696082,487532,737945,257827,516191,718359,373605,652594,80348,505023,357859,207727,597007,65692,229455,3254,493913,48051,478441,626021,356376,478307,508905,617283,552974,748900,432165,132208,395725,401449,704059,409181,411578,156473,452588,747968,400958,274925,575984,492254,164807,686255,515705,293595,442983,186808,331104,324687,199756,680602,275149,771760,44419,437517,109690,299018,482519,273388,16007,672981,664644,428355,719073,214280,57441,68330,184984,303650,614082,105383,451505,584787,352466,194411,709238,235461,552332,187792,407759,735472,446508,134214,582247,482589,334568,218779,72762,141747,115840,190591,504002,248866,517887,633941,228207,479224,527002,766841,445379,714190,646704,416015,117606,167353,561376,258638,441644,583244,570606,492048,768124,783360,782487,19485,579309,264860,396145,768529,353969,724672,407640,631466,415140,136217,766147,622184,136282,39596,139020,82525,57638,240508,263244,550483,138488,400918,239965,572023,163784,575514,81474,705786,351857,445506,41827,522192,479706,164909,775403,94957,739513,61537,514790,277246,254455,702507,619455,101219,728974,250783,626623,99163,498752,360532,193846,215428,277432,417019,211741,188438,189002,681938,659452,590713,48263,663729,412006,530545,729979,345792,628223,714202,657192,182195,216147,122477,507802,436622,110821,504151,379092,748066,486610,715478,205694,386887,510647,573069,294627,561590,445674,188659,382156,292558,320006,25367,236650,24796,520957,183677,728054,230064,535520,377963,544681,551067,648904,772093,335461,215900,689960,620431,170882,512278,431841,632393,441977,90925,348989,288957,306176,471723,238016,435319,538721,42193,58715,398445,428646,190046,27672,684498,546809,60856,702957,229394,733301,115776,134655,184320,506675,234985,136308,62320,415771,687711,221527,124431,648876,747621,97680,769332,272430,745437,538947,239717,355271,295898,105722,747791,246260,590326,493386,370814,563343,411074,499338,89335,526051,719028,174950,150905,286322,353269,112872,730003,366768,160583,127923,567440,75047,572115,244192,349616,53594,622857,724484,243328,377841,438053,578154,38751,183851,96769,756479,5962,510622,551219,781752,160456,16925,691952,11356,524812,419503,32674,356080,219603,9577,536688,615434,503670,742059,720019,257723,425295,394716,302944,780399,544656,529217,352668,370959,690073,719193,319160,69324,270379,519585,551271,43839,713958,443936,236369,562563,512715,30418,734419,309547,284533,356405,503653,727201,267903,705644,227749,78932,50800,530984,330304,408848,120536,378090,655679,426555,712595,36035,160150,532842,387474,240324,102428,218918,194248,566776,278072,193018,275117,743792,667939,174741,751600,441882,7895,633342,488042,400324,504170,395698,377851,446793,383304,512549,668695,52124,121438,383077,314151,391624,733980,709222,221477,80731,56404,728714,23543,209196,314191,426584,737941,254331,594131,685512,649684,670452,21020,354177,123103,271565,772788,159530,774323,717759,632566,593179,636825,398740,686476,708859,687576,103537,404823,519491,469115,308707,333734,273224,656032,735077,101278,780540,667890,131915,139643,627027,452259,460422,544635,510863,761853,2672,768606,421267,7688,452424,604632,463054,494920,144808,441071,82442,768457,291041,560870,599755,117361,736584,635035,401002,313381,502005,70210,261382,489817,384952,386179,675216,267951,747596,75830,473096,654657,316688,258879,652278,587525,395395,113029,83860,441067,78946,63036,258194,53588,617613,58033,585738,400279,464840,489162,595843,615078,192526,628470,146719,544563,447935,598051,194787,254501,742711,506506,87279,295829,45416,525534,267170,65002,409756,130767,703013,278338,425502,575634,186354,717669,553906,780107,289448,735310,304920,157340,426985,305054,274456,166078,230387,34461,351196,651153,387636,381912,79302,374180,371783,626888,330773,35393,382403,508436,207377,291107,618554,97106,267656,489766,340378,596553,452257,458674,583605,102759,508212,11601,738942,345844,673671,484343,300842,509973,767354,110380,118717,355006,64288,569081,725920,715031,598377,479711,169279,677978,331856,198574,430895,588950,74123,547900,231029,595569,375602,47889,336853,649147,201114,300772,448793,564582,710599,641614,667521,592770,279359,534495,265474,149420,555154,304137,256359,16520,337982,69171,136657,367346,665755,616008,221985,524723,341717,200117,212755,291313,15237};
static const uint32_t omega_2304[2304]={1,596706,108550,232015,569699,172100,742388,645233,304608,518501,313951,362422,44106,518680,587229,208847,56658,657871,58689,708290,399298,347433,433770,503527,253873,408797,57531,647144,36158,366886,312290,185421,698947,555377,617278,277512,743765,563706,156007,391868,645113,769100,26277,673147,150949,542853,735274,712008,473854,505418,585079,436265,115736,43217,382443,439682,754816,428814,416366,449080,516405,645692,16312,207847,271740,211689,701906,512737,638718,585661,690234,622956,337855,585558,331674,409360,724501,658636,622677,712774,67826,618452,485622,493622,339688,775700,330130,327832,762555,423453,721824,549753,661258,30531,187470,523020,499803,515886,382873,80854,429656,708417,194943,32785,131957,2727,176465,688753,532578,164310,83461,287252,121585,303356,768983,714165,506573,422829,473755,183599,22322,184249,117527,239259,521965,13856,366342,15680,669657,603908,66716,214837,632716,682741,146125,101423,375222,111156,276266,657678,48498,125526,271980,66066,119632,577706,278303,371528,257046,373398,591202,471399,477258,437569,342887,587437,552657,700950,348609,268570,470484,493885,601166,339993,247917,536718,589917,614608,428766,758835,722207,346739,717775,372483,607829,634996,474364,98049,326948,476404,35295,77785,636960,496892,216057,88306,725732,411104,292996,396474,259200,182721,182963,447391,82217,611216,606838,736905,221771,479318,558520,698002,688127,657819,364417,547217,84933,490803,101541,284040,386280,236401,513114,772273,774239,423457,758565,200592,22596,742605,92509,359128,730652,167596,106794,553297,312622,101480,702941,31618,183984,229359,457866,140148,232294,194780,689832,455610,568971,535487,54088,160928,745066,567461,374577,649398,764006,629954,772313,358288,65291,638833,271083,639708,670407,50916,9672,319945,191860,503176,750815,692436,89810,439850,731216,647911,226836,588470,444848,29116,311638,463526,426837,470270,486644,88935,40526,536647,525285,741168,406282,261617,253522,122378,341170,679423,612225,278583,593315,99967,318635,301278,91017,755233,146418,246778,62571,722505,342180,164513,577185,388794,218970,14825,454038,230256,667585,372734,759084,463411,741415,520796,439193,375874,616412,548376,742785,179132,314103,191858,93125,533715,228406,517134,95650,29801,140806,400981,334829,600307,87633,223426,209527,35740,52576,373328,339915,706509,686789,510050,46302,322103,37924,529137,88145,226108,168496,539909,328172,752096,512486,487463,757246,423183,200209,225610,686088,533918,722130,618676,193035,524631,609222,700433,495841,550212,372962,503238,145259,372287,374242,509943,434362,457668,279871,673502,474109,693414,64333,64654,467196,60501,118021,468287,93756,258560,571049,430092,13020,521083,137756,195284,619032,329540,381,170296,622778,661283,64322,551137,56507,641780,118220,141909,544459,211246,353805,210108,476364,451246,435951,756692,426401,382306,160504,767325,760560,703703,372210,646179,768564,586510,459061,345308,694979,142911,739428,91167,174618,761698,581144,131072,686592,463118,596060,50086,611205,309960,326216,19689,479517,232142,365344,640813,440575,144433,227200,15096,5637,662949,91409,439046,396524,326782,126694,33298,731345,70246,129288,750687,300085,295908,509648,662317,553219,771214,251551,623074,246673,77321,291809,264796,664915,523988,774154,621912,148786,63342,166563,214603,441770,349593,689885,746588,55233,298506,480417,665257,140219,296926,68220,712316,169467,254295,759848,430693,637349,740670,140513,255626,647480,772319,21719,716591,464201,555833,105586,424569,5509,270598,297507,508844,327625,232090,671072,479740,126210,287803,678332,578970,138044,490553,546992,564175,351244,383353,572969,48469,54994,257474,387880,48942,286972,683159,460435,40385,220728,103594,144854,764906,279708,547188,14401,476297,423355,213350,95546,641257,602021,555612,621569,719210,432020,488240,648096,163545,302834,282768,453057,32337,717131,724070,420758,55926,201156,502911,79286,127682,491354,658288,559654,538702,12789,553533,130258,651728,623211,525851,64812,743424,760820,741785,394214,651282,51714,680933,773135,466634,773598,215079,113783,317567,675124,97045,505289,379383,533813,736880,187980,115651,241672,556025,302432,115422,684173,765627,439545,475638,441323,748112,736417,439535,775466,139184,778045,522954,285257,401835,737103,82048,38110,279191,694420,296043,378775,432708,540804,127840,767582,575246,400057,464629,570315,346687,240142,211410,293464,778366,142135,661923,459355,304008,490878,202914,591680,553463,662332,103477,49381,598332,551588,478090,246087,569972,133750,608820,533087,726957,500141,95376,254806,165824,281112,126142,446567,347181,469170,566562,538168,199712,556547,5286,376530,375048,471325,189230,238479,407719,731205,351033,599508,386388,445047,486099,762341,416212,209593,250286,166627,19098,338721,314694,332654,10573,566405,75285,391304,164798,649058,774465,540921,223313,150795,303366,469155,232943,476640,636292,628033,557230,207764,96885,602371,245325,229380,454916,69615,404443,408044,387127,378538,18366,665367,758916,487011,522318,710326,299803,447431,449627,253050,487106,24035,55522,407120,516927,348546,277420,682083,760799,744735,464747,479133,621811,200277,66846,233878,643718,293612,571061,540315,532259,171819,707256,693762,127356,238726,522233,125420,473385,310181,593594,508409,53006,14500,14755,202751,465366,93755,445215,462499,198077,226682,348983,178729,333412,314424,594400,469791,591235,578672,142603,260454,342290,783210,767270,59531,216980,145161,647174,703396,489942,222491,42449,378420,109548,390243,15420,631575,581904,61613,148326,538293,368667,24799,22804,303054,736801,49866,157172,713151,201381,23669,218845,629231,202425,212738,741061,10981,397182,495469,266743,727134,363368,508062,586689,732339,191733,707531,282102,210888,590610,517258,451260,172864,709670,541167,524482,219821,193703,393490,268049,580975,341327,358945,420633,670332,732904,485393,152762,549290,129452,690346,84982,745040,720325,685721,100535,52330,72159,270889,32811,762454,474944,725328,617068,307012,665734,408938,373450,285474,632472,8262,294199,675116,23563,420250,89985,676387,143441,515764,437314,154891,324822,140907,349490,331325,532992,441879,371584,771420,185310,266905,256742,714526,493164,441329,411543,604356,264903,276855,388423,532207,477547,546183,379397,270726,689858,302746,257827,300989,765764,718723,463129,109577,460775,29926,309761,652594,352347,526831,449386,585328,177469,510412,629599,449153,207727,736232,502826,277741,301264,354104,18894,31652,104602,3254,512766,709250,600167,368420,693646,628589,180702,242767,626021,93810,362883,165861,425126,225687,414151,275297,569982,617283,127598,503154,157059,654419,469007,440248,78460,765956,132208,153982,4880,172443,171964,276555,766292,85008,592176,409181,451223,28850,610125,573583,596366,119009,142982,20699,747968,197102,475555,266468,355433,279836,156178,591664,406499,492254,308042,334529,194815,423795,338055,72525,107566,594061,293595,610752,261687,504809,670629,131639,606942,125449,543917,324687,271780,579099,343740,393005,709209,419412,618036,581363,771760,174851,355938,22381,138658,255089,611007,449683,767424,299018,483099,624226,644388,572522,446988,101526,733782,324752,672981,584600,540856,605473,145294,106250,256687,13497,6441,214280,412538,539188,168335,40285,85564,215648,444184,196998,303650,727683,510064,566576,275081,152690,671313,147462,435847,584787,104255,536937,447244,102867,321586,185156,27418,773984,235461,495950,572203,454497,725321,356931,330523,608351,337850,735472,572285,32646,226089,581497,44181,620053,111508,376030,482589,248234,119158,532383,527429,66958,479265,267542,428379,141747,231490,643449,368703,355468,13799,38623,95218,761939,248866,440709,200215,672402,554027,359286,223519,84554,730558,479224,86787,677995,29464,374661,637598,481874,535189,58647,714190,540364,3135,7242,325576,408017,726646,581132,20849,167353,29021,26560,334969,319520,400774,587725,64565,628910,583244,619433,683541,444076,771713,330665,737615,84730,780440,783360,186655,674811,551346,213662,611261,40973,138128,478753,264860,469410,420939,739255,264681,196132,574514,726703,125490,724672,75071,384063,435928,349591,279834,529488,374564,725830,136217,747203,416475,471071,597940,84414,227984,166083,505849,39596,219655,627354,391493,138248,14261,757084,110214,632412,240508,48087,71353,309507,277943,198282,347096,667625,740144,400918,343679,28545,354547,366995,334281,266956,137669,767049,575514,511621,571672,81455,270624,144643,197700,93127,160405,445506,197803,451687,374001,58860,124725,160684,70587,715535,164909,297739,289739,443673,7661,453231,455529,20806,359908,61537,233608,122103,752830,595891,260341,283558,267475,400488,702507,353705,74944,588418,750576,651404,780634,606896,94608,250783,619051,699900,496109,661776,480005,14378,69196,276788,360532,309606,599762,761039,599112,665834,544102,261396,769505,417019,767681,113704,179453,716645,568524,150645,100620,637236,681938,408139,672205,507095,125683,734863,657835,511381,717295,663729,205655,505058,411833,526315,409963,192159,311962,306103,345792,440474,195924,230704,82411,434752,514791,312877,289476,182195,443368,535444,246643,193444,168753,354595,24526,61154,436622,65586,410878,175532,148365,308997,685312,456413,306957,748066,705576,146401,286469,567304,695055,57629,372257,490365,386887,524161,600640,600398,335970,701144,172145,176523,46456,561590,304043,224841,85359,95234,125542,418944,236144,698428,292558,681820,499321,397081,546960,270247,11088,9122,359904,24796,582769,760765,40756,690852,424233,52709,615765,676567,230064,470739,681881,80420,751743,599377,554002,325495,643213,551067,588581,93529,327751,214390,247874,729273,622433,38295,215900,408784,133963,19355,153407,11048,425073,718070,144528,512278,143653,112954,732445,773689,463416,591501,280185,32546,90925,693551,343511,52145,135450,556525,194891,338513,754245,471723,319835,356524,313091,296717,694426,742835,246714,258076,42193,377079,521744,529839,660983,442191,103938,171136,504778,190046,683394,464726,482083,692344,28128,636943,536583,720790,60856,441181,618848,206176,394567,564391,768536,329323,553105,115776,410627,24277,319950,41946,262565,344168,407487,166949,234985,40576,604229,469258,591503,690236,249646,554955,266227,687711,753560,642555,382380,448532,183054,695728,559935,573834,747621,730785,410033,443446,76852,96572,273311,737059,461258,745437,254224,695216,557253,614865,243452,455189,31265,270875,295898,26115,360178,583152,557751,97273,249443,61231,164685,590326,258730,174139,82928,287520,233149,410399,280123,638102,411074,409119,273418,348999,325693,503490,109859,309252,89947,719028,718707,316165,722860,665340,315074,689605,524801,212312,353269,770341,262278,645605,588077,164329,453821,782980,613065,160583,122078,719039,232224,726854,141581,665141,641452,238902,572115,429556,573253,306997,332115,347410,26669,356960,401055,622857,16036,22801,79658,411151,137182,14797,196851,324300,438053,88382,640450,43933,692194,608743,21663,202217,652289,96769,320243,187301,733275,172156,473401,457145,763672,303844,551219,418017,142548,342786,638928,556161,768265,777724,120412,691952,344315,386837,456579,656667,750063,52016,713115,654073,32674,483276,487453,273713,121044,230142,12147,531810,160287,536688,706040,491552,518565,118446,259373,9207,161449,634575,720019,616798,568758,341591,433768,93476,36773,728128,484855,302944,118104,643142,486435,715141,71045,613894,529066,23513,352668,146012,42691,642848,527735,135881,11042,761642,66770,319160,227528,677775,358792,777852,512763,485854,274517,455736,551271,112289,303621,657151,495558,105029,204391,645317,292808,236369,219186,432117,400008,210392,734892,728367,525887,395481,734419,496389,100202,322926,742976,562633,679767,638507,18455,503653,236173,768960,307064,360006,570011,687815,142104,181340,227749,161792,64151,351341,295121,135265,619816,480527,500593,330304,751024,66230,59291,362603,727435,582205,280450,704075,655679,292007,125073,223707,244659,770572,229828,653103,131633,160150,257510,718549,39937,22541,41576,389147,132079,731647,102428,10226,316727,9763,568282,669578,465794,108237,686316,278072,403978,249548,46481,595381,667710,541689,227336,480929,667939,99188,17734,343816,307723,342038,35249,46944,343826,7895,644177,5316,260407,498104,381526,46258,701313,745251,504170,88941,487318,404586,350653,242557,655521,15779,208115,383304,318732,213046,436674,543219,571951,489897,4995,641226,121438,324006,479353,292483,580447,191681,229898,121029,679884,733980,185029,231773,305271,537274,213389,649611,174541,250274,56404,283220,687985,528555,617537,502249,657219,336794,436180,314191,216799,245193,583649,226814,778075,406831,408313,312036,594131,544882,375642,52156,432328,183853,396973,338314,297262,21020,367149,573768,533075,616734,764263,444640,468667,450707,772788,216956,708076,392057,618563,134303,8896,242440,560048,632566,479995,314206,550418,306721,147069,155328,226131,575597,686476,180990,538036,553981,328445,713746,378918,375317,396234,404823,764995,117994,24445,296350,261043,73035,483558,335930,333734,530311,296255,759326,727839,376241,266434,434815,505941,101278,22562,38626,318614,304228,161550,583084,716515,549483,139643,489749,212300,243046,251102,611542,76105,89599,656005,544635,261128,657941,309976,473180,189767,274952,730355,768861,768606,580610,317995,689606,338146,320862,585284,556679,434378,604632,449949,468937,188961,313570,192126,204689,640758,522907,441071,151,16091,723830,566381,638200,136187,79965,293419,560870,740912,404941,673813,393118,767941,151786,201457,721748,635035,245068,414694,758562,760557,480307,46560,733495,626189,70210,581980,759692,564516,154130,580936,570623,42300,772380,386179,287892,516618,56227,419993,275299,196672,51022,591628,75830,501259,572473,192751,266103,332101,610497,73691,242194,258879,563540,589658,389871,515312,202386,442034,424416,362728,113029,50457,297968,630599,234071,653909,93015,698379,38321,63036,97640,682826,731031,711202,512472,750550,20907,308417,58033,166293,476349,117627,374423,409911,497887,150889,775099,489162,108245,759798,363111,693376,106974,639920,267597,346047,628470,458539,642454,433871,452036,250369,341482,411777,11941,598051,516456,526619,68835,290197,342032,371818,179005,518458,506506,394938,251154,305814,237178,403964,512635,93503,480615,525534,482372,17597,64638,320232,673784,322586,753435,473600,130767,431014,256530,333975,198033,605892,272949,153762,334208,575634,47129,280535,505620,482097,429257,764467,751709,678759,780107,270595,74111,183194,414941,89715,154772,602659,540594,157340,689551,420478,617500,358235,557674,369210,508064,213379,166078,655763,280207,626302,128942,314354,343113,704901,17405,651153,629379,778481,610918,611397,506806,17069,698353,191185,374180,332138,754511,173236,209778,186995,664352,640379,762662,35393,586259,307806,516893,427928,503525,627183,191697,376862,291107,475319,448832,588546,359566,445306,710836,675795,189300,489766,172609,521674,278552,112732,651722,176419,657912,239444,458674,511581,204262,439621,390356,74152,363949,165325,201998,11601,608510,427423,760980,644703,528272,172354,333678,15937,484343,300262,159135,138973,210839,336373,681835,49579,458609,110380,198761,242505,177888,638067,677111,526674,769864,776920,569081,370823,244173,615026,743076,697797,567713,339177,586363,479711,55678,273297,216785,508280,630671,112048,635899,347514,198574,679106,246424,336117,680494,461775,598205,755943,9377,547900,287411,211158,328864,58040,426430,452838,175010,445511,47889,211076,750715,557272,201864,739180,163308,671853,407331,300772,535127,664203,250978,255932,716403,304096,515819,354982,641614,551871,139912,414658,427893,769562,744738,688143,21422,534495,342652,583146,110959,229334,424075,559842,698807,52803,304137,696574,105366,753897,408700,145763,301487,248172,724714,69171,242997,780226,776119,457785,375344,56715,202229,762512,616008,754340,756801,448392,463841,382587,195636,718796,154451,200117,163928,99820,339285,11648,452696,45746,698631,2921};
static const uint32_t omega_2560[2560]={1,13502,564252,344779,474996,19485,660535,761946,698240,670206,518501,686606,260138,575913,336040,768529,278752,443260,18480,408162,58689,440907,366075,520101,355698,631466,736169,469470,610089,380763,647144,129694,316553,80990,738385,622184,748365,634052,401096,223599,743765,410371,116889,546224,555994,82525,313208,351738,432094,443821,542853,475690,772902,570923,330106,550483,92298,663606,708455,721600,382443,613035,206244,641494,612772,572023,298447,22410,202474,657419,207847,351092,326773,199894,290143,705786,719368,13697,63698,703379,337855,207107,543305,311706,439120,522192,387384,740732,193577,384358,618452,494005,519956,747991,284470,94957,530818,134847,173230,618875,721824,273447,101001,667362,503502,277246,476634,201653,539331,706667,80854,468835,653290,76720,270198,101219,477354,522761,236412,622110,532578,397537,738363,325140,85236,99163,134877,578290,312493,98140,422829,685551,116026,644413,73699,215428,89463,770125,677197,124302,366342,208330,605670,250861,655619,188438,716709,146485,637306,468388,101423,98318,476102,68838,384530,590713,408585,286508,194398,502446,119632,764243,377894,294595,497893,530545,365606,454551,497528,302481,437569,731337,246769,240705,617482,714202,764855,24147,154618,778532,601166,540011,487695,708685,693616,122477,9383,568145,422878,563788,346739,304642,631034,386832,337877,504151,423073,63234,705339,167501,35295,269602,670998,245031,275059,715478,759465,100940,627101,552014,396474,486235,579790,198107,446260,573069,321041,359169,495248,69000,221771,346300,644152,466482,217524,188659,567207,291778,64087,472130,490803,371407,443553,57761,444827,25367,176477,591653,566689,347991,758565,482916,418229,461870,615180,183677,669289,670943,285782,575639,553297,485598,595987,332282,163117,377963,442872,263231,36105,239168,232294,639505,391568,47747,757252,772093,614859,549701,500788,450785,567461,587842,29032,309564,502193,620431,580189,101878,758201,268354,271083,300074,56056,141386,726376,632393,718747,245926,608934,453173,692436,640698,48873,293284,30713,288957,359634,506790,20245,738362,311638,304345,537745,443242,558805,435319,119555,507950,15345,380886,741168,596922,422876,536784,1596,398445,464403,347862,583529,546981,593315,289544,451698,361011,298380,684498,782279,274695,500916,612319,722505,67977,509723,453561,447685,229394,651755,501897,540644,417490,667585,381004,767682,592973,372026,184320,734104,5475,287516,487277,548376,627941,143279,434749,257025,62320,114926,676072,601772,105252,95650,487372,264344,179972,779483,124431,541378,144265,430584,423187,35740,11104,304257,132930,140809,769332,153804,754958,349584,333143,37924,515115,403772,320345,362109,239717,594643,202897,101877,744699,487463,709665,608439,36571,264212,747791,717514,48541,510786,705689,193035,116523,304658,63705,14532,370814,270477,734833,448101,362699,372287,574898,732008,689640,490434,89335,608591,522153,644167,669012,64333,660178,641898,584053,571780,150905,780710,240804,387458,173158,430092,47091,516911,369173,47803,730003,252404,338458,515203,25226,622778,151582,521232,742601,361263,567440,304300,713516,119454,710970,211246,26091,551593,195659,294526,349616,765207,76685,580989,719785,160504,348482,337798,220854,498742,243328,781983,194908,338217,394665,345308,567305,48252,525513,575949,38751,714215,157020,309174,719940,686592,71110,509995,209300,385473,5962,596102,318290,33134,76137,232142,153923,11613,126526,627072,160456,483747,671337,122043,416403,91409,410743,439467,507220,342578,524812,511379,95404,299324,113249,750687,651256,31287,205495,712189,219603,58321,172337,312004,545911,246673,511235,501199,516580,600177,503670,195499,484289,155811,435837,63342,596833,4559,453460,650705,425295,296960,312322,139381,289140,480417,361254,445922,709559,743949,544656,535605,533319,218826,534321,430693,328183,437050,774048,376995,690073,69912,1819,275947,171478,464201,753902,191970,620752,214165,270379,194998,770036,258880,40978,232090,235180,438227,215321,211471,713958,603811,218195,631530,33575,546992,741837,229428,327462,102440,512715,116773,546714,121725,39572,48942,441561,579412,577878,233196,284533,162222,44088,705177,330260,279708,34035,491024,221905,588846,267903,448569,414747,449566,559104,555612,408288,193219,250808,723374,50800,460725,39249,387962,711278,453057,692926,206429,5920,29018,120536,436275,493691,197133,612449,127682,568164,679416,317522,630652,712595,217888,403221,714353,453574,623211,514421,433716,409957,10588,387474,389190,57792,80028,283237,680933,432670,387363,457190,94700,194248,43868,84820,749219,414345,505289,121129,609351,599980,193859,275117,715233,584919,514097,759234,115422,322815,27526,342938,685366,751600,444806,525186,77600,401543,775466,722167,204467,149270,639048,488042,693713,648810,689918,327185,279191,103750,183032,577470,207907,377851,497370,519248,588907,308164,400057,295519,439965,180967,113475,668695,484365,398602,234134,415633,661923,702058,519016,589887,222987,314151,550348,619611,475603,381589,49381,102051,743964,747186,382414,221477,293517,43235,155025,6958,726957,643445,320900,22109,55177,23543,616381,732359,728676,352553,469170,476294,311139,617096,202596,737941,110823,112636,307571,226981,189230,443239,518299,309285,651940,649684,740251,749364,22052,68924,762341,548003,291861,401392,303386,123103,628025,494086,46896,234104,10573,184944,542381,369634,5337,774323,173240,753895,97456,587793,150795,78851,58603,63096,408785,636825,240814,522478,332151,744438,96885,711761,707635,617014,662154,687576,39941,331014,276523,115020,378538,372912,396677,93697,752240,469115,517045,611719,454915,712090,449627,599365,507100,289060,183618,656032,281237,311207,751871,187043,682083,292750,654255,572374,337483,667890,582309,525122,780194,324021,643718,90141,524149,176524,442886,452259,102023,365908,615350,128934,238726,531298,348919,754645,40263,761853,225915,679957,571855,380194,14755,248316,760913,67811,618474,7688,399724,499519,550689,523627,178729,447078,650651,479548,378431,494920,340510,20311,62772,734303,342290,553041,162530,285899,588651,768457,89969,551888,261944,676334,222491,667408,341233,381925,669248,117361,652280,540198,662486,470074,148326,426936,519634,317152,335078,313381,337501,127565,555152,464256,713151,674751,782933,488032,558693,489817,375572,277391,84341,548649,397182,645319,556096,676368,681559,267951,313304,81208,548377,641443,707531,779528,732021,81805,775461,654657,516651,775458,614151,390617,524482,755885,332162,109599,36769,587525,449064,47988,94429,452011,670332,653031,496507,617437,106612,441067,176312,713906,685068,644809,720325,401335,317133,78540,559647,53588,502973,184937,447867,336675,725328,582795,36845,46955,247361,400279,159519,366149,735888,592213,294199,634628,344638,137936,362775,615078,373195,300938,754730,404572,154891,547773,319845,661358,123677,544563,63280,543070,272180,227909,185310,586,78562,73330,716717,254501,451156,93176,767947,254198,276855,680879,486923,468834,639788,295829,708780,409584,457869,645587,257827,707231,645733,662397,51757,65002,292684,546484,149709,299538,652594,79660,14667,626862,458480,278338,336959,643091,241358,33956,207727,297574,768940,344547,475976,717669,574629,233414,94525,181481,3254,67292,661185,137914,65731,735310,621667,34719,326060,756661,626021,70352,459172,221390,685565,305054,710331,200439,598484,362253,617283,377387,499330,348894,417095,34461,759349,101430,192832,509061,132208,576058,727108,332164,136603,381912,493722,615695,86958,632138,409181,500090,426721,750148,423927,626888,26171,65031,684242,459211,747968,757285,434298,434511,176993,508436,310429,431008,664508,353483,492254,378784,560960,547772,306343,97106,562259,69567,43795,665896,293595,313030,298465,265446,175317,596553,140804,701822,465988,597785,324687,235718,652054,622190,46016,102759,119687,723492,77314,456776,771760,35498,660425,60087,516039,345844,754128,109978,453861,581480,299018,681803,428995,119256,387657,509973,695617,505705,254434,329883,672981,385223,547267,538082,293250,355006,688414,387563,24146,141116,214280,256387,65015,468210,48150,715031,207598,122538,49644,519633,303650,554187,751963,645866,108080,677978,485671,14911,4545,264432,584787,298555,697265,39532,292223,588950,105389,378702,237157,497407,235461,315484,531211,740967,233103,595569,171973,97442,398765,84877,735472,458908,573667,561627,153274,649147,539926,123386,532286,371758,482589,703241,41301,676431,748824,564582,100273,238238,209210,737015,141747,117071,653505,629567,163423,592770,764564,11870,463096,718051,248866,353403,195455,673562,396275,149420,314265,522854,708737,612359,479224,703949,200385,652737,443724,16520,578516,230501,714610,6783,714190,602831,303372,717436,562107,367346,447201,744675,163415,484754,167353,387082,579933,562171,448113,524723,93062,12080,165072,140099,583244,615716,370500,731015,599291,291313,52545,520885,757573,406069,783360,769859,219109,438582,308365,763876,122826,21415,85121,113155,264860,96755,523223,207448,447321,14832,504609,340101,764881,375199,724672,342454,417286,263260,427663,151895,47192,313891,173272,402598,136217,653667,466808,702371,44976,161177,34996,149309,382265,559762,39596,372990,666472,237137,227367,700836,470153,431623,351267,339540,240508,307671,10459,212438,453255,232878,691063,119755,74906,61761,400918,170326,577117,141867,170589,211338,484914,760951,580887,125942,575514,432269,456588,583467,493218,77575,63993,769664,719663,79982,445506,576254,240056,471655,344241,261169,395977,42629,589784,399003,164909,289356,263405,35370,498891,688404,252543,648514,610131,164486,61537,509914,682360,115999,279859,506115,306727,581708,244030,76694,702507,314526,130071,706641,513163,682142,306007,260600,546949,161251,250783,385824,44998,458221,698125,684198,648484,205071,470868,685221,360532,97810,667335,138948,709662,567933,693898,13236,106164,659059,417019,575031,177691,532500,127742,594923,66652,636876,146055,314973,681938,685043,307259,714523,398831,192648,374776,496853,588963,280915,663729,19118,405467,488766,285468,252816,417755,328810,285833,480880,345792,52024,536592,542656,165879,69159,18506,759214,628743,4829,182195,243350,295666,74676,89745,660884,773978,215216,360483,219573,436622,478719,152327,396529,445484,279210,360288,720127,78022,615860,748066,513759,112363,538330,508302,67883,23896,682421,156260,231347,386887,297126,203571,585254,337101,210292,462320,424192,288113,714361,561590,437061,139209,316879,565837,594702,216154,491583,719274,311231,292558,411954,339808,725600,338534,757994,606884,191708,216672,435370,24796,300445,365132,321491,168181,599684,114072,112418,497579,207722,230064,297763,187374,451079,620244,405398,340489,520130,747256,544193,551067,143856,391793,735614,26109,11268,168502,233660,282573,332576,215900,195519,754329,473797,281168,162930,203172,681483,25160,515007,512278,483287,727305,641975,56985,150968,64614,537435,174427,330188,90925,142663,734488,490077,752648,494404,423727,276571,763116,44999,471723,479016,245616,340119,224556,348042,663806,275411,768016,402475,42193,186439,360485,246577,781765,384916,318958,435499,199832,236380,190046,493817,331663,422350,484981,98863,1082,508666,282445,171042,60856,715384,273638,329800,335676,553967,131606,281464,242717,365871,115776,402357,15679,190388,411335,599041,49257,777886,495845,296084,234985,155420,640082,348612,526336,721041,668435,107289,181589,678109,687711,295989,519017,603389,3878,658930,241983,639096,352777,360174,747621,772257,479104,650431,642552,14029,629557,28403,433777,450218,745437,268246,379589,463016,421252,543644,188718,580464,681484,38662,295898,73696,174922,746790,519149,35570,65847,734820,272575,77672,590326,666838,478703,719656,768829,412547,512884,48528,335260,420662,411074,208463,51353,93721,292927,694026,174770,261208,139194,114349,719028,123183,141463,199308,211581,632456,2651,542557,395903,610203,353269,736270,266450,414188,735558,53358,530957,444903,268158,758135,160583,631779,262129,40760,422098,215921,479061,69845,663907,72391,572115,757270,231768,587702,488835,433745,18154,706676,202372,63576,622857,434879,445563,562507,284619,540033,1378,588453,445144,388696,438053,216056,735109,257848,207412,744610,69146,626341,474187,63421,96769,712251,273366,574061,397888,777399,187259,465071,750227,707224,551219,629438,771748,656835,156289,622905,299614,112024,661318,366958,691952,372618,343894,276141,440783,258549,271982,687957,484037,670112,32674,132105,752074,577866,71172,563758,725040,611024,471357,237450,536688,272126,282162,266781,183184,279691,587862,299072,627550,347524,720019,186528,778802,329901,132656,358066,486401,471039,643980,494221,302944,422107,337439,73802,39412,238705,247756,250042,564535,249040,352668,455178,346311,9313,406366,93288,713449,781542,507414,611883,319160,29459,591391,162609,569196,512982,588363,13325,524481,742383,551271,548181,345134,568040,571890,69403,179550,565166,151831,749786,236369,41524,553933,455899,680921,270646,666588,236647,661636,743789,734419,341800,203949,205483,550165,498828,621139,739273,78184,453101,503653,749326,292337,561456,194515,515458,334792,368614,333795,224257,227749,375073,590142,532553,59987,732561,322636,744112,395399,72083,330304,90435,576932,777441,754343,662825,347086,289670,586228,170912,655679,215197,103945,465839,152709,70766,565473,380140,69008,329787,160150,268940,349645,373404,772773,395887,394171,725569,703333,500124,102428,350691,395998,326171,688661,589113,739493,698541,34142,369016,278072,662232,174010,183381,589502,508244,68128,198442,269264,24127,667939,460546,755835,440423,97995,31761,338555,258175,705761,381818,7895,61194,578894,634091,144313,295319,89648,134551,93443,456176,504170,679611,600329,205891,575454,405510,285991,264113,194454,475197,383304,487842,343396,602394,669886,114666,298996,384759,549227,367728,121438,81303,264345,193474,560374,469210,233013,163750,307758,401772,733980,681310,39397,36175,400947,561884,489844,740126,628336,776403,56404,139916,462461,761252,728184,759818,166980,51002,54685,430808,314191,307067,472222,166265,580765,45420,672538,670725,475790,556380,594131,340122,265062,474076,131421,133677,43110,33997,761309,714437,21020,235358,491500,381969,479975,660258,155336,289275,736465,549257,772788,598417,240980,413727,778024,9038,610121,29466,685905,195568,632566,704510,724758,720265,374576,146536,542547,260883,451210,38923,686476,71600,75726,166347,121207,95785,743420,452347,506838,668341,404823,410449,386684,689664,31121,314246,266316,171642,328446,71271,333734,183996,276261,494301,599743,127329,502124,472154,31490,596318,101278,490611,129106,210987,445878,115471,201052,258239,3167,459340,139643,693220,259212,606837,340475,331102,681338,417453,168011,654427,544635,252063,434442,28716,743098,21508,557446,103404,211506,403167,768606,535045,22448,715550,164887,775673,383637,283842,232672,259734,604632,336283,132710,303813,404930,288441,442851,763050,720589,49058,441071,230320,620831,497462,194710,14904,693392,231473,521417,107027,560870,115953,442128,401436,114113,666000,131081,243163,120875,313287,635035,356425,263727,466209,448283,469980,445860,655796,228209,319105,70210,108610,428,295329,224668,293544,407789,505970,699020,234712,386179,138042,227265,106993,101802,515410,470057,702153,234984,141918,75830,3833,51340,701556,7900,128704,266710,7903,169210,392744,258879,27476,451199,673762,746592,195836,334297,735373,688932,331350,113029,130330,286854,165924,676749,342294,607049,69455,98293,138552,63036,382026,466228,704821,223714,729773,280388,598424,335494,446686,58033,200566,746516,736406,536000,383082,623842,417212,47473,191148,489162,148733,438723,645425,420586,168283,410166,482423,28631,378789,628470,235588,463516,122003,659684,238798,720081,240291,511181,555452,598051,782775,704799,710031,66644,528860,332205,690185,15414,529163,506506,102482,296438,314527,143573,487532,74581,373777,325492,137774,525534,76130,137628,120964,731604,718359,490677,236877,633652,483823,130767,703701,768694,156499,324881,505023,446402,140270,542003,749405,575634,485787,14421,438814,307385,65692,208732,549947,688836,601880,780107,716069,122176,645447,717630,48051,161694,748642,457301,26700,157340,713009,324189,561971,97796,478307,73030,582922,184877,421108,166078,405974,284031,434467,366266,748900,24012,681931,590529,274300,651153,207303,56253,451197,646758,401449,289639,167666,696403,151223,374180,283271,356640,33213,359434,156473,757190,718330,99119,324150,35393,26076,349063,348850,606368,274925,472932,352353,118853,429878,291107,404577,222401,235589,477018,686255,221102,713794,739566,117465,489766,470331,484896,517915,608044,186808,642557,81539,317373,185576,458674,547643,131307,161171,737345,680602,663674,59869,706047,326585,11601,747863,122936,723274,267322,437517,29233,673383,329500,201881,484343,101558,354366,664105,395704,273388,87744,277656,528927,453478,110380,398138,236094,245279,490111,428355,94947,395798,759215,642245,569081,526974,718346,315151,735211,68330,575763,660823,733717,263728,479711,229174,31398,137495,675281,105383,297690,768450,778816,518929,198574,484806,86096,743829,491138,194411,677972,404659,546204,285954,547900,467877,252150,42394,550258,187792,611388,685919,384596,698484,47889,324453,209694,221734,630087,134214,243435,659975,251075,411603,300772,80120,742060,106930,34537,218779,683088,545123,574151,46346,641614,666290,129856,153794,619938,190591,18797,771491,320265,65310,534495,429958,587906,109799,387086,633941,469096,260507,74624,171002,304137,79412,582976,130624,339637,766841,204845,552860,68751,776578,69171,180530,479989,65925,221254,416015,336160,38686,619946,298607,616008,396279,203428,221190,335248,258638,690299,771281,618289,643262,200117,167645,412861,52346,184070,492048,730816,262476,25788,377292};

/* multiplication inverses of omega */
static const uint32_t w_4_inv[3][3]={{160150,783360,623211},
{783360,1,783360},
{623211,783360,160150}};

static const uint32_t w_9_inv[8][8]={{342032,324006,689605,113704,449683,93755,327625,9672},
{324006,113704,93755,9672,342032,689605,449683,327625},
{689605,93755,1,689605,93755,1,689605,93755},
{113704,9672,689605,327625,324006,93755,342032,449683},
{449683,342032,93755,324006,327625,689605,9672,113704},
{93755,689605,1,93755,689605,1,93755,689605},
{327625,449683,689605,342032,9672,93755,113704,324006},
{9672,327625,93755,449683,113704,689605,324006,342032}};

static const uint32_t omega_256_inv[128]={1,200117,616008,69171,304137,534495,641614,300772,47889,547900,198574,479711,569081,110380,484343,11601,458674,489766,291107,35393,374180,651153,166078,157340,780107,575634,130767,525534,506506,598051,628470,489162,58033,63036,113029,258879,75830,386179,70210,635035,560870,441071,604632,768606,544635,139643,101278,333734,404823,686476,632566,772788,21020,594131,314191,56404,733980,121438,383304,504170,7895,667939,278072,102428,160150,655679,330304,227749,503653,734419,236369,551271,319160,352668,302944,720019,536688,32674,691952,551219,96769,438053,622857,572115,160583,353269,719028,411074,590326,295898,745437,747621,687711,234985,115776,60856,190046,42193,471723,90925,512278,215900,551067,230064,24796,292558,561590,386887,748066,436622,182195,345792,663729,681938,417019,360532,250783,702507,61537,164909,445506,575514,400918,240508,39596,136217,724672,264860};
static const uint32_t omega_1024_inv[1024]={1,15237,291313,212755,200117,341717,524723,221985,616008,665755,367346,136657,69171,337982,16520,256359,304137,555154,149420,265474,534495,279359,592770,667521,641614,710599,564582,448793,300772,201114,649147,336853,47889,375602,595569,231029,547900,74123,588950,430895,198574,331856,677978,169279,479711,598377,715031,725920,569081,64288,355006,118717,110380,767354,509973,300842,484343,673671,345844,738942,11601,508212,102759,583605,458674,452257,596553,340378,489766,267656,97106,618554,291107,207377,508436,382403,35393,330773,626888,371783,374180,79302,381912,387636,651153,351196,34461,230387,166078,274456,305054,426985,157340,304920,735310,289448,780107,553906,717669,186354,575634,425502,278338,703013,130767,409756,65002,267170,525534,45416,295829,87279,506506,742711,254501,194787,598051,447935,544563,146719,628470,192526,615078,595843,489162,464840,400279,585738,58033,617613,53588,258194,63036,78946,441067,83860,113029,395395,587525,652278,258879,316688,654657,473096,75830,747596,267951,675216,386179,384952,489817,261382,70210,502005,313381,401002,635035,736584,117361,599755,560870,291041,768457,82442,441071,144808,494920,463054,604632,452424,7688,421267,768606,2672,761853,510863,544635,460422,452259,627027,139643,131915,667890,780540,101278,735077,656032,273224,333734,308707,469115,519491,404823,103537,687576,708859,686476,398740,636825,593179,632566,717759,774323,159530,772788,271565,123103,354177,21020,670452,649684,685512,594131,254331,737941,426584,314191,209196,23543,728714,56404,80731,221477,709222,733980,391624,314151,383077,121438,52124,668695,512549,383304,446793,377851,395698,504170,400324,488042,633342,7895,441882,751600,174741,667939,743792,275117,193018,278072,566776,194248,218918,102428,240324,387474,532842,160150,36035,712595,426555,655679,378090,120536,408848,330304,530984,50800,78932,227749,705644,267903,727201,503653,356405,284533,309547,734419,30418,512715,562563,236369,443936,713958,43839,551271,519585,270379,69324,319160,719193,690073,370959,352668,529217,544656,780399,302944,394716,425295,257723,720019,742059,503670,615434,536688,9577,219603,356080,32674,419503,524812,11356,691952,16925,160456,781752,551219,510622,5962,756479,96769,183851,38751,578154,438053,377841,243328,724484,622857,53594,349616,244192,572115,75047,567440,127923,160583,366768,730003,112872,353269,286322,150905,174950,719028,526051,89335,499338,411074,563343,370814,493386,590326,246260,747791,105722,295898,355271,239717,538947,745437,272430,769332,97680,747621,648876,124431,221527,687711,415771,62320,136308,234985,506675,184320,134655,115776,733301,229394,702957,60856,546809,684498,27672,190046,428646,398445,58715,42193,538721,435319,238016,471723,306176,288957,348989,90925,441977,632393,431841,512278,170882,620431,689960,215900,335461,772093,648904,551067,544681,377963,535520,230064,728054,183677,520957,24796,236650,25367,320006,292558,382156,188659,445674,561590,294627,573069,510647,386887,205694,715478,486610,748066,379092,504151,110821,436622,507802,122477,216147,182195,657192,714202,628223,345792,729979,530545,412006,663729,48263,590713,659452,681938,189002,188438,211741,417019,277432,215428,193846,360532,498752,99163,626623,250783,728974,101219,619455,702507,254455,277246,514790,61537,739513,94957,775403,164909,479706,522192,41827,445506,351857,705786,81474,575514,163784,572023,239965,400918,138488,550483,263244,240508,57638,82525,139020,39596,136282,622184,766147,136217,415140,631466,407640,724672,353969,768529,396145,264860,579309,19485,782487,783360,768124,492048,570606,583244,441644,258638,561376,167353,117606,416015,646704,714190,445379,766841,527002,479224,228207,633941,517887,248866,504002,190591,115840,141747,72762,218779,334568,482589,582247,134214,446508,735472,407759,187792,552332,235461,709238,194411,352466,584787,451505,105383,614082,303650,184984,68330,57441,214280,719073,428355,664644,672981,16007,273388,482519,299018,109690,437517,44419,771760,275149,680602,199756,324687,331104,186808,442983,293595,515705,686255,164807,492254,575984,274925,400958,747968,452588,156473,411578,409181,704059,401449,395725,132208,432165,748900,552974,617283,508905,478307,356376,626021,478441,48051,493913,3254,229455,65692,597007,207727,357859,505023,80348,652594,373605,718359,516191,257827,737945,487532,696082,276855,40650,528860,588574,185310,335426,238798,636642,154891,590835,168283,187518,294199,318521,383082,197623,725328,165748,729773,525167,720325,704415,342294,699501,670332,387966,195836,131083,524482,466673,128704,310265,707531,35765,515410,108145,397182,398409,293544,521979,713151,281356,469980,382359,148326,46777,666000,183606,222491,492320,14904,700919,342290,638553,288441,320307,178729,330937,775673,362094,14755,780689,21508,272498,238726,322939,331102,156334,643718,651446,115471,2821,682083,48284,127329,510137,449627,474654,314246,263870,378538,679824,95785,74502,96885,384621,146536,190182,150795,65602,9038,623831,10573,511796,660258,429184,762341,112909,133677,97849,189230,529030,45420,356777,469170,574165,759818,54647,726957,702630,561884,74139,49381,391737,469210,400284,661923,731237,114666,270812,400057,336568,405510,387663,279191,383037,295319,150019,775466,341479,31761,608620,115422,39569,508244,590343,505289,216585,589113,564443,680933,543037,395887,250519,623211,747326,70766,356806,127682,405271,662825,374513,453057,252377,732561,704429,555612,77717,515458,56160,279708,426956,498828,473814,48942,752943,270646,220798,546992,339425,69403,739522,232090,263776,512982,714037,464201,64168,93288,412402,430693,254144,238705,2962,480417,388645,358066,525638,63342,41302,279691,167927,246673,773784,563758,427281,750687,363858,258549,772005,91409,766436,622905,1609,232142,272739,777399,26882,686592,599510,744610,205207,345308,405520,540033,58877,160504,729767,433745,539169,211246,708314,215921,655438,622778,416593,53358,670489,430092,497039,632456,608411,64333,257310,694026,284023,372287,220018,412547,289975,193035,537101,35570,677639,487463,428090,543644,244414,37924,510931,14029,685681,35740,134485,658930,561834,95650,367590,721041,647053,548376,276686,599041,648706,667585,50060,553967,80404,722505,236552,98863,755689,593315,354715,384916,724646,741168,244640,348042,545345,311638,477185,494404,434372,692436,341384,150968,351520,271083,612479,162930,93401,567461,447900,11268,134457,232294,238680,405398,247841,553297,55307,599684,262404,758565,546711,757994,463355,490803,401205,594702,337687,221771,488734,210292,272714,396474,577667,67883,296751,35295,404269,279210,672540,346739,275559,660884,567214,601166,126169,69159,155138,437569,53382,252816,371355,119632,735098,192648,123909,101423,594359,594923,571620,366342,505929,567933,589515,422829,284609,684198,156738,532578,54387,682142,163906,80854,528906,506115,268571,721824,43848,688404,7958,618452,303655,261169,741534,337855,431504,77575,701887,207847,619577,211338,543396,382443,644873,232878,520117,542853,725723,700836,644341,743765,647079,161177,17214,647144,368221,151895,375721,58689,429392,14832,387216,518501,204052,763876,874};
static const uint32_t omega_2304_inv[2304]={1,2921,698631,45746,452696,11648,339285,99820,163928,200117,154451,718796,195636,382587,463841,448392,756801,754340,616008,762512,202229,56715,375344,457785,776119,780226,242997,69171,724714,248172,301487,145763,408700,753897,105366,696574,304137,52803,698807,559842,424075,229334,110959,583146,342652,534495,21422,688143,744738,769562,427893,414658,139912,551871,641614,354982,515819,304096,716403,255932,250978,664203,535127,300772,407331,671853,163308,739180,201864,557272,750715,211076,47889,445511,175010,452838,426430,58040,328864,211158,287411,547900,9377,755943,598205,461775,680494,336117,246424,679106,198574,347514,635899,112048,630671,508280,216785,273297,55678,479711,586363,339177,567713,697797,743076,615026,244173,370823,569081,776920,769864,526674,677111,638067,177888,242505,198761,110380,458609,49579,681835,336373,210839,138973,159135,300262,484343,15937,333678,172354,528272,644703,760980,427423,608510,11601,201998,165325,363949,74152,390356,439621,204262,511581,458674,239444,657912,176419,651722,112732,278552,521674,172609,489766,189300,675795,710836,445306,359566,588546,448832,475319,291107,376862,191697,627183,503525,427928,516893,307806,586259,35393,762662,640379,664352,186995,209778,173236,754511,332138,374180,191185,698353,17069,506806,611397,610918,778481,629379,651153,17405,704901,343113,314354,128942,626302,280207,655763,166078,213379,508064,369210,557674,358235,617500,420478,689551,157340,540594,602659,154772,89715,414941,183194,74111,270595,780107,678759,751709,764467,429257,482097,505620,280535,47129,575634,334208,153762,272949,605892,198033,333975,256530,431014,130767,473600,753435,322586,673784,320232,64638,17597,482372,525534,480615,93503,512635,403964,237178,305814,251154,394938,506506,518458,179005,371818,342032,290197,68835,526619,516456,598051,11941,411777,341482,250369,452036,433871,642454,458539,628470,346047,267597,639920,106974,693376,363111,759798,108245,489162,775099,150889,497887,409911,374423,117627,476349,166293,58033,308417,20907,750550,512472,711202,731031,682826,97640,63036,38321,698379,93015,653909,234071,630599,297968,50457,113029,362728,424416,442034,202386,515312,389871,589658,563540,258879,242194,73691,610497,332101,266103,192751,572473,501259,75830,591628,51022,196672,275299,419993,56227,516618,287892,386179,772380,42300,570623,580936,154130,564516,759692,581980,70210,626189,733495,46560,480307,760557,758562,414694,245068,635035,721748,201457,151786,767941,393118,673813,404941,740912,560870,293419,79965,136187,638200,566381,723830,16091,151,441071,522907,640758,204689,192126,313570,188961,468937,449949,604632,434378,556679,585284,320862,338146,689606,317995,580610,768606,768861,730355,274952,189767,473180,309976,657941,261128,544635,656005,89599,76105,611542,251102,243046,212300,489749,139643,549483,716515,583084,161550,304228,318614,38626,22562,101278,505941,434815,266434,376241,727839,759326,296255,530311,333734,335930,483558,73035,261043,296350,24445,117994,764995,404823,396234,375317,378918,713746,328445,553981,538036,180990,686476,575597,226131,155328,147069,306721,550418,314206,479995,632566,560048,242440,8896,134303,618563,392057,708076,216956,772788,450707,468667,444640,764263,616734,533075,573768,367149,21020,297262,338314,396973,183853,432328,52156,375642,544882,594131,312036,408313,406831,778075,226814,583649,245193,216799,314191,436180,336794,657219,502249,617537,528555,687985,283220,56404,250274,174541,649611,213389,537274,305271,231773,185029,733980,679884,121029,229898,191681,580447,292483,479353,324006,121438,641226,4995,489897,571951,543219,436674,213046,318732,383304,208115,15779,655521,242557,350653,404586,487318,88941,504170,745251,701313,46258,381526,498104,260407,5316,644177,7895,343826,46944,35249,342038,307723,343816,17734,99188,667939,480929,227336,541689,667710,595381,46481,249548,403978,278072,686316,108237,465794,669578,568282,9763,316727,10226,102428,731647,132079,389147,41576,22541,39937,718549,257510,160150,131633,653103,229828,770572,244659,223707,125073,292007,655679,704075,280450,582205,727435,362603,59291,66230,751024,330304,500593,480527,619816,135265,295121,351341,64151,161792,227749,181340,142104,687815,570011,360006,307064,768960,236173,503653,18455,638507,679767,562633,742976,322926,100202,496389,734419,395481,525887,728367,734892,210392,400008,432117,219186,236369,292808,645317,204391,105029,495558,657151,303621,112289,551271,455736,274517,485854,512763,777852,358792,677775,227528,319160,66770,761642,11042,135881,527735,642848,42691,146012,352668,23513,529066,613894,71045,715141,486435,643142,118104,302944,484855,728128,36773,93476,433768,341591,568758,616798,720019,634575,161449,9207,259373,118446,518565,491552,706040,536688,160287,531810,12147,230142,121044,273713,487453,483276,32674,654073,713115,52016,750063,656667,456579,386837,344315,691952,120412,777724,768265,556161,638928,342786,142548,418017,551219,303844,763672,457145,473401,172156,733275,187301,320243,96769,652289,202217,21663,608743,692194,43933,640450,88382,438053,324300,196851,14797,137182,411151,79658,22801,16036,622857,401055,356960,26669,347410,332115,306997,573253,429556,572115,238902,641452,665141,141581,726854,232224,719039,122078,160583,613065,782980,453821,164329,588077,645605,262278,770341,353269,212312,524801,689605,315074,665340,722860,316165,718707,719028,89947,309252,109859,503490,325693,348999,273418,409119,411074,638102,280123,410399,233149,287520,82928,174139,258730,590326,164685,61231,249443,97273,557751,583152,360178,26115,295898,270875,31265,455189,243452,614865,557253,695216,254224,745437,461258,737059,273311,96572,76852,443446,410033,730785,747621,573834,559935,695728,183054,448532,382380,642555,753560,687711,266227,554955,249646,690236,591503,469258,604229,40576,234985,166949,407487,344168,262565,41946,319950,24277,410627,115776,553105,329323,768536,564391,394567,206176,618848,441181,60856,720790,536583,636943,28128,692344,482083,464726,683394,190046,504778,171136,103938,442191,660983,529839,521744,377079,42193,258076,246714,742835,694426,296717,313091,356524,319835,471723,754245,338513,194891,556525,135450,52145,343511,693551,90925,32546,280185,591501,463416,773689,732445,112954,143653,512278,144528,718070,425073,11048,153407,19355,133963,408784,215900,38295,622433,729273,247874,214390,327751,93529,588581,551067,643213,325495,554002,599377,751743,80420,681881,470739,230064,676567,615765,52709,424233,690852,40756,760765,582769,24796,359904,9122,11088,270247,546960,397081,499321,681820,292558,698428,236144,418944,125542,95234,85359,224841,304043,561590,46456,176523,172145,701144,335970,600398,600640,524161,386887,490365,372257,57629,695055,567304,286469,146401,705576,748066,306957,456413,685312,308997,148365,175532,410878,65586,436622,61154,24526,354595,168753,193444,246643,535444,443368,182195,289476,312877,514791,434752,82411,230704,195924,440474,345792,306103,311962,192159,409963,526315,411833,505058,205655,663729,717295,511381,657835,734863,125683,507095,672205,408139,681938,637236,100620,150645,568524,716645,179453,113704,767681,417019,769505,261396,544102,665834,599112,761039,599762,309606,360532,276788,69196,14378,480005,661776,496109,699900,619051,250783,94608,606896,780634,651404,750576,588418,74944,353705,702507,400488,267475,283558,260341,595891,752830,122103,233608,61537,359908,20806,455529,453231,7661,443673,289739,297739,164909,715535,70587,160684,124725,58860,374001,451687,197803,445506,160405,93127,197700,144643,270624,81455,571672,511621,575514,767049,137669,266956,334281,366995,354547,28545,343679,400918,740144,667625,347096,198282,277943,309507,71353,48087,240508,632412,110214,757084,14261,138248,391493,627354,219655,39596,505849,166083,227984,84414,597940,471071,416475,747203,136217,725830,374564,529488,279834,349591,435928,384063,75071,724672,125490,726703,574514,196132,264681,739255,420939,469410,264860,478753,138128,40973,611261,213662,551346,674811,186655,783360,780440,84730,737615,330665,771713,444076,683541,619433,583244,628910,64565,587725,400774,319520,334969,26560,29021,167353,20849,581132,726646,408017,325576,7242,3135,540364,714190,58647,535189,481874,637598,374661,29464,677995,86787,479224,730558,84554,223519,359286,554027,672402,200215,440709,248866,761939,95218,38623,13799,355468,368703,643449,231490,141747,428379,267542,479265,66958,527429,532383,119158,248234,482589,376030,111508,620053,44181,581497,226089,32646,572285,735472,337850,608351,330523,356931,725321,454497,572203,495950,235461,773984,27418,185156,321586,102867,447244,536937,104255,584787,435847,147462,671313,152690,275081,566576,510064,727683,303650,196998,444184,215648,85564,40285,168335,539188,412538,214280,6441,13497,256687,106250,145294,605473,540856,584600,672981,324752,733782,101526,446988,572522,644388,624226,483099,299018,767424,449683,611007,255089,138658,22381,355938,174851,771760,581363,618036,419412,709209,393005,343740,579099,271780,324687,543917,125449,606942,131639,670629,504809,261687,610752,293595,594061,107566,72525,338055,423795,194815,334529,308042,492254,406499,591664,156178,279836,355433,266468,475555,197102,747968,20699,142982,119009,596366,573583,610125,28850,451223,409181,592176,85008,766292,276555,171964,172443,4880,153982,132208,765956,78460,440248,469007,654419,157059,503154,127598,617283,569982,275297,414151,225687,425126,165861,362883,93810,626021,242767,180702,628589,693646,368420,600167,709250,512766,3254,104602,31652,18894,354104,301264,277741,502826,736232,207727,449153,629599,510412,177469,585328,449386,526831,352347,652594,309761,29926,460775,109577,463129,718723,765764,300989,257827,302746,689858,270726,379397,546183,477547,532207,388423,276855,264903,604356,411543,441329,493164,714526,256742,266905,185310,771420,371584,441879,532992,331325,349490,140907,324822,154891,437314,515764,143441,676387,89985,420250,23563,675116,294199,8262,632472,285474,373450,408938,665734,307012,617068,725328,474944,762454,32811,270889,72159,52330,100535,685721,720325,745040,84982,690346,129452,549290,152762,485393,732904,670332,420633,358945,341327,580975,268049,393490,193703,219821,524482,541167,709670,172864,451260,517258,590610,210888,282102,707531,191733,732339,586689,508062,363368,727134,266743,495469,397182,10981,741061,212738,202425,629231,218845,23669,201381,713151,157172,49866,736801,303054,22804,24799,368667,538293,148326,61613,581904,631575,15420,390243,109548,378420,42449,222491,489942,703396,647174,145161,216980,59531,767270,783210,342290,260454,142603,578672,591235,469791,594400,314424,333412,178729,348983,226682,198077,462499,445215,93755,465366,202751,14755,14500,53006,508409,593594,310181,473385,125420,522233,238726,127356,693762,707256,171819,532259,540315,571061,293612,643718,233878,66846,200277,621811,479133,464747,744735,760799,682083,277420,348546,516927,407120,55522,24035,487106,253050,449627,447431,299803,710326,522318,487011,758916,665367,18366,378538,387127,408044,404443,69615,454916,229380,245325,602371,96885,207764,557230,628033,636292,476640,232943,469155,303366,150795,223313,540921,774465,649058,164798,391304,75285,566405,10573,332654,314694,338721,19098,166627,250286,209593,416212,762341,486099,445047,386388,599508,351033,731205,407719,238479,189230,471325,375048,376530,5286,556547,199712,538168,566562,469170,347181,446567,126142,281112,165824,254806,95376,500141,726957,533087,608820,133750,569972,246087,478090,551588,598332,49381,103477,662332,553463,591680,202914,490878,304008,459355,661923,142135,778366,293464,211410,240142,346687,570315,464629,400057,575246,767582,127840,540804,432708,378775,296043,694420,279191,38110,82048,737103,401835,285257,522954,778045,139184,775466,439535,736417,748112,441323,475638,439545,765627,684173,115422,302432,556025,241672,115651,187980,736880,533813,379383,505289,97045,675124,317567,113783,215079,773598,466634,773135,680933,51714,651282,394214,741785,760820,743424,64812,525851,623211,651728,130258,553533,12789,538702,559654,658288,491354,127682,79286,502911,201156,55926,420758,724070,717131,32337,453057,282768,302834,163545,648096,488240,432020,719210,621569,555612,602021,641257,95546,213350,423355,476297,14401,547188,279708,764906,144854,103594,220728,40385,460435,683159,286972,48942,387880,257474,54994,48469,572969,383353,351244,564175,546992,490553,138044,578970,678332,287803,126210,479740,671072,232090,327625,508844,297507,270598,5509,424569,105586,555833,464201,716591,21719,772319,647480,255626,140513,740670,637349,430693,759848,254295,169467,712316,68220,296926,140219,665257,480417,298506,55233,746588,689885,349593,441770,214603,166563,63342,148786,621912,774154,523988,664915,264796,291809,77321,246673,623074,251551,771214,553219,662317,509648,295908,300085,750687,129288,70246,731345,33298,126694,326782,396524,439046,91409,662949,5637,15096,227200,144433,440575,640813,365344,232142,479517,19689,326216,309960,611205,50086,596060,463118,686592,131072,581144,761698,174618,91167,739428,142911,694979,345308,459061,586510,768564,646179,372210,703703,760560,767325,160504,382306,426401,756692,435951,451246,476364,210108,353805,211246,544459,141909,118220,641780,56507,551137,64322,661283,622778,170296,381,329540,619032,195284,137756,521083,13020,430092,571049,258560,93756,468287,118021,60501,467196,64654,64333,693414,474109,673502,279871,457668,434362,509943,374242,372287,145259,503238,372962,550212,495841,700433,609222,524631,193035,618676,722130,533918,686088,225610,200209,423183,757246,487463,512486,752096,328172,539909,168496,226108,88145,529137,37924,322103,46302,510050,686789,706509,339915,373328,52576,35740,209527,223426,87633,600307,334829,400981,140806,29801,95650,517134,228406,533715,93125,191858,314103,179132,742785,548376,616412,375874,439193,520796,741415,463411,759084,372734,667585,230256,454038,14825,218970,388794,577185,164513,342180,722505,62571,246778,146418,755233,91017,301278,318635,99967,593315,278583,612225,679423,341170,122378,253522,261617,406282,741168,525285,536647,40526,88935,486644,470270,426837,463526,311638,29116,444848,588470,226836,647911,731216,439850,89810,692436,750815,503176,191860,319945,9672,50916,670407,639708,271083,638833,65291,358288,772313,629954,764006,649398,374577,567461,745066,160928,54088,535487,568971,455610,689832,194780,232294,140148,457866,229359,183984,31618,702941,101480,312622,553297,106794,167596,730652,359128,92509,742605,22596,200592,758565,423457,774239,772273,513114,236401,386280,284040,101541,490803,84933,547217,364417,657819,688127,698002,558520,479318,221771,736905,606838,611216,82217,447391,182963,182721,259200,396474,292996,411104,725732,88306,216057,496892,636960,77785,35295,476404,326948,98049,474364,634996,607829,372483,717775,346739,722207,758835,428766,614608,589917,536718,247917,339993,601166,493885,470484,268570,348609,700950,552657,587437,342887,437569,477258,471399,591202,373398,257046,371528,278303,577706,119632,66066,271980,125526,48498,657678,276266,111156,375222,101423,146125,682741,632716,214837,66716,603908,669657,15680,366342,13856,521965,239259,117527,184249,22322,183599,473755,422829,506573,714165,768983,303356,121585,287252,83461,164310,532578,688753,176465,2727,131957,32785,194943,708417,429656,80854,382873,515886,499803,523020,187470,30531,661258,549753,721824,423453,762555,327832,330130,775700,339688,493622,485622,618452,67826,712774,622677,658636,724501,409360,331674,585558,337855,622956,690234,585661,638718,512737,701906,211689,271740,207847,16312,645692,516405,449080,416366,428814,754816,439682,382443,43217,115736,436265,585079,505418,473854,712008,735274,542853,150949,673147,26277,769100,645113,391868,156007,563706,743765,277512,617278,555377,698947,185421,312290,366886,36158,647144,57531,408797,253873,503527,433770,347433,399298,708290,58689,657871,56658,208847,587229,518680,44106,362422,313951,518501,304608,645233,742388,172100,569699,232015,108550,596706};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = barrett_4q2((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = barrett_4q2((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n)
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse_256(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = barrett_2q2((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 6 --> 256 * 10 */
static void ntt_butterfly_1536_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g);
	a[N2_2560 + n2] = (b + c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4]) % Q;
	a[N2_2560 * 2 + n2] = (b + c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4]) % Q;
	a[N2_2560 * 3 + n2] = (b + c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4]) % Q;
	a[N2_2560 * 4 + n2] = (b + c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4]) % Q;
	a[N2_2560 * 5 + n2] = (b + c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4]) % Q;
	a[N2_2560 * 6 + n2] = (b + c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4]) % Q;
	a[N2_2560 * 7 + n2] = (b + c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4]) % Q;
	a[N2_2560 * 8 + n2] = (b + c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4]) % Q;
	a[N2_2560 * 9 + n2] = (b + c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4]) % Q;
}

/* 256 * 10 --> 256 * 4 */
static void ntt_butterfly_2560_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j, k;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	k = a[N2_2560 * 9 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j + k);
	a[N2_2560 + n2] = (b + c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7] + k * w_10[0][8]) % Q;
	a[N2_2560 * 2 + n2] = (b + c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7] + k * w_10[1][8]) % Q;
	a[N2_2560 * 3 + n2] = (b + c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7] + k * w_10[2][8]) % Q;
}

/* 256 * 3 --> 256 * 9 */
static void ntt_butterfly_768_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_2304 + n2] = (b + c * w_9[0][0] + d * w_9[0][1]) % Q;
	a[N2_2304 * 2 + n2] = (b + c * w_9[1][0] + d * w_9[1][1]) % Q;
	a[N2_2304 * 3 + n2] = (b + c * w_9[2][0] + d * w_9[2][1]) % Q;
	a[N2_2304 * 4 + n2] = (b + c * w_9[3][0] + d * w_9[3][1]) % Q;
	a[N2_2304 * 5 + n2] = (b + c * w_9[4][0] + d * w_9[4][1]) % Q;
	a[N2_2304 * 6 + n2] = (b + c * w_9[5][0] + d * w_9[5][1]) % Q;
	a[N2_2304 * 7 + n2] = (b + c * w_9[6][0] + d * w_9[6][1]) % Q;
	a[N2_2304 * 8 + n2] = (b + c * w_9[7][0] + d * w_9[7][1]) % Q;
}

/* 256 * 6 --> 256 * 9 */
static void ntt_butterfly_1536_2304(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g);
	a[N2_2304 + n2] = (b + c * w_9[0][0] + d * w_9[0][1] + e * w_9[0][2] + f * w_9[0][3] + g * w_9[0][4]) % Q;
	a[N2_2304 * 2 + n2] = (b + c * w_9[1][0] + d * w_9[1][1] + e * w_9[1][2] + f * w_9[1][3] + g * w_9[1][4]) % Q;
	a[N2_2304 * 3 + n2] = (b + c * w_9[2][0] + d * w_9[2][1] + e * w_9[2][2] + f * w_9[2][3] + g * w_9[2][4]) % Q;
	a[N2_2304 * 4 + n2] = (b + c * w_9[3][0] + d * w_9[3][1] + e * w_9[3][2] + f * w_9[3][3] + g * w_9[3][4]) % Q;
	a[N2_2304 * 5 + n2] = (b + c * w_9[4][0] + d * w_9[4][1] + e * w_9[4][2] + f * w_9[4][3] + g * w_9[4][4]) % Q;
	a[N2_2304 * 6 + n2] = (b + c * w_9[5][0] + d * w_9[5][1] + e * w_9[5][2] + f * w_9[5][3] + g * w_9[5][4]) % Q;
	a[N2_2304 * 7 + n2] = (b + c * w_9[6][0] + d * w_9[6][1] + e * w_9[6][2] + f * w_9[6][3] + g * w_9[6][4]) % Q;
	a[N2_2304 * 8 + n2] = (b + c * w_9[7][0] + d * w_9[7][1] + e * w_9[7][2] + f * w_9[7][3] + g * w_9[7][4]) % Q;
}

/* 256 * 9 --> 256 * 9 */
static void ntt_butterfly_2304_2304_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2304 + n2];
	d = a[N2_2304 * 2 + n2];
	e = a[N2_2304 * 3 + n2];
	f = a[N2_2304 * 4 + n2];
	g = a[N2_2304 * 5 + n2];
	h = a[N2_2304 * 6 + n2];
	i = a[N2_2304 * 7 + n2];
	j = a[N2_2304 * 8 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j);
	a[N2_2304 + n2] = (b + c * w_9_inv[0][0] + d * w_9_inv[0][1] + e * w_9_inv[0][2] + f * w_9_inv[0][3] + g * w_9_inv[0][4] + h * w_9_inv[0][5] + i * w_9_inv[0][6] + j * w_9_inv[0][7]) % Q;
	a[N2_2304 * 2 + n2] = (b + c * w_9_inv[1][0] + d * w_9_inv[1][1] + e * w_9_inv[1][2] + f * w_9_inv[1][3] + g * w_9_inv[1][4] + h * w_9_inv[1][5] + i * w_9_inv[1][6] + j * w_9_inv[1][7]) % Q;
	a[N2_2304 * 3 + n2] = (b + c * w_9_inv[2][0] + d * w_9_inv[2][1] + e * w_9_inv[2][2] + f * w_9_inv[2][3] + g * w_9_inv[2][4] + h * w_9_inv[2][5] + i * w_9_inv[2][6] + j * w_9_inv[2][7]) % Q;
	a[N2_2304 * 4 + n2] = (b + c * w_9_inv[3][0] + d * w_9_inv[3][1] + e * w_9_inv[3][2] + f * w_9_inv[3][3] + g * w_9_inv[3][4] + h * w_9_inv[3][5] + i * w_9_inv[3][6] + j * w_9_inv[3][7]) % Q;
	a[N2_2304 * 5 + n2] = (b + c * w_9_inv[4][0] + d * w_9_inv[4][1] + e * w_9_inv[4][2] + f * w_9_inv[4][3] + g * w_9_inv[4][4] + h * w_9_inv[4][5] + i * w_9_inv[4][6] + j * w_9_inv[4][7]) % Q;
	a[N2_2304 * 6 + n2] = (b + c * w_9_inv[5][0] + d * w_9_inv[5][1] + e * w_9_inv[5][2] + f * w_9_inv[5][3] + g * w_9_inv[5][4] + h * w_9_inv[5][5] + i * w_9_inv[5][6] + j * w_9_inv[5][7]) % Q;
	a[N2_2304 * 7 + n2] = (b + c * w_9_inv[6][0] + d * w_9_inv[6][1] + e * w_9_inv[6][2] + f * w_9_inv[6][3] + g * w_9_inv[6][4] + h * w_9_inv[6][5] + i * w_9_inv[6][6] + j * w_9_inv[6][7]) % Q;
	a[N2_2304 * 8 + n2] = (b + c * w_9_inv[7][0] + d * w_9_inv[7][1] + e * w_9_inv[7][2] + f * w_9_inv[7][3] + g * w_9_inv[7][4] + h * w_9_inv[7][5] + i * w_9_inv[7][6] + j * w_9_inv[7][7]) % Q;
}

/* 256 * 4 --> 256 * 4 */
static void ntt_butterfly_1024_1024_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	e = a[N2_1024 * 3 + n2];
	
	a[n2] = barrett_8q(b + c + d + e);
	a[N2_1024 + n2] = (b + c * w_4_inv[0][0] + d * w_4_inv[0][1] + e * w_4_inv[0][2]) % Q;
	a[N2_1024 * 2 + n2] = (b + c * w_4_inv[1][0] + d * w_4_inv[1][1] + e * w_4_inv[1][2]) % Q;
	a[N2_1024 * 3 + n2] = (b + c * w_4_inv[2][0] + d * w_4_inv[2][1] + e * w_4_inv[2][2]) % Q;
}

/* 256 * 3 --> 256 * 4 */
static void ntt_butterfly_768_1024(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_1024 + n2];
	d = a[N2_1024 * 2 + n2];
	
	a[n2] = barrett_8q(b + c + d);
	a[N2_1024 + n2] = (b + c * w_4[0][0] + d * w_4[0][1]) % Q;
	a[N2_1024 * 2 + n2] = (b + c * w_4[1][0] + d * w_4[1][1]) % Q;
	a[N2_1024 * 3 + n2] = (b + c * w_4[2][0] + d * w_4[2][1]) % Q;
}

/* 256 * 4 --> 256 * 1 */
static void ntt_butterfly_1024_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_8q(a[n2] + a[N2_1024 + n2] + a[N2_1024 * 2 + n2] + a[N2_1024 * 3 + n2]);
}

/* 256 * 9 --> 256 * 10 */
static void ntt_butterfly_2304_2560(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h, i, j;
	
	b = a[n2];
	c = a[N2_2560 + n2];
	d = a[N2_2560 * 2 + n2];
	e = a[N2_2560 * 3 + n2];
	f = a[N2_2560 * 4 + n2];
	g = a[N2_2560 * 5 + n2];
	h = a[N2_2560 * 6 + n2];
	i = a[N2_2560 * 7 + n2];
	j = a[N2_2560 * 8 + n2];
	
	a[n2] = barrett_32q(b + c + d + e + f + g + h + i + j);
	a[N2_2560 + n2] = (b + c * w_10[0][0] + d * w_10[0][1] + e * w_10[0][2] + f * w_10[0][3] + g * w_10[0][4] + h * w_10[0][5] + i * w_10[0][6] + j * w_10[0][7]) % Q;
	a[N2_2560 * 2 + n2] = (b + c * w_10[1][0] + d * w_10[1][1] + e * w_10[1][2] + f * w_10[1][3] + g * w_10[1][4] + h * w_10[1][5] + i * w_10[1][6] + j * w_10[1][7]) % Q;
	a[N2_2560 * 3 + n2] = (b + c * w_10[2][0] + d * w_10[2][1] + e * w_10[2][2] + f * w_10[2][3] + g * w_10[2][4] + h * w_10[2][5] + i * w_10[2][6] + j * w_10[2][7]) % Q;
	a[N2_2560 * 4 + n2] = (b + c * w_10[3][0] + d * w_10[3][1] + e * w_10[3][2] + f * w_10[3][3] + g * w_10[3][4] + h * w_10[3][5] + i * w_10[3][6] + j * w_10[3][7]) % Q;
	a[N2_2560 * 5 + n2] = (b + c * w_10[4][0] + d * w_10[4][1] + e * w_10[4][2] + f * w_10[4][3] + g * w_10[4][4] + h * w_10[4][5] + i * w_10[4][6] + j * w_10[4][7]) % Q;
	a[N2_2560 * 6 + n2] = (b + c * w_10[5][0] + d * w_10[5][1] + e * w_10[5][2] + f * w_10[5][3] + g * w_10[5][4] + h * w_10[5][5] + i * w_10[5][6] + j * w_10[5][7]) % Q;
	a[N2_2560 * 7 + n2] = (b + c * w_10[6][0] + d * w_10[6][1] + e * w_10[6][2] + f * w_10[6][3] + g * w_10[6][4] + h * w_10[6][5] + i * w_10[6][6] + j * w_10[6][7]) % Q;
	a[N2_2560 * 8 + n2] = (b + c * w_10[7][0] + d * w_10[7][1] + e * w_10[7][2] + f * w_10[7][3] + g * w_10[7][4] + h * w_10[7][5] + i * w_10[7][6] + j * w_10[7][7]) % Q;
	a[N2_2560 * 9 + n2] = (b + c * w_10[8][0] + d * w_10[8][1] + e * w_10[8][2] + f * w_10[8][3] + g * w_10[8][4] + h * w_10[8][5] + i * w_10[8][6] + j * w_10[8][7]) % Q;
}

/* 256 * 10 --> 256 * 1 */
static void ntt_butterfly_2560_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_32q(a[n2] + a[N2_2560 + n2] + a[N2_2560 * 2 + n2] + a[N2_2560 * 3 + n2] + a[N2_2560 * 4 + n2] + a[N2_2560 * 5 + n2] + a[N2_2560 * 6 + n2] + a[N2_2560 * 7 + n2] + a[N2_2560 * 8 + n2] + a[N2_2560 * 9 + n2]);	
}

void ntt_1536_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_1536_2560);
}

void intt_2560_1024(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 1024, omega_256, omega_2560, ntt_butterfly_2560_1024, INV_2560);
}

void ntt_768_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_768_2304);
}

void ntt_1536_2304(uint32_t *a)
{
	ntt_core(a, N1_2304, N2_2304, omega_256, omega_2304, ntt_butterfly_1536_2304);
}

void intt_2304_2304_inv(uint32_t *a)
{
	intt_core(a, N1_2304, N2_2304, 2304, omega_256_inv, omega_2304_inv, ntt_butterfly_2304_2304_inv, INV_2304);
}

void ntt_1024_1024_inv(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256_inv, omega_1024_inv, ntt_butterfly_1024_1024_inv);
}

void ntt_768_1024(uint32_t *a)
{
	ntt_core(a, N1_1024, N2_1024, omega_256, omega_1024, ntt_butterfly_768_1024);
}

void intt_1024_256(uint32_t *a)
{
	intt_core(a, N1_1024, N2_1024, 256, omega_256, omega_1024, ntt_butterfly_1024_256, INV_1024);
}

void ntt_2304_2560(uint32_t *a)
{
	ntt_core(a, N1_2560, N2_2560, omega_256, omega_2560, ntt_butterfly_2304_2560);
}

void intt_2560_256(uint32_t *a)
{
	intt_core(a, N1_2560, N2_2560, 256, omega_256, omega_2560, ntt_butterfly_2560_256, INV_2560);
}
