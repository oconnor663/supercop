/* ****************************** *
 * Titanium_CCA_std               *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>

/* 768=3*256 */
#define N1_768 3
#define N2_768 256

/* 1536=3*512 */
#define N1_1536 3
#define N2_1536 512

/* 1792=7*256 */
#define N1_1792 7
#define N2_1792 256

/* multiplication inverses of 768, 1536, 1792 */
#define INV_768 118119
#define INV_1536 118196
#define INV_1792 118207

/* omega_n: n-th root of unity mod Q */

/* [omega_3^1, omega_3^2] */
static const uint32_t w_3[2]={41938,76334};

/* [omega_3^-1, omega_3^-2] */
static const uint32_t w_3_inv[2]={76334,41938};

/* [omega_7^1,   omega_7^2,  omega_7^3,   omega_7^4,   omega_7^5,  omega_7^6]
 * [omega_7^2,   omega_7^4,  omega_7^6,   omega_7^8,  omega_7^10, omega_7^12]
 * [omega_7^3,   omega_7^6,  omega_7^9,  omega_7^12,  omega_7^15, omega_7^18]
 * [omega_7^4,   omega_7^8, omega_7^12,  omega_7^16,  omega_7^20, omega_7^24]
 * [omega_7^5,  omega_7^10, omega_7^15,  omega_7^20,  omega_7^25, omega_7^30]
 * [omega_7^6,  omega_7^12, omega_7^18,  omega_7^24,  omega_7^30, omega_7^36] */
static const uint32_t w_7[6][6]={{39443,105480,76592,89290,50349,111937},
{105480,89290,111937,39443,76592,50349},
{76592,111937,105480,50349,39443,89290},
{89290,39443,50349,105480,111937,76592},
{50349,76592,39443,111937,89290,105480},
{111937,50349,89290,76592,105480,39443}};

/* omega_256,512,768,1536,1792, respectively */
static const uint32_t omega_256[128]={1,21307,56475,3323,75907,85447,42940,80925,85181,52382,79246,29174,85803,58760,79615,85439,109030,102217,58597,36491,105308,40473,29768,86950,15378,42836,112184,7158,61609,109209,13161,114417,39943,91266,78269,28283,24946,5560,75647,104458,25292,44856,100952,71486,32508,41268,55794,40835,55157,69671,35574,81834,56472,57675,24755,75478,51765,61130,74634,46153,60249,108574,84611,89511,58752,27432,106731,82446,86326,84659,47790,49273,68663,83804,44347,18532,66050,115196,79876,87735,64880,23336,460,102834,76713,109304,26685,38984,809,87778,34897,86301,25076,55191,84471,63356,76543,35304,6048,65439,106649,109367,68023,48719,91885,20726,95773,71242,37612,99309,72893,88388,22137,335,41465,113718,48748,150,2679,73867,25358,31842,43566,54258,74904,3666,51282,59600};
static const uint32_t omega_512[256]={1,1042,21307,84843,56475,65269,3323,32649,75907,88730,85447,94478,42940,36286,80925,113474,85181,53852,52382,58191,79246,19778,29174,3147,85803,110611,58760,80779,79615,49457,85439,86142,109030,67180,102217,64414,58597,29206,36491,57989,105308,91865,40473,67678,29768,30730,86950,4782,15378,57021,42836,46191,112184,42004,7158,7437,61609,92612,109209,17152,13161,112367,114417,3330,39943,106783,91266,7680,78269,66201,28283,20909,24946,91945,5560,116416,75647,54356,104458,34076,25292,97658,44856,22117,100952,47287,71486,94695,32508,47258,41268,68157,55794,65305,40835,90063,55157,111189,69671,95833,35574,48659,81834,114468,56472,62143,57675,14666,24755,11196,75478,114804,51765,6642,61130,66586,74634,63267,46153,72588,60249,94768,108574,65120,84611,51277,89511,71338,58752,72443,27432,80351,106731,37082,82446,42534,86326,64212,84659,101293,47790,4247,49273,11984,68663,109954,83804,38294,44347,83104,18532,31845,66050,107487,115196,105410,79876,84873,87735,113114,64880,71077,23336,70147,460,6228,102834,115963,76713,100671,109304,116142,26685,11615,38984,53689,809,15067,87778,39647,34897,52863,86301,38162,25076,109132,55191,28344,84471,23670,63356,20618,76543,41804,35304,3865,6048,33547,65439,62190,106649,69911,109367,63515,68023,34439,48719,26081,91885,61313,20726,70806,95773,91327,71242,76993,37612,43341,99309,109376,72893,23240,88388,83902,22137,3519,335,112524,41465,36885,113718,102883,48748,56299,150,38027,2679,71239,73867,91964,25358,48157,31842,62924,43566,97213,54258,2342,74904,108061,3666,35236,51282,94721,59600,9875};
static const uint32_t omega_768[768]={1,4136,75184,21307,12367,55976,56475,109698,15700,3323,24260,43856,75907,54810,83092,85447,9068,12707,42940,72067,21152,80925,111483,65534,85181,91622,1900,52382,94089,33934,79246,26973,28889,29174,25204,45231,85803,62208,48513,58760,98618,78744,79615,15608,95903,85439,94253,2600,109030,91404,46436,102217,61810,58207,58597,15815,5871,36491,10428,78836,105308,72702,45506,40473,40033,112561,29768,116528,115606,86950,75280,63544,15378,90807,60977,42836,115015,8034,112184,8045,39407,7158,37238,24922,61609,54782,85557,109209,3837,21250,13161,28316,24706,114417,18439,95892,39943,95140,4769,91266,67033,16576,78269,7383,21654,28283,6491,117078,24946,42600,85103,5560,51198,46258,75647,43907,50297,104458,105292,6526,25292,54380,78707,44856,72352,17182,100952,33782,41939,71486,101869,41758,32508,94960,88200,41268,16509,37703,55794,13361,27605,40835,117989,8106,55157,99008,35962,69671,46228,69840,35574,2452,88267,81834,86371,45996,56472,97290,26694,57675,105432,112474,24755,80535,35992,75478,54561,117685,51765,25910,8422,61130,84279,27413,74634,111967,56717,46153,114459,73878,60249,106926,23189,108574,97756,61702,84611,99562,80119,89511,23006,61324,58752,65530,68637,27432,34945,2914,106731,44580,113546,82446,15597,50407,86326,96422,103109,84659,61544,22488,47790,25257,27893,49273,8749,112599,68663,16695,97361,83804,73454,80680,44347,96042,68978,18532,7448,53948,66050,90443,93022,115196,47012,820,79876,30647,85609,87735,10396,64757,64880,100516,4581,23336,6928,32142,460,10192,48924,102834,11716,83719,76713,76782,7347,109304,41938,67350,26685,20451,20141,38984,31725,49843,809,34380,31534,87778,69971,104298,34897,40932,46089,86301,111295,115877,25076,107188,42364,55191,3086,108485,84471,111887,80656,63356,65721,30702,76543,83300,117824,35304,68462,13270,6048,58925,71420,65439,47080,45522,106649,60247,98654,109367,65960,73022,68023,89934,116712,48719,82865,92759,91885,25211,74183,20726,93084,16809,95773,20851,18719,71242,38869,29177,37612,34237,31451,99309,98168,109912,72893,7571,89584,88388,109198,76614,22137,15330,10552,335,84557,112764,41465,3390,64826,113718,84200,55488,48748,84536,25908,150,29035,41665,2679,80955,117290,73867,14753,107813,25358,90810,73385,31842,60663,45135,43566,59197,13682,54258,47207,97702,74904,45957,13441,3666,23632,48454,51282,38863,4361,59600,24668,75522,118272,114137,43089,96966,105906,62297,61798,8575,102573,114950,94013,74417,42366,63463,35181,32826,109205,105566,75333,46206,97121,37348,6790,52739,33092,26651,116373,65891,24184,84339,39027,91300,89384,89099,93069,73042,32470,56065,69760,59513,19655,39529,38658,102665,22370,32834,24020,115673,9243,26869,71837,16056,56463,60066,59676,102458,112402,81782,107845,39437,12965,45571,72767,77800,78240,5712,88505,1745,2667,31323,42993,54729,102895,27466,57296,75437,3258,110239,6089,110228,78866,111115,81035,93351,56664,63491,32716,9064,114436,97023,105112,89957,93567,3856,99834,22381,78330,23133,113504,27007,51240,101697,40004,110890,96619,89990,111782,1195,93327,75673,33170,112713,67075,72015,42626,74366,67976,13815,12981,111747,92981,63893,39566,73417,45921,101091,17321,84491,76334,46787,16404,76515,85765,23313,30073,77005,101764,80570,62479,104912,90668,77438,284,110167,63116,19265,82311,48602,72045,48433,82699,115821,30006,36439,31902,72277,61801,20983,91579,60598,12841,5799,93518,37738,82281,42795,63712,588,66508,92363,109851,57143,33994,90860,43639,6306,61556,72120,3814,44395,58024,11347,95084,9699,20517,56571,33662,18711,38154,28762,95267,56949,59521,52743,49636,90841,83328,115359,11542,73693,4727,35827,102676,67866,31947,21851,15164,33614,56729,95785,70483,93016,90380,69000,109524,5674,49610,101578,20912,34469,44819,37593,73926,22231,49295,99741,110825,64325,52223,27830,25251,3077,71261,117453,38397,87626,32664,30538,107877,53516,53393,17757,113692,94937,111345,86131,117813,108081,69349,15439,106557,34554,41560,41491,110926,8969,76335,50923,91588,97822,98132,79289,86548,68430,117464,83893,86739,30495,48302,13975,83376,77341,72184,31972,6978,2396,93197,11085,75909,63082,115187,9788,33802,6386,37617,54917,52552,87571,41730,34973,449,82969,49811,105003,112225,59348,46853,52834,71193,72751,11624,58026,19619,8906,52313,45251,50250,28339,1561,69554,35408,25514,26388,93062,44090,97547,25189,101464,22500,97422,99554,47031,79404,89096,80661,84036,86822,18964,20105,8361,45380,110702,28689,29885,9075,41659,96136,102943,107721,117938,33716,5509,76808,114883,53447,4555,34073,62785,69525,33737,92365,118123,89238,76608,115594,37318,983,44406,103520,10460,92915,27463,44888,86431,57610,73138,74707,59076,104591,64015,71066,20571,43369,72316,104832,114607,94641,69819,66991,79410,113912,58673,93605,42751};
static const uint32_t omega_1536[1536]={1,75894,4136,1042,75184,51884,21307,45002,12367,84843,55976,112930,56475,18403,109698,65269,15700,53598,3323,37726,24260,32649,43856,86771,75907,44574,54810,88730,83092,104434,85447,6028,9068,94478,12707,105289,42940,112391,72067,36286,21152,108732,80925,41606,111483,113474,65534,21200,85181,42907,91622,53852,1900,23813,52382,87432,94089,58191,33934,110694,79246,113874,26973,19778,28889,75165,29174,60996,25204,3147,45231,5962,85803,58048,62208,110611,48513,7132,58760,47975,98618,80779,78744,98992,79615,88059,15608,49457,95903,60135,85439,108514,94253,86142,2600,45036,109030,107194,91404,67180,46436,33203,102217,12655,61810,64414,58207,65508,58597,95918,15815,29206,5871,39283,36491,85659,10428,57989,78836,103133,105308,65650,72702,91865,45506,60764,40473,108052,40033,67678,112561,82290,29768,80019,116528,30730,115606,74078,86950,59538,75280,4782,63544,26761,15378,98241,90807,57021,60977,2494,42836,25433,115015,46191,8034,35081,112184,92318,8045,42004,39407,103780,7158,21363,37238,7437,24922,8452,61609,66937,54782,92612,85557,75258,109209,90825,3837,17152,21250,95145,13161,25449,28316,112367,24706,55295,114417,78411,18439,3330,95892,53212,39943,97052,95140,106783,4769,23106,91266,1832,67033,7680,16576,67316,78269,4334,7383,66201,21654,5341,28283,91598,6491,20909,117078,22061,24946,55813,42600,91945,85103,36825,5560,90849,51198,116416,46258,7193,75647,63725,43907,54356,50297,97716,104458,14535,105292,34076,6526,75193,25292,58531,54380,97658,78707,11193,44856,49505,72352,22117,17182,50883,100952,44421,33782,47287,41939,73763,71486,57701,101869,94695,41758,56617,32508,105645,94960,47258,88200,72092,41268,6279,16509,68157,37703,52793,55794,19890,13361,65305,27605,84221,40835,24071,117989,90063,8106,58891,55157,49069,99008,111189,35962,32280,69671,98136,46228,95833,69840,32465,35574,35385,2452,48659,88267,71251,81834,76093,86371,114468,45996,111102,56472,27267,97290,62143,26694,16219,57675,20993,105432,14666,112474,102800,24755,107638,80535,11196,35992,61913,75478,11123,54561,114804,117685,81522,51765,96942,25910,6642,8422,31976,61130,23522,84279,66586,27413,60152,74634,60553,111967,63267,56717,52436,46153,80887,114459,72588,73878,47094,60249,103426,106926,94768,23189,3726,108574,35246,97756,65120,61702,28699,84611,71245,99562,51277,80119,18183,89511,101533,23006,71338,61324,81106,58752,32188,65530,72443,68637,38739,27432,82862,34945,80351,2914,102879,106731,79563,44580,37082,113546,89344,82446,41932,15597,42534,50407,48673,86326,10882,96422,64212,103109,57947,84659,47694,61544,101293,22488,24882,47790,14442,25257,4247,27893,61188,49273,87621,8749,11984,112599,9437,68663,1342,16695,109954,97361,10059,83804,90201,73454,38294,80680,16437,44347,94730,96042,83104,68978,16806,18532,83365,7448,31845,53948,73071,66050,34141,90443,107487,93022,96298,115196,63337,47012,105410,820,21482,79876,26529,30647,84873,85609,464,87735,26736,10396,113114,64757,69789,64880,61184,100516,71077,4581,66067,23336,42482,6928,70147,32142,4323,460,20705,10192,6228,48924,93767,102834,3145,11716,115963,83719,25953,76713,67997,76782,100671,7347,54296,109304,86102,41938,116142,67350,56659,26685,42811,20451,11615,20141,20802,38984,52601,31725,53689,49843,59283,809,14559,34380,15067,31534,105514,87778,96807,69971,39647,104298,53614,34897,103902,40932,52863,46089,72864,86301,5900,111295,38162,115877,61850,25076,105374,107188,109132,42364,40184,55191,27459,3086,28344,108485,22241,84471,90655,111887,23670,80656,87349,63356,69722,65721,20618,30702,1215,76543,57774,83300,41804,117824,104491,35304,5234,68462,3865,13270,18785,6048,107672,58925,33547,71420,16163,65439,25923,47080,62190,45522,92338,106649,6451,60247,69911,98654,92684,109367,18231,65960,63515,73022,13707,68023,39385,89934,34439,116712,39012,48719,29260,82865,26081,92759,6040,91885,25837,25211,61313,74183,13256,20726,66417,93084,70806,16809,9668,95773,10574,20851,91327,18719,82783,71242,108426,38869,76993,29177,52132,37612,6273,34237,43341,31451,74781,99309,10321,98168,109376,109912,103184,72893,40040,7571,23240,89584,82964,88388,29131,109198,83902,76614,5690,22137,115786,15330,3519,10552,7005,335,114068,84557,112524,112764,113282,41465,54999,3390,36885,64826,102463,113718,14809,84200,102883,55488,96107,48748,101272,84536,56299,25908,91400,150,29892,29035,38027,41665,94855,2679,8739,80955,71239,117290,26461,73867,40171,14753,91964,107813,115409,25358,100069,90810,48157,73385,5620,31842,62812,60663,62924,45135,53064,43566,76289,59197,97213,13682,63041,54258,63884,47207,2342,97702,106399,74904,90704,45957,108061,13441,104902,3666,49308,23632,35236,48454,23760,51282,104770,38863,94721,4361,45880,59600,49788,24668,9875,75522,38815,118272,42379,114137,117231,43089,66389,96966,73271,105906,33430,62297,5343,61798,99870,8575,53004,102573,64675,114950,80547,94013,85624,74417,31502,42366,73699,63463,29543,35181,13839,32826,112245,109205,23795,105566,12984,75333,5882,46206,81987,97121,9541,37348,76667,6790,4799,52739,97073,33092,75366,26651,64421,116373,94460,65891,30841,24184,60082,84339,7579,39027,4399,91300,98495,89384,43108,89099,57277,93069,115126,73042,112311,32470,60225,56065,7662,69760,111141,59513,70298,19655,37494,39529,19281,38658,30214,102665,68816,22370,58138,32834,9759,24020,32131,115673,73237,9243,11079,26869,51093,71837,85070,16056,105618,56463,53859,60066,52765,59676,22355,102458,89067,112402,78990,81782,32614,107845,60284,39437,15140,12965,52623,45571,26408,72767,57509,77800,10221,78240,50595,5712,35983,88505,38254,1745,87543,2667,44195,31323,58735,42993,113491,54729,91512,102895,20032,27466,61252,57296,115779,75437,92840,3258,72082,110239,83192,6089,25955,110228,76269,78866,14493,111115,96910,81035,110836,93351,109821,56664,51336,63491,25661,32716,43015,9064,27448,114436,101121,97023,23128,105112,92824,89957,5906,93567,62978,3856,39862,99834,114943,22381,65061,78330,21221,23133,11490,113504,95167,27007,116441,51240,110593,101697,50957,40004,113939,110890,52072,96619,112932,89990,26675,111782,97364,1195,96212,93327,62460,75673,26328,33170,81448,112713,27424,67075,1857,72015,111080,42626,54548,74366,63917,67976,20557,13815,103738,12981,84197,111747,43080,92981,59742,63893,20615,39566,107080,73417,68768,45921,96156,101091,67390,17321,73852,84491,70986,76334,44510,46787,60572,16404,23578,76515,61656,85765,12628,23313,71015,30073,46181,77005,111994,101764,50116,80570,65480,62479,98383,104912,52968,90668,34052,77438,94202,284,28210,110167,59382,63116,69204,19265,7084,82311,85993,48602,20137,72045,22440,48433,85808,82699,82888,115821,69614,30006,47022,36439,42180,31902,3805,72277,7171,61801,91006,20983,56130,91579,102054,60598,97280,12841,103607,5799,15473,93518,10635,37738,107077,82281,56360,42795,107150,63712,3469,588,36751,66508,21331,92363,111631,109851,86297,57143,94751,33994,51687,90860,58121,43639,57720,6306,55006,61556,65837,72120,37386,3814,45685,44395,71179,58024,14847,11347,23505,95084,114547,9699,83027,20517,53153,56571,89574,33662,47028,18711,66996,38154,100090,28762,16740,95267,46935,56949,37167,59521,86085,52743,45830,49636,79534,90841,35411,83328,37922,115359,15394,11542,38710,73693,81191,4727,28929,35827,76341,102676,75739,67866,69600,31947,107391,21851,54061,15164,60326,33614,70579,56729,16980,95785,93391,70483,103831,93016,114026,90380,57085,69000,30652,109524,106289,5674,108836,49610,116931,101578,8319,20912,108214,34469,28072,44819,79979,37593,101836,73926,23543,22231,35169,49295,101467,99741,34908,110825,86428,64325,45202,52223,84132,27830,10786,25251,21975,3077,54936,71261,12863,117453,96791,38397,91744,87626,33400,32664,117809,30538,91537,107877,5159,53516,48484,53393,57089,17757,47196,113692,52206,94937,75791,111345,48126,86131,113950,117813,97568,108081,112045,69349,24506,15439,115128,106557,2310,34554,92320,41560,50276,41491,17602,110926,63977,8969,32171,76335,2131,50923,61614,91588,75462,97822,106658,98132,97471,79289,65672,86548,64584,68430,58990,117464,103714,83893,103206,86739,12759,30495,21466,48302,78626,13975,64659,83376,14371,77341,65410,72184,45409,31972,112373,6978,80111,2396,56423,93197,12899,11085,9141,75909,78089,63082,90814,115187,89929,9788,96032,33802,27618,6386,94603,37617,30924,54917,48551,52552,97655,87571,117058,41730,60499,34973,76469,449,13782,82969,113039,49811,114408,105003,99488,112225,10601,59348,84726,46853,102110,52834,92350,71193,56083,72751,25935,11624,111822,58026,48362,19619,25589,8906,100042,52313,54758,45251,104566,50250,78888,28339,83834,1561,79261,69554,89013,35408,92192,25514,112233,26388,92436,93062,56960,44090,105017,97547,51856,25189,47467,101464,108605,22500,107699,97422,26946,99554,35490,47031,9847,79404,41280,89096,66141,80661,112000,84036,74932,86822,43492,18964,107952,20105,8897,8361,15089,45380,78233,110702,95033,28689,35309,29885,89142,9075,34371,41659,112583,96136,2487,102943,114754,107721,111268,117938,4205,33716,5749,5509,4991,76808,63274,114883,81388,53447,15810,4555,103464,34073,15390,62785,22166,69525,17001,33737,61974,92365,26873,118123,88381,89238,80246,76608,23418,115594,109534,37318,47034,983,91812,44406,78102,103520,26309,10460,2864,92915,18204,27463,70116,44888,112653,86431,55461,57610,55349,73138,65209,74707,41984,59076,21060,104591,55232,64015,54389,71066,115931,20571,11874,43369,27569,72316,10212,104832,13371,114607,68965,94641,83037,69819,94513,66991,13503,79410,23552,113912,72393,58673,68485,93605,108398,42751,79458};
static const uint32_t omega_1792[1792]={1,9282,52780,17194,44431,108864,69409,21307,19118,43776,61077,34225,113445,11971,56475,15014,34354,9820,79030,27314,69509,3323,93106,107354,9803,39509,76238,13757,75907,16513,110131,2403,69322,41684,39905,85447,98589,24897,106785,50630,49031,109511,42940,107343,25974,50294,5377,116381,61133,80925,112300,28651,60878,79475,18249,20282,85181,113310,59904,27555,59284,68092,97305,52382,107694,90585,7213,8548,99626,70218,79246,21585,115781,50764,110089,85651,99749,29174,66171,7533,21963,76187,13467,104406,85803,91337,9170,77653,19484,11071,100058,58760,53517,116467,31474,7358,53435,64981,79615,16726,76556,8608,65181,43647,46429,85439,24333,75749,87506,50001,6030,27331,109030,72672,30585,34770,86396,36732,83638,102217,110461,108638,100591,38600,36283,55575,58597,78100,28983,67404,98031,49553,105522,36491,93863,37448,106262,45337,2700,105797,105308,60784,34878,24395,59868,48222,51572,40473,35338,36287,92703,33171,28603,88434,29768,20848,16508,63721,93322,101625,56075,86950,93221,110327,47580,6178,100064,114452,15378,101358,61514,69177,115070,74550,76050,42836,88199,95685,36213,115473,30460,57250,112184,16396,88594,95612,68265,47269,76301,7158,89403,35278,70732,1001,65988,83022,61609,4783,43431,52158,39167,95165,58766,109209,78328,16365,37398,115254,8343,89184,13161,102666,20251,33985,14679,118255,69470,114417,45327,28153,51089,51641,89566,10695,39943,83344,93588,86904,21068,47907,84567,91266,59786,115009,99713,49841,58459,98187,78269,60092,116749,46992,107193,52950,57585,28283,75019,53207,77599,109621,117776,117766,24946,88511,34844,63626,39443,54991,78467,5560,40892,21487,34056,82336,80899,107514,75647,86926,106999,26337,108016,4291,89334,104458,95375,115618,75347,22605,3308,72149,25292,106712,82682,99100,37079,111121,84562,44856,32432,29039,114104,96886,66233,109925,100952,77758,47910,112413,13060,111368,11756,71486,21522,4107,37268,91324,6777,101151,32508,24833,104102,102627,13072,104479,53751,41268,81602,9472,42265,110462,117920,35098,55794,80714,46166,9733,99407,48101,111180,40835,83778,100694,48462,32065,52462,22343,55157,81730,14838,56544,64107,9711,13476,69671,87731,9537,54230,111245,52800,84561,35574,97925,11845,69673,106295,115097,88618,81834,33982,105106,78188,17888,99397,73554,56472,105441,112560,76511,64010,55541,97828,57675,35752,94299,63118,55107,90722,96117,24755,89744,7069,91216,68778,78015,67924,75478,55817,57654,77376,50376,56863,68240,51765,57804,50400,43085,33957,109602,59691,61130,53079,72233,95342,45858,107702,46568,74634,27827,100255,113219,43153,73768,32179,46153,7340,4632,61125,6669,44879,9372,60249,36474,54342,86372,50510,117921,44380,108574,97908,90597,324,50543,69408,12025,84611,26582,16646,43634,44036,108937,37357,89511,91550,93868,83858,15343,13034,106582,58752,97534,49046,12195,6729,10434,101074,27432,100328,81167,111357,27927,82271,68934,106731,22494,37463,8946,9126,24064,62624,82446,37462,117937,74619,6870,18193,91855,86326,96630,55501,81367,75389,57630,91154,84659,117299,66353,41035,47810,12124,57345,47790,63030,66202,58729,2321,17836,89825,49273,108568,42216,10463,15433,20503,7589,68663,75042,30147,108809,31991,75232,19632,83804,105480,1466,6017,24938,14255,85696,44347,38814,11990,114560,71650,6221,26098,18532,45082,1250,11746,96939,85087,68713,66050,67141,22325,6354,77874,60165,84697,115196,61352,103042,80366,9401,92881,29545,79876,73868,14195,1868,70918,71631,66409,87735,46665,28804,61748,112251,46925,76664,64880,88317,8231,114057,15451,69306,11445,23336,46889,97331,57168,60698,64537,97962,460,11892,32835,103222,95304,47961,112703,102834,42078,30550,64719,13191,26307,66102,76713,46606,72531,22826,43989,27502,40430,109304,13934,62999,15006,78371,60672,59751,26685,26508,39416,40923,72683,14414,23985,38984,52381,98412,37805,108292,82390,109035,809,57939,2467,72005,107960,75864,90479,87778,90972,51157,91452,12143,115430,104426,34897,82480,116504,20089,67850,98248,53106,86301,101126,37004,6336,29071,56309,11751,25076,112441,36410,51659,20096,14551,112889,55191,42499,35263,49775,37212,44624,7922,84471,28105,78645,1934,92165,6921,18483,63356,17036,115424,48734,73036,97589,86464,76543,6215,88679,56671,60191,89483,68200,35304,75518,72278,39940,55498,53521,35322,6048,76134,112886,27345,2432,101954,34755,65439,72943,62274,27117,15050,13687,17532,106649,89281,85604,18314,32247,85964,48190,109367,7335,76495,33771,38972,59270,56417,68023,48212,77025,104038,99944,65069,68520,48719,52079,15527,65100,1443,29077,112001,91885,9967,24208,98229,113294,29665,10986,20726,66834,11303,6295,3328,21243,16435,95773,25118,29193,5983,64169,112103,92465,71242,3901,17544,99760,13003,55386,78394,37612,90961,67328,102237,59555,99781,89652,99309,84649,24479,11645,105641,76592,106214,72893,71266,108396,101534,39324,14890,66116,88388,75888,76701,53495,30536,53044,102182,22137,35433,90166,21064,10779,109993,22490,335,34372,58623,82886,100260,41356,70507,41465,17788,117381,117839,111167,38442,107276,113718,62224,36109,96329,100171,43169,104007,48748,84711,8598,90634,107212,111035,114221,150,91297,110982,95367,41362,7926,3326,2679,29148,61385,54529,48011,103711,21555,73867,4913,67361,53724,27200,75818,18326,25358,9686,17972,51174,12700,81492,52909,31842,111490,79703,5631,108549,102404,72100,43566,4225,68087,50895,25028,21724,104976,54258,16322,111364,92901,96912,71019,62929,74904,50234,39822,24679,93950,17071,85475,3666,83461,115125,111968,22125,42322,48171,51282,68972,104628,17493,99470,41502,6403,59600,44379,99292,45128,73403,74166,59952,118272,108991,65493,101079,73842,9409,48864,96966,99155,74497,57196,84048,4828,106302,61798,103259,83919,108453,39243,90959,48764,114950,25167,10919,108470,78764,42035,104516,42366,101760,8142,115870,48951,76589,78368,32826,19684,93376,11488,67643,69242,8762,75333,10930,92299,67979,112896,1892,57140,37348,5973,89622,57395,38798,100024,97991,33092,4963,58369,90718,58989,50181,20968,65891,10579,27688,111060,109725,18647,48055,39027,96688,2492,67509,8184,32622,18524,89099,52102,110740,96310,42086,104806,13867,32470,26936,109103,40620,98789,107202,18215,59513,64756,1806,86799,110915,64838,53292,38658,101547,41717,109665,53092,74626,71844,32834,93940,42524,30767,68272,112243,90942,9243,45601,87688,83503,31877,81541,34635,16056,7812,9635,17682,79673,81990,62698,59676,40173,89290,50869,20242,68720,12751,81782,24410,80825,12011,72936,115573,12476,12965,57489,83395,93878,58405,70051,66701,77800,82935,81986,25570,85102,89670,29839,88505,97425,101765,54552,24951,16648,62198,31323,25052,7946,70693,112095,18209,3821,102895,16915,56759,49096,3203,43723,42223,75437,30074,22588,82060,2800,87813,61023,6089,101877,29679,22661,50008,71004,41972,111115,28870,82995,47541,117272,52285,35251,56664,113490,74842,66115,79106,23108,59507,9064,39945,101908,80875,3019,109930,29089,105112,15607,98022,84288,103594,18,48803,3856,72946,90120,67184,66632,28707,107578,78330,34929,24685,31369,97205,70366,33706,27007,58487,3264,18560,68432,59814,20086,40004,58181,1524,71281,11080,65323,60688,89990,43254,65066,40674,8652,497,507,93327,29762,83429,54647,78830,63282,39806,112713,77381,96786,84217,35937,37374,10759,42626,31347,11274,91936,10257,113982,28939,13815,22898,2655,42926,95668,114965,46124,92981,11561,35591,19173,81194,7152,33711,73417,85841,89234,4169,21387,52040,8348,17321,40515,70363,5860,105213,6905,106517,46787,96751,114166,81005,26949,111496,17122,85765,93440,14171,15646,105201,13794,64522,77005,36671,108801,76008,7811,353,83175,62479,37559,72107,108540,18866,70172,7093,77438,34495,17579,69811,86208,65811,95930,63116,36543,103435,61729,54166,108562,104797,48602,30542,108736,64043,7028,65473,33712,82699,20348,106428,48600,11978,3176,29655,36439,84291,13167,40085,100385,18876,44719,61801,12832,5713,41762,54263,62732,20445,60598,82521,23974,55155,63166,27551,22156,93518,28529,111204,27057,49495,40258,50349,42795,62456,60619,40897,67897,61410,50033,66508,60469,67873,75188,84316,8671,58582,57143,65194,46040,22931,72415,10571,71705,43639,90446,18018,5054,75120,44505,86094,72120,110933,113641,57148,111604,73394,108901,58024,81799,63931,31901,67763,352,73893,9699,20365,27676,117949,67730,48865,106248,33662,91691,101627,74639,74237,9336,80916,28762,26723,24405,34415,102930,105239,11691,59521,20739,69227,106078,111544,107839,17199,90841,17945,37106,6916,90346,36002,49339,11542,95779,80810,109327,109147,94209,55649,35827,80811,336,43654,111403,100080,26418,31947,21643,62772,36906,42884,60643,27119,33614,974,51920,77238,70463,106149,60928,70483,55243,52071,59544,115952,100437,28448,69000,9705,76057,107810,102840,97770,110684,49610,43231,88126,9464,86282,43041,98641,34469,12793,116807,112256,93335,104018,32577,73926,79459,106283,3713,46623,112052,92175,99741,73191,117023,106527,21334,33186,49560,52223,51132,95948,111919,40399,58108,33576,3077,56921,15231,37907,108872,25392,88728,38397,44405,104078,116405,47355,46642,51864,30538,71608,89469,56525,6022,71348,41609,53393,29956,110042,4216,102822,48967,106828,94937,71384,20942,61105,57575,53736,20311,117813,106381,85438,15051,22969,70312,5570,15439,76195,87723,53554,105082,91966,52171,41560,71667,45742,95447,74284,90771,77843,8969,104339,55274,103267,39902,57601,58522,91588,91765,78857,77350,45590,103859,94288,79289,65892,19861,80468,9981,35883,9238,117464,60334,115806,46268,10313,42409,27794,30495,27301,67116,26821,106130,2843,13847,83376,35793,1769,98184,50423,20025,65167,31972,17147,81269,111937,89202,61964,106522,93197,5832,81863,66614,98177,103722,5384,63082,75774,83010,68498,81061,73649,110351,33802,90168,39628,116339,26108,111352,99790,54917,101237,2849,69539,45237,20684,31809,41730,112058,29594,61602,58082,28790,50073,82969,42755,45995,78333,62775,64752,82951,112225,42139,5387,90928,115841,16319,83518,52834,45330,55999,91156,103223,104586,100741,11624,28992,32669,99959,86026,32309,70083,8906,110938,41778,84502,79301,59003,61856,50250,70061,41248,14235,18329,53204,49753,69554,66194,102746,53173,116830,89196,6272,26388,108306,94065,20044,4979,88608,107287,97547,51439,106970,111978,114945,97030,101838,22500,93155,89080,112290,54104,6170,25808,47031,114372,100729,18513,105270,62887,39879,80661,27312,50945,16036,58718,18492,28621,18964,33624,93794,106628,12632,41681,12059,45380,47007,9877,16739,78949,103383,52157,29885,42385,41572,64778,87737,65229,16091,96136,82840,28107,97209,107494,8280,95783,117938,83901,59650,35387,18013,76917,47766,76808,100485,892,434,7106,79831,10997,4555,56049,82164,21944,18102,75104,14266,69525,33562,109675,27639,11061,7238,4052,118123,26976,7291,22906,76911,110347,114947,115594,89125,56888,63744,70262,14562,96718,44406,113360,50912,64549,91073,42455,99947,92915,108587,100301,67099,105573,36781,65364,86431,6783,38570,112642,9724,15869,46173,74707,114048,50186,67378,93245,96549,13297,64015,101951,6909,25372,21361,47254,55344,43369,68039,78451,93594,24323,101202,32798,114607,34812,3148,6305,96148,75951,70102,66991,49301,13645,100780,18803,76771,111870,58673,73894,18981,73145,44870,44107,58321};

/* multiplication inverses of omega_256,512,768,1536, respectively */
static const uint32_t omega_256_inv[128]={1,58673,66991,114607,43369,64015,74707,86431,92915,44406,115594,118123,69525,4555,76808,117938,96136,29885,45380,18964,80661,47031,22500,97547,26388,69554,50250,8906,11624,52834,112225,82969,41730,54917,33802,63082,93197,31972,83376,30495,117464,79289,91588,8969,41560,15439,117813,94937,53393,30538,38397,3077,52223,99741,73926,34469,49610,69000,70483,33614,31947,35827,11542,90841,59521,28762,33662,9699,58024,72120,43639,57143,66508,42795,93518,60598,61801,36439,82699,48602,63116,77438,62479,77005,85765,46787,17321,73417,92981,13815,42626,112713,93327,89990,40004,27007,78330,3856,105112,9064,56664,111115,6089,75437,102895,31323,88505,77800,12965,81782,59676,16056,9243,32834,38658,59513,32470,89099,39027,65891,33092,37348,75333,32826,42366,114950,61798,96966};
static const uint32_t omega_512_inv[256]={1,108398,58673,23552,66991,83037,114607,10212,43369,115931,64015,21060,74707,55349,86431,70116,92915,26309,44406,47034,115594,80246,118123,61974,69525,15390,4555,81388,76808,5749,117938,114754,96136,34371,29885,95033,45380,8897,18964,74932,80661,41280,47031,26946,22500,47467,97547,56960,26388,92192,69554,83834,50250,54758,8906,48362,11624,56083,52834,84726,112225,114408,82969,76469,41730,97655,54917,94603,33802,89929,63082,9141,93197,80111,31972,65410,83376,78626,30495,103206,117464,64584,79289,106658,91588,2131,8969,17602,41560,2310,15439,112045,117813,48126,94937,47196,53393,5159,30538,33400,38397,12863,3077,10786,52223,86428,99741,35169,73926,79979,34469,8319,49610,106289,69000,114026,70483,16980,33614,54061,31947,75739,35827,81191,11542,37922,90841,45830,59521,46935,28762,66996,33662,53153,9699,23505,58024,45685,72120,55006,43639,51687,57143,111631,66508,3469,42795,107077,93518,103607,60598,56130,61801,3805,36439,69614,82699,22440,48602,7084,63116,28210,77438,52968,62479,50116,77005,71015,85765,23578,46787,70986,17321,96156,73417,20615,92981,84197,13815,63917,42626,1857,112713,26328,93327,97364,89990,52072,40004,110593,27007,11490,78330,114943,3856,5906,105112,101121,9064,25661,56664,110836,111115,76269,6089,72082,75437,61252,102895,113491,31323,87543,88505,50595,77800,26408,12965,60284,81782,89067,59676,53859,16056,51093,9243,32131,32834,68816,38658,37494,59513,7662,32470,115126,89099,98495,39027,60082,65891,64421,33092,4799,37348,81987,75333,23795,32826,29543,42366,85624,114950,53004,61798,33430,96966,117231};
static const uint32_t omega_768_inv[768]={1,42751,93605,58673,113912,79410,66991,69819,94641,114607,104832,72316,43369,20571,71066,64015,104591,59076,74707,73138,57610,86431,44888,27463,92915,10460,103520,44406,983,37318,115594,76608,89238,118123,92365,33737,69525,62785,34073,4555,53447,114883,76808,5509,33716,117938,107721,102943,96136,41659,9075,29885,28689,110702,45380,8361,20105,18964,86822,84036,80661,89096,79404,47031,99554,97422,22500,101464,25189,97547,44090,93062,26388,25514,35408,69554,1561,28339,50250,45251,52313,8906,19619,58026,11624,72751,71193,52834,46853,59348,112225,105003,49811,82969,449,34973,41730,87571,52552,54917,37617,6386,33802,9788,115187,63082,75909,11085,93197,2396,6978,31972,72184,77341,83376,13975,48302,30495,86739,83893,117464,68430,86548,79289,98132,97822,91588,50923,76335,8969,110926,41491,41560,34554,106557,15439,69349,108081,117813,86131,111345,94937,113692,17757,53393,53516,107877,30538,32664,87626,38397,117453,71261,3077,25251,27830,52223,64325,110825,99741,49295,22231,73926,37593,44819,34469,20912,101578,49610,5674,109524,69000,90380,93016,70483,95785,56729,33614,15164,21851,31947,67866,102676,35827,4727,73693,11542,115359,83328,90841,49636,52743,59521,56949,95267,28762,38154,18711,33662,56571,20517,9699,95084,11347,58024,44395,3814,72120,61556,6306,43639,90860,33994,57143,109851,92363,66508,588,63712,42795,82281,37738,93518,5799,12841,60598,91579,20983,61801,72277,31902,36439,30006,115821,82699,48433,72045,48602,82311,19265,63116,110167,284,77438,90668,104912,62479,80570,101764,77005,30073,23313,85765,76515,16404,46787,76334,84491,17321,101091,45921,73417,39566,63893,92981,111747,12981,13815,67976,74366,42626,72015,67075,112713,33170,75673,93327,1195,111782,89990,96619,110890,40004,101697,51240,27007,113504,23133,78330,22381,99834,3856,93567,89957,105112,97023,114436,9064,32716,63491,56664,93351,81035,111115,78866,110228,6089,110239,3258,75437,57296,27466,102895,54729,42993,31323,2667,1745,88505,5712,78240,77800,72767,45571,12965,39437,107845,81782,112402,102458,59676,60066,56463,16056,71837,26869,9243,115673,24020,32834,22370,102665,38658,39529,19655,59513,69760,56065,32470,73042,93069,89099,89384,91300,39027,84339,24184,65891,116373,26651,33092,52739,6790,37348,97121,46206,75333,105566,109205,32826,35181,63463,42366,74417,94013,114950,102573,8575,61798,62297,105906,96966,43089,114137,118272,75522,24668,59600,4361,38863,51282,48454,23632,3666,13441,45957,74904,97702,47207,54258,13682,59197,43566,45135,60663,31842,73385,90810,25358,107813,14753,73867,117290,80955,2679,41665,29035,150,25908,84536,48748,55488,84200,113718,64826,3390,41465,112764,84557,335,10552,15330,22137,76614,109198,88388,89584,7571,72893,109912,98168,99309,31451,34237,37612,29177,38869,71242,18719,20851,95773,16809,93084,20726,74183,25211,91885,92759,82865,48719,116712,89934,68023,73022,65960,109367,98654,60247,106649,45522,47080,65439,71420,58925,6048,13270,68462,35304,117824,83300,76543,30702,65721,63356,80656,111887,84471,108485,3086,55191,42364,107188,25076,115877,111295,86301,46089,40932,34897,104298,69971,87778,31534,34380,809,49843,31725,38984,20141,20451,26685,67350,41938,109304,7347,76782,76713,83719,11716,102834,48924,10192,460,32142,6928,23336,4581,100516,64880,64757,10396,87735,85609,30647,79876,820,47012,115196,93022,90443,66050,53948,7448,18532,68978,96042,44347,80680,73454,83804,97361,16695,68663,112599,8749,49273,27893,25257,47790,22488,61544,84659,103109,96422,86326,50407,15597,82446,113546,44580,106731,2914,34945,27432,68637,65530,58752,61324,23006,89511,80119,99562,84611,61702,97756,108574,23189,106926,60249,73878,114459,46153,56717,111967,74634,27413,84279,61130,8422,25910,51765,117685,54561,75478,35992,80535,24755,112474,105432,57675,26694,97290,56472,45996,86371,81834,88267,2452,35574,69840,46228,69671,35962,99008,55157,8106,117989,40835,27605,13361,55794,37703,16509,41268,88200,94960,32508,41758,101869,71486,41939,33782,100952,17182,72352,44856,78707,54380,25292,6526,105292,104458,50297,43907,75647,46258,51198,5560,85103,42600,24946,117078,6491,28283,21654,7383,78269,16576,67033,91266,4769,95140,39943,95892,18439,114417,24706,28316,13161,21250,3837,109209,85557,54782,61609,24922,37238,7158,39407,8045,112184,8034,115015,42836,60977,90807,15378,63544,75280,86950,115606,116528,29768,112561,40033,40473,45506,72702,105308,78836,10428,36491,5871,15815,58597,58207,61810,102217,46436,91404,109030,2600,94253,85439,95903,15608,79615,78744,98618,58760,48513,62208,85803,45231,25204,29174,28889,26973,79246,33934,94089,52382,1900,91622,85181,65534,111483,80925,21152,72067,42940,12707,9068,85447,83092,54810,75907,43856,24260,3323,15700,109698,56475,55976,12367,21307,75184,4136};
static const uint32_t omega_1536_inv[1536]={1,79458,42751,108398,93605,68485,58673,72393,113912,23552,79410,13503,66991,94513,69819,83037,94641,68965,114607,13371,104832,10212,72316,27569,43369,11874,20571,115931,71066,54389,64015,55232,104591,21060,59076,41984,74707,65209,73138,55349,57610,55461,86431,112653,44888,70116,27463,18204,92915,2864,10460,26309,103520,78102,44406,91812,983,47034,37318,109534,115594,23418,76608,80246,89238,88381,118123,26873,92365,61974,33737,17001,69525,22166,62785,15390,34073,103464,4555,15810,53447,81388,114883,63274,76808,4991,5509,5749,33716,4205,117938,111268,107721,114754,102943,2487,96136,112583,41659,34371,9075,89142,29885,35309,28689,95033,110702,78233,45380,15089,8361,8897,20105,107952,18964,43492,86822,74932,84036,112000,80661,66141,89096,41280,79404,9847,47031,35490,99554,26946,97422,107699,22500,108605,101464,47467,25189,51856,97547,105017,44090,56960,93062,92436,26388,112233,25514,92192,35408,89013,69554,79261,1561,83834,28339,78888,50250,104566,45251,54758,52313,100042,8906,25589,19619,48362,58026,111822,11624,25935,72751,56083,71193,92350,52834,102110,46853,84726,59348,10601,112225,99488,105003,114408,49811,113039,82969,13782,449,76469,34973,60499,41730,117058,87571,97655,52552,48551,54917,30924,37617,94603,6386,27618,33802,96032,9788,89929,115187,90814,63082,78089,75909,9141,11085,12899,93197,56423,2396,80111,6978,112373,31972,45409,72184,65410,77341,14371,83376,64659,13975,78626,48302,21466,30495,12759,86739,103206,83893,103714,117464,58990,68430,64584,86548,65672,79289,97471,98132,106658,97822,75462,91588,61614,50923,2131,76335,32171,8969,63977,110926,17602,41491,50276,41560,92320,34554,2310,106557,115128,15439,24506,69349,112045,108081,97568,117813,113950,86131,48126,111345,75791,94937,52206,113692,47196,17757,57089,53393,48484,53516,5159,107877,91537,30538,117809,32664,33400,87626,91744,38397,96791,117453,12863,71261,54936,3077,21975,25251,10786,27830,84132,52223,45202,64325,86428,110825,34908,99741,101467,49295,35169,22231,23543,73926,101836,37593,79979,44819,28072,34469,108214,20912,8319,101578,116931,49610,108836,5674,106289,109524,30652,69000,57085,90380,114026,93016,103831,70483,93391,95785,16980,56729,70579,33614,60326,15164,54061,21851,107391,31947,69600,67866,75739,102676,76341,35827,28929,4727,81191,73693,38710,11542,15394,115359,37922,83328,35411,90841,79534,49636,45830,52743,86085,59521,37167,56949,46935,95267,16740,28762,100090,38154,66996,18711,47028,33662,89574,56571,53153,20517,83027,9699,114547,95084,23505,11347,14847,58024,71179,44395,45685,3814,37386,72120,65837,61556,55006,6306,57720,43639,58121,90860,51687,33994,94751,57143,86297,109851,111631,92363,21331,66508,36751,588,3469,63712,107150,42795,56360,82281,107077,37738,10635,93518,15473,5799,103607,12841,97280,60598,102054,91579,56130,20983,91006,61801,7171,72277,3805,31902,42180,36439,47022,30006,69614,115821,82888,82699,85808,48433,22440,72045,20137,48602,85993,82311,7084,19265,69204,63116,59382,110167,28210,284,94202,77438,34052,90668,52968,104912,98383,62479,65480,80570,50116,101764,111994,77005,46181,30073,71015,23313,12628,85765,61656,76515,23578,16404,60572,46787,44510,76334,70986,84491,73852,17321,67390,101091,96156,45921,68768,73417,107080,39566,20615,63893,59742,92981,43080,111747,84197,12981,103738,13815,20557,67976,63917,74366,54548,42626,111080,72015,1857,67075,27424,112713,81448,33170,26328,75673,62460,93327,96212,1195,97364,111782,26675,89990,112932,96619,52072,110890,113939,40004,50957,101697,110593,51240,116441,27007,95167,113504,11490,23133,21221,78330,65061,22381,114943,99834,39862,3856,62978,93567,5906,89957,92824,105112,23128,97023,101121,114436,27448,9064,43015,32716,25661,63491,51336,56664,109821,93351,110836,81035,96910,111115,14493,78866,76269,110228,25955,6089,83192,110239,72082,3258,92840,75437,115779,57296,61252,27466,20032,102895,91512,54729,113491,42993,58735,31323,44195,2667,87543,1745,38254,88505,35983,5712,50595,78240,10221,77800,57509,72767,26408,45571,52623,12965,15140,39437,60284,107845,32614,81782,78990,112402,89067,102458,22355,59676,52765,60066,53859,56463,105618,16056,85070,71837,51093,26869,11079,9243,73237,115673,32131,24020,9759,32834,58138,22370,68816,102665,30214,38658,19281,39529,37494,19655,70298,59513,111141,69760,7662,56065,60225,32470,112311,73042,115126,93069,57277,89099,43108,89384,98495,91300,4399,39027,7579,84339,60082,24184,30841,65891,94460,116373,64421,26651,75366,33092,97073,52739,4799,6790,76667,37348,9541,97121,81987,46206,5882,75333,12984,105566,23795,109205,112245,32826,13839,35181,29543,63463,73699,42366,31502,74417,85624,94013,80547,114950,64675,102573,53004,8575,99870,61798,5343,62297,33430,105906,73271,96966,66389,43089,117231,114137,42379,118272,38815,75522,9875,24668,49788,59600,45880,4361,94721,38863,104770,51282,23760,48454,35236,23632,49308,3666,104902,13441,108061,45957,90704,74904,106399,97702,2342,47207,63884,54258,63041,13682,97213,59197,76289,43566,53064,45135,62924,60663,62812,31842,5620,73385,48157,90810,100069,25358,115409,107813,91964,14753,40171,73867,26461,117290,71239,80955,8739,2679,94855,41665,38027,29035,29892,150,91400,25908,56299,84536,101272,48748,96107,55488,102883,84200,14809,113718,102463,64826,36885,3390,54999,41465,113282,112764,112524,84557,114068,335,7005,10552,3519,15330,115786,22137,5690,76614,83902,109198,29131,88388,82964,89584,23240,7571,40040,72893,103184,109912,109376,98168,10321,99309,74781,31451,43341,34237,6273,37612,52132,29177,76993,38869,108426,71242,82783,18719,91327,20851,10574,95773,9668,16809,70806,93084,66417,20726,13256,74183,61313,25211,25837,91885,6040,92759,26081,82865,29260,48719,39012,116712,34439,89934,39385,68023,13707,73022,63515,65960,18231,109367,92684,98654,69911,60247,6451,106649,92338,45522,62190,47080,25923,65439,16163,71420,33547,58925,107672,6048,18785,13270,3865,68462,5234,35304,104491,117824,41804,83300,57774,76543,1215,30702,20618,65721,69722,63356,87349,80656,23670,111887,90655,84471,22241,108485,28344,3086,27459,55191,40184,42364,109132,107188,105374,25076,61850,115877,38162,111295,5900,86301,72864,46089,52863,40932,103902,34897,53614,104298,39647,69971,96807,87778,105514,31534,15067,34380,14559,809,59283,49843,53689,31725,52601,38984,20802,20141,11615,20451,42811,26685,56659,67350,116142,41938,86102,109304,54296,7347,100671,76782,67997,76713,25953,83719,115963,11716,3145,102834,93767,48924,6228,10192,20705,460,4323,32142,70147,6928,42482,23336,66067,4581,71077,100516,61184,64880,69789,64757,113114,10396,26736,87735,464,85609,84873,30647,26529,79876,21482,820,105410,47012,63337,115196,96298,93022,107487,90443,34141,66050,73071,53948,31845,7448,83365,18532,16806,68978,83104,96042,94730,44347,16437,80680,38294,73454,90201,83804,10059,97361,109954,16695,1342,68663,9437,112599,11984,8749,87621,49273,61188,27893,4247,25257,14442,47790,24882,22488,101293,61544,47694,84659,57947,103109,64212,96422,10882,86326,48673,50407,42534,15597,41932,82446,89344,113546,37082,44580,79563,106731,102879,2914,80351,34945,82862,27432,38739,68637,72443,65530,32188,58752,81106,61324,71338,23006,101533,89511,18183,80119,51277,99562,71245,84611,28699,61702,65120,97756,35246,108574,3726,23189,94768,106926,103426,60249,47094,73878,72588,114459,80887,46153,52436,56717,63267,111967,60553,74634,60152,27413,66586,84279,23522,61130,31976,8422,6642,25910,96942,51765,81522,117685,114804,54561,11123,75478,61913,35992,11196,80535,107638,24755,102800,112474,14666,105432,20993,57675,16219,26694,62143,97290,27267,56472,111102,45996,114468,86371,76093,81834,71251,88267,48659,2452,35385,35574,32465,69840,95833,46228,98136,69671,32280,35962,111189,99008,49069,55157,58891,8106,90063,117989,24071,40835,84221,27605,65305,13361,19890,55794,52793,37703,68157,16509,6279,41268,72092,88200,47258,94960,105645,32508,56617,41758,94695,101869,57701,71486,73763,41939,47287,33782,44421,100952,50883,17182,22117,72352,49505,44856,11193,78707,97658,54380,58531,25292,75193,6526,34076,105292,14535,104458,97716,50297,54356,43907,63725,75647,7193,46258,116416,51198,90849,5560,36825,85103,91945,42600,55813,24946,22061,117078,20909,6491,91598,28283,5341,21654,66201,7383,4334,78269,67316,16576,7680,67033,1832,91266,23106,4769,106783,95140,97052,39943,53212,95892,3330,18439,78411,114417,55295,24706,112367,28316,25449,13161,95145,21250,17152,3837,90825,109209,75258,85557,92612,54782,66937,61609,8452,24922,7437,37238,21363,7158,103780,39407,42004,8045,92318,112184,35081,8034,46191,115015,25433,42836,2494,60977,57021,90807,98241,15378,26761,63544,4782,75280,59538,86950,74078,115606,30730,116528,80019,29768,82290,112561,67678,40033,108052,40473,60764,45506,91865,72702,65650,105308,103133,78836,57989,10428,85659,36491,39283,5871,29206,15815,95918,58597,65508,58207,64414,61810,12655,102217,33203,46436,67180,91404,107194,109030,45036,2600,86142,94253,108514,85439,60135,95903,49457,15608,88059,79615,98992,78744,80779,98618,47975,58760,7132,48513,110611,62208,58048,85803,5962,45231,3147,25204,60996,29174,75165,28889,19778,26973,113874,79246,110694,33934,58191,94089,87432,52382,23813,1900,53852,91622,42907,85181,21200,65534,113474,111483,41606,80925,108732,21152,36286,72067,112391,42940,105289,12707,94478,9068,6028,85447,104434,83092,88730,54810,44574,75907,86771,43856,32649,24260,37726,3323,53598,15700,65269,109698,18403,56475,112930,55976,84843,12367,45002,21307,51884,75184,1042,4136,75894};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* bit reverse step of dimension 512 */
static void bit_reverse_512(uint32_t *a)
{
uint32_t t;
t=a[1];a[1]=a[256];a[256]=t;
t=a[2];a[2]=a[128];a[128]=t;
t=a[3];a[3]=a[384];a[384]=t;
t=a[4];a[4]=a[64];a[64]=t;
t=a[5];a[5]=a[320];a[320]=t;
t=a[6];a[6]=a[192];a[192]=t;
t=a[7];a[7]=a[448];a[448]=t;
t=a[8];a[8]=a[32];a[32]=t;
t=a[9];a[9]=a[288];a[288]=t;
t=a[10];a[10]=a[160];a[160]=t;
t=a[11];a[11]=a[416];a[416]=t;
t=a[12];a[12]=a[96];a[96]=t;
t=a[13];a[13]=a[352];a[352]=t;
t=a[14];a[14]=a[224];a[224]=t;
t=a[15];a[15]=a[480];a[480]=t;
t=a[17];a[17]=a[272];a[272]=t;
t=a[18];a[18]=a[144];a[144]=t;
t=a[19];a[19]=a[400];a[400]=t;
t=a[20];a[20]=a[80];a[80]=t;
t=a[21];a[21]=a[336];a[336]=t;
t=a[22];a[22]=a[208];a[208]=t;
t=a[23];a[23]=a[464];a[464]=t;
t=a[24];a[24]=a[48];a[48]=t;
t=a[25];a[25]=a[304];a[304]=t;
t=a[26];a[26]=a[176];a[176]=t;
t=a[27];a[27]=a[432];a[432]=t;
t=a[28];a[28]=a[112];a[112]=t;
t=a[29];a[29]=a[368];a[368]=t;
t=a[30];a[30]=a[240];a[240]=t;
t=a[31];a[31]=a[496];a[496]=t;
t=a[33];a[33]=a[264];a[264]=t;
t=a[34];a[34]=a[136];a[136]=t;
t=a[35];a[35]=a[392];a[392]=t;
t=a[36];a[36]=a[72];a[72]=t;
t=a[37];a[37]=a[328];a[328]=t;
t=a[38];a[38]=a[200];a[200]=t;
t=a[39];a[39]=a[456];a[456]=t;
t=a[41];a[41]=a[296];a[296]=t;
t=a[42];a[42]=a[168];a[168]=t;
t=a[43];a[43]=a[424];a[424]=t;
t=a[44];a[44]=a[104];a[104]=t;
t=a[45];a[45]=a[360];a[360]=t;
t=a[46];a[46]=a[232];a[232]=t;
t=a[47];a[47]=a[488];a[488]=t;
t=a[49];a[49]=a[280];a[280]=t;
t=a[50];a[50]=a[152];a[152]=t;
t=a[51];a[51]=a[408];a[408]=t;
t=a[52];a[52]=a[88];a[88]=t;
t=a[53];a[53]=a[344];a[344]=t;
t=a[54];a[54]=a[216];a[216]=t;
t=a[55];a[55]=a[472];a[472]=t;
t=a[57];a[57]=a[312];a[312]=t;
t=a[58];a[58]=a[184];a[184]=t;
t=a[59];a[59]=a[440];a[440]=t;
t=a[60];a[60]=a[120];a[120]=t;
t=a[61];a[61]=a[376];a[376]=t;
t=a[62];a[62]=a[248];a[248]=t;
t=a[63];a[63]=a[504];a[504]=t;
t=a[65];a[65]=a[260];a[260]=t;
t=a[66];a[66]=a[132];a[132]=t;
t=a[67];a[67]=a[388];a[388]=t;
t=a[69];a[69]=a[324];a[324]=t;
t=a[70];a[70]=a[196];a[196]=t;
t=a[71];a[71]=a[452];a[452]=t;
t=a[73];a[73]=a[292];a[292]=t;
t=a[74];a[74]=a[164];a[164]=t;
t=a[75];a[75]=a[420];a[420]=t;
t=a[76];a[76]=a[100];a[100]=t;
t=a[77];a[77]=a[356];a[356]=t;
t=a[78];a[78]=a[228];a[228]=t;
t=a[79];a[79]=a[484];a[484]=t;
t=a[81];a[81]=a[276];a[276]=t;
t=a[82];a[82]=a[148];a[148]=t;
t=a[83];a[83]=a[404];a[404]=t;
t=a[85];a[85]=a[340];a[340]=t;
t=a[86];a[86]=a[212];a[212]=t;
t=a[87];a[87]=a[468];a[468]=t;
t=a[89];a[89]=a[308];a[308]=t;
t=a[90];a[90]=a[180];a[180]=t;
t=a[91];a[91]=a[436];a[436]=t;
t=a[92];a[92]=a[116];a[116]=t;
t=a[93];a[93]=a[372];a[372]=t;
t=a[94];a[94]=a[244];a[244]=t;
t=a[95];a[95]=a[500];a[500]=t;
t=a[97];a[97]=a[268];a[268]=t;
t=a[98];a[98]=a[140];a[140]=t;
t=a[99];a[99]=a[396];a[396]=t;
t=a[101];a[101]=a[332];a[332]=t;
t=a[102];a[102]=a[204];a[204]=t;
t=a[103];a[103]=a[460];a[460]=t;
t=a[105];a[105]=a[300];a[300]=t;
t=a[106];a[106]=a[172];a[172]=t;
t=a[107];a[107]=a[428];a[428]=t;
t=a[109];a[109]=a[364];a[364]=t;
t=a[110];a[110]=a[236];a[236]=t;
t=a[111];a[111]=a[492];a[492]=t;
t=a[113];a[113]=a[284];a[284]=t;
t=a[114];a[114]=a[156];a[156]=t;
t=a[115];a[115]=a[412];a[412]=t;
t=a[117];a[117]=a[348];a[348]=t;
t=a[118];a[118]=a[220];a[220]=t;
t=a[119];a[119]=a[476];a[476]=t;
t=a[121];a[121]=a[316];a[316]=t;
t=a[122];a[122]=a[188];a[188]=t;
t=a[123];a[123]=a[444];a[444]=t;
t=a[125];a[125]=a[380];a[380]=t;
t=a[126];a[126]=a[252];a[252]=t;
t=a[127];a[127]=a[508];a[508]=t;
t=a[129];a[129]=a[258];a[258]=t;
t=a[131];a[131]=a[386];a[386]=t;
t=a[133];a[133]=a[322];a[322]=t;
t=a[134];a[134]=a[194];a[194]=t;
t=a[135];a[135]=a[450];a[450]=t;
t=a[137];a[137]=a[290];a[290]=t;
t=a[138];a[138]=a[162];a[162]=t;
t=a[139];a[139]=a[418];a[418]=t;
t=a[141];a[141]=a[354];a[354]=t;
t=a[142];a[142]=a[226];a[226]=t;
t=a[143];a[143]=a[482];a[482]=t;
t=a[145];a[145]=a[274];a[274]=t;
t=a[147];a[147]=a[402];a[402]=t;
t=a[149];a[149]=a[338];a[338]=t;
t=a[150];a[150]=a[210];a[210]=t;
t=a[151];a[151]=a[466];a[466]=t;
t=a[153];a[153]=a[306];a[306]=t;
t=a[154];a[154]=a[178];a[178]=t;
t=a[155];a[155]=a[434];a[434]=t;
t=a[157];a[157]=a[370];a[370]=t;
t=a[158];a[158]=a[242];a[242]=t;
t=a[159];a[159]=a[498];a[498]=t;
t=a[161];a[161]=a[266];a[266]=t;
t=a[163];a[163]=a[394];a[394]=t;
t=a[165];a[165]=a[330];a[330]=t;
t=a[166];a[166]=a[202];a[202]=t;
t=a[167];a[167]=a[458];a[458]=t;
t=a[169];a[169]=a[298];a[298]=t;
t=a[171];a[171]=a[426];a[426]=t;
t=a[173];a[173]=a[362];a[362]=t;
t=a[174];a[174]=a[234];a[234]=t;
t=a[175];a[175]=a[490];a[490]=t;
t=a[177];a[177]=a[282];a[282]=t;
t=a[179];a[179]=a[410];a[410]=t;
t=a[181];a[181]=a[346];a[346]=t;
t=a[182];a[182]=a[218];a[218]=t;
t=a[183];a[183]=a[474];a[474]=t;
t=a[185];a[185]=a[314];a[314]=t;
t=a[187];a[187]=a[442];a[442]=t;
t=a[189];a[189]=a[378];a[378]=t;
t=a[190];a[190]=a[250];a[250]=t;
t=a[191];a[191]=a[506];a[506]=t;
t=a[193];a[193]=a[262];a[262]=t;
t=a[195];a[195]=a[390];a[390]=t;
t=a[197];a[197]=a[326];a[326]=t;
t=a[199];a[199]=a[454];a[454]=t;
t=a[201];a[201]=a[294];a[294]=t;
t=a[203];a[203]=a[422];a[422]=t;
t=a[205];a[205]=a[358];a[358]=t;
t=a[206];a[206]=a[230];a[230]=t;
t=a[207];a[207]=a[486];a[486]=t;
t=a[209];a[209]=a[278];a[278]=t;
t=a[211];a[211]=a[406];a[406]=t;
t=a[213];a[213]=a[342];a[342]=t;
t=a[215];a[215]=a[470];a[470]=t;
t=a[217];a[217]=a[310];a[310]=t;
t=a[219];a[219]=a[438];a[438]=t;
t=a[221];a[221]=a[374];a[374]=t;
t=a[222];a[222]=a[246];a[246]=t;
t=a[223];a[223]=a[502];a[502]=t;
t=a[225];a[225]=a[270];a[270]=t;
t=a[227];a[227]=a[398];a[398]=t;
t=a[229];a[229]=a[334];a[334]=t;
t=a[231];a[231]=a[462];a[462]=t;
t=a[233];a[233]=a[302];a[302]=t;
t=a[235];a[235]=a[430];a[430]=t;
t=a[237];a[237]=a[366];a[366]=t;
t=a[239];a[239]=a[494];a[494]=t;
t=a[241];a[241]=a[286];a[286]=t;
t=a[243];a[243]=a[414];a[414]=t;
t=a[245];a[245]=a[350];a[350]=t;
t=a[247];a[247]=a[478];a[478]=t;
t=a[249];a[249]=a[318];a[318]=t;
t=a[251];a[251]=a[446];a[446]=t;
t=a[253];a[253]=a[382];a[382]=t;
t=a[255];a[255]=a[510];a[510]=t;
t=a[259];a[259]=a[385];a[385]=t;
t=a[261];a[261]=a[321];a[321]=t;
t=a[263];a[263]=a[449];a[449]=t;
t=a[265];a[265]=a[289];a[289]=t;
t=a[267];a[267]=a[417];a[417]=t;
t=a[269];a[269]=a[353];a[353]=t;
t=a[271];a[271]=a[481];a[481]=t;
t=a[275];a[275]=a[401];a[401]=t;
t=a[277];a[277]=a[337];a[337]=t;
t=a[279];a[279]=a[465];a[465]=t;
t=a[281];a[281]=a[305];a[305]=t;
t=a[283];a[283]=a[433];a[433]=t;
t=a[285];a[285]=a[369];a[369]=t;
t=a[287];a[287]=a[497];a[497]=t;
t=a[291];a[291]=a[393];a[393]=t;
t=a[293];a[293]=a[329];a[329]=t;
t=a[295];a[295]=a[457];a[457]=t;
t=a[299];a[299]=a[425];a[425]=t;
t=a[301];a[301]=a[361];a[361]=t;
t=a[303];a[303]=a[489];a[489]=t;
t=a[307];a[307]=a[409];a[409]=t;
t=a[309];a[309]=a[345];a[345]=t;
t=a[311];a[311]=a[473];a[473]=t;
t=a[315];a[315]=a[441];a[441]=t;
t=a[317];a[317]=a[377];a[377]=t;
t=a[319];a[319]=a[505];a[505]=t;
t=a[323];a[323]=a[389];a[389]=t;
t=a[327];a[327]=a[453];a[453]=t;
t=a[331];a[331]=a[421];a[421]=t;
t=a[333];a[333]=a[357];a[357]=t;
t=a[335];a[335]=a[485];a[485]=t;
t=a[339];a[339]=a[405];a[405]=t;
t=a[343];a[343]=a[469];a[469]=t;
t=a[347];a[347]=a[437];a[437]=t;
t=a[349];a[349]=a[373];a[373]=t;
t=a[351];a[351]=a[501];a[501]=t;
t=a[355];a[355]=a[397];a[397]=t;
t=a[359];a[359]=a[461];a[461]=t;
t=a[363];a[363]=a[429];a[429]=t;
t=a[367];a[367]=a[493];a[493]=t;
t=a[371];a[371]=a[413];a[413]=t;
t=a[375];a[375]=a[477];a[477]=t;
t=a[379];a[379]=a[445];a[445]=t;
t=a[383];a[383]=a[509];a[509]=t;
t=a[391];a[391]=a[451];a[451]=t;
t=a[395];a[395]=a[419];a[419]=t;
t=a[399];a[399]=a[483];a[483]=t;
t=a[407];a[407]=a[467];a[467]=t;
t=a[411];a[411]=a[435];a[435]=t;
t=a[415];a[415]=a[499];a[499]=t;
t=a[423];a[423]=a[459];a[459]=t;
t=a[431];a[431]=a[491];a[491]=t;
t=a[439];a[439]=a[475];a[475]=t;
t=a[447];a[447]=a[507];a[507]=t;
t=a[463];a[463]=a[487];a[487]=t;
t=a[479];a[479]=a[503];a[503]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint32_t *a, uint32_t n, const uint32_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	uint64_t u, v;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			u = a[j1];
			v = a[j1 + d];
			
			a[j1] = barrett_4q(u + v);
			a[j1 + d] = barrett_4q(Q2 + u - v);

			j_omega = num_of_problems;
			
			for (j = j1 + 1; j < j2; j++)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = a[j];
				v = a[j + d];
				
				a[j] = barrett_4q(u + v);
				a[j + d] = barrett_4q2((Q2 + u - v) * omega[j_omega]);
				
				j_omega += num_of_problems;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k++)
	{
		j = k << 2;
		
		u = a[j];
		v = a[j + 2];
			
		a[j] = barrett_4q(u + v);
		a[j + 2] = barrett_4q(Q2 + u - v);
		
		u = a[j + 1];
		v = a[j + 3];

		a[j + 1] = barrett_4q(u + v);
		a[j + 3] = barrett_4q2((Q2 + u - v) * omega[num_of_problems]);
	}
	
	for (k = 0; k < (n >> 1); k++)
	{
		j = k << 1;
		
		u = a[j];
		v = a[j + 1];
		
		a[j] = barrett_4q(u + v);				
		a[j + 1] = barrett_4q(Q2 + u - v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), void (*bit_reverse)(uint32_t *))
{
	uint32_t n1, n2;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_2, const uint32_t *omega_n, void (*ntt_butterfly)(uint32_t *, uint32_t), uint32_t inv_n, void (*bit_reverse)(uint32_t *))
{
	uint32_t i, n1, n2;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 1; n2 < N2; n2++)
		{
			a[N2 * n1 + n2] = barrett_2q2((uint64_t)a[N2 * n1 + n2] * (uint64_t)omega_n[n1 * n2]);
		}
	}
	
	for (n2 = 0; n2 < N2; n2++)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i++)
	{
		a[i] = barrett_2q2((uint64_t)a[i] * (uint64_t)inv_n);
	}
}

/* 256 * 4 --> 256 * 7 */
static void ntt_butterfly_1024_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	
	a[n2] = barrett_8q(b + c + d + e);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0] + d * w_7[2][1] + e * w_7[2][2]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0] + d * w_7[3][1] + e * w_7[3][2]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0] + d * w_7[4][1] + e * w_7[4][2]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0] + d * w_7[5][1] + e * w_7[5][2]) % Q;
}

/* 256 * 7 --> 256 * 3 */
static void ntt_butterfly_1792_768(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g, h;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	g = a[N2_1792 * 5 + n2];
	h = a[N2_1792 * 6 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g + h);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2] + f * w_7[0][3] + g * w_7[0][4] + h * w_7[0][5]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2] + f * w_7[1][3] + g * w_7[1][4] + h * w_7[1][5]) % Q;
}

/* 512 * 1 --> 512 * 3 */
static void ntt_butterfly_512_1536(uint32_t *a, uint32_t n2)
{
	a[N2_1536 + n2] = a[n2];
	a[N2_1536 * 2 + n2] = a[n2];
}

/* 512 * 2 --> 512 * 3 */
static void ntt_butterfly_1024_1536(uint32_t *a, uint32_t n2)
{
	uint64_t b, c;
	
	b = a[n2];
	c = a[N2_1536 + n2];
	
	a[n2] = barrett_4q(b + c);
	a[N2_1536 + n2] = (b + c * w_3[0]) % Q;
	a[N2_1536 * 2 + n2] = (b + c * w_3[1]) % Q;
}

/* 512 * 3 --> 512 * 3 */
static void ntt_butterfly_1536_1536_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_1536 + n2];
	d = a[N2_1536 * 2 + n2];

	a[n2] = barrett_8q(b + c + d);
	a[N2_1536 + n2] = (b + c * w_3_inv[0] + d * w_3_inv[1]) % Q;
	a[N2_1536 * 2 + n2] = (b + c * w_3_inv[1] + d * w_3_inv[0]) % Q;
}

/* 256 * 3 --> 256 * 3 */
static void ntt_butterfly_768_768_inv(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d;
	
	b = a[n2];
	c = a[N2_768 + n2];
	d = a[N2_768 * 2 + n2];

	a[n2] = barrett_8q(b + c + d);
	a[N2_768 + n2] = (b + c * w_3_inv[0] + d * w_3_inv[1]) % Q;
	a[N2_768 * 2 + n2] = (b + c * w_3_inv[1] + d * w_3_inv[0]) % Q;	
}

/* 256 * 3 --> 256 * 1 */
static void ntt_butterfly_768_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_8q(a[n2] + a[N2_768 + n2] + a[N2_768 * 2 + n2]);
}

/* 256 * 6 --> 256 * 7 */
static void ntt_butterfly_1536_1792(uint32_t *a, uint32_t n2)
{
	uint64_t b, c, d, e, f, g;
	
	b = a[n2];
	c = a[N2_1792 + n2];
	d = a[N2_1792 * 2 + n2];
	e = a[N2_1792 * 3 + n2];
	f = a[N2_1792 * 4 + n2];
	g = a[N2_1792 * 5 + n2];
	
	a[n2] = barrett_16q(b + c + d + e + f + g);
	a[N2_1792 + n2] = (b + c * w_7[0][0] + d * w_7[0][1] + e * w_7[0][2] + f * w_7[0][3] + g * w_7[0][4]) % Q;
	a[N2_1792 * 2 + n2] = (b + c * w_7[1][0] + d * w_7[1][1] + e * w_7[1][2] + f * w_7[1][3] + g * w_7[1][4]) % Q;
	a[N2_1792 * 3 + n2] = (b + c * w_7[2][0] + d * w_7[2][1] + e * w_7[2][2] + f * w_7[2][3] + g * w_7[2][4]) % Q;
	a[N2_1792 * 4 + n2] = (b + c * w_7[3][0] + d * w_7[3][1] + e * w_7[3][2] + f * w_7[3][3] + g * w_7[3][4]) % Q;
	a[N2_1792 * 5 + n2] = (b + c * w_7[4][0] + d * w_7[4][1] + e * w_7[4][2] + f * w_7[4][3] + g * w_7[4][4]) % Q;
	a[N2_1792 * 6 + n2] = (b + c * w_7[5][0] + d * w_7[5][1] + e * w_7[5][2] + f * w_7[5][3] + g * w_7[5][4]) % Q;
}

/* 256 * 7 --> 256 * 1 */
static void ntt_butterfly_1792_256(uint32_t *a, uint32_t n2)
{
	a[n2] = barrett_16q(a[n2] + a[N2_1792 + n2] + a[N2_1792 * 2 + n2] + a[N2_1792 * 3 + n2] + a[N2_1792 * 4 + n2] + a[N2_1792 * 5 + n2] + a[N2_1792 * 6 + n2]);	
}

void ntt_1024_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1024_1792, bit_reverse_256);
}

void intt_1792_768(uint32_t *a)
{
	intt_core(a, N1_1792, N2_1792, 768, omega_256, omega_1792, ntt_butterfly_1792_768, INV_1792, bit_reverse_256);
}

void ntt_512_1536(uint32_t *a)
{
	ntt_core(a, N1_1536, N2_1536, omega_512, omega_1536, ntt_butterfly_512_1536, bit_reverse_512);
}

void ntt_1024_1536(uint32_t *a)
{
	ntt_core(a, N1_1536, N2_1536, omega_512, omega_1536, ntt_butterfly_1024_1536, bit_reverse_512);
}

void intt_1536_1536_inv(uint32_t *a)
{
	intt_core(a, N1_1536, N2_1536, 1536, omega_512_inv, omega_1536_inv, ntt_butterfly_1536_1536_inv, INV_1536, bit_reverse_512);
}

void ntt_768_768_inv(uint32_t *a)
{
	ntt_core(a, N1_768, N2_768, omega_256_inv, omega_768_inv, ntt_butterfly_768_768_inv, bit_reverse_256);
}

void intt_768_256(uint32_t *a)
{
	intt_core(a, N1_768, N2_768, 256, omega_256, omega_768, ntt_butterfly_768_256, INV_768, bit_reverse_256);
}

void ntt_1536_1792(uint32_t *a)
{
	ntt_core(a, N1_1792, N2_1792, omega_256, omega_1792, ntt_butterfly_1536_1792, bit_reverse_256);
}

void intt_1792_256(uint32_t *a)
{
	intt_core(a, N1_1792, N2_1792, 256, omega_256, omega_1792, ntt_butterfly_1792_256, INV_1792, bit_reverse_256);
}
