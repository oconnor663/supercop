/* ****************************** *
 * Titanium_CCA_super             *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include "fastmodulo.h"
#include <stdint.h>
#include <x86intrin.h>

/* 1280=5*256 */
#define N1_1280 5
#define N2_1280 256

/* 3072=3*1024 */
#define N1_3072 3
#define N2_3072 1024

/* 3328=13*256 */
#define N1_3328 13
#define N2_3328 256

/* multiplication inverses of 1280, 3072, 3328 (in Montgomery form) */
#define INV_1280 485786
#define INV_3072 402091
#define INV_3328 463321

/* omega_n: n-th root of unity mod Q */
static const __m256i w_3[2]={{17202,17202,17202,17202},{1180878,1180878,1180878,1180878}};

static const __m256i w_5[4][4]={{{429875,429875,429875,429875},{502185,502185,502185,502185},{551890,551890,551890,551890},{912211,912211,912211,912211}},
{{502185,502185,502185,502185},{912211,912211,912211,912211},{429875,429875,429875,429875},{551890,551890,551890,551890}},
{{551890,551890,551890,551890},{429875,429875,429875,429875},{912211,912211,912211,912211},{502185,502185,502185,502185}},
{{912211,912211,912211,912211},{551890,551890,551890,551890},{502185,502185,502185,502185},{429875,429875,429875,429875}}};

static const __m256i w_13[12][12]={{{52774,52774,52774,52774},{754832,754832,754832,754832},{508799,508799,508799,508799},{1165135,1165135,1165135,1165135},{921408,921408,921408,921408},{1070326,1070326,1070326,1070326},{657498,657498,657498,657498},{1175611,1175611,1175611,1175611},{268410,268410,268410,268410},{157677,157677,157677,157677},{573453,573453,573453,573453},{1080643,1080643,1080643,1080643}},
{{754832,754832,754832,754832},{1165135,1165135,1165135,1165135},{1070326,1070326,1070326,1070326},{1175611,1175611,1175611,1175611},{157677,157677,157677,157677},{1080643,1080643,1080643,1080643},{52774,52774,52774,52774},{508799,508799,508799,508799},{921408,921408,921408,921408},{657498,657498,657498,657498},{268410,268410,268410,268410},{573453,573453,573453,573453}},
{{508799,508799,508799,508799},{1070326,1070326,1070326,1070326},{268410,268410,268410,268410},{1080643,1080643,1080643,1080643},{754832,754832,754832,754832},{921408,921408,921408,921408},{1175611,1175611,1175611,1175611},{573453,573453,573453,573453},{52774,52774,52774,52774},{1165135,1165135,1165135,1165135},{657498,657498,657498,657498},{157677,157677,157677,157677}},
{{1165135,1165135,1165135,1165135},{1175611,1175611,1175611,1175611},{1080643,1080643,1080643,1080643},{508799,508799,508799,508799},{657498,657498,657498,657498},{573453,573453,573453,573453},{754832,754832,754832,754832},{1070326,1070326,1070326,1070326},{157677,157677,157677,157677},{52774,52774,52774,52774},{921408,921408,921408,921408},{268410,268410,268410,268410}},
{{921408,921408,921408,921408},{157677,157677,157677,157677},{754832,754832,754832,754832},{657498,657498,657498,657498},{1080643,1080643,1080643,1080643},{1165135,1165135,1165135,1165135},{268410,268410,268410,268410},{52774,52774,52774,52774},{1070326,1070326,1070326,1070326},{573453,573453,573453,573453},{508799,508799,508799,508799},{1175611,1175611,1175611,1175611}},
{{1070326,1070326,1070326,1070326},{1080643,1080643,1080643,1080643},{921408,921408,921408,921408},{573453,573453,573453,573453},{1165135,1165135,1165135,1165135},{157677,157677,157677,157677},{508799,508799,508799,508799},{268410,268410,268410,268410},{754832,754832,754832,754832},{1175611,1175611,1175611,1175611},{52774,52774,52774,52774},{657498,657498,657498,657498}},
{{657498,657498,657498,657498},{52774,52774,52774,52774},{1175611,1175611,1175611,1175611},{754832,754832,754832,754832},{268410,268410,268410,268410},{508799,508799,508799,508799},{157677,157677,157677,157677},{1165135,1165135,1165135,1165135},{573453,573453,573453,573453},{921408,921408,921408,921408},{1080643,1080643,1080643,1080643},{1070326,1070326,1070326,1070326}},
{{1175611,1175611,1175611,1175611},{508799,508799,508799,508799},{573453,573453,573453,573453},{1070326,1070326,1070326,1070326},{52774,52774,52774,52774},{268410,268410,268410,268410},{1165135,1165135,1165135,1165135},{1080643,1080643,1080643,1080643},{657498,657498,657498,657498},{754832,754832,754832,754832},{157677,157677,157677,157677},{921408,921408,921408,921408}},
{{268410,268410,268410,268410},{921408,921408,921408,921408},{52774,52774,52774,52774},{157677,157677,157677,157677},{1070326,1070326,1070326,1070326},{754832,754832,754832,754832},{573453,573453,573453,573453},{657498,657498,657498,657498},{508799,508799,508799,508799},{1080643,1080643,1080643,1080643},{1175611,1175611,1175611,1175611},{1165135,1165135,1165135,1165135}},
{{157677,157677,157677,157677},{657498,657498,657498,657498},{1165135,1165135,1165135,1165135},{52774,52774,52774,52774},{573453,573453,573453,573453},{1175611,1175611,1175611,1175611},{921408,921408,921408,921408},{754832,754832,754832,754832},{1080643,1080643,1080643,1080643},{268410,268410,268410,268410},{1070326,1070326,1070326,1070326},{508799,508799,508799,508799}},
{{573453,573453,573453,573453},{268410,268410,268410,268410},{657498,657498,657498,657498},{921408,921408,921408,921408},{508799,508799,508799,508799},{52774,52774,52774,52774},{1080643,1080643,1080643,1080643},{157677,157677,157677,157677},{1175611,1175611,1175611,1175611},{1070326,1070326,1070326,1070326},{1165135,1165135,1165135,1165135},{754832,754832,754832,754832}},
{{1080643,1080643,1080643,1080643},{573453,573453,573453,573453},{157677,157677,157677,157677},{268410,268410,268410,268410},{1175611,1175611,1175611,1175611},{657498,657498,657498,657498},{1070326,1070326,1070326,1070326},{921408,921408,921408,921408},{1165135,1165135,1165135,1165135},{508799,508799,508799,508799},{754832,754832,754832,754832},{52774,52774,52774,52774}}};

/* omega_256,1024,1280,3072,3328 respectively (in Montgomery form) */
static const uint64_t omega_256[128]={2041,86000,1067886,809725,674025,552078,730215,565227,343292,855856,101899,234485,238134,304425,415055,398726,64649,182911,698901,1060799,280412,1179521,930838,939744,1052617,316621,655990,177815,1178604,798278,120664,1030454,475763,825896,618129,718614,602363,7334,570245,1111801,985993,650412,1120902,374498,245376,1087399,449110,245821,540275,374937,623709,265762,856903,949628,76124,411076,913168,776334,645934,926933,423585,599656,810176,399525,27288,1078198,510475,573294,273474,631245,30340,376183,529459,537310,237676,660224,467164,1084033,861414,246867,543846,491359,601955,638198,62095,749179,419217,1010830,585158,604907,584134,3516,412891,714339,446885,585279,911140,881659,798193,252094,425389,699737,1107178,593376,1006361,800125,577109,294516,654975,1183441,930476,865203,1083340,523448,176607,1002671,867705,949853,714876,885113,390771,31764,781932,1010954,1027703,78083,764818,551640};
static const uint64_t omega_1024[512]={2041,793935,920234,785715,86000,70330,351463,376722,1067886,1124347,1118557,259841,809725,756221,53800,991317,674025,101931,43933,945773,552078,889759,994140,1033111,730215,1029726,1020698,595937,565227,544292,479109,358794,343292,788393,303566,354409,855856,252999,122338,791869,101899,12701,415366,445838,234485,23889,552125,935631,238134,1189151,868968,1069501,304425,1192793,829317,708717,415055,142302,1107437,189450,398726,978332,1179556,1088896,64649,797212,524343,178181,182911,7067,906987,1035534,698901,419287,678491,866504,1060799,197840,200799,692621,280412,519644,384281,58903,1179521,1054736,270757,681012,930838,352490,180993,531261,939744,658179,211288,147156,1052617,598775,938953,1084244,316621,1115279,654756,464683,655990,470986,817313,973623,177815,1023776,5822,889948,1178604,159744,159614,32734,798278,366678,849590,127788,120664,356126,135486,445426,1030454,533145,382366,586025,475763,687341,1117537,462402,825896,964064,432879,765392,618129,659161,1169720,1073608,718614,489879,87585,419209,602363,846598,801839,247971,7334,1167579,182073,387260,570245,649536,162287,245420,1111801,854471,99320,1089840,985993,270125,64180,339468,650412,1017263,837620,425878,1120902,152399,179380,155054,374498,95343,802531,923363,245376,1068857,873962,1151321,1087399,999739,507330,346627,449110,1031795,643880,632436,245821,305096,649608,232559,540275,152760,531716,185743,374937,523807,853126,1182762,623709,114836,658403,429912,265762,598216,393369,542224,856903,76790,666018,673666,949628,720315,951974,613849,76124,16002,42899,1134670,411076,1051122,337736,158061,913168,1077785,3042,572830,776334,514792,441053,356649,645934,240978,370652,1133971,926933,135453,413218,745552,423585,81015,1195375,953187,599656,600728,448919,845379,810176,1196397,752578,92475,399525,560075,308264,147333,27288,275306,328512,740085,1078198,406130,1016150,949413,510475,1019985,1098130,690466,573294,31117,418167,783452,273474,936642,26789,986363,631245,281486,369787,289731,30340,857896,1045958,89996,376183,541822,464551,527158,529459,379073,966300,219053,537310,853163,20793,1124672,237676,742143,690644,747022,660224,1009127,85370,653531,467164,681284,1196310,667666,1084033,110685,201270,1152317,861414,885283,219807,75133,246867,127911,240712,111036,543846,43813,828653,60653,491359,333984,90352,723639,601955,448390,329075,91492,638198,1077209,638947,610152,62095,700670,947750,85468,749179,369294,1006644,58124,419217,610171,80639,828399,1010830,549417,688785,130719,585158,827652,281758,635259,604907,933380,437320,307484,584134,1026309,81868,829822,3516,1035454,620821,890391,412891,426400,432293,193456,714339,1109803,102504,603181,446885,58276,567569,433922,585279,945748,527678,1036979,911140,296538,683567,1028356,881659,277026,809151,195997,798193,283718,152057,1043669,252094,437139,130828,691542,425389,643638,396244,952062,699737,37142,308162,47781,1107178,1134747,486228,118452,593376,461853,290072,363156,1006361,979997,408434,868692,800125,971269,276473,269423,577109,160314,715934,270361,294516,1106257,235851,159024,654975,678427,804040,1198066,1183441,88332,1148281,516521,930476,1197259,395809,527502,865203,989104,910299,673803,1083340,632398,208733,49638,523448,502742,661063,629910,176607,1042849,649855,473631,1002671,972800,572648,598702,867705,1034894,74261,593876,949853,939915,825075,162768,714876,435834,55229,1187940,885113,53887,1076229,880548,390771,402738,101720,1036078,31764,1049639,88409,25352,781932,1186116,302970,970794,1010954,670441,198190,542399,1027703,244331,48937,1037353,78083,729905,727166,450064,764818,57905,205473,462121,551640,462271,698040,777032};
static const uint64_t omega_1280[1280]={2041,909480,805934,810505,374893,86000,136068,545398,172715,621268,1067886,469112,1122042,677837,375404,809725,538604,655575,436808,676846,674025,1126337,889978,380213,136768,552078,921079,197773,1134240,725779,730215,806778,270865,188664,1081545,565227,156555,295901,119501,832303,343292,434823,486749,503039,1000801,855856,841902,400663,160765,164922,101899,253559,1016211,831757,817314,234485,697267,1074285,153637,849980,238134,697858,429538,436315,1082912,304425,1193540,1120516,1142507,1044286,415055,537722,407542,21025,371793,398726,587282,880486,50016,340372,64649,69242,215765,1032088,367113,182911,410489,288764,838704,952070,698901,199875,880452,1110849,810640,1060799,333020,268337,61847,316350,280412,177077,46738,1062170,722643,1179521,1192120,251193,274784,362986,930838,1112443,620466,649462,1131552,939744,204736,276453,686991,257374,1052617,357633,605908,236690,718309,316621,317229,939187,986731,721588,655990,1125386,504363,636896,1148560,177815,841091,16384,806737,1092015,1178604,943753,37608,290426,923026,798278,703214,343726,918197,615272,120664,946094,607642,47852,696261,1030454,43442,654177,149620,914339,475763,1048588,866879,22859,868527,825896,555998,958487,315136,1158830,618129,729853,50244,274086,82478,718614,490686,609071,883030,382371,602363,374015,488392,792565,546003,7334,1062683,1172540,920116,257045,570245,820597,26198,181542,945119,1111801,1059341,1072186,1194764,71039,985993,1125316,503695,1041292,591869,650412,456000,414991,913651,24196,1120902,1009267,286259,1157108,362080,374498,253385,877627,912736,700082,245376,1177738,901258,316702,9924,1087399,586860,1150306,742171,441640,449110,862704,154172,683931,1083945,245821,155058,384308,175846,856532,540275,705752,299484,769849,466151,374937,52189,1148419,313393,183732,623709,1125411,675756,150160,63720,265762,379583,130756,597399,703184,856903,64583,718999,494360,781055,949628,778290,923242,1176879,1098446,76124,863364,845088,294143,32,411076,191673,49102,879344,655274,913168,259203,1035840,642534,791592,776334,356882,393356,193728,239867,645934,139420,474693,182605,373338,926933,219406,929910,1172049,1052354,423585,790277,1106094,80646,1146133,599656,793184,859988,607486,1039059,810176,1090602,548964,754439,490250,399525,218367,611917,602111,131994,27288,705407,809655,537936,1059971,1078198,1149443,288934,326863,996892,510475,79066,617592,1169730,1064455,573294,301999,280386,142598,265404,273474,8176,796871,450171,564751,631245,889248,886710,930952,1079300,30340,974148,669972,129195,1061735,376183,782928,899040,877461,876921,529459,739460,210384,946507,371967,537310,506303,997718,39125,1057982,237676,1104258,1055821,182823,478111,660224,104633,930036,694019,84825,467164,658451,840793,82002,1193304,1084033,178199,981679,1118379,197880,861414,655325,1119040,751882,739696,246867,712734,434574,1032067,846145,543846,602906,310735,1082601,951844,491359,718186,383909,890887,525811,601955,1123201,141203,765555,117096,638198,202520,563384,892047,1050344,62095,1106027,867317,1156658,871249,749179,611209,492662,833313,1037548,419217,988210,701471,566709,923777,1010830,746176,822168,588884,793081,585158,552139,955892,974990,404160,604907,706370,750383,1101931,965153,584134,576598,812761,601807,1019096,3516,238938,842454,303238,771442,412891,893611,175266,1193306,810205,714339,1134508,1173338,688115,918487,446885,1183780,342760,190130,445148,585279,758679,1044175,37456,733977,911140,1164084,120573,226377,174892,881659,1190829,889260,441823,553549,798193,360094,321315,1012410,76636,252094,317613,1079775,890645,112731,425389,602107,679650,153089,399749,699737,755547,945825,296997,1019963,1107178,227914,600330,765385,628937,593376,390946,684193,1154907,991463,1006361,395451,898338,1144609,790498,800125,618147,661563,83180,451466,577109,338405,1004343,1129273,267609,294516,448593,960463,539378,115267,654975,1115700,377700,352403,213690,1183441,31447,368556,299374,255336,930476,355909,623687,543276,768621,865203,657252,863582,949861,27434,1083340,411202,911724,279654,922923,523448,647867,260559,1083011,1126911,176607,898025,867775,750258,244966,1002671,17929,136863,724139,29947,867705,749590,649362,445980,490526,949853,1122746,136861,997967,691888,714876,694631,159127,388907,698966,885113,333787,686427,799686,819343,390771,682523,967816,198776,390732,31764,97734,213813,1116153,655870,781932,684150,1051804,247182,715740,1010954,541974,516580,479634,606296,1027703,496422,13422,196546,198297,78083,1018982,36659,829064,517768,764818,383910,753973,793881,79329,551640,985361,195051,12876,670568,1196040,288601,392147,387576,823188,1112081,1062013,652683,1025366,576813,130195,728969,76039,520244,822677,388356,659477,542506,761273,521235,524056,71744,308103,817868,1061313,646003,277002,1000308,63841,472302,467866,391303,927216,1009417,116536,632854,1041526,902180,1078580,365778,854789,763258,711332,695042,197280,342225,356179,797418,1037316,1033159,1096182,944522,181870,366324,380767,963596,500814,123796,1044444,348101,959947,500223,768543,761766,115169,893656,4541,77565,55574,153795,783026,660359,790539,1177056,826288,799355,610799,317595,1148065,857709,1133432,1128839,982316,165993,830968,1015170,787592,909317,359377,246011,499180,998206,317629,87232,387441,137282,865061,929744,1136234,881731,917669,1021004,1151343,135911,475438,18560,5961,946888,923297,835095,267243,85638,577615,548619,66529,258337,993345,921628,511090,940707,145464,840448,592173,961391,479772,881460,880852,258894,211350,476493,542091,72695,693718,561185,49521,1020266,356990,1181697,391344,106066,19477,254328,1160473,907655,275055,399803,494867,854355,279884,582809,1077417,251987,590439,1150229,501820,167627,1154639,543904,1048461,283742,722318,149493,331202,1175222,329554,372185,642083,239594,882945,39251,579952,468228,1147837,923995,1115603,479467,707395,589010,315051,815710,595718,824066,709689,405516,652078,1190747,135398,25541,277965,941036,627836,377484,1171883,1016539,252962,86280,138740,125895,3317,1127042,212088,72765,694386,156789,606212,547669,742081,783090,284430,1173885,77179,188814,911822,40973,836001,823583,944696,320454,285345,497999,952705,20343,296823,881379,1188157,110682,611221,47775,455910,756441,748971,335377,1043909,514150,114136,952260,1043023,813773,1022235,341549,657806,492329,898597,428232,731930,823144,1145892,49662,884688,1014349,574372,72670,522325,1047921,1134361,932319,818498,1067325,600682,494897,341178,1133498,479082,703721,417026,248453,419791,274839,21202,99635,1121957,334717,352993,903938,1198049,787005,1006408,1148979,318737,542807,284913,938878,162241,555547,406489,421747,841199,804725,1004353,958214,552147,1058661,723388,1015476,824743,271148,978675,268171,26032,145727,774496,407804,91987,1117435,51948,598425,404897,338093,590595,159022,387905,107479,649117,443642,707831,798556,979714,586164,595970,1066087,1170793,492674,388426,660145,138110,119883,48638,909147,871218,201189,687606,1119015,580489,28351,133626,624787,896082,917695,1055483,932677,924607,1189905,401210,747910,633330,566836,308833,311371,267129,118781,1167741,223933,528109,1068886,136346,821898,415153,299041,320620,321160,668622,458621,987697,251574,826114,660771,691778,200363,1158956,140099,960405,93823,142260,1015258,719970,537857,1093448,268045,504062,1113256,730917,539630,357288,1116079,4777,114048,1019882,216402,79702,1000201,336667,542756,79041,446199,458385,951214,485347,763507,166014,351936,654235,595175,887346,115480,246237,706722,479895,814172,307194,672270,596126,74880,1056878,432526,1080985,559883,995561,634697,306034,147737,1135986,92054,330764,41423,326832,448902,586872,705419,364768,160533,778864,209871,496610,631372,274304,187251,451905,375913,609197,405000,612923,645942,242189,223091,793921,593174,491711,447698,96150,232928,613947,621483,385320,596274,178985,1194565,959143,355627,894843,426639,785190,304470,1022815,4775,387876,483742,63573,24743,509966,279594,751196,14301,855321,1007951,752933,612802,439402,153906,1160625,464104,286941,33997,1077508,971704,1023189,316422,7252,308821,756258,644532,399888,837987,876766,185671,1121445,945987,880468,118306,307436,1085350,772692,595974,518431,1044992,798332,498344,442534,252256,901084,178118,90903,970167,597751,432696,569144,604705,807135,513888,43174,206618,191720,802630,299743,53472,407583,397956,579934,536518,1114901,746615,620972,859676,193738,68808,930472,903565,749488,237618,658703,1082814,543106,82381,820381,845678,984391,14640,1166634,829525,898707,942745,267605,842172,574394,654805,429460,332878,540829,334499,248220,1170647,114741,786879,286357,918427,275158,674633,550214,937522,115070,71170,1021474,300056,330306,447823,953115,195410,1180152,1061218,473942,1168134,330376,448491,548719,752101,707555,248228,75335,1061220,200114,506193,483205,503450,1038954,809174,499115,312968,864294,511654,398395,378738,807310,515558,230265,999305,807349,1166317,1100347,984268,81928,542211,416149,513931,146277,950899,482341,187127,656107,681501,718447,591785,170378,701659,1184659,1001535,999784,1119998,179099,1161422,369017,680313,433263,814171,444108,404200,1118752,646441,212720,1003030,1185205,527513};
static const uint64_t omega_3072[3072]={2041,887479,964123,793935,1165022,490463,920234,82603,657569,785715,349101,814009,86000,467572,145081,70330,1079492,225498,351463,470993,837225,376722,824145,40358,1067886,453169,1050816,1124347,201055,39080,1118557,942477,1001569,259841,929425,1095329,809725,171483,352852,756221,834149,534305,53800,632425,316445,991317,235085,943503,674025,609489,732720,101931,613088,1078444,43933,531469,646226,945773,1142752,525970,552078,1110622,568052,889759,901848,905330,994140,812194,616383,1033111,769803,153146,730215,130941,908452,1029726,801830,69212,1020698,239187,458376,595937,1018798,490763,565227,1137699,950369,544292,971218,245450,479109,226697,1141081,358794,809368,677807,343292,407789,198920,788393,239172,56798,303566,1004158,323122,354409,27950,271769,855856,921418,470643,252999,743218,482545,122338,541763,118087,791869,406967,237136,101899,634981,215103,12701,333579,276353,415366,893153,152303,445838,712441,85684,234485,455436,959995,23889,17485,55778,552125,292226,525683,935631,69298,287940,238134,542312,678486,1189151,942791,861624,868968,37808,1090243,1069501,958178,181240,304425,678548,772333,1192793,922136,204059,829317,245905,280138,708717,387080,252220,415055,394565,560115,142302,511439,347304,1107437,762768,1109862,189450,453267,160088,398726,296703,495358,978332,844607,642765,1179556,56704,742277,1088896,231378,821428,64649,585700,197539,797212,158563,1105104,524343,205039,308604,178181,38537,479173,182911,471601,421258,7067,219472,206025,906987,946254,1000873,1035534,1021534,416033,698901,213792,1096830,419287,194898,619747,678491,923650,1040248,866504,525488,507441,1060799,97620,454963,197840,628721,753918,200799,214224,202234,692621,616530,895100,280412,296618,216551,519644,761647,491520,384281,557252,491120,58903,1147259,100720,1179521,717130,60078,1054736,239576,1128240,270757,200381,125801,681012,284653,577514,930838,1064617,555594,352490,329965,727132,180993,960132,416880,531261,189490,725421,939744,437766,1143106,658179,742780,258045,211288,114275,254910,147156,110867,789393,1052617,378902,81485,598775,799404,456014,938953,267573,581613,1084244,1167671,961975,316621,271865,790177,1115279,564339,846669,654756,875685,871135,464683,436807,788331,655990,1004877,243054,470986,729694,666,817313,521230,650016,973623,734136,630767,177815,64298,1013039,1023776,454636,309239,5822,434766,1098933,889948,210942,276113,1178604,1007541,1116144,159744,933596,300915,159614,648136,163195,32734,1192049,1131628,798278,103173,1036327,366678,58044,274788,849590,341137,1021025,127788,1081275,915089,120664,1013120,556519,356126,388295,431851,135486,382324,960145,445426,545033,202178,1030454,4244,840444,533145,547901,785940,382366,407250,305600,586025,911189,1141512,475763,344362,1098463,687341,634632,1015474,1117537,1191036,289637,462402,312566,1136677,825896,751842,1171827,964064,572220,733878,432879,180974,1010571,765392,512717,296633,618129,812015,776287,659161,595099,468920,1169720,945420,1197059,1073608,207550,200609,718614,93111,507181,489879,1020261,201203,87585,169425,1086925,419209,23622,537115,602363,291533,662843,846598,591011,1169109,801839,549775,477272,247971,1038193,962044,7334,897923,857521,1167579,575637,679958,182073,1119804,1100215,387260,278832,329264,570245,175645,275956,649536,103937,962912,162287,803708,506608,245420,874034,840036,1111801,23512,387732,854471,184173,1030917,99320,40698,985033,1089840,184575,531246,985993,433050,925104,270125,932288,746511,64180,569609,161488,339468,28800,663677,650412,552937,785012,1017263,530062,597953,837620,967601,136681,425878,290748,413665,1120902,1022932,1181824,152399,380159,906302,179380,828155,366974,155054,772686,1138486,374498,548587,541249,95343,1076786,1103384,802531,226099,1026046,923363,225720,1023261,245376,1053897,701263,1068857,649974,328437,873962,589775,666885,1151321,541520,321777,1087399,169799,157130,999739,388646,4512,507330,724900,809469,346627,634610,506365,449110,1169564,602868,1031795,921352,141397,643880,678802,224157,632436,1170040,726490,245821,187847,988369,305096,32279,192939,649608,354198,209747,232559,649920,1039302,540275,537071,782226,152760,619899,274979,531716,1188600,9360,185743,331192,748793,374937,959603,1190639,523807,871267,1123175,853126,917163,1172766,1182762,184581,452261,623709,438906,512928,114836,657339,1017951,658403,589529,311027,429912,301424,447859,265762,659979,1008900,598216,770007,1061899,393369,330045,73359,542224,1038212,911605,856903,916467,750378,76790,703366,341437,666018,1182884,175994,673666,742781,444561,949628,115251,186214,720315,1063443,834633,951974,382222,1104809,613849,445481,20684,76124,1084134,1018288,16002,209261,639939,42899,564966,380263,1134670,289556,929659,411076,1057621,399867,1051122,690355,893867,337736,464958,211224,158061,924390,84692,913168,49647,1189884,1077785,532232,386295,3042,689359,826486,572830,690943,341823,776334,1038846,552730,514792,337170,328030,441053,803726,269653,356649,891602,801589,645934,396746,3971,240978,243933,281453,370652,858570,337579,1133971,505701,4829,926933,1152885,1118861,135453,217701,556545,413218,415839,457227,745552,907486,567420,423585,324477,288498,81015,396168,25013,1195375,877886,451068,953187,188821,546641,599656,982903,375571,600728,848528,1142591,448919,289357,953486,845379,863397,891480,810176,424529,277674,1196397,1002359,243518,752578,668288,453530,92475,493024,553391,399525,760943,973166,560075,1068229,929864,308264,261034,599947,147333,776012,884744,27288,200520,891824,275306,420317,613418,328512,485690,853549,740085,791445,397529,1078198,886156,1008141,406130,1071855,321115,1016150,205767,709099,949413,749065,787887,510475,258030,1007791,1019985,240270,1177596,1098130,877725,374017,690466,31685,823968,573294,972535,280417,31117,314008,524524,418167,961153,354837,783452,1185986,75503,273474,176090,607987,936642,538257,345217,26789,579354,271031,986363,1153353,948436,631245,674469,755004,281486,535275,64089,369787,65084,250652,289731,23691,227828,30340,358877,715143,857896,424300,696426,1045958,778855,399849,89996,579126,876299,376183,930825,1036071,541822,339802,24932,464551,976396,372012,527158,488101,65169,529459,748419,106651,379073,825615,1056410,966300,689808,706500,219053,1129167,647425,537310,1030553,498113,853163,629769,935483,20793,38991,93686,1124672,914705,383380,237676,181735,377608,742143,57372,734541,690644,883346,459578,747022,725457,465834,660224,1178242,581285,1009127,1004513,641847,85370,374430,1044390,653531,28975,955790,467164,723737,744022,681284,697603,128386,1196310,350520,704312,667666,654435,908099,1084033,151387,922765,110685,389749,859809,201270,603347,516884,1152317,608901,86683,861414,39200,736938,885283,1118689,402888,219807,388673,248120,75133,751252,152758,246867,1194461,529764,127911,61123,676753,240712,950079,368297,111036,1160491,33572,543846,452671,418085,43813,913088,703420,828653,999705,37507,60653,474146,664402,491359,307230,294531,333984,336230,1120897,90352,1084367,147519,723639,436669,208824,601955,870189,138454,448390,1063116,946032,329075,63070,804862,91492,454189,802257,638198,1196575,655939,1077209,926306,421210,638947,721582,159177,610152,990485,804303,62095,1060074,256673,700670,688321,113919,947750,875936,961492,85468,681783,318769,749179,485253,815565,369294,364933,465656,1006644,344551,407557,58124,819096,12740,419217,317669,453430,610171,940046,455791,80639,952931,363965,828399,349800,597864,1010830,1149796,49817,549417,797080,698152,688785,395511,886344,130719,236654,57262,585158,942752,775986,827652,1197825,175144,281758,948225,813042,635259,549068,399370,604907,348161,408795,933380,748213,22947,437320,624559,830814,307484,944436,971708,584134,445247,704937,1026309,855750,320018,81868,149543,836508,829822,986167,538647,3516,439949,959994,1035454,477226,54802,620821,917148,771188,890391,169941,284620,412891,527238,1032409,426400,607539,45063,432293,1106050,850572,193456,33819,1086220,714339,659157,1047116,1109803,1165816,22123,102504,857547,26590,603181,705334,792139,446885,707490,365419,58276,415584,818887,567569,658606,113685,433922,628040,733108,585279,747649,259051,945748,74095,38685,527678,431860,616049,1036979,968929,1025243,911140,388795,239533,296538,870324,158413,683567,1194876,58639,1028356,466163,921857,881659,902389,1171682,277026,142129,592358,809151,938589,666366,195997,728980,1013314,798193,1022447,577639,283718,1104880,677594,152057,89980,1189113,1043669,360567,831880,252094,875659,814043,437139,411431,178265,130828,199521,264895,691542,643374,950105,425389,138580,1185867,643638,1069008,59946,396244,1021338,999408,952062,22496,184274,699737,390638,139274,37142,272930,548271,308162,405698,768370,47781,594518,1128495,1107178,378364,374681,1134747,274316,273951,486228,560353,204113,118452,579592,332842,593376,187560,173841,461853,950248,739395,290072,127354,404758,363156,895161,875159,1006361,276087,1121512,979997,1090768,747759,408434,693640,181455,868692,76875,982173,800125,748978,136048,971269,173118,993938,276473,33747,835959,269423,588885,2823,577109,870961,359086,160314,618507,628284,715934,1028089,985793,270361,621067,74925,294516,1130487,43859,1106257,1120792,873549,235851,45039,748233,159024,827148,644079,654975,987935,826660,678427,967436,511647,804040,129708,965776,1198066,796503,905710,1183441,1030440,987263,88332,519481,311564,1148281,225193,971971,516521,539545,961625,930476,638361,448577,1197259,38216,511587,395809,158305,907216,527502,1151312,60957,865203,1078615,788063,989104,813122,1179567,910299,477450,1099632,673803,1135772,958337,1083340,288547,833732,632398,72837,225433,208733,402133,773785,49638,709321,423130,523448,1004559,835016,502742,419326,280536,661063,716555,640668,629910,876457,1091767,176607,1190279,470583,1042849,771815,423985,649855,896572,471415,473631,455142,37936,1002671,928622,1083106,972800,585836,404014,572648,291299,149015,598702,362627,470839,867705,490057,673841,1034894,261313,1120428,74261,1048316,887856,593876,1193323,334893,949853,148516,977536,939915,1181896,402660,825075,976574,25592,162768,661829,1016172,714876,179445,970885,435834,218494,1099770,55229,1189807,1093025,1187940,311143,500310,885113,561075,683593,53887,86183,1053732,1076229,248938,488934,880548,951126,363346,390771,984282,1191801,402738,996351,1059206,101720,794885,1039234,1036078,649353,715858,31764,1181760,196185,1049639,843838,981681,88409,504241,853937,25352,926006,776217,781932,428782,400600,1186116,360963,411194,302970,64074,1166290,970794,236012,122090,1010954,316160,549821,670441,665343,1083089,198190,14866,387422,542399,132244,728357,1027703,875477,414399,244331,233799,700127,48937,552434,417782,1037353,39134,407692,78083,1054273,144500,729905,1016950,856523,727166,532132,903991,450064,591759,507600,764818,81742,610147,57905,706846,57215,205473,985121,730114,462121,617134,931150,551640,886122,657002,462271,1038671,260617,698040,166370,369020,777032,636185,739220,1196040,310602,233958,404146,33059,707618,277847,1115478,540512,412366,848980,384072,1112081,730509,1053000,1127751,118589,972583,846618,727088,360856,821359,373936,1157723,130195,744912,147265,73734,997026,1159001,79524,255604,196512,938240,268656,102752,388356,1026598,845229,441860,363932,663776,1144281,565656,881636,206764,962996,254578,524056,588592,465361,1096150,584993,119637,1154148,666612,551855,252308,55329,672111,646003,87459,630029,308322,296233,292751,203941,385887,581698,164970,428278,1044935,467866,1067140,289629,168355,396251,1128869,177383,958894,739705,602144,179283,707318,632854,60382,247712,653789,226863,952631,718972,971384,57000,839287,388713,520274,854789,790292,999161,409688,958909,1141283,894515,193923,874959,843672,1170131,926312,342225,276663,727438,945082,454863,715536,1075743,656318,1079994,406212,791114,960945,1096182,563100,982978,1185380,864502,921728,782715,304928,1045778,752243,485640,1112397,963596,742645,238086,1174192,1180596,1142303,645956,905855,672398,262450,1128783,910141,959947,655769,519595,8930,255290,336457,329113,1160273,107838,128580,239903,1016841,893656,519533,425748,5288,275945,994022,368764,952176,917943,489364,811001,945861,783026,803516,637966,1055779,686642,850777,90644,435313,88219,1008631,744814,1037993,799355,901378,702723,219749,353474,555316,18525,1141377,455804,109185,966703,376653,1133432,612381,1000542,400869,1039518,92977,673738,993042,889477,1019900,1159544,718908,1015170,726480,776823,1191014,978609,992056,291094,251827,197208,162547,176547,782048,499180,984289,101251,778794,1003183,578334,519590,274431,157833,331577,672593,690640,137282,1100461,743118,1000241,569360,444163,997282,983857,995847,505460,581551,302981,917669,901463,981530,678437,436434,706561,813800,640829,706961,1139178,50822,1097361,18560,480951,1138003,143345,958505,69841,927324,997700,1072280,517069,913428,620567,267243,133464,642487,845591,868116,470949,1017088,237949,781201,666820,1008591,472660,258337,760315,54975,539902,455301,940036,986793,1083806,943171,1050925,1087214,408688,145464,819179,1116596,599306,398677,742067,259128,930508,616468,113837,30410,236106,881460,926216,407904,82802,633742,351412,543325,322396,326946,733398,761274,409750,542091,193204,955027,727095,468387,1197415,380768,676851,548065,224458,463945,567314,1020266,1133783,185042,174305,743445,888842,1192259,763315,99148,308133,987139,921968,19477,190540,81937,1038337,264485,897166,1038467,549945,1034886,1165347,6032,66453,399803,1094908,161754,831403,1140037,923293,348491,856944,177056,1070293,116806,282992,1077417,184961,641562,841955,809786,766230,1062595,815757,237936,752655,653048,995903,167627,1193837,357637,664936,650180,412141,815715,790831,892481,612056,286892,56569,722318,853719,99618,510740,563449,182607,80544,7045,908444,735679,885515,61404,372185,446239,26254,234017,625861,464203,765202,1017107,187510,432689,685364,901448,579952,386066,421794,538920,602982,729161,28361,252661,1022,124473,990531,997472,479467,1104970,690900,708202,177820,996878,1110496,1028656,111156,778872,1174459,660966,595718,906548,535238,351483,607070,28972,396242,648306,720809,950110,159888,236037,1190747,300158,340560,30502,622444,518123,1016008,78277,97866,810821,919249,868817,627836,1022436,922125,548545,1094144,235169,1035794,394373,691473,952661,324047,358045,86280,1174569,810349,343610,1013908,167164,1098761,1157383,213048,108241,1013506,666835,212088,765031,272977,927956,265793,451570,1133901,628472,1036593,858613,1169281,534404,547669,645144,413069,180818,668019,600128,360461,230480,1061400,772203,907333,784416,77179,175149,16257,1045682,817922,291779,1018701,369926,831107,1043027,425395,59595,823583,649494,656832,1102738,121295,94697,395550,971982,172035,274718,972361,174820,952705,144184,496818,129224,548107,869644,324119,608306,531196,46760,656561,876304,110682,1028282,1040951,198342,809435,1193569,690751,473181,388612,851454,563471,691716,748971,28517,595213,166286,276729,1056684,554201,519279,973924,565645,28041,471591,952260,1010234,209712,892985,1165802,1005142,548473,843883,988334,965522,548161,158779,657806,661010,415855,1045321,578182,923102,666365,9481,1188721,1012338,866889,449288,823144,238478,7442,674274,326814,74906,344955,280918,25315,15319,1013500,745820,574372,759175,685153,1083245,540742,180130,539678,608552,887054,768169,896657,750222,932319,538102,189181,599865,428074,136182,804712,868036,1124722,655857,159869,286476,341178,281614,447703,1121291,494715,856644,532063,15197,1022087,524415,455300,753520,248453,1082830,1011867,477766,134638,363448,246107,815859,93272,584232,752600,1177397,1121957,113947,179793,1182079,988820,558142,1155182,633115,817818,63411,908525,268422,787005,140460,798214,146959,507726,304214,860345,733123,986857,1040020,273691,1113389,284913,1148434,8197,120296,665849,811786,1195039,508722,371595,625251,507138,856258,421747,159235,645351,683289,860911,870051,757028,394355,928428,841432,306479,396492,552147,801335,1194110,957103,954148,916628,827429,339511,860502,64110,692380,1193252,271148,45196,79220,1062628,980380,641536,784863,782242,740854,452529,290595,630661,774496,873604,909583,1117066,801913,1173068,2706,320195,747013,244894,1009260,651440,598425,215178,822510,597353,349553,55490,749162,908724,244595,352702,334684,306601,387905,773552,920407,1684,195722,954563,445503,529793,744551,1105606,705057,644690,798556,437138,224915,638006,129852,268217,889817,937047,598134,1050748,422069,313337,1170793,997561,306257,922775,777764,584663,869569,712391,344532,457996,406636,800552,119883,311925,189940,791951,126226,876966,181931,992314,488982,248668,449016,410194,687606,940051,190290,178096,957811,20485,99951,320356,824064,507615,1166396,374113,624787,225546,917664,1166964,884073,673557,779914,236928,843244,414629,12095,1122578,924607,1021991,590094,261439,659824,852864,1171292,618727,927050,211718,44728,249645,566836,523612,443077,916595,662806,1133992,828294,1132997,947429,908350,1174390,970253,1167741,839204,482938,340185,773781,501655,152123,419226,798232,1108085,618955,321782,821898,267256,162010,656259,858279,1173149,733530,221685,826069,670923,709980,1132912,668622,449662,1091430,819008,372466,141671,231781,508273,491581,979028,68914,550656,660771,167528,699968,344918,568312,262598,1177288,1159090,1104395,73409,283376,814701,960405,1016346,820473,455938,1140709,463540,507437,314735,738503,451059,472624,732247,537857,19839,616796,188954,193568,556234,1112711,823651,153691,544550,1169106,242291,730917,474344,454059,516797,500478,1069695,1771,847561,493769,530415,543646,289982,114048,1046694,275316,1087396,808332,338272,996811,594734,681197,45764,589180,1111398,336667,1158881,461143,312798,79392,795193,978274,809408,949961,1122948,446829,1045323,951214,3620,668317,1070170,1136958,521328,957369,248002,829784,1087045,37590,1164509,654235,745410,779996,1154268,284993,494661,369428,198376,1160574,1137428,723935,533679,706722,890851,903550,864097,861851,77184,1107729,113714,1050562,474442,761412,989257,596126,327892,1059627,749691,134965,252049,869006,1135011,393219,1106589,743892,395824,559883,1506,542142,120872,271775,776871,559134,476499,1038904,587929,207596,393778,1135986,138007,941408,497411,509760,1084162,250331,322145,236589,1112613,516298,879312,448902,712828,382516,828787,833148,732425,191437,853530,790524,1139957,378985,1185341,778864,880412,744651,587910,258035,742290,1117442,245150,834116,369682,848281,600217,187251,48285,1148264,648664,401001,499929,509296,802570,311737,1067362,961427,1140819,612923,255329,422095,370429,256,1022937,916323,249856,385039,562822,649013,798711,593174,849920,789286,264701,449868,1175134,760761,573522,367267,890597,253645,226373,613947,752834,493144,171772,342331,878063,1116213,1048538,361573,368259,211914,659434,1194565,758132,238087,162627,720855,1143279,577260,280933,426893,307690,1028140,913461,785190,670843,165672,771681,590542,1153018,765788,92031,347509,1004625,1164262,111861,483742,538924,150965,88278,32265,1175958,1095577,340534,1171491,594900,492747,405942,751196,490591,832662,1139805,782497,379194,630512,539475,1084396,764159,570041,464973,612802,450432,939030,252333,1123986,1159396,670403,766221,582032,161102,229152,172838,286941,809286,958548,901543,327757,1039668,514514,3205,1139442,169725,731918,276224,316422,295692,26399,921055,1055952,605723,388930,259492,531715,1002084,469101,184767,399888,175634,620442,914363,93201,520487,1046024,1108101,8968,154412,837514,366201,945987,322422,384038,760942,786650,1019816,1067253,998560,933186,506539,554707,247976,772692,1059501,12214,554443,129073,1138135,801837,176743,198673,246019,1175585,1013807,498344,807443,1058807,1160939,925151,649810,889919,792383,429711,1150300,603563,69586,90903,819717,823400,63334,923765,924130,711853,637728,993968,1079629,618489,865239,604705,1010521,1024240,736228,247833,458686,908009,1070727,793323,834925,302920,322922,191720,921994,76569,218084,107313,450322,789647,504441,1016626,329389,1121206,215908,397956,449103,1062033,226812,1024963,204143,921608,1164334,362122,928658,609196,1195258,620972,327120,838995,1037767,579574,569797,482147,169992,212288,927720,577014,1123156,903565,67594,1154222,91824,77289,324532,962230,1153042,449848,1039057,370933,554002,543106,210146,371421,519654,230645,686434,394041,1068373,232305,15,401578,292371,14640,167641,210818,1109749,678600,886517,49800,972888,226110,681560,658536,236456,267605,559720,749504,822,1159865,686494,802272,1039776,290865,670579,46769,1137124,332878,119466,410018,208977,384959,18514,287782,720631,98449,524278,62309,239744,114741,909534,364349,565683,1125244,972648,989348,795948,424296,1148443,488760,774951,674633,193522,363065,695339,778755,917545,537018,481526,557413,568171,321624,106314,1021474,7802,727498,155232,426266,774096,548226,301509,726666,724450,742939,1160145,195410,269459,114975,225281,612245,794067,625433,906782,1049066,599379,835454,727242,330376,708024,524240,163187,936768,77653,1123820,149765,310225,604205,4758,863188,248228,1049565,220545,258166,16185,795421,373006,221507,1172489,1035313,536252,181909,483205,1018636,227196,762247,979587,98311,1142852,8274,105056,10141,886938,697771,312968,637006,514488,1144194,1111898,144349,121852,949143,709147,317533,246955,834735,807310,213799,6280,795343,201730,138875,1096361,403196,158847,162003,548728,482223,1166317,16321,1001896,148442,354243,216400,1109672,693840,344144,1172729,272075,421864,416149,769299,797481,11965,837118,786887,895111,1134007,31791,227287,962069,1075991,187127,881921,648260,527640,532738,114992,999891,1183215,810659,655682,1065837,469724,170378,322604,783682,953750,964282,497954,1149144,645647,780299,160728,1158947,790389,1119998,143808,1053581,468176,181131,341558,470915,665949,294090,748017,606322,690481,433263,1116339,587934,1140176,491235,1140866,992608,212960,467967,735960,580947,266931,646441,311959,541079,735810,159410,937464,500041,1031711,829061,421049,561896,458861};
static const uint64_t omega_3328[3328]={2041,1135482,956680,503684,627991,1083529,1141888,1172869,692851,1047196,429483,568091,190538,86000,312025,1011932,713901,339941,724537,1048620,997469,126121,805523,218904,284346,604673,1067886,292100,1136418,912710,751639,958184,13191,524654,979215,1039950,1143635,1016561,734527,809725,303109,908534,1132133,773524,659704,323364,1060386,982344,240160,954935,603578,804445,674025,124214,682627,698043,762334,2650,730553,284729,584121,906946,397771,101968,381105,552078,192692,430253,414159,304918,201473,747353,847205,1010272,812362,202272,973499,530227,730215,234047,860662,22269,850842,258298,916956,792817,390827,684173,220937,447403,688833,565227,703959,422981,663612,313860,769570,768649,389514,579453,788312,466776,559558,66588,343292,851279,1110730,655121,203297,815268,900319,424924,969137,166818,626842,1145185,426627,855856,201958,245849,1028166,468405,137433,417485,1136835,1131201,704666,848009,1095383,1040709,101899,1129307,215079,348831,363236,190860,587994,686606,1082004,1026647,183922,1000957,1180828,234485,486806,1067580,536875,110715,459162,871157,1113892,122581,19499,1108967,64660,812743,238134,594429,84792,839813,1050322,912395,52196,148977,673909,1000064,11897,1082082,24582,304425,928633,891953,382729,270988,1196345,1044112,1158039,872392,1022596,632784,72450,329036,415055,191147,879152,838155,1092369,992856,852264,882698,256856,856696,469698,806293,64972,398726,720146,305133,127373,234708,187050,229374,883063,744030,1128748,407739,483627,881558,64649,1123020,236500,1157589,386651,1064667,36277,1093916,487543,646398,646353,717587,601986,182911,764290,1139565,803275,129947,712831,569406,238844,934836,843758,1195240,1062741,449314,698901,522348,130102,1133070,701347,1016724,929110,616105,889251,1118940,305284,660440,1128470,1060799,115582,955008,940629,379623,422017,299297,606328,1110460,1082525,707772,696980,794350,280412,149478,919174,529903,284635,839417,239484,853571,1156660,233172,382086,436874,556248,1179521,1158604,510490,344109,569699,360760,542694,111279,125467,83605,775254,982915,907097,930838,995730,56773,438286,264637,626852,863115,319196,17143,472123,694935,969777,85553,939744,183117,944053,843416,59305,903022,858587,1043906,978276,1168541,568485,1057790,1124775,1052617,873704,1155523,1154425,975605,1030335,389553,677461,249523,430614,1014161,140710,235383,316621,765308,1178783,409912,291947,659765,998899,524865,1017943,91045,579349,127597,1104826,655990,851115,944354,739676,539683,1176886,4946,663655,299040,667041,636618,952183,353977,177815,737442,55828,736119,233178,212844,1091264,1011485,143539,709207,954689,354014,332237,1178604,666641,1136689,457099,356229,153944,745217,1193307,475146,488925,2916,415977,542075,798278,904849,841881,226134,21506,807325,907373,334192,1145645,630298,706354,1157833,692629,120664,178673,497456,183280,1138636,649796,645447,1113428,31738,930822,248961,707895,821762,1030454,627163,477305,692143,650375,1086728,763770,232152,399282,612107,1041223,1178554,878910,475763,1056421,203485,304676,1037162,711405,57834,462684,966826,656821,174637,523213,890748,825896,636573,1023417,238376,956821,120740,431103,399829,757931,795728,947839,680923,839531,618129,108090,221515,916891,230110,490088,744443,261986,1122587,469321,657603,880302,748292,718614,387341,771133,1010105,730607,1157713,483226,211755,658581,849719,784653,641223,451696,602363,331601,1147041,789999,804807,47739,69071,992090,893368,6497,45514,529434,334827,7334,397875,762683,941136,455646,606246,1027272,525762,875965,877789,945704,998818,413470,570245,534791,188134,803092,499504,1121313,462609,686189,863513,1073620,294097,1116846,664773,1111801,397449,798055,6524,482006,1078027,586272,137739,172710,964457,386668,585148,692301,985993,347783,1170228,906516,545971,1127258,503334,915793,51290,544818,103661,549894,694649,650412,43069,6851,842965,799852,836028,1184608,241234,612642,327450,822360,935802,1151659,1120902,74876,189471,230844,153527,526726,42199,585321,604814,684942,95212,452718,528753,374498,15091,844999,934702,1029253,957502,81069,423346,1150786,585912,707611,445983,8019,245376,1191186,398143,391693,218531,22828,658182,123502,398634,919028,1053882,1134279,145352,1087399,1006169,331826,790871,169923,504020,735087,588858,277378,665765,686320,762639,984163,449110,462724,1036627,227097,414028,405792,290930,592340,303246,638418,498985,185693,167681,245821,619881,1008828,808516,859104,837859,1055074,1057803,758084,74300,861650,907697,779772,540275,53395,1073133,852015,717755,655534,534616,332035,886013,200969,586709,990171,1108956,374937,811109,801294,896288,309646,1023849,33762,149661,549617,121421,391432,392072,310807,623709,859722,179067,166627,23974,681147,511568,1087069,729831,282806,912537,839126,61154,265762,44083,158897,13342,1057721,674896,715618,1029843,1088506,931126,60600,317387,724204,856903,621254,619209,794636,599777,191962,653986,1068136,428836,846805,312262,317278,204524,949628,538002,669613,1171155,1116409,1010422,175555,986969,373614,988459,278019,556293,1108287,76124,929565,960811,194424,697050,17941,726476,268892,414167,79262,1073993,555615,1063337,411076,1005267,614839,656883,821965,96757,3819,104757,785128,421789,740088,899209,584588,913168,1011724,590552,417960,917401,221512,1001512,1100996,861510,64353,1085725,301447,1063409,776334,471380,87278,205909,221525,634821,122679,849456,1014608,711072,1064198,86469,261833,645934,555510,430829,940061,826146,773309,733804,836009,522460,565161,169459,413177,448329,926933,920613,674784,280559,795373,178595,301440,62777,12879,938671,497203,131165,1101054,423585,399718,294665,670323,313481,677294,167768,187974,523888,1020319,163749,932293,689299,599656,10766,636012,74410,155042,924037,1138577,1115928,201017,430854,234886,1156609,473648,810176,760643,975528,806112,378115,1025338,1164455,806511,1104332,213276,886650,204325,572416,399525,946292,1186236,1045397,854474,845440,476225,5597,272113,613576,339894,852185,714889,27288,653467,132516,133908,406437,68630,252486,718943,691886,711088,612886,633428,1076438,1078198,555199,816639,567114,192914,158704,664969,375553,208731,892798,509434,178676,412835,510475,767214,131805,1019789,736487,635731,812091,657883,170828,136386,1196270,763475,166650,573294,793480,858882,1109408,804264,987168,750826,1126936,1340,541212,1179299,232072,259680,273474,562441,215315,880465,942875,524994,973483,981539,183256,617523,428398,22580,465032,631245,352107,209341,459662,1144629,534666,119766,348858,799728,739453,839439,817011,856839,30340,827535,1130459,68802,193206,308827,163762,565602,909063,587602,961021,261359,837161,376183,409536,115050,386079,425937,1149390,426211,609158,357996,631577,572031,476491,889102,529459,827733,337797,98214,839055,865770,908714,847197,37847,1137923,394010,757367,1129423,537310,1019561,1177278,928612,286219,488526,474780,29958,819880,202383,238684,655632,166492,237676,334344,452424,435044,657575,472017,90634,191616,828960,472157,933978,1083744,1067788,660224,32696,266298,500184,1109849,345787,1161593,65437,461362,1115969,242611,110195,749830,467164,397971,450973,628647,550952,803668,1025406,444460,1034445,672640,852317,585808,46896,1084033,104451,1029903,594167,286540,1018727,740296,1022558,506569,720304,640751,586509,641166,861414,376063,200133,206141,865987,778200,552682,1126879,411058,314912,1047831,489253,335668,246867,1067384,75042,299433,364419,368247,219141,787773,95296,479492,105565,757411,1086396,543846,1163083,1167923,29196,748156,960523,1129554,436436,930104,134210,274490,658073,801903,491359,835776,1104286,312717,661984,707778,527738,250659,735649,311577,469777,974102,294540,601955,1057328,977518,983989,564804,654710,1013645,318550,267650,702912,3685,290252,547390,638198,714120,153013,648152,292596,324637,1095305,844693,1179477,3550,503954,200587,579054,62095,80757,837363,668774,875208,665030,1051088,871291,928397,360319,1001171,1134935,810856,749179,858706,83435,778120,413080,788246,1130357,549754,1049386,956365,1002322,1016865,546166,419217,205551,734983,1126224,915428,762197,272766,165620,872560,1076144,984489,838276,75484,1010830,647909,1156492,179624,30381,869129,809800,583746,701842,233150,1002640,433606,484487,585158,410231,878562,707151,242312,157521,487582,744406,107564,681425,1056589,257033,656381,604907,457853,653609,919446,46085,1196371,310730,399486,848284,526944,1081559,399871,771318,584134,540255,617535,89914,133279,177425,955443,651394,1097739,479472,669705,972273,367660,3516,264911,86620,794900,341615,231178,317037,1012006,1022745,24184,748082,651679,247230,412891,128964,884449,1185801,136551,136358,787985,105817,837733,1014913,494504,782755,264464,714339,1164166,571767,734653,849886,866408,883863,941969,920835,403235,531369,866008,185853,446885,923087,379364,539144,805406,1122961,702632,713159,902158,69734,262064,120522,589824,585279,591427,896536,502796,516106,80289,859348,1143837,111071,2118,161624,968118,155807,911140,707632,1051717,1100303,41584,1159492,622375,149268,852239,389792,1124474,1156357,393326,881659,809985,157775,511490,891053,609328,355130,3331,690882,276972,136997,734927,309654,798193,906282,1156004,765749,720306,584337,804639,1192272,915447,226264,1146920,608803,786833,252094,993358,1069322,521602,805147,42007,10660,31711,494330,898449,456450,691357,57538,425389,1031773,562641,564320,1128007,941749,1135970,370555,1011840,912783,1088690,533362,959264,699737,902916,254286,265745,523602,700954,121265,1197481,151066,455455,3378,563234,610703,1107178,207581,982661,883189,784191,493966,383068,293463,1028869,1006261,132944,42122,361098,593376,1032819,1010144,828615,618924,447064,666358,732703,741810,249995,295801,975358,808978,1006361,906487,165893,360535,898864,731355,426254,594338,255467,499546,1134700,251015,278605,800125,324003,1007328,1186181,200620,846304,66997,787439,1129867,1192293,323100,120467,943128,577109,1011065,9669,428985,238205,987894,639921,36699,1171372,985895,715907,66506,260104,294516,80842,835930,354651,335593,1164311,75995,974025,70317,590517,207124,694369,161805,654975,727276,466831,206254,74758,1121735,540065,1184541,933022,493773,1034695,809376,562704,1183441,810616,330373,1040888,1043251,284565,417745,991501,734157,463586,683813,790809,720676,930476,423935,111916,128823,69312,184608,820251,520315,1165126,1048910,5925,604865,444466,865203,128949,109473,747907,795580,330151,114356,792441,213930,410487,846056,1071928,97101,1083340,482606,926961,130817,134361,807557,353754,477571,377567,907721,102804,761673,676262,523448,252508,98389,695154,782849,9168,183720,708366,715156,882586,1019878,622226,757868,176607,67149,94218,934613,1143514,835365,716553,1014080,29315,985766,760367,374093,656197,1002671,757270,271259,740734,648702,353799,406337,493168,128715,719506,386398,1012552,1196776,867705,241814,1025716,86857,100246,1030319,840865,130502,632999,1196431,1014472,952981,608330,949853,181832,49537,870368,605676,332128,658924,759366,1053437,507503,732748,670576,365596,714876,393979,433703,144570,381734,781090,503960,31345,35363,517332,242856,387966,1112973,885113,427568,670851,995238,755726,691951,75714,513625,573158,1035389,403014,774711,724263,390771,1065684,103702,591488,373990,1165356,551705,1129255,483762,667856,411452,1182164,888525,31764,197440,688489,683787,326110,281148,954584,919587,861222,999483,825111,15529,471143,781932,715286,809919,821356,501686,675770,24320,506173,1107547,581927,492892,725361,569591,1010954,744484,303580,801928,984265,1166239,804625,389089,586618,1160846,768689,459315,149729,1027703,349355,1157821,1031113,9965,466280,173258,1082074,250238,629986,1120371,675821,981925,78083,783778,162647,866301,307769,54743,190608,507672,758089,1131346,208894,1087381,315814,764818,623241,881707,654130,600571,559143,989764,608395,314479,82571,1187348,829319,1128573,551640,566548,583023,728126,452501,659267,669013,124140,373783,1013800,738789,399591,282711,1196040,62599,241401,694397,570090,114552,56193,25212,505230,150885,768598,629990,1007543,1112081,886056,186149,484180,858140,473544,149461,200612,1071960,392558,979177,913735,593408,130195,905981,61663,285371,446442,239897,1184890,673427,218866,158131,54446,181520,463554,388356,894972,289547,65948,424557,538377,874717,137695,215737,957921,243146,594503,393636,524056,1073867,515454,500038,435747,1195431,467528,913352,613960,291135,800310,1096113,816976,646003,1005389,767828,783922,893163,996608,450728,350876,187809,385719,995809,224582,667854,467866,964034,337419,1175812,347239,939783,281125,405264,807254,513908,977144,750678,509248,632854,494122,775100,534469,884221,428511,429432,808567,618628,409769,731305,638523,1131493,854789,346802,87351,542960,994784,382813,297762,773157,228944,1031263,571239,52896,771454,342225,996123,952232,169915,729676,1060648,780596,61246,66880,493415,350072,102698,157372,1096182,68774,983002,849250,834845,1007221,610087,511475,116077,171434,1014159,197124,17253,963596,711275,130501,661206,1087366,738919,326924,84189,1075500,1178582,89114,1133421,385338,959947,603652,1113289,358268,147759,285686,1145885,1049104,524172,198017,1186184,115999,1173499,893656,269448,306128,815352,927093,1736,153969,40042,325689,175485,565297,1125631,869045,783026,1006934,318929,359926,105712,205225,345817,315383,941225,341385,728383,391788,1133109,799355,477935,892948,1070708,963373,1011031,968707,315018,454051,69333,790342,714454,316523,1133432,75061,961581,40492,811430,133414,1161804,104165,710538,551683,551728,480494,596095,1015170,433791,58516,394806,1068134,485250,628675,959237,263245,354323,2841,135340,748767,499180,675733,1067979,65011,496734,181357,268971,581976,308830,79141,892797,537641,69611,137282,1082499,243073,257452,818458,776064,898784,591753,87621,115556,490309,501101,403731,917669,1048603,278907,668178,913446,358664,958597,344510,41421,964909,815995,761207,641833,18560,39477,687591,853972,628382,837321,655387,1086802,1072614,1114476,422827,215166,290984,267243,202351,1141308,759795,933444,571229,334966,878885,1180938,725958,503146,228304,1112528,258337,1014964,254028,354665,1138776,295059,339494,154175,219805,29540,629596,140291,73306,145464,324377,42558,43656,222476,167746,808528,520620,948558,767467,183920,1057371,962698,881460,432773,19298,788169,906134,538316,199182,673216,180138,1107036,618732,1070484,93255,542091,346966,253727,458405,658398,21195,1193135,534426,899041,531040,561463,245898,844104,1020266,460639,1142253,461962,964903,985237,106817,186596,1054542,488874,243392,844067,865844,19477,531440,61392,740982,841852,1044137,452864,4774,722935,709156,1195165,782104,656006,399803,293232,356200,971947,1176575,390756,290708,863889,52436,567783,491727,40248,505452,1077417,1019408,700625,1014801,59445,548285,552634,84653,1166343,267259,949120,490186,376319,167627,570918,720776,505938,547706,111353,434311,965929,798799,585974,156858,19527,319171,722318,141660,994596,893405,160919,486676,1140247,735397,231255,541260,1023444,674868,307333,372185,561508,174664,959705,241260,1077341,766978,798252,440150,402353,250242,517158,358550,579952,1089991,976566,281190,967971,707993,453638,936095,75494,728760,540478,317779,449789,479467,810740,426948,187976,467474,40368,714855,986326,539500,348362,413428,556858,746385,595718,866480,51040,408082,393274,1150342,1129010,205991,304713,1191584,1152567,668647,863254,1190747,800206,435398,256945,742435,591835,170809,672319,322116,320292,252377,199263,784611,627836,663290,1009947,394989,698577,76768,735472,511892,334568,124461,903984,81235,533308,86280,800632,400026,1191557,716075,120054,611809,1060342,1025371,233624,811413,612933,505780,212088,850298,27853,291565,652110,70823,694747,282288,1146791,653263,1094420,648187,503432,547669,1155012,1191230,355116,398229,362053,13473,956847,585439,870631,375721,262279,46422,77179,1123205,1008610,967237,1044554,671355,1155882,612760,593267,513139,1102869,745363,669328,823583,1182990,353082,263379,168828,240579,1117012,774735,47295,612169,490470,752098,1190062,952705,6895,799938,806388,979550,1175253,539899,1074579,799447,279053,144199,63802,1052729,110682,191912,866255,407210,1028158,694061,462994,609223,920703,532316,511761,435442,213918,748971,735357,161454,970984,784053,792289,907151,605741,894835,559663,699096,1012388,1030400,952260,578200,189253,389565,338977,360222,143007,140278,439997,1123781,336431,290384,418309,657806,1144686,124948,346066,480326,542547,663465,866046,312068,997112,611372,207910,89125,823144,386972,396787,301793,888435,174232,1164319,1048420,648464,1076660,806649,806009,887274,574372,338359,1019014,1031454,1174107,516934,686513,111012,468250,915275,285544,358955,1136927,932319,1153998,1039184,1184739,140360,523185,482463,168238,109575,266955,1137481,880694,473877,341178,576827,578872,403445,598304,1006119,544095,129945,769245,351276,885819,880803,993557,248453,660079,528468,26926,81672,187659,1022526,211112,824467,209622,920062,641788,89794,1121957,268516,237270,1003657,501031,1180140,471605,929189,783914,1118819,124088,642466,134744,787005,192814,583242,541198,376116,1101324,1194262,1093324,412953,776292,457993,298872,613493,284913,186357,607529,780121,280680,976569,196569,97085,336571,1133728,112356,896634,134672,421747,726701,1110803,992172,976556,563260,1075402,348625,183473,487009,133883,1111612,936248,552147,642571,767252,258020,371935,424772,464277,362072,675621,632920,1028622,784904,749752,271148,277468,523297,917522,402708,1019486,896641,1135304,1185202,259410,700878,1066916,97027,774496,798363,903416,527758,884600,520787,1030313,1010107,674193,177762,1034332,265788,508782,598425,1187315,562069,1123671,1043039,274044,59504,82153,997064,767227,963195,41472,724433,387905,437438,222553,391969,819966,172743,33626,391570,93749,984805,311431,993756,625665,798556,251789,11845,152684,343607,352641,721856,1192484,925968,584505,858187,345896,483192,1170793,544614,1065565,1064173,791644,1129451,945595,479138,506195,486993,585195,564653,121643,119883,642882,381442,630967,1005167,1039377,533112,822528,989350,305283,688647,1019405,785246,687606,430867,1066276,178292,461594,562350,385990,540198,1027253,1061695,1811,434606,1031431,624787,404601,339199,88673,393817,210913,447255,71145,1196741,656869,18782,966009,938401,924607,635640,982766,317616,255206,673087,224598,216542,1014825,580558,769683,1175501,733049,566836,845974,988740,738419,53452,663415,1078315,849223,398353,458628,358642,381070,341242,1167741,370546,67622,1129279,1004875,889254,1034319,632479,289018,610479,237060,936722,360920,821898,788545,1083031,812002,772144,48691,771870,588923,840085,566504,626050,721590,308979,668622,370348,860284,1099867,359026,332311,289367,350884,1160234,60158,804071,440714,68658,660771,178520,20803,269469,911862,709555,723301,1168123,378201,995698,959397,542449,1031589,960405,863737,745657,763037,540506,726064,1107447,1006465,369121,725924,264103,114337,130293,537857,1165385,931783,697897,88232,852294,36488,1132644,736719,82112,955470,1087886,448251,730917,800110,747108,569434,647129,394413,172675,753621,163636,525441,345764,612273,1151185,114048,1093630,168178,603914,911541,179354,457785,175523,691512,477777,557330,611572,556915,336667,822018,997948,991940,332094,419881,645399,71202,787023,883169,150250,708828,862413,951214,130697,1123039,898648,833662,829834,978940,410308,1102785,718589,1092516,440670,111685,654235,34998,30158,1168885,449925,237558,68527,761645,267977,1063871,923591,540008,396178,706722,362305,93795,885364,536097,490303,670343,947422,462432,886504,728304,223979,903541,596126,140753,220563,214092,633277,543371,184436,879531,930431,495169,1194396,907829,650691,559883,483961,1045068,549929,905485,873444,102776,353388,18604,1194531,694127,997494,619027,1135986,1117324,360718,529307,322873,533051,146993,326790,269684,837762,196910,63146,387225,448902,339375,1114646,419961,785001,409835,67724,648327,148695,241716,195759,181216,651915,778864,992530,463098,71857,282653,435884,925315,1032461,325521,121937,213592,359805,1122597,187251,550172,41589,1018457,1167700,328952,388281,614335,496239,964931,195441,764475,713594,612923,787850,319519,490930,955769,1040560,710499,453675,1090517,516656,141492,941048,541700,593174,740228,544472,278635,1151996,1710,887351,798595,349797,671137,116522,798210,426763,613947,657826,580546,1108167,1064802,1020656,242638,546687,100342,718609,528376,225808,830421,1194565,933170,1111461,403181,856466,966903,881044,186075,175336,1173897,449999,546402,950851,785190,1069117,313632,12280,1061530,1061723,410096,1092264,360348,183168,703577,415326,933617,483742,33915,626314,463428,348195,331673,314218,256112,277246,794846,666712,332073,1012228,751196,274994,818717,658937,392675,75120,495449,484922,295923,1128347,936017,1077559,608257,612802,606654,301545,695285,681975,1117792,338733,54244,1087010,1195963,1036457,229963,1042274,286941,490449,146364,97778,1156497,38589,575706,1048813,345842,808289,73607,41724,804755,316422,388096,1040306,686591,307028,588753,842951,1194750,507199,921109,1061084,463154,888427,399888,291799,42077,432332,477775,613744,393442,5809,282634,971817,51161,589278,411248,945987,204723,128759,676479,392934,1156074,1187421,1166370,703751,299632,741631,506724,1140543,772692,166308,635440,633761,70074,256332,62111,827526,186241,285298,109391,664719,238817,498344,295165,943795,932336,674479,497127,1076816,600,1047015,742626,1194703,634847,587378,90903,990500,215420,314892,413890,704115,815013,904618,169212,191820,1065137,1155959,836983,604705,165262,187937,369466,579157,751017,531723,465378,456271,948086,902280,222723,389103,191720,291594,1032188,837546,299217,466726,771827,603743,942614,698535,63381,947066,919476,397956,874078,190753,11900,997461,351777,1131084,410642,68214,5788,874981,1077614,254953,620972,187016,1188412,769096,959876,210187,558160,1161382,26709,212186,482174,1131575,937977,903565,1117239,362151,843430,862488,33770,1122086,224056,1127764,607564,990957,503712,1036276,543106,470805,731250,991827,1123323,76346,658016,13540,265059,704308,163386,388705,635377,14640,387465,867708,157193,154830,913516,780336,206580,463924,734495,514268,407272,477405,267605,774146,1086165,1069258,1128769,1013473,377830,677766,32955,149171,1192156,593216,753615,332878,1069132,1088608,450174,402501,867930,1083725,405640,984151,787594,352025,126153,1100980,114741,715475,271120,1067264,1063720,390524,844327,720510,820514,290360,1095277,436408,521819,674633,945573,1099692,502927,415232,1188913,1014361,489715,482925,315495,178203,575855,440213,1021474,1130932,1103863,263468,54567,362716,481528,184001,1168766,212315,437714,823988,541884,195410,440811,926822,457347,549379,844282,791744,704913,1069366,478575,811683,185529,1305,330376,956267,172365,1111224,1097835,167762,357216,1067579,565082,1650,183609,245100,589751,248228,1016249,1148544,327713,592405,865953,539157,438715,144644,690578,465333,527505,832485,483205,804102,764378,1053511,816347,416991,694121,1166736,1162718,680749,955225,810115,85108,312968,770513,527230,202843,442355,506130,1122367,684456,624923,162692,795067,423370,473818,807310,132397,1094379,606593,824091,32725,646376,68826,714319,530225,786629,15917,309556,1166317,1000641,509592,514294,871971,916933,243497,278494,336859,198598,372970,1182552,726938,416149,482795,388162,376725,696395,522311,1173761,691908,90534,616154,705189,472720,628490,187127,453597,894501,396153,213816,31842,393456,808992,611463,37235,429392,738766,1048352,170378,848726,40260,166968,1188116,731801,1024823,116007,947843,568095,77710,522260,216156,1119998,414303,1035434,331780,890312,1143338,1007473,690409,439992,66735,989187,110700,882267,433263,574840,316374,543951,597510,638938,208317,589686,883602,1115510,10733,368762,69508,646441,631533,615058,469955,745580,538814,529068,1073941,824298,184281,459292,798490,915370};

/* multiplication inverses of omega */
static const __m256i w_3_inv[2]={{1180878,1180878,1180878,1180878},{17202,17202,17202,17202}};

static const __m256i w_5_inv[4][4]={{{912211,912211,912211,912211},{551890,551890,551890,551890},{502185,502185,502185,502185},{429875,429875,429875,429875}},
{{551890,551890,551890,551890},{429875,429875,429875,429875},{912211,912211,912211,912211},{502185,502185,502185,502185}},
{{502185,502185,502185,502185},{912211,912211,912211,912211},{429875,429875,429875,429875},{551890,551890,551890,551890}},
{{429875,429875,429875,429875},{502185,502185,502185,502185},{551890,551890,551890,551890},{912211,912211,912211,912211}}};

/* (in Montgomery form) */
static const uint64_t omega_256_inv[128]={2041,646441,433263,1119998,170378,187127,416149,1166317,807310,312968,483205,248228,330376,195410,1021474,674633,114741,332878,267605,14640,543106,903565,620972,397956,191720,604705,90903,498344,772692,945987,399888,316422,286941,612802,751196,483742,785190,1194565,613947,593174,612923,187251,778864,448902,1135986,559883,596126,706722,654235,951214,336667,114048,730917,537857,960405,660771,668622,821898,1167741,566836,924607,624787,687606,119883,1170793,798556,387905,598425,774496,271148,552147,421747,284913,787005,1121957,248453,341178,932319,574372,823144,657806,952260,748971,110682,952705,823583,77179,547669,212088,86280,627836,1190747,595718,479467,579952,372185,722318,167627,1077417,399803,19477,1020266,542091,881460,145464,258337,267243,18560,917669,137282,499180,1015170,1133432,799355,783026,893656,959947,963596,1096182,342225,854789,632854,467866,646003,524056,388356,130195,1112081};
static const uint64_t omega_1024_inv[512]={2041,421049,500041,735810,646441,735960,992608,1140176,433263,748017,470915,468176,1119998,160728,1149144,953750,170378,655682,999891,527640,187127,227287,895111,11965,416149,1172729,1109672,148442,1166317,162003,1096361,795343,807310,317533,121852,1144194,312968,10141,1142852,762247,483205,1035313,373006,258166,248228,604205,1123820,163187,330376,599379,625433,225281,195410,724450,548226,155232,1021474,568171,537018,695339,674633,1148443,989348,565683,114741,524278,287782,208977,332878,670579,802272,822,267605,681560,49800,1109749,14640,15,394041,519654,543106,1039057,962230,91824,903565,927720,482147,1037767,620972,928658,921608,226812,397956,329389,789647,218084,191720,834925,908009,736228,604705,1079629,711853,63334,90903,1150300,889919,1160939,498344,246019,801837,554443,772692,506539,1067253,760942,945987,154412,1046024,914363,399888,1002084,388930,921055,316422,169725,514514,901543,286941,161102,670403,252333,612802,764159,630512,1139805,751196,594900,1095577,88278,483742,1004625,765788,771681,785190,307690,577260,162627,1194565,368259,1116213,171772,613947,890597,760761,264701,593174,562822,916323,370429,612923,1067362,509296,648664,187251,369682,1117442,587910,778864,1139957,191437,828787,448902,1112613,250331,497411,1135986,587929,559134,120872,559883,1106589,869006,749691,596126,474442,1107729,864097,706722,1137428,369428,1154268,654235,1087045,957369,1070170,951214,1122948,978274,312798,336667,45764,996811,1087396,114048,530415,1771,516797,730917,544550,1112711,188954,537857,451059,507437,455938,960405,73409,1177288,344918,660771,979028,231781,819008,668622,670923,733530,656259,821898,1108085,152123,340185,1167741,908350,828294,916595,566836,211718,1171292,261439,924607,414629,779914,1166964,624787,507615,99951,178096,687606,248668,181931,791951,119883,457996,869569,922775,1170793,1050748,889817,638006,798556,1105606,445503,1684,387905,352702,749162,597353,598425,244894,2706,1117066,774496,452529,784863,1062628,271148,64110,827429,957103,552147,841432,757028,683289,421747,625251,1195039,120296,284913,1040020,860345,146959,787005,63411,1155182,1182079,1121957,584232,246107,477766,248453,524415,532063,1121291,341178,655857,804712,599865,932319,768169,539678,1083245,574372,15319,344955,674274,823144,1012338,666365,1045321,657806,965522,548473,892985,952260,565645,554201,166286,748971,851454,690751,198342,110682,46760,324119,129224,952705,274718,395550,1102738,823583,1043027,1018701,1045682,77179,772203,360461,180818,547669,858613,1133901,927956,212088,108241,1098761,343610,86280,952661,1035794,548545,627836,810821,1016008,30502,1190747,950110,396242,351483,595718,778872,1110496,708202,479467,124473,28361,538920,579952,432689,765202,234017,372185,735679,80544,510740,722318,612056,815715,664936,167627,752655,1062595,841955,1077417,1070293,348491,831403,399803,1165347,1038467,1038337,19477,308133,1192259,174305,1020266,224458,380768,727095,542091,733398,543325,82802,881460,113837,259128,599306,145464,1050925,986793,539902,258337,666820,1017088,845591,267243,517069,927324,143345,18560,1139178,813800,678437,917669,505460,997282,1000241,137282,331577,519590,778794,499180,162547,291094,1191014,1015170,1019900,673738,400869,1133432,109185,18525,219749,799355,1008631,90644,1055779,783026,489364,368764,5288,893656,128580,329113,8930,959947,262450,645956,1174192,963596,752243,782715,1185380,1096182,406212,1075743,945082,342225,843672,894515,409688,854789,839287,718972,653789,632854,602144,177383,168355,467866,164970,203941,308322,646003,252308,1154148,1096150,524056,206764,1144281,441860,388356,938240,79524,73734,130195,821359,846618,1127751,1112081,412366,277847,404146};
static const uint64_t omega_1280_inv[1280]={2041,527513,1185205,1003030,212720,646441,1118752,404200,444108,814171,433263,680313,369017,1161422,179099,1119998,999784,1001535,1184659,701659,170378,591785,718447,681501,656107,187127,482341,950899,146277,513931,416149,542211,81928,984268,1100347,1166317,807349,999305,230265,515558,807310,378738,398395,511654,864294,312968,499115,809174,1038954,503450,483205,506193,200114,1061220,75335,248228,707555,752101,548719,448491,330376,1168134,473942,1061218,1180152,195410,953115,447823,330306,300056,1021474,71170,115070,937522,550214,674633,275158,918427,286357,786879,114741,1170647,248220,334499,540829,332878,429460,654805,574394,842172,267605,942745,898707,829525,1166634,14640,984391,845678,820381,82381,543106,1082814,658703,237618,749488,903565,930472,68808,193738,859676,620972,746615,1114901,536518,579934,397956,407583,53472,299743,802630,191720,206618,43174,513888,807135,604705,569144,432696,597751,970167,90903,178118,901084,252256,442534,498344,798332,1044992,518431,595974,772692,1085350,307436,118306,880468,945987,1121445,185671,876766,837987,399888,644532,756258,308821,7252,316422,1023189,971704,1077508,33997,286941,464104,1160625,153906,439402,612802,752933,1007951,855321,14301,751196,279594,509966,24743,63573,483742,387876,4775,1022815,304470,785190,426639,894843,355627,959143,1194565,178985,596274,385320,621483,613947,232928,96150,447698,491711,593174,793921,223091,242189,645942,612923,405000,609197,375913,451905,187251,274304,631372,496610,209871,778864,160533,364768,705419,586872,448902,326832,41423,330764,92054,1135986,147737,306034,634697,995561,559883,1080985,432526,1056878,74880,596126,672270,307194,814172,479895,706722,246237,115480,887346,595175,654235,351936,166014,763507,485347,951214,458385,446199,79041,542756,336667,1000201,79702,216402,1019882,114048,4777,1116079,357288,539630,730917,1113256,504062,268045,1093448,537857,719970,1015258,142260,93823,960405,140099,1158956,200363,691778,660771,826114,251574,987697,458621,668622,321160,320620,299041,415153,821898,136346,1068886,528109,223933,1167741,118781,267129,311371,308833,566836,633330,747910,401210,1189905,924607,932677,1055483,917695,896082,624787,133626,28351,580489,1119015,687606,201189,871218,909147,48638,119883,138110,660145,388426,492674,1170793,1066087,595970,586164,979714,798556,707831,443642,649117,107479,387905,159022,590595,338093,404897,598425,51948,1117435,91987,407804,774496,145727,26032,268171,978675,271148,824743,1015476,723388,1058661,552147,958214,1004353,804725,841199,421747,406489,555547,162241,938878,284913,542807,318737,1148979,1006408,787005,1198049,903938,352993,334717,1121957,99635,21202,274839,419791,248453,417026,703721,479082,1133498,341178,494897,600682,1067325,818498,932319,1134361,1047921,522325,72670,574372,1014349,884688,49662,1145892,823144,731930,428232,898597,492329,657806,341549,1022235,813773,1043023,952260,114136,514150,1043909,335377,748971,756441,455910,47775,611221,110682,1188157,881379,296823,20343,952705,497999,285345,320454,944696,823583,836001,40973,911822,188814,77179,1173885,284430,783090,742081,547669,606212,156789,694386,72765,212088,1127042,3317,125895,138740,86280,252962,1016539,1171883,377484,627836,941036,277965,25541,135398,1190747,652078,405516,709689,824066,595718,815710,315051,589010,707395,479467,1115603,923995,1147837,468228,579952,39251,882945,239594,642083,372185,329554,1175222,331202,149493,722318,283742,1048461,543904,1154639,167627,501820,1150229,590439,251987,1077417,582809,279884,854355,494867,399803,275055,907655,1160473,254328,19477,106066,391344,1181697,356990,1020266,49521,561185,693718,72695,542091,476493,211350,258894,880852,881460,479772,961391,592173,840448,145464,940707,511090,921628,993345,258337,66529,548619,577615,85638,267243,835095,923297,946888,5961,18560,475438,135911,1151343,1021004,917669,881731,1136234,929744,865061,137282,387441,87232,317629,998206,499180,246011,359377,909317,787592,1015170,830968,165993,982316,1128839,1133432,857709,1148065,317595,610799,799355,826288,1177056,790539,660359,783026,153795,55574,77565,4541,893656,115169,761766,768543,500223,959947,348101,1044444,123796,500814,963596,380767,366324,181870,944522,1096182,1033159,1037316,797418,356179,342225,197280,695042,711332,763258,854789,365778,1078580,902180,1041526,632854,116536,1009417,927216,391303,467866,472302,63841,1000308,277002,646003,1061313,817868,308103,71744,524056,521235,761273,542506,659477,388356,822677,520244,76039,728969,130195,576813,1025366,652683,1062013,1112081,823188,387576,392147,288601,1196040,670568,12876,195051,985361,551640,79329,793881,753973,383910,764818,517768,829064,36659,1018982,78083,198297,196546,13422,496422,1027703,606296,479634,516580,541974,1010954,715740,247182,1051804,684150,781932,655870,1116153,213813,97734,31764,390732,198776,967816,682523,390771,819343,799686,686427,333787,885113,698966,388907,159127,694631,714876,691888,997967,136861,1122746,949853,490526,445980,649362,749590,867705,29947,724139,136863,17929,1002671,244966,750258,867775,898025,176607,1126911,1083011,260559,647867,523448,922923,279654,911724,411202,1083340,27434,949861,863582,657252,865203,768621,543276,623687,355909,930476,255336,299374,368556,31447,1183441,213690,352403,377700,1115700,654975,115267,539378,960463,448593,294516,267609,1129273,1004343,338405,577109,451466,83180,661563,618147,800125,790498,1144609,898338,395451,1006361,991463,1154907,684193,390946,593376,628937,765385,600330,227914,1107178,1019963,296997,945825,755547,699737,399749,153089,679650,602107,425389,112731,890645,1079775,317613,252094,76636,1012410,321315,360094,798193,553549,441823,889260,1190829,881659,174892,226377,120573,1164084,911140,733977,37456,1044175,758679,585279,445148,190130,342760,1183780,446885,918487,688115,1173338,1134508,714339,810205,1193306,175266,893611,412891,771442,303238,842454,238938,3516,1019096,601807,812761,576598,584134,965153,1101931,750383,706370,604907,404160,974990,955892,552139,585158,793081,588884,822168,746176,1010830,923777,566709,701471,988210,419217,1037548,833313,492662,611209,749179,871249,1156658,867317,1106027,62095,1050344,892047,563384,202520,638198,117096,765555,141203,1123201,601955,525811,890887,383909,718186,491359,951844,1082601,310735,602906,543846,846145,1032067,434574,712734,246867,739696,751882,1119040,655325,861414,197880,1118379,981679,178199,1084033,1193304,82002,840793,658451,467164,84825,694019,930036,104633,660224,478111,182823,1055821,1104258,237676,1057982,39125,997718,506303,537310,371967,946507,210384,739460,529459,876921,877461,899040,782928,376183,1061735,129195,669972,974148,30340,1079300,930952,886710,889248,631245,564751,450171,796871,8176,273474,265404,142598,280386,301999,573294,1064455,1169730,617592,79066,510475,996892,326863,288934,1149443,1078198,1059971,537936,809655,705407,27288,131994,602111,611917,218367,399525,490250,754439,548964,1090602,810176,1039059,607486,859988,793184,599656,1146133,80646,1106094,790277,423585,1052354,1172049,929910,219406,926933,373338,182605,474693,139420,645934,239867,193728,393356,356882,776334,791592,642534,1035840,259203,913168,655274,879344,49102,191673,411076,32,294143,845088,863364,76124,1098446,1176879,923242,778290,949628,781055,494360,718999,64583,856903,703184,597399,130756,379583,265762,63720,150160,675756,1125411,623709,183732,313393,1148419,52189,374937,466151,769849,299484,705752,540275,856532,175846,384308,155058,245821,1083945,683931,154172,862704,449110,441640,742171,1150306,586860,1087399,9924,316702,901258,1177738,245376,700082,912736,877627,253385,374498,362080,1157108,286259,1009267,1120902,24196,913651,414991,456000,650412,591869,1041292,503695,1125316,985993,71039,1194764,1072186,1059341,1111801,945119,181542,26198,820597,570245,257045,920116,1172540,1062683,7334,546003,792565,488392,374015,602363,382371,883030,609071,490686,718614,82478,274086,50244,729853,618129,1158830,315136,958487,555998,825896,868527,22859,866879,1048588,475763,914339,149620,654177,43442,1030454,696261,47852,607642,946094,120664,615272,918197,343726,703214,798278,923026,290426,37608,943753,1178604,1092015,806737,16384,841091,177815,1148560,636896,504363,1125386,655990,721588,986731,939187,317229,316621,718309,236690,605908,357633,1052617,257374,686991,276453,204736,939744,1131552,649462,620466,1112443,930838,362986,274784,251193,1192120,1179521,722643,1062170,46738,177077,280412,316350,61847,268337,333020,1060799,810640,1110849,880452,199875,698901,952070,838704,288764,410489,182911,367113,1032088,215765,69242,64649,340372,50016,880486,587282,398726,371793,21025,407542,537722,415055,1044286,1142507,1120516,1193540,304425,1082912,436315,429538,697858,238134,849980,153637,1074285,697267,234485,817314,831757,1016211,253559,101899,164922,160765,400663,841902,855856,1000801,503039,486749,434823,343292,832303,119501,295901,156555,565227,1081545,188664,270865,806778,730215,725779,1134240,197773,921079,552078,136768,380213,889978,1126337,674025,676846,436808,655575,538604,809725,375404,677837,1122042,469112,1067886,621268,172715,545398,136068,86000,374893,810505,805934,909480};
static const uint64_t omega_3072_inv[3072]={2041,458861,561896,421049,829061,1031711,500041,937464,159410,735810,541079,311959,646441,266931,580947,735960,467967,212960,992608,1140866,491235,1140176,587934,1116339,433263,690481,606322,748017,294090,665949,470915,341558,181131,468176,1053581,143808,1119998,790389,1158947,160728,780299,645647,1149144,497954,964282,953750,783682,322604,170378,469724,1065837,655682,810659,1183215,999891,114992,532738,527640,648260,881921,187127,1075991,962069,227287,31791,1134007,895111,786887,837118,11965,797481,769299,416149,421864,272075,1172729,344144,693840,1109672,216400,354243,148442,1001896,16321,1166317,482223,548728,162003,158847,403196,1096361,138875,201730,795343,6280,213799,807310,834735,246955,317533,709147,949143,121852,144349,1111898,1144194,514488,637006,312968,697771,886938,10141,105056,8274,1142852,98311,979587,762247,227196,1018636,483205,181909,536252,1035313,1172489,221507,373006,795421,16185,258166,220545,1049565,248228,863188,4758,604205,310225,149765,1123820,77653,936768,163187,524240,708024,330376,727242,835454,599379,1049066,906782,625433,794067,612245,225281,114975,269459,195410,1160145,742939,724450,726666,301509,548226,774096,426266,155232,727498,7802,1021474,106314,321624,568171,557413,481526,537018,917545,778755,695339,363065,193522,674633,774951,488760,1148443,424296,795948,989348,972648,1125244,565683,364349,909534,114741,239744,62309,524278,98449,720631,287782,18514,384959,208977,410018,119466,332878,1137124,46769,670579,290865,1039776,802272,686494,1159865,822,749504,559720,267605,236456,658536,681560,226110,972888,49800,886517,678600,1109749,210818,167641,14640,292371,401578,15,232305,1068373,394041,686434,230645,519654,371421,210146,543106,554002,370933,1039057,449848,1153042,962230,324532,77289,91824,1154222,67594,903565,1123156,577014,927720,212288,169992,482147,569797,579574,1037767,838995,327120,620972,1195258,609196,928658,362122,1164334,921608,204143,1024963,226812,1062033,449103,397956,215908,1121206,329389,1016626,504441,789647,450322,107313,218084,76569,921994,191720,322922,302920,834925,793323,1070727,908009,458686,247833,736228,1024240,1010521,604705,865239,618489,1079629,993968,637728,711853,924130,923765,63334,823400,819717,90903,69586,603563,1150300,429711,792383,889919,649810,925151,1160939,1058807,807443,498344,1013807,1175585,246019,198673,176743,801837,1138135,129073,554443,12214,1059501,772692,247976,554707,506539,933186,998560,1067253,1019816,786650,760942,384038,322422,945987,366201,837514,154412,8968,1108101,1046024,520487,93201,914363,620442,175634,399888,184767,469101,1002084,531715,259492,388930,605723,1055952,921055,26399,295692,316422,276224,731918,169725,1139442,3205,514514,1039668,327757,901543,958548,809286,286941,172838,229152,161102,582032,766221,670403,1159396,1123986,252333,939030,450432,612802,464973,570041,764159,1084396,539475,630512,379194,782497,1139805,832662,490591,751196,405942,492747,594900,1171491,340534,1095577,1175958,32265,88278,150965,538924,483742,111861,1164262,1004625,347509,92031,765788,1153018,590542,771681,165672,670843,785190,913461,1028140,307690,426893,280933,577260,1143279,720855,162627,238087,758132,1194565,659434,211914,368259,361573,1048538,1116213,878063,342331,171772,493144,752834,613947,226373,253645,890597,367267,573522,760761,1175134,449868,264701,789286,849920,593174,798711,649013,562822,385039,249856,916323,1022937,256,370429,422095,255329,612923,1140819,961427,1067362,311737,802570,509296,499929,401001,648664,1148264,48285,187251,600217,848281,369682,834116,245150,1117442,742290,258035,587910,744651,880412,778864,1185341,378985,1139957,790524,853530,191437,732425,833148,828787,382516,712828,448902,879312,516298,1112613,236589,322145,250331,1084162,509760,497411,941408,138007,1135986,393778,207596,587929,1038904,476499,559134,776871,271775,120872,542142,1506,559883,395824,743892,1106589,393219,1135011,869006,252049,134965,749691,1059627,327892,596126,989257,761412,474442,1050562,113714,1107729,77184,861851,864097,903550,890851,706722,533679,723935,1137428,1160574,198376,369428,494661,284993,1154268,779996,745410,654235,1164509,37590,1087045,829784,248002,957369,521328,1136958,1070170,668317,3620,951214,1045323,446829,1122948,949961,809408,978274,795193,79392,312798,461143,1158881,336667,1111398,589180,45764,681197,594734,996811,338272,808332,1087396,275316,1046694,114048,289982,543646,530415,493769,847561,1771,1069695,500478,516797,454059,474344,730917,242291,1169106,544550,153691,823651,1112711,556234,193568,188954,616796,19839,537857,732247,472624,451059,738503,314735,507437,463540,1140709,455938,820473,1016346,960405,814701,283376,73409,1104395,1159090,1177288,262598,568312,344918,699968,167528,660771,550656,68914,979028,491581,508273,231781,141671,372466,819008,1091430,449662,668622,1132912,709980,670923,826069,221685,733530,1173149,858279,656259,162010,267256,821898,321782,618955,1108085,798232,419226,152123,501655,773781,340185,482938,839204,1167741,970253,1174390,908350,947429,1132997,828294,1133992,662806,916595,443077,523612,566836,249645,44728,211718,927050,618727,1171292,852864,659824,261439,590094,1021991,924607,1122578,12095,414629,843244,236928,779914,673557,884073,1166964,917664,225546,624787,374113,1166396,507615,824064,320356,99951,20485,957811,178096,190290,940051,687606,410194,449016,248668,488982,992314,181931,876966,126226,791951,189940,311925,119883,800552,406636,457996,344532,712391,869569,584663,777764,922775,306257,997561,1170793,313337,422069,1050748,598134,937047,889817,268217,129852,638006,224915,437138,798556,644690,705057,1105606,744551,529793,445503,954563,195722,1684,920407,773552,387905,306601,334684,352702,244595,908724,749162,55490,349553,597353,822510,215178,598425,651440,1009260,244894,747013,320195,2706,1173068,801913,1117066,909583,873604,774496,630661,290595,452529,740854,782242,784863,641536,980380,1062628,79220,45196,271148,1193252,692380,64110,860502,339511,827429,916628,954148,957103,1194110,801335,552147,396492,306479,841432,928428,394355,757028,870051,860911,683289,645351,159235,421747,856258,507138,625251,371595,508722,1195039,811786,665849,120296,8197,1148434,284913,1113389,273691,1040020,986857,733123,860345,304214,507726,146959,798214,140460,787005,268422,908525,63411,817818,633115,1155182,558142,988820,1182079,179793,113947,1121957,1177397,752600,584232,93272,815859,246107,363448,134638,477766,1011867,1082830,248453,753520,455300,524415,1022087,15197,532063,856644,494715,1121291,447703,281614,341178,286476,159869,655857,1124722,868036,804712,136182,428074,599865,189181,538102,932319,750222,896657,768169,887054,608552,539678,180130,540742,1083245,685153,759175,574372,745820,1013500,15319,25315,280918,344955,74906,326814,674274,7442,238478,823144,449288,866889,1012338,1188721,9481,666365,923102,578182,1045321,415855,661010,657806,158779,548161,965522,988334,843883,548473,1005142,1165802,892985,209712,1010234,952260,471591,28041,565645,973924,519279,554201,1056684,276729,166286,595213,28517,748971,691716,563471,851454,388612,473181,690751,1193569,809435,198342,1040951,1028282,110682,876304,656561,46760,531196,608306,324119,869644,548107,129224,496818,144184,952705,174820,972361,274718,172035,971982,395550,94697,121295,1102738,656832,649494,823583,59595,425395,1043027,831107,369926,1018701,291779,817922,1045682,16257,175149,77179,784416,907333,772203,1061400,230480,360461,600128,668019,180818,413069,645144,547669,534404,1169281,858613,1036593,628472,1133901,451570,265793,927956,272977,765031,212088,666835,1013506,108241,213048,1157383,1098761,167164,1013908,343610,810349,1174569,86280,358045,324047,952661,691473,394373,1035794,235169,1094144,548545,922125,1022436,627836,868817,919249,810821,97866,78277,1016008,518123,622444,30502,340560,300158,1190747,236037,159888,950110,720809,648306,396242,28972,607070,351483,535238,906548,595718,660966,1174459,778872,111156,1028656,1110496,996878,177820,708202,690900,1104970,479467,997472,990531,124473,1022,252661,28361,729161,602982,538920,421794,386066,579952,901448,685364,432689,187510,1017107,765202,464203,625861,234017,26254,446239,372185,61404,885515,735679,908444,7045,80544,182607,563449,510740,99618,853719,722318,56569,286892,612056,892481,790831,815715,412141,650180,664936,357637,1193837,167627,995903,653048,752655,237936,815757,1062595,766230,809786,841955,641562,184961,1077417,282992,116806,1070293,177056,856944,348491,923293,1140037,831403,161754,1094908,399803,66453,6032,1165347,1034886,549945,1038467,897166,264485,1038337,81937,190540,19477,921968,987139,308133,99148,763315,1192259,888842,743445,174305,185042,1133783,1020266,567314,463945,224458,548065,676851,380768,1197415,468387,727095,955027,193204,542091,409750,761274,733398,326946,322396,543325,351412,633742,82802,407904,926216,881460,236106,30410,113837,616468,930508,259128,742067,398677,599306,1116596,819179,145464,408688,1087214,1050925,943171,1083806,986793,940036,455301,539902,54975,760315,258337,472660,1008591,666820,781201,237949,1017088,470949,868116,845591,642487,133464,267243,620567,913428,517069,1072280,997700,927324,69841,958505,143345,1138003,480951,18560,1097361,50822,1139178,706961,640829,813800,706561,436434,678437,981530,901463,917669,302981,581551,505460,995847,983857,997282,444163,569360,1000241,743118,1100461,137282,690640,672593,331577,157833,274431,519590,578334,1003183,778794,101251,984289,499180,782048,176547,162547,197208,251827,291094,992056,978609,1191014,776823,726480,1015170,718908,1159544,1019900,889477,993042,673738,92977,1039518,400869,1000542,612381,1133432,376653,966703,109185,455804,1141377,18525,555316,353474,219749,702723,901378,799355,1037993,744814,1008631,88219,435313,90644,850777,686642,1055779,637966,803516,783026,945861,811001,489364,917943,952176,368764,994022,275945,5288,425748,519533,893656,1016841,239903,128580,107838,1160273,329113,336457,255290,8930,519595,655769,959947,910141,1128783,262450,672398,905855,645956,1142303,1180596,1174192,238086,742645,963596,1112397,485640,752243,1045778,304928,782715,921728,864502,1185380,982978,563100,1096182,960945,791114,406212,1079994,656318,1075743,715536,454863,945082,727438,276663,342225,926312,1170131,843672,874959,193923,894515,1141283,958909,409688,999161,790292,854789,520274,388713,839287,57000,971384,718972,952631,226863,653789,247712,60382,632854,707318,179283,602144,739705,958894,177383,1128869,396251,168355,289629,1067140,467866,1044935,428278,164970,581698,385887,203941,292751,296233,308322,630029,87459,646003,672111,55329,252308,551855,666612,1154148,119637,584993,1096150,465361,588592,524056,254578,962996,206764,881636,565656,1144281,663776,363932,441860,845229,1026598,388356,102752,268656,938240,196512,255604,79524,1159001,997026,73734,147265,744912,130195,1157723,373936,821359,360856,727088,846618,972583,118589,1127751,1053000,730509,1112081,384072,848980,412366,540512,1115478,277847,707618,33059,404146,233958,310602,1196040,739220,636185,777032,369020,166370,698040,260617,1038671,462271,657002,886122,551640,931150,617134,462121,730114,985121,205473,57215,706846,57905,610147,81742,764818,507600,591759,450064,903991,532132,727166,856523,1016950,729905,144500,1054273,78083,407692,39134,1037353,417782,552434,48937,700127,233799,244331,414399,875477,1027703,728357,132244,542399,387422,14866,198190,1083089,665343,670441,549821,316160,1010954,122090,236012,970794,1166290,64074,302970,411194,360963,1186116,400600,428782,781932,776217,926006,25352,853937,504241,88409,981681,843838,1049639,196185,1181760,31764,715858,649353,1036078,1039234,794885,101720,1059206,996351,402738,1191801,984282,390771,363346,951126,880548,488934,248938,1076229,1053732,86183,53887,683593,561075,885113,500310,311143,1187940,1093025,1189807,55229,1099770,218494,435834,970885,179445,714876,1016172,661829,162768,25592,976574,825075,402660,1181896,939915,977536,148516,949853,334893,1193323,593876,887856,1048316,74261,1120428,261313,1034894,673841,490057,867705,470839,362627,598702,149015,291299,572648,404014,585836,972800,1083106,928622,1002671,37936,455142,473631,471415,896572,649855,423985,771815,1042849,470583,1190279,176607,1091767,876457,629910,640668,716555,661063,280536,419326,502742,835016,1004559,523448,423130,709321,49638,773785,402133,208733,225433,72837,632398,833732,288547,1083340,958337,1135772,673803,1099632,477450,910299,1179567,813122,989104,788063,1078615,865203,60957,1151312,527502,907216,158305,395809,511587,38216,1197259,448577,638361,930476,961625,539545,516521,971971,225193,1148281,311564,519481,88332,987263,1030440,1183441,905710,796503,1198066,965776,129708,804040,511647,967436,678427,826660,987935,654975,644079,827148,159024,748233,45039,235851,873549,1120792,1106257,43859,1130487,294516,74925,621067,270361,985793,1028089,715934,628284,618507,160314,359086,870961,577109,2823,588885,269423,835959,33747,276473,993938,173118,971269,136048,748978,800125,982173,76875,868692,181455,693640,408434,747759,1090768,979997,1121512,276087,1006361,875159,895161,363156,404758,127354,290072,739395,950248,461853,173841,187560,593376,332842,579592,118452,204113,560353,486228,273951,274316,1134747,374681,378364,1107178,1128495,594518,47781,768370,405698,308162,548271,272930,37142,139274,390638,699737,184274,22496,952062,999408,1021338,396244,59946,1069008,643638,1185867,138580,425389,950105,643374,691542,264895,199521,130828,178265,411431,437139,814043,875659,252094,831880,360567,1043669,1189113,89980,152057,677594,1104880,283718,577639,1022447,798193,1013314,728980,195997,666366,938589,809151,592358,142129,277026,1171682,902389,881659,921857,466163,1028356,58639,1194876,683567,158413,870324,296538,239533,388795,911140,1025243,968929,1036979,616049,431860,527678,38685,74095,945748,259051,747649,585279,733108,628040,433922,113685,658606,567569,818887,415584,58276,365419,707490,446885,792139,705334,603181,26590,857547,102504,22123,1165816,1109803,1047116,659157,714339,1086220,33819,193456,850572,1106050,432293,45063,607539,426400,1032409,527238,412891,284620,169941,890391,771188,917148,620821,54802,477226,1035454,959994,439949,3516,538647,986167,829822,836508,149543,81868,320018,855750,1026309,704937,445247,584134,971708,944436,307484,830814,624559,437320,22947,748213,933380,408795,348161,604907,399370,549068,635259,813042,948225,281758,175144,1197825,827652,775986,942752,585158,57262,236654,130719,886344,395511,688785,698152,797080,549417,49817,1149796,1010830,597864,349800,828399,363965,952931,80639,455791,940046,610171,453430,317669,419217,12740,819096,58124,407557,344551,1006644,465656,364933,369294,815565,485253,749179,318769,681783,85468,961492,875936,947750,113919,688321,700670,256673,1060074,62095,804303,990485,610152,159177,721582,638947,421210,926306,1077209,655939,1196575,638198,802257,454189,91492,804862,63070,329075,946032,1063116,448390,138454,870189,601955,208824,436669,723639,147519,1084367,90352,1120897,336230,333984,294531,307230,491359,664402,474146,60653,37507,999705,828653,703420,913088,43813,418085,452671,543846,33572,1160491,111036,368297,950079,240712,676753,61123,127911,529764,1194461,246867,152758,751252,75133,248120,388673,219807,402888,1118689,885283,736938,39200,861414,86683,608901,1152317,516884,603347,201270,859809,389749,110685,922765,151387,1084033,908099,654435,667666,704312,350520,1196310,128386,697603,681284,744022,723737,467164,955790,28975,653531,1044390,374430,85370,641847,1004513,1009127,581285,1178242,660224,465834,725457,747022,459578,883346,690644,734541,57372,742143,377608,181735,237676,383380,914705,1124672,93686,38991,20793,935483,629769,853163,498113,1030553,537310,647425,1129167,219053,706500,689808,966300,1056410,825615,379073,106651,748419,529459,65169,488101,527158,372012,976396,464551,24932,339802,541822,1036071,930825,376183,876299,579126,89996,399849,778855,1045958,696426,424300,857896,715143,358877,30340,227828,23691,289731,250652,65084,369787,64089,535275,281486,755004,674469,631245,948436,1153353,986363,271031,579354,26789,345217,538257,936642,607987,176090,273474,75503,1185986,783452,354837,961153,418167,524524,314008,31117,280417,972535,573294,823968,31685,690466,374017,877725,1098130,1177596,240270,1019985,1007791,258030,510475,787887,749065,949413,709099,205767,1016150,321115,1071855,406130,1008141,886156,1078198,397529,791445,740085,853549,485690,328512,613418,420317,275306,891824,200520,27288,884744,776012,147333,599947,261034,308264,929864,1068229,560075,973166,760943,399525,553391,493024,92475,453530,668288,752578,243518,1002359,1196397,277674,424529,810176,891480,863397,845379,953486,289357,448919,1142591,848528,600728,375571,982903,599656,546641,188821,953187,451068,877886,1195375,25013,396168,81015,288498,324477,423585,567420,907486,745552,457227,415839,413218,556545,217701,135453,1118861,1152885,926933,4829,505701,1133971,337579,858570,370652,281453,243933,240978,3971,396746,645934,801589,891602,356649,269653,803726,441053,328030,337170,514792,552730,1038846,776334,341823,690943,572830,826486,689359,3042,386295,532232,1077785,1189884,49647,913168,84692,924390,158061,211224,464958,337736,893867,690355,1051122,399867,1057621,411076,929659,289556,1134670,380263,564966,42899,639939,209261,16002,1018288,1084134,76124,20684,445481,613849,1104809,382222,951974,834633,1063443,720315,186214,115251,949628,444561,742781,673666,175994,1182884,666018,341437,703366,76790,750378,916467,856903,911605,1038212,542224,73359,330045,393369,1061899,770007,598216,1008900,659979,265762,447859,301424,429912,311027,589529,658403,1017951,657339,114836,512928,438906,623709,452261,184581,1182762,1172766,917163,853126,1123175,871267,523807,1190639,959603,374937,748793,331192,185743,9360,1188600,531716,274979,619899,152760,782226,537071,540275,1039302,649920,232559,209747,354198,649608,192939,32279,305096,988369,187847,245821,726490,1170040,632436,224157,678802,643880,141397,921352,1031795,602868,1169564,449110,506365,634610,346627,809469,724900,507330,4512,388646,999739,157130,169799,1087399,321777,541520,1151321,666885,589775,873962,328437,649974,1068857,701263,1053897,245376,1023261,225720,923363,1026046,226099,802531,1103384,1076786,95343,541249,548587,374498,1138486,772686,155054,366974,828155,179380,906302,380159,152399,1181824,1022932,1120902,413665,290748,425878,136681,967601,837620,597953,530062,1017263,785012,552937,650412,663677,28800,339468,161488,569609,64180,746511,932288,270125,925104,433050,985993,531246,184575,1089840,985033,40698,99320,1030917,184173,854471,387732,23512,1111801,840036,874034,245420,506608,803708,162287,962912,103937,649536,275956,175645,570245,329264,278832,387260,1100215,1119804,182073,679958,575637,1167579,857521,897923,7334,962044,1038193,247971,477272,549775,801839,1169109,591011,846598,662843,291533,602363,537115,23622,419209,1086925,169425,87585,201203,1020261,489879,507181,93111,718614,200609,207550,1073608,1197059,945420,1169720,468920,595099,659161,776287,812015,618129,296633,512717,765392,1010571,180974,432879,733878,572220,964064,1171827,751842,825896,1136677,312566,462402,289637,1191036,1117537,1015474,634632,687341,1098463,344362,475763,1141512,911189,586025,305600,407250,382366,785940,547901,533145,840444,4244,1030454,202178,545033,445426,960145,382324,135486,431851,388295,356126,556519,1013120,120664,915089,1081275,127788,1021025,341137,849590,274788,58044,366678,1036327,103173,798278,1131628,1192049,32734,163195,648136,159614,300915,933596,159744,1116144,1007541,1178604,276113,210942,889948,1098933,434766,5822,309239,454636,1023776,1013039,64298,177815,630767,734136,973623,650016,521230,817313,666,729694,470986,243054,1004877,655990,788331,436807,464683,871135,875685,654756,846669,564339,1115279,790177,271865,316621,961975,1167671,1084244,581613,267573,938953,456014,799404,598775,81485,378902,1052617,789393,110867,147156,254910,114275,211288,258045,742780,658179,1143106,437766,939744,725421,189490,531261,416880,960132,180993,727132,329965,352490,555594,1064617,930838,577514,284653,681012,125801,200381,270757,1128240,239576,1054736,60078,717130,1179521,100720,1147259,58903,491120,557252,384281,491520,761647,519644,216551,296618,280412,895100,616530,692621,202234,214224,200799,753918,628721,197840,454963,97620,1060799,507441,525488,866504,1040248,923650,678491,619747,194898,419287,1096830,213792,698901,416033,1021534,1035534,1000873,946254,906987,206025,219472,7067,421258,471601,182911,479173,38537,178181,308604,205039,524343,1105104,158563,797212,197539,585700,64649,821428,231378,1088896,742277,56704,1179556,642765,844607,978332,495358,296703,398726,160088,453267,189450,1109862,762768,1107437,347304,511439,142302,560115,394565,415055,252220,387080,708717,280138,245905,829317,204059,922136,1192793,772333,678548,304425,181240,958178,1069501,1090243,37808,868968,861624,942791,1189151,678486,542312,238134,287940,69298,935631,525683,292226,552125,55778,17485,23889,959995,455436,234485,85684,712441,445838,152303,893153,415366,276353,333579,12701,215103,634981,101899,237136,406967,791869,118087,541763,122338,482545,743218,252999,470643,921418,855856,271769,27950,354409,323122,1004158,303566,56798,239172,788393,198920,407789,343292,677807,809368,358794,1141081,226697,479109,245450,971218,544292,950369,1137699,565227,490763,1018798,595937,458376,239187,1020698,69212,801830,1029726,908452,130941,730215,153146,769803,1033111,616383,812194,994140,905330,901848,889759,568052,1110622,552078,525970,1142752,945773,646226,531469,43933,1078444,613088,101931,732720,609489,674025,943503,235085,991317,316445,632425,53800,534305,834149,756221,352852,171483,809725,1095329,929425,259841,1001569,942477,1118557,39080,201055,1124347,1050816,453169,1067886,40358,824145,376722,837225,470993,351463,225498,1079492,70330,145081,467572,86000,814009,349101,785715,657569,82603,920234,490463,1165022,793935,964123,887479};

static const __m256i V_B4Q_B4Q_B4Q_B4Q = {BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q, BARRETT_FACTOR_4Q};
static const __m256i V_B8Q_B8Q_B8Q_B8Q = {BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q, BARRETT_FACTOR_8Q};
static const __m256i V_B16Q_B16Q_B16Q_B16Q = {BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q, BARRETT_FACTOR_16Q};
static const __m256i V_B32Q_B32Q_B32Q_B32Q = {BARRETT_FACTOR_32Q, BARRETT_FACTOR_32Q, BARRETT_FACTOR_32Q, BARRETT_FACTOR_32Q};
static const __m256i V_Q_Q_Q_Q = {Q, Q, Q, Q};
static const __m256i V_Q2_Q2_Q2_Q2 = {Q2, Q2, Q2, Q2};
static const __m256i V_MM_MM_MM_MM = {MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK, MONTGOMERY_MASK};
static const __m256i V_MF_MF_MF_MF = {MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR, MONTGOMERY_FACTOR};

/* bit reverse step of dimension 256 */
static void bit_reverse_256(uint64_t *a)
{
uint64_t t;
t=a[1];a[1]=a[128];a[128]=t;
t=a[2];a[2]=a[64];a[64]=t;
t=a[3];a[3]=a[192];a[192]=t;
t=a[4];a[4]=a[32];a[32]=t;
t=a[5];a[5]=a[160];a[160]=t;
t=a[6];a[6]=a[96];a[96]=t;
t=a[7];a[7]=a[224];a[224]=t;
t=a[8];a[8]=a[16];a[16]=t;
t=a[9];a[9]=a[144];a[144]=t;
t=a[10];a[10]=a[80];a[80]=t;
t=a[11];a[11]=a[208];a[208]=t;
t=a[12];a[12]=a[48];a[48]=t;
t=a[13];a[13]=a[176];a[176]=t;
t=a[14];a[14]=a[112];a[112]=t;
t=a[15];a[15]=a[240];a[240]=t;
t=a[17];a[17]=a[136];a[136]=t;
t=a[18];a[18]=a[72];a[72]=t;
t=a[19];a[19]=a[200];a[200]=t;
t=a[20];a[20]=a[40];a[40]=t;
t=a[21];a[21]=a[168];a[168]=t;
t=a[22];a[22]=a[104];a[104]=t;
t=a[23];a[23]=a[232];a[232]=t;
t=a[25];a[25]=a[152];a[152]=t;
t=a[26];a[26]=a[88];a[88]=t;
t=a[27];a[27]=a[216];a[216]=t;
t=a[28];a[28]=a[56];a[56]=t;
t=a[29];a[29]=a[184];a[184]=t;
t=a[30];a[30]=a[120];a[120]=t;
t=a[31];a[31]=a[248];a[248]=t;
t=a[33];a[33]=a[132];a[132]=t;
t=a[34];a[34]=a[68];a[68]=t;
t=a[35];a[35]=a[196];a[196]=t;
t=a[37];a[37]=a[164];a[164]=t;
t=a[38];a[38]=a[100];a[100]=t;
t=a[39];a[39]=a[228];a[228]=t;
t=a[41];a[41]=a[148];a[148]=t;
t=a[42];a[42]=a[84];a[84]=t;
t=a[43];a[43]=a[212];a[212]=t;
t=a[44];a[44]=a[52];a[52]=t;
t=a[45];a[45]=a[180];a[180]=t;
t=a[46];a[46]=a[116];a[116]=t;
t=a[47];a[47]=a[244];a[244]=t;
t=a[49];a[49]=a[140];a[140]=t;
t=a[50];a[50]=a[76];a[76]=t;
t=a[51];a[51]=a[204];a[204]=t;
t=a[53];a[53]=a[172];a[172]=t;
t=a[54];a[54]=a[108];a[108]=t;
t=a[55];a[55]=a[236];a[236]=t;
t=a[57];a[57]=a[156];a[156]=t;
t=a[58];a[58]=a[92];a[92]=t;
t=a[59];a[59]=a[220];a[220]=t;
t=a[61];a[61]=a[188];a[188]=t;
t=a[62];a[62]=a[124];a[124]=t;
t=a[63];a[63]=a[252];a[252]=t;
t=a[65];a[65]=a[130];a[130]=t;
t=a[67];a[67]=a[194];a[194]=t;
t=a[69];a[69]=a[162];a[162]=t;
t=a[70];a[70]=a[98];a[98]=t;
t=a[71];a[71]=a[226];a[226]=t;
t=a[73];a[73]=a[146];a[146]=t;
t=a[74];a[74]=a[82];a[82]=t;
t=a[75];a[75]=a[210];a[210]=t;
t=a[77];a[77]=a[178];a[178]=t;
t=a[78];a[78]=a[114];a[114]=t;
t=a[79];a[79]=a[242];a[242]=t;
t=a[81];a[81]=a[138];a[138]=t;
t=a[83];a[83]=a[202];a[202]=t;
t=a[85];a[85]=a[170];a[170]=t;
t=a[86];a[86]=a[106];a[106]=t;
t=a[87];a[87]=a[234];a[234]=t;
t=a[89];a[89]=a[154];a[154]=t;
t=a[91];a[91]=a[218];a[218]=t;
t=a[93];a[93]=a[186];a[186]=t;
t=a[94];a[94]=a[122];a[122]=t;
t=a[95];a[95]=a[250];a[250]=t;
t=a[97];a[97]=a[134];a[134]=t;
t=a[99];a[99]=a[198];a[198]=t;
t=a[101];a[101]=a[166];a[166]=t;
t=a[103];a[103]=a[230];a[230]=t;
t=a[105];a[105]=a[150];a[150]=t;
t=a[107];a[107]=a[214];a[214]=t;
t=a[109];a[109]=a[182];a[182]=t;
t=a[110];a[110]=a[118];a[118]=t;
t=a[111];a[111]=a[246];a[246]=t;
t=a[113];a[113]=a[142];a[142]=t;
t=a[115];a[115]=a[206];a[206]=t;
t=a[117];a[117]=a[174];a[174]=t;
t=a[119];a[119]=a[238];a[238]=t;
t=a[121];a[121]=a[158];a[158]=t;
t=a[123];a[123]=a[222];a[222]=t;
t=a[125];a[125]=a[190];a[190]=t;
t=a[127];a[127]=a[254];a[254]=t;
t=a[131];a[131]=a[193];a[193]=t;
t=a[133];a[133]=a[161];a[161]=t;
t=a[135];a[135]=a[225];a[225]=t;
t=a[137];a[137]=a[145];a[145]=t;
t=a[139];a[139]=a[209];a[209]=t;
t=a[141];a[141]=a[177];a[177]=t;
t=a[143];a[143]=a[241];a[241]=t;
t=a[147];a[147]=a[201];a[201]=t;
t=a[149];a[149]=a[169];a[169]=t;
t=a[151];a[151]=a[233];a[233]=t;
t=a[155];a[155]=a[217];a[217]=t;
t=a[157];a[157]=a[185];a[185]=t;
t=a[159];a[159]=a[249];a[249]=t;
t=a[163];a[163]=a[197];a[197]=t;
t=a[167];a[167]=a[229];a[229]=t;
t=a[171];a[171]=a[213];a[213]=t;
t=a[173];a[173]=a[181];a[181]=t;
t=a[175];a[175]=a[245];a[245]=t;
t=a[179];a[179]=a[205];a[205]=t;
t=a[183];a[183]=a[237];a[237]=t;
t=a[187];a[187]=a[221];a[221]=t;
t=a[191];a[191]=a[253];a[253]=t;
t=a[199];a[199]=a[227];a[227]=t;
t=a[203];a[203]=a[211];a[211]=t;
t=a[207];a[207]=a[243];a[243]=t;
t=a[215];a[215]=a[235];a[235]=t;
t=a[223];a[223]=a[251];a[251]=t;
t=a[239];a[239]=a[247];a[247]=t;
}

/* bit reverse step of dimension 1024 */
static void bit_reverse_1024(uint64_t *a)
{
uint64_t t;
t=a[1];a[1]=a[512];a[512]=t;
t=a[2];a[2]=a[256];a[256]=t;
t=a[3];a[3]=a[768];a[768]=t;
t=a[4];a[4]=a[128];a[128]=t;
t=a[5];a[5]=a[640];a[640]=t;
t=a[6];a[6]=a[384];a[384]=t;
t=a[7];a[7]=a[896];a[896]=t;
t=a[8];a[8]=a[64];a[64]=t;
t=a[9];a[9]=a[576];a[576]=t;
t=a[10];a[10]=a[320];a[320]=t;
t=a[11];a[11]=a[832];a[832]=t;
t=a[12];a[12]=a[192];a[192]=t;
t=a[13];a[13]=a[704];a[704]=t;
t=a[14];a[14]=a[448];a[448]=t;
t=a[15];a[15]=a[960];a[960]=t;
t=a[16];a[16]=a[32];a[32]=t;
t=a[17];a[17]=a[544];a[544]=t;
t=a[18];a[18]=a[288];a[288]=t;
t=a[19];a[19]=a[800];a[800]=t;
t=a[20];a[20]=a[160];a[160]=t;
t=a[21];a[21]=a[672];a[672]=t;
t=a[22];a[22]=a[416];a[416]=t;
t=a[23];a[23]=a[928];a[928]=t;
t=a[24];a[24]=a[96];a[96]=t;
t=a[25];a[25]=a[608];a[608]=t;
t=a[26];a[26]=a[352];a[352]=t;
t=a[27];a[27]=a[864];a[864]=t;
t=a[28];a[28]=a[224];a[224]=t;
t=a[29];a[29]=a[736];a[736]=t;
t=a[30];a[30]=a[480];a[480]=t;
t=a[31];a[31]=a[992];a[992]=t;
t=a[33];a[33]=a[528];a[528]=t;
t=a[34];a[34]=a[272];a[272]=t;
t=a[35];a[35]=a[784];a[784]=t;
t=a[36];a[36]=a[144];a[144]=t;
t=a[37];a[37]=a[656];a[656]=t;
t=a[38];a[38]=a[400];a[400]=t;
t=a[39];a[39]=a[912];a[912]=t;
t=a[40];a[40]=a[80];a[80]=t;
t=a[41];a[41]=a[592];a[592]=t;
t=a[42];a[42]=a[336];a[336]=t;
t=a[43];a[43]=a[848];a[848]=t;
t=a[44];a[44]=a[208];a[208]=t;
t=a[45];a[45]=a[720];a[720]=t;
t=a[46];a[46]=a[464];a[464]=t;
t=a[47];a[47]=a[976];a[976]=t;
t=a[49];a[49]=a[560];a[560]=t;
t=a[50];a[50]=a[304];a[304]=t;
t=a[51];a[51]=a[816];a[816]=t;
t=a[52];a[52]=a[176];a[176]=t;
t=a[53];a[53]=a[688];a[688]=t;
t=a[54];a[54]=a[432];a[432]=t;
t=a[55];a[55]=a[944];a[944]=t;
t=a[56];a[56]=a[112];a[112]=t;
t=a[57];a[57]=a[624];a[624]=t;
t=a[58];a[58]=a[368];a[368]=t;
t=a[59];a[59]=a[880];a[880]=t;
t=a[60];a[60]=a[240];a[240]=t;
t=a[61];a[61]=a[752];a[752]=t;
t=a[62];a[62]=a[496];a[496]=t;
t=a[63];a[63]=a[1008];a[1008]=t;
t=a[65];a[65]=a[520];a[520]=t;
t=a[66];a[66]=a[264];a[264]=t;
t=a[67];a[67]=a[776];a[776]=t;
t=a[68];a[68]=a[136];a[136]=t;
t=a[69];a[69]=a[648];a[648]=t;
t=a[70];a[70]=a[392];a[392]=t;
t=a[71];a[71]=a[904];a[904]=t;
t=a[73];a[73]=a[584];a[584]=t;
t=a[74];a[74]=a[328];a[328]=t;
t=a[75];a[75]=a[840];a[840]=t;
t=a[76];a[76]=a[200];a[200]=t;
t=a[77];a[77]=a[712];a[712]=t;
t=a[78];a[78]=a[456];a[456]=t;
t=a[79];a[79]=a[968];a[968]=t;
t=a[81];a[81]=a[552];a[552]=t;
t=a[82];a[82]=a[296];a[296]=t;
t=a[83];a[83]=a[808];a[808]=t;
t=a[84];a[84]=a[168];a[168]=t;
t=a[85];a[85]=a[680];a[680]=t;
t=a[86];a[86]=a[424];a[424]=t;
t=a[87];a[87]=a[936];a[936]=t;
t=a[88];a[88]=a[104];a[104]=t;
t=a[89];a[89]=a[616];a[616]=t;
t=a[90];a[90]=a[360];a[360]=t;
t=a[91];a[91]=a[872];a[872]=t;
t=a[92];a[92]=a[232];a[232]=t;
t=a[93];a[93]=a[744];a[744]=t;
t=a[94];a[94]=a[488];a[488]=t;
t=a[95];a[95]=a[1000];a[1000]=t;
t=a[97];a[97]=a[536];a[536]=t;
t=a[98];a[98]=a[280];a[280]=t;
t=a[99];a[99]=a[792];a[792]=t;
t=a[100];a[100]=a[152];a[152]=t;
t=a[101];a[101]=a[664];a[664]=t;
t=a[102];a[102]=a[408];a[408]=t;
t=a[103];a[103]=a[920];a[920]=t;
t=a[105];a[105]=a[600];a[600]=t;
t=a[106];a[106]=a[344];a[344]=t;
t=a[107];a[107]=a[856];a[856]=t;
t=a[108];a[108]=a[216];a[216]=t;
t=a[109];a[109]=a[728];a[728]=t;
t=a[110];a[110]=a[472];a[472]=t;
t=a[111];a[111]=a[984];a[984]=t;
t=a[113];a[113]=a[568];a[568]=t;
t=a[114];a[114]=a[312];a[312]=t;
t=a[115];a[115]=a[824];a[824]=t;
t=a[116];a[116]=a[184];a[184]=t;
t=a[117];a[117]=a[696];a[696]=t;
t=a[118];a[118]=a[440];a[440]=t;
t=a[119];a[119]=a[952];a[952]=t;
t=a[121];a[121]=a[632];a[632]=t;
t=a[122];a[122]=a[376];a[376]=t;
t=a[123];a[123]=a[888];a[888]=t;
t=a[124];a[124]=a[248];a[248]=t;
t=a[125];a[125]=a[760];a[760]=t;
t=a[126];a[126]=a[504];a[504]=t;
t=a[127];a[127]=a[1016];a[1016]=t;
t=a[129];a[129]=a[516];a[516]=t;
t=a[130];a[130]=a[260];a[260]=t;
t=a[131];a[131]=a[772];a[772]=t;
t=a[133];a[133]=a[644];a[644]=t;
t=a[134];a[134]=a[388];a[388]=t;
t=a[135];a[135]=a[900];a[900]=t;
t=a[137];a[137]=a[580];a[580]=t;
t=a[138];a[138]=a[324];a[324]=t;
t=a[139];a[139]=a[836];a[836]=t;
t=a[140];a[140]=a[196];a[196]=t;
t=a[141];a[141]=a[708];a[708]=t;
t=a[142];a[142]=a[452];a[452]=t;
t=a[143];a[143]=a[964];a[964]=t;
t=a[145];a[145]=a[548];a[548]=t;
t=a[146];a[146]=a[292];a[292]=t;
t=a[147];a[147]=a[804];a[804]=t;
t=a[148];a[148]=a[164];a[164]=t;
t=a[149];a[149]=a[676];a[676]=t;
t=a[150];a[150]=a[420];a[420]=t;
t=a[151];a[151]=a[932];a[932]=t;
t=a[153];a[153]=a[612];a[612]=t;
t=a[154];a[154]=a[356];a[356]=t;
t=a[155];a[155]=a[868];a[868]=t;
t=a[156];a[156]=a[228];a[228]=t;
t=a[157];a[157]=a[740];a[740]=t;
t=a[158];a[158]=a[484];a[484]=t;
t=a[159];a[159]=a[996];a[996]=t;
t=a[161];a[161]=a[532];a[532]=t;
t=a[162];a[162]=a[276];a[276]=t;
t=a[163];a[163]=a[788];a[788]=t;
t=a[165];a[165]=a[660];a[660]=t;
t=a[166];a[166]=a[404];a[404]=t;
t=a[167];a[167]=a[916];a[916]=t;
t=a[169];a[169]=a[596];a[596]=t;
t=a[170];a[170]=a[340];a[340]=t;
t=a[171];a[171]=a[852];a[852]=t;
t=a[172];a[172]=a[212];a[212]=t;
t=a[173];a[173]=a[724];a[724]=t;
t=a[174];a[174]=a[468];a[468]=t;
t=a[175];a[175]=a[980];a[980]=t;
t=a[177];a[177]=a[564];a[564]=t;
t=a[178];a[178]=a[308];a[308]=t;
t=a[179];a[179]=a[820];a[820]=t;
t=a[181];a[181]=a[692];a[692]=t;
t=a[182];a[182]=a[436];a[436]=t;
t=a[183];a[183]=a[948];a[948]=t;
t=a[185];a[185]=a[628];a[628]=t;
t=a[186];a[186]=a[372];a[372]=t;
t=a[187];a[187]=a[884];a[884]=t;
t=a[188];a[188]=a[244];a[244]=t;
t=a[189];a[189]=a[756];a[756]=t;
t=a[190];a[190]=a[500];a[500]=t;
t=a[191];a[191]=a[1012];a[1012]=t;
t=a[193];a[193]=a[524];a[524]=t;
t=a[194];a[194]=a[268];a[268]=t;
t=a[195];a[195]=a[780];a[780]=t;
t=a[197];a[197]=a[652];a[652]=t;
t=a[198];a[198]=a[396];a[396]=t;
t=a[199];a[199]=a[908];a[908]=t;
t=a[201];a[201]=a[588];a[588]=t;
t=a[202];a[202]=a[332];a[332]=t;
t=a[203];a[203]=a[844];a[844]=t;
t=a[205];a[205]=a[716];a[716]=t;
t=a[206];a[206]=a[460];a[460]=t;
t=a[207];a[207]=a[972];a[972]=t;
t=a[209];a[209]=a[556];a[556]=t;
t=a[210];a[210]=a[300];a[300]=t;
t=a[211];a[211]=a[812];a[812]=t;
t=a[213];a[213]=a[684];a[684]=t;
t=a[214];a[214]=a[428];a[428]=t;
t=a[215];a[215]=a[940];a[940]=t;
t=a[217];a[217]=a[620];a[620]=t;
t=a[218];a[218]=a[364];a[364]=t;
t=a[219];a[219]=a[876];a[876]=t;
t=a[220];a[220]=a[236];a[236]=t;
t=a[221];a[221]=a[748];a[748]=t;
t=a[222];a[222]=a[492];a[492]=t;
t=a[223];a[223]=a[1004];a[1004]=t;
t=a[225];a[225]=a[540];a[540]=t;
t=a[226];a[226]=a[284];a[284]=t;
t=a[227];a[227]=a[796];a[796]=t;
t=a[229];a[229]=a[668];a[668]=t;
t=a[230];a[230]=a[412];a[412]=t;
t=a[231];a[231]=a[924];a[924]=t;
t=a[233];a[233]=a[604];a[604]=t;
t=a[234];a[234]=a[348];a[348]=t;
t=a[235];a[235]=a[860];a[860]=t;
t=a[237];a[237]=a[732];a[732]=t;
t=a[238];a[238]=a[476];a[476]=t;
t=a[239];a[239]=a[988];a[988]=t;
t=a[241];a[241]=a[572];a[572]=t;
t=a[242];a[242]=a[316];a[316]=t;
t=a[243];a[243]=a[828];a[828]=t;
t=a[245];a[245]=a[700];a[700]=t;
t=a[246];a[246]=a[444];a[444]=t;
t=a[247];a[247]=a[956];a[956]=t;
t=a[249];a[249]=a[636];a[636]=t;
t=a[250];a[250]=a[380];a[380]=t;
t=a[251];a[251]=a[892];a[892]=t;
t=a[253];a[253]=a[764];a[764]=t;
t=a[254];a[254]=a[508];a[508]=t;
t=a[255];a[255]=a[1020];a[1020]=t;
t=a[257];a[257]=a[514];a[514]=t;
t=a[259];a[259]=a[770];a[770]=t;
t=a[261];a[261]=a[642];a[642]=t;
t=a[262];a[262]=a[386];a[386]=t;
t=a[263];a[263]=a[898];a[898]=t;
t=a[265];a[265]=a[578];a[578]=t;
t=a[266];a[266]=a[322];a[322]=t;
t=a[267];a[267]=a[834];a[834]=t;
t=a[269];a[269]=a[706];a[706]=t;
t=a[270];a[270]=a[450];a[450]=t;
t=a[271];a[271]=a[962];a[962]=t;
t=a[273];a[273]=a[546];a[546]=t;
t=a[274];a[274]=a[290];a[290]=t;
t=a[275];a[275]=a[802];a[802]=t;
t=a[277];a[277]=a[674];a[674]=t;
t=a[278];a[278]=a[418];a[418]=t;
t=a[279];a[279]=a[930];a[930]=t;
t=a[281];a[281]=a[610];a[610]=t;
t=a[282];a[282]=a[354];a[354]=t;
t=a[283];a[283]=a[866];a[866]=t;
t=a[285];a[285]=a[738];a[738]=t;
t=a[286];a[286]=a[482];a[482]=t;
t=a[287];a[287]=a[994];a[994]=t;
t=a[289];a[289]=a[530];a[530]=t;
t=a[291];a[291]=a[786];a[786]=t;
t=a[293];a[293]=a[658];a[658]=t;
t=a[294];a[294]=a[402];a[402]=t;
t=a[295];a[295]=a[914];a[914]=t;
t=a[297];a[297]=a[594];a[594]=t;
t=a[298];a[298]=a[338];a[338]=t;
t=a[299];a[299]=a[850];a[850]=t;
t=a[301];a[301]=a[722];a[722]=t;
t=a[302];a[302]=a[466];a[466]=t;
t=a[303];a[303]=a[978];a[978]=t;
t=a[305];a[305]=a[562];a[562]=t;
t=a[307];a[307]=a[818];a[818]=t;
t=a[309];a[309]=a[690];a[690]=t;
t=a[310];a[310]=a[434];a[434]=t;
t=a[311];a[311]=a[946];a[946]=t;
t=a[313];a[313]=a[626];a[626]=t;
t=a[314];a[314]=a[370];a[370]=t;
t=a[315];a[315]=a[882];a[882]=t;
t=a[317];a[317]=a[754];a[754]=t;
t=a[318];a[318]=a[498];a[498]=t;
t=a[319];a[319]=a[1010];a[1010]=t;
t=a[321];a[321]=a[522];a[522]=t;
t=a[323];a[323]=a[778];a[778]=t;
t=a[325];a[325]=a[650];a[650]=t;
t=a[326];a[326]=a[394];a[394]=t;
t=a[327];a[327]=a[906];a[906]=t;
t=a[329];a[329]=a[586];a[586]=t;
t=a[331];a[331]=a[842];a[842]=t;
t=a[333];a[333]=a[714];a[714]=t;
t=a[334];a[334]=a[458];a[458]=t;
t=a[335];a[335]=a[970];a[970]=t;
t=a[337];a[337]=a[554];a[554]=t;
t=a[339];a[339]=a[810];a[810]=t;
t=a[341];a[341]=a[682];a[682]=t;
t=a[342];a[342]=a[426];a[426]=t;
t=a[343];a[343]=a[938];a[938]=t;
t=a[345];a[345]=a[618];a[618]=t;
t=a[346];a[346]=a[362];a[362]=t;
t=a[347];a[347]=a[874];a[874]=t;
t=a[349];a[349]=a[746];a[746]=t;
t=a[350];a[350]=a[490];a[490]=t;
t=a[351];a[351]=a[1002];a[1002]=t;
t=a[353];a[353]=a[538];a[538]=t;
t=a[355];a[355]=a[794];a[794]=t;
t=a[357];a[357]=a[666];a[666]=t;
t=a[358];a[358]=a[410];a[410]=t;
t=a[359];a[359]=a[922];a[922]=t;
t=a[361];a[361]=a[602];a[602]=t;
t=a[363];a[363]=a[858];a[858]=t;
t=a[365];a[365]=a[730];a[730]=t;
t=a[366];a[366]=a[474];a[474]=t;
t=a[367];a[367]=a[986];a[986]=t;
t=a[369];a[369]=a[570];a[570]=t;
t=a[371];a[371]=a[826];a[826]=t;
t=a[373];a[373]=a[698];a[698]=t;
t=a[374];a[374]=a[442];a[442]=t;
t=a[375];a[375]=a[954];a[954]=t;
t=a[377];a[377]=a[634];a[634]=t;
t=a[379];a[379]=a[890];a[890]=t;
t=a[381];a[381]=a[762];a[762]=t;
t=a[382];a[382]=a[506];a[506]=t;
t=a[383];a[383]=a[1018];a[1018]=t;
t=a[385];a[385]=a[518];a[518]=t;
t=a[387];a[387]=a[774];a[774]=t;
t=a[389];a[389]=a[646];a[646]=t;
t=a[391];a[391]=a[902];a[902]=t;
t=a[393];a[393]=a[582];a[582]=t;
t=a[395];a[395]=a[838];a[838]=t;
t=a[397];a[397]=a[710];a[710]=t;
t=a[398];a[398]=a[454];a[454]=t;
t=a[399];a[399]=a[966];a[966]=t;
t=a[401];a[401]=a[550];a[550]=t;
t=a[403];a[403]=a[806];a[806]=t;
t=a[405];a[405]=a[678];a[678]=t;
t=a[406];a[406]=a[422];a[422]=t;
t=a[407];a[407]=a[934];a[934]=t;
t=a[409];a[409]=a[614];a[614]=t;
t=a[411];a[411]=a[870];a[870]=t;
t=a[413];a[413]=a[742];a[742]=t;
t=a[414];a[414]=a[486];a[486]=t;
t=a[415];a[415]=a[998];a[998]=t;
t=a[417];a[417]=a[534];a[534]=t;
t=a[419];a[419]=a[790];a[790]=t;
t=a[421];a[421]=a[662];a[662]=t;
t=a[423];a[423]=a[918];a[918]=t;
t=a[425];a[425]=a[598];a[598]=t;
t=a[427];a[427]=a[854];a[854]=t;
t=a[429];a[429]=a[726];a[726]=t;
t=a[430];a[430]=a[470];a[470]=t;
t=a[431];a[431]=a[982];a[982]=t;
t=a[433];a[433]=a[566];a[566]=t;
t=a[435];a[435]=a[822];a[822]=t;
t=a[437];a[437]=a[694];a[694]=t;
t=a[439];a[439]=a[950];a[950]=t;
t=a[441];a[441]=a[630];a[630]=t;
t=a[443];a[443]=a[886];a[886]=t;
t=a[445];a[445]=a[758];a[758]=t;
t=a[446];a[446]=a[502];a[502]=t;
t=a[447];a[447]=a[1014];a[1014]=t;
t=a[449];a[449]=a[526];a[526]=t;
t=a[451];a[451]=a[782];a[782]=t;
t=a[453];a[453]=a[654];a[654]=t;
t=a[455];a[455]=a[910];a[910]=t;
t=a[457];a[457]=a[590];a[590]=t;
t=a[459];a[459]=a[846];a[846]=t;
t=a[461];a[461]=a[718];a[718]=t;
t=a[463];a[463]=a[974];a[974]=t;
t=a[465];a[465]=a[558];a[558]=t;
t=a[467];a[467]=a[814];a[814]=t;
t=a[469];a[469]=a[686];a[686]=t;
t=a[471];a[471]=a[942];a[942]=t;
t=a[473];a[473]=a[622];a[622]=t;
t=a[475];a[475]=a[878];a[878]=t;
t=a[477];a[477]=a[750];a[750]=t;
t=a[478];a[478]=a[494];a[494]=t;
t=a[479];a[479]=a[1006];a[1006]=t;
t=a[481];a[481]=a[542];a[542]=t;
t=a[483];a[483]=a[798];a[798]=t;
t=a[485];a[485]=a[670];a[670]=t;
t=a[487];a[487]=a[926];a[926]=t;
t=a[489];a[489]=a[606];a[606]=t;
t=a[491];a[491]=a[862];a[862]=t;
t=a[493];a[493]=a[734];a[734]=t;
t=a[495];a[495]=a[990];a[990]=t;
t=a[497];a[497]=a[574];a[574]=t;
t=a[499];a[499]=a[830];a[830]=t;
t=a[501];a[501]=a[702];a[702]=t;
t=a[503];a[503]=a[958];a[958]=t;
t=a[505];a[505]=a[638];a[638]=t;
t=a[507];a[507]=a[894];a[894]=t;
t=a[509];a[509]=a[766];a[766]=t;
t=a[511];a[511]=a[1022];a[1022]=t;
t=a[515];a[515]=a[769];a[769]=t;
t=a[517];a[517]=a[641];a[641]=t;
t=a[519];a[519]=a[897];a[897]=t;
t=a[521];a[521]=a[577];a[577]=t;
t=a[523];a[523]=a[833];a[833]=t;
t=a[525];a[525]=a[705];a[705]=t;
t=a[527];a[527]=a[961];a[961]=t;
t=a[529];a[529]=a[545];a[545]=t;
t=a[531];a[531]=a[801];a[801]=t;
t=a[533];a[533]=a[673];a[673]=t;
t=a[535];a[535]=a[929];a[929]=t;
t=a[537];a[537]=a[609];a[609]=t;
t=a[539];a[539]=a[865];a[865]=t;
t=a[541];a[541]=a[737];a[737]=t;
t=a[543];a[543]=a[993];a[993]=t;
t=a[547];a[547]=a[785];a[785]=t;
t=a[549];a[549]=a[657];a[657]=t;
t=a[551];a[551]=a[913];a[913]=t;
t=a[553];a[553]=a[593];a[593]=t;
t=a[555];a[555]=a[849];a[849]=t;
t=a[557];a[557]=a[721];a[721]=t;
t=a[559];a[559]=a[977];a[977]=t;
t=a[563];a[563]=a[817];a[817]=t;
t=a[565];a[565]=a[689];a[689]=t;
t=a[567];a[567]=a[945];a[945]=t;
t=a[569];a[569]=a[625];a[625]=t;
t=a[571];a[571]=a[881];a[881]=t;
t=a[573];a[573]=a[753];a[753]=t;
t=a[575];a[575]=a[1009];a[1009]=t;
t=a[579];a[579]=a[777];a[777]=t;
t=a[581];a[581]=a[649];a[649]=t;
t=a[583];a[583]=a[905];a[905]=t;
t=a[587];a[587]=a[841];a[841]=t;
t=a[589];a[589]=a[713];a[713]=t;
t=a[591];a[591]=a[969];a[969]=t;
t=a[595];a[595]=a[809];a[809]=t;
t=a[597];a[597]=a[681];a[681]=t;
t=a[599];a[599]=a[937];a[937]=t;
t=a[601];a[601]=a[617];a[617]=t;
t=a[603];a[603]=a[873];a[873]=t;
t=a[605];a[605]=a[745];a[745]=t;
t=a[607];a[607]=a[1001];a[1001]=t;
t=a[611];a[611]=a[793];a[793]=t;
t=a[613];a[613]=a[665];a[665]=t;
t=a[615];a[615]=a[921];a[921]=t;
t=a[619];a[619]=a[857];a[857]=t;
t=a[621];a[621]=a[729];a[729]=t;
t=a[623];a[623]=a[985];a[985]=t;
t=a[627];a[627]=a[825];a[825]=t;
t=a[629];a[629]=a[697];a[697]=t;
t=a[631];a[631]=a[953];a[953]=t;
t=a[635];a[635]=a[889];a[889]=t;
t=a[637];a[637]=a[761];a[761]=t;
t=a[639];a[639]=a[1017];a[1017]=t;
t=a[643];a[643]=a[773];a[773]=t;
t=a[647];a[647]=a[901];a[901]=t;
t=a[651];a[651]=a[837];a[837]=t;
t=a[653];a[653]=a[709];a[709]=t;
t=a[655];a[655]=a[965];a[965]=t;
t=a[659];a[659]=a[805];a[805]=t;
t=a[661];a[661]=a[677];a[677]=t;
t=a[663];a[663]=a[933];a[933]=t;
t=a[667];a[667]=a[869];a[869]=t;
t=a[669];a[669]=a[741];a[741]=t;
t=a[671];a[671]=a[997];a[997]=t;
t=a[675];a[675]=a[789];a[789]=t;
t=a[679];a[679]=a[917];a[917]=t;
t=a[683];a[683]=a[853];a[853]=t;
t=a[685];a[685]=a[725];a[725]=t;
t=a[687];a[687]=a[981];a[981]=t;
t=a[691];a[691]=a[821];a[821]=t;
t=a[695];a[695]=a[949];a[949]=t;
t=a[699];a[699]=a[885];a[885]=t;
t=a[701];a[701]=a[757];a[757]=t;
t=a[703];a[703]=a[1013];a[1013]=t;
t=a[707];a[707]=a[781];a[781]=t;
t=a[711];a[711]=a[909];a[909]=t;
t=a[715];a[715]=a[845];a[845]=t;
t=a[719];a[719]=a[973];a[973]=t;
t=a[723];a[723]=a[813];a[813]=t;
t=a[727];a[727]=a[941];a[941]=t;
t=a[731];a[731]=a[877];a[877]=t;
t=a[733];a[733]=a[749];a[749]=t;
t=a[735];a[735]=a[1005];a[1005]=t;
t=a[739];a[739]=a[797];a[797]=t;
t=a[743];a[743]=a[925];a[925]=t;
t=a[747];a[747]=a[861];a[861]=t;
t=a[751];a[751]=a[989];a[989]=t;
t=a[755];a[755]=a[829];a[829]=t;
t=a[759];a[759]=a[957];a[957]=t;
t=a[763];a[763]=a[893];a[893]=t;
t=a[767];a[767]=a[1021];a[1021]=t;
t=a[775];a[775]=a[899];a[899]=t;
t=a[779];a[779]=a[835];a[835]=t;
t=a[783];a[783]=a[963];a[963]=t;
t=a[787];a[787]=a[803];a[803]=t;
t=a[791];a[791]=a[931];a[931]=t;
t=a[795];a[795]=a[867];a[867]=t;
t=a[799];a[799]=a[995];a[995]=t;
t=a[807];a[807]=a[915];a[915]=t;
t=a[811];a[811]=a[851];a[851]=t;
t=a[815];a[815]=a[979];a[979]=t;
t=a[823];a[823]=a[947];a[947]=t;
t=a[827];a[827]=a[883];a[883]=t;
t=a[831];a[831]=a[1011];a[1011]=t;
t=a[839];a[839]=a[907];a[907]=t;
t=a[847];a[847]=a[971];a[971]=t;
t=a[855];a[855]=a[939];a[939]=t;
t=a[859];a[859]=a[875];a[875]=t;
t=a[863];a[863]=a[1003];a[1003]=t;
t=a[871];a[871]=a[923];a[923]=t;
t=a[879];a[879]=a[987];a[987]=t;
t=a[887];a[887]=a[955];a[955]=t;
t=a[895];a[895]=a[1019];a[1019]=t;
t=a[911];a[911]=a[967];a[967]=t;
t=a[919];a[919]=a[935];a[935]=t;
t=a[927];a[927]=a[999];a[999]=t;
t=a[943];a[943]=a[983];a[983]=t;
t=a[959];a[959]=a[1015];a[1015]=t;
t=a[991];a[991]=a[1007];a[1007]=t;
}

/* DIF radix-2 NTT */
static void ntt_2(uint64_t *a, uint32_t n, const uint64_t *omega)
{
	uint32_t num_of_problems = 1;
	uint32_t d = n >> 1;
	uint32_t j1, j2, j_omega;
	uint32_t k, j;
	
	__m256i u, v, t, t1, o, u1, v1, r1, r2;

	while (d > 2)
	{
		for (k = 0; k < num_of_problems; k++)
		{
			/* Gentleman-Sande's butterfly
			 * (u, v) <-- (u + v, (u - v) * omega) % Q
			 * where omega = 1 (save 1 multiplication) */
			j1 = 2 * k * d;
			j2 = j1 + d;
			
			j_omega = 0;

			for (j = j1; j < j2; j += 4)
			{
				/* Gentleman-Sande's butterfly
				 * (u, v) <-- (u + v, (u - v) * omega) % Q */
				u = _mm256_loadu_si256((__m256i *)(a + j));
				v = _mm256_loadu_si256((__m256i *)(a + j + d));
				
				t = _mm256_add_epi64(u, v);
				t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
				t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				r1 = _mm256_sub_epi64(t, t1);
				
				t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
				t = _mm256_sub_epi64(t, v);
				o = _mm256_set_epi64x(omega[j_omega + num_of_problems * 3], omega[j_omega + num_of_problems * 2], omega[j_omega + num_of_problems], omega[j_omega]);
				t = _mm256_mul_epu32(t, o);
				t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
				t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
				t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
				t1 = _mm256_add_epi64(t, t1);
				r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);

				_mm256_storeu_si256((__m256i *)(a + j), r1);
				_mm256_storeu_si256((__m256i *)(a + j + d), r2);

				j_omega += num_of_problems * 4;
			} 
		}
		
		num_of_problems <<= 1;
		d >>= 1;
	}
	
	/* last 2 levels (save some overhead of iterations) */
	for (k = 0; k < num_of_problems; k += 2)
	{
		j = k << 2;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);
		
		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		o = _mm256_set_epi64x(omega[num_of_problems], omega[0], omega[num_of_problems], omega[0]);
		t = _mm256_mul_epu32(t, o);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		r2 = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
		
		u = _mm256_permute2f128_si256(r1, r2, 0x20);
		v = _mm256_permute2f128_si256(r1, r2, 0x31);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
	
	for (k = 0; k < (n >> 1); k += 4)
	{
		j = k << 1;
		
		u1 = _mm256_loadu_si256((__m256i *)(a + j));
		v1 = _mm256_loadu_si256((__m256i *)(a + j + 4));
		u1 = _mm256_permute4x64_epi64(u1, 0xD8);
		v1 = _mm256_permute4x64_epi64(v1, 0xD8);
		u = _mm256_permute2f128_si256(u1, v1, 0x20);
		v = _mm256_permute2f128_si256(u1, v1, 0x31);
		
		t = _mm256_add_epi64(u, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r1 = _mm256_sub_epi64(t, t1);

		t = _mm256_add_epi64(V_Q2_Q2_Q2_Q2, u);
		t = _mm256_sub_epi64(t, v);
		t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
		t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		r2 = _mm256_sub_epi64(t, t1);

		u1 = _mm256_permute2f128_si256(r1, r2, 0x20);
		v1 = _mm256_permute2f128_si256(r1, r2, 0x31);
		u = _mm256_permute4x64_epi64(u1, 0xD8);
		v = _mm256_permute4x64_epi64(v1, 0xD8);
		
		_mm256_storeu_si256((__m256i *)(a + j), u);
		_mm256_storeu_si256((__m256i *)(a + j + 4), v);
	}
}

/* Partial NTT similar to Sorensen et al.'s work:
 * Efficient computation of the DFT with only a subset of input or output points
 * X(k1+N1k2)=sum_n2^{N2-1} [omega_N^{n2k1}](sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1})omega_N2^{n2k2}
 * http://ieeexplore.ieee.org/document/205723/
 * 
 * ntt_butterfly is the function of the "partial" subroutine of NTT
 * Note: we exclusively use DIF NTT from natural order input to bit-reversed order output (DIF_N-->DIF_R) for both NTT and Inverse-NTT,
 * because DIF_R-->DIF_N may not be able to be efficiently parallelized due to its non-consecutive memory access at each iteration */
static void ntt_core(uint64_t *a, uint32_t N1, uint32_t N2, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t), void (*bit_reverse)(uint64_t *))
{
	uint32_t n1, n2;
	__m256i u, v, t, t1;
	
	/* y_k1(n2)=sum_n1^{N1-1} x(N2n1+n2)omega_N1^{n1k1} */
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by corresponding twiddle factors 
	 * we don't need to multiply with those twiddle factors which is equal to 1 */
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
    /* sum_n2^{N2-1} [omega_N^{n2k1}]y_k1(n2)omega_N2^{n2k2} */
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
}

/* Inverse-NTT, which is the NTT in "reversed order" of each step 
 * X(k2+N2k1)=sum_n1^{N1-1} [omega_N^{-n1k2}](sum_n2^{N2-1} x(N1n2+n1)omega_N2^{-n2k2})omega_N1^{-n1k1} */
static void intt_core(uint64_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint64_t *omega_2, const uint64_t *omega_n, void (*ntt_butterfly)(uint64_t *, uint32_t), uint64_t inv_n, void (*bit_reverse)(uint64_t *))
{
	uint32_t i, n1, n2;
	__m256i u, v, t, t1;
	
	for (n1 = 0; n1 < N1; n1++)
	{
		ntt_2(a + N2 * n1, N2, omega_2);
		bit_reverse(a + N2 * n1);
	}
	
	for (n1 = 1; n1 < N1; n1++)
	{
		for (n2 = 0; n2 < N2; n2 += 4)
		{
			u = _mm256_loadu_si256((__m256i *)(a + N2 * n1 + n2));
			v = _mm256_set_epi64x(omega_n[n1 * (n2 + 3)], omega_n[n1 * (n2 + 2)], omega_n[n1 * (n2 + 1)], omega_n[n1 * n2]);
			
			t = _mm256_mul_epu32(u, v);
			t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
			t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
			t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
			t1 = _mm256_add_epi64(t, t1);
			u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
			_mm256_storeu_si256((__m256i *)(a + N2 * n1 + n2), u);
		}
	}
	
	for (n2 = 0; n2 < N2; n2 += 4)
	{
		ntt_butterfly(a, n2);
	}
	
	/* multiply each a coordinate by the multiplication inverse of the dimension n */
	for (i = 0; i < DIM; i += 4)
	{
		u = _mm256_loadu_si256((__m256i *)(a + i));
		v = _mm256_set1_epi64x(inv_n);
		
		t = _mm256_mul_epu32(u, v);
		t1 = _mm256_and_si256(t, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_MF_MF_MF_MF);
		t1 = _mm256_and_si256(t1, V_MM_MM_MM_MM);
		t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
		t1 = _mm256_add_epi64(t, t1);
		u = _mm256_srli_epi64(t1, MONTGOMERY_SHIFT);
			
		_mm256_storeu_si256((__m256i *)(a + i), u);
	}
}

/* 256 * 8 --> 256 * 13 */
static void ntt_butterfly_2048_3328(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, c1, d1, e1, f1, g1, h1, i1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_3328 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 6 + n2));
	i = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 7 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_13[0][0]);
	d1 = _mm256_mul_epu32(d, w_13[0][1]);
	e1 = _mm256_mul_epu32(e, w_13[0][2]);
	f1 = _mm256_mul_epu32(f, w_13[0][3]);
	g1 = _mm256_mul_epu32(g, w_13[0][4]);
	h1 = _mm256_mul_epu32(h, w_13[0][5]);
	i1 = _mm256_mul_epu32(i, w_13[0][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 + n2), t);
	a[N2_3328 + n2] %= Q;
	a[N2_3328 + n2 + 1] %= Q;
	a[N2_3328 + n2 + 2] %= Q;
	a[N2_3328 + n2 + 3] %= Q;
	
	c1 = _mm256_mul_epu32(c, w_13[1][0]);
	d1 = _mm256_mul_epu32(d, w_13[1][1]);
	e1 = _mm256_mul_epu32(e, w_13[1][2]);
	f1 = _mm256_mul_epu32(f, w_13[1][3]);
	g1 = _mm256_mul_epu32(g, w_13[1][4]);
	h1 = _mm256_mul_epu32(h, w_13[1][5]);
	i1 = _mm256_mul_epu32(i, w_13[1][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 2 + n2), t);
	a[N2_3328 * 2 + n2] %= Q;
	a[N2_3328 * 2 + n2 + 1] %= Q;
	a[N2_3328 * 2 + n2 + 2] %= Q;
	a[N2_3328 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[2][0]);
	d1 = _mm256_mul_epu32(d, w_13[2][1]);
	e1 = _mm256_mul_epu32(e, w_13[2][2]);
	f1 = _mm256_mul_epu32(f, w_13[2][3]);
	g1 = _mm256_mul_epu32(g, w_13[2][4]);
	h1 = _mm256_mul_epu32(h, w_13[2][5]);
	i1 = _mm256_mul_epu32(i, w_13[2][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 3 + n2), t);
	a[N2_3328 * 3 + n2] %= Q;
	a[N2_3328 * 3 + n2 + 1] %= Q;
	a[N2_3328 * 3 + n2 + 2] %= Q;
	a[N2_3328 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[3][0]);
	d1 = _mm256_mul_epu32(d, w_13[3][1]);
	e1 = _mm256_mul_epu32(e, w_13[3][2]);
	f1 = _mm256_mul_epu32(f, w_13[3][3]);
	g1 = _mm256_mul_epu32(g, w_13[3][4]);
	h1 = _mm256_mul_epu32(h, w_13[3][5]);
	i1 = _mm256_mul_epu32(i, w_13[3][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 4 + n2), t);
	a[N2_3328 * 4 + n2] %= Q;
	a[N2_3328 * 4 + n2 + 1] %= Q;
	a[N2_3328 * 4 + n2 + 2] %= Q;
	a[N2_3328 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[4][0]);
	d1 = _mm256_mul_epu32(d, w_13[4][1]);
	e1 = _mm256_mul_epu32(e, w_13[4][2]);
	f1 = _mm256_mul_epu32(f, w_13[4][3]);
	g1 = _mm256_mul_epu32(g, w_13[4][4]);
	h1 = _mm256_mul_epu32(h, w_13[4][5]);
	i1 = _mm256_mul_epu32(i, w_13[4][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 5 + n2), t);
	a[N2_3328 * 5 + n2] %= Q;
	a[N2_3328 * 5 + n2 + 1] %= Q;
	a[N2_3328 * 5 + n2 + 2] %= Q;
	a[N2_3328 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[5][0]);
	d1 = _mm256_mul_epu32(d, w_13[5][1]);
	e1 = _mm256_mul_epu32(e, w_13[5][2]);
	f1 = _mm256_mul_epu32(f, w_13[5][3]);
	g1 = _mm256_mul_epu32(g, w_13[5][4]);
	h1 = _mm256_mul_epu32(h, w_13[5][5]);
	i1 = _mm256_mul_epu32(i, w_13[5][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 6 + n2), t);
	a[N2_3328 * 6 + n2] %= Q;
	a[N2_3328 * 6 + n2 + 1] %= Q;
	a[N2_3328 * 6 + n2 + 2] %= Q;
	a[N2_3328 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[6][0]);
	d1 = _mm256_mul_epu32(d, w_13[6][1]);
	e1 = _mm256_mul_epu32(e, w_13[6][2]);
	f1 = _mm256_mul_epu32(f, w_13[6][3]);
	g1 = _mm256_mul_epu32(g, w_13[6][4]);
	h1 = _mm256_mul_epu32(h, w_13[6][5]);
	i1 = _mm256_mul_epu32(i, w_13[6][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 7 + n2), t);
	a[N2_3328 * 7 + n2] %= Q;
	a[N2_3328 * 7 + n2 + 1] %= Q;
	a[N2_3328 * 7 + n2 + 2] %= Q;
	a[N2_3328 * 7 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[7][0]);
	d1 = _mm256_mul_epu32(d, w_13[7][1]);
	e1 = _mm256_mul_epu32(e, w_13[7][2]);
	f1 = _mm256_mul_epu32(f, w_13[7][3]);
	g1 = _mm256_mul_epu32(g, w_13[7][4]);
	h1 = _mm256_mul_epu32(h, w_13[7][5]);
	i1 = _mm256_mul_epu32(i, w_13[7][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 8 + n2), t);
	a[N2_3328 * 8 + n2] %= Q;
	a[N2_3328 * 8 + n2 + 1] %= Q;
	a[N2_3328 * 8 + n2 + 2] %= Q;
	a[N2_3328 * 8 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[8][0]);
	d1 = _mm256_mul_epu32(d, w_13[8][1]);
	e1 = _mm256_mul_epu32(e, w_13[8][2]);
	f1 = _mm256_mul_epu32(f, w_13[8][3]);
	g1 = _mm256_mul_epu32(g, w_13[8][4]);
	h1 = _mm256_mul_epu32(h, w_13[8][5]);
	i1 = _mm256_mul_epu32(i, w_13[8][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 9 + n2), t);
	a[N2_3328 * 9 + n2] %= Q;
	a[N2_3328 * 9 + n2 + 1] %= Q;
	a[N2_3328 * 9 + n2 + 2] %= Q;
	a[N2_3328 * 9 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[9][0]);
	d1 = _mm256_mul_epu32(d, w_13[9][1]);
	e1 = _mm256_mul_epu32(e, w_13[9][2]);
	f1 = _mm256_mul_epu32(f, w_13[9][3]);
	g1 = _mm256_mul_epu32(g, w_13[9][4]);
	h1 = _mm256_mul_epu32(h, w_13[9][5]);
	i1 = _mm256_mul_epu32(i, w_13[9][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 10 + n2), t);
	a[N2_3328 * 10 + n2] %= Q;
	a[N2_3328 * 10 + n2 + 1] %= Q;
	a[N2_3328 * 10 + n2 + 2] %= Q;
	a[N2_3328 * 10 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[10][0]);
	d1 = _mm256_mul_epu32(d, w_13[10][1]);
	e1 = _mm256_mul_epu32(e, w_13[10][2]);
	f1 = _mm256_mul_epu32(f, w_13[10][3]);
	g1 = _mm256_mul_epu32(g, w_13[10][4]);
	h1 = _mm256_mul_epu32(h, w_13[10][5]);
	i1 = _mm256_mul_epu32(i, w_13[10][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 11 + n2), t);
	a[N2_3328 * 11 + n2] %= Q;
	a[N2_3328 * 11 + n2 + 1] %= Q;
	a[N2_3328 * 11 + n2 + 2] %= Q;
	a[N2_3328 * 11 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[11][0]);
	d1 = _mm256_mul_epu32(d, w_13[11][1]);
	e1 = _mm256_mul_epu32(e, w_13[11][2]);
	f1 = _mm256_mul_epu32(f, w_13[11][3]);
	g1 = _mm256_mul_epu32(g, w_13[11][4]);
	h1 = _mm256_mul_epu32(h, w_13[11][5]);
	i1 = _mm256_mul_epu32(i, w_13[11][6]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 12 + n2), t);
	a[N2_3328 * 12 + n2] %= Q;
	a[N2_3328 * 12 + n2 + 1] %= Q;
	a[N2_3328 * 12 + n2 + 2] %= Q;
	a[N2_3328 * 12 + n2 + 3] %= Q;
}

/* 256 * 13 --> 256 * 5 */
static void ntt_butterfly_3328_1280(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, k, l, m, n, c1, d1, e1, f1, g1, h1, i1, j1, k1, l1, m1, n1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_3328 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 6 + n2));
	i = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 7 + n2));
	j = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 8 + n2));
	k = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 9 + n2));
	l = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 10 + n2));
	m = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 11 + n2));
	n = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 12 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t = _mm256_add_epi64(t, k);
	t = _mm256_add_epi64(t, l);
	t = _mm256_add_epi64(t, m);
	t = _mm256_add_epi64(t, n);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_13[0][0]);
	d1 = _mm256_mul_epu32(d, w_13[0][1]);
	e1 = _mm256_mul_epu32(e, w_13[0][2]);
	f1 = _mm256_mul_epu32(f, w_13[0][3]);
	g1 = _mm256_mul_epu32(g, w_13[0][4]);
	h1 = _mm256_mul_epu32(h, w_13[0][5]);
	i1 = _mm256_mul_epu32(i, w_13[0][6]);
	j1 = _mm256_mul_epu32(j, w_13[0][7]);
	k1 = _mm256_mul_epu32(k, w_13[0][8]);
	l1 = _mm256_mul_epu32(l, w_13[0][9]);
	m1 = _mm256_mul_epu32(m, w_13[0][10]);
	n1 = _mm256_mul_epu32(n, w_13[0][11]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	t = _mm256_add_epi64(t, n1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 + n2), t);
	a[N2_3328 + n2] %= Q;
	a[N2_3328 + n2 + 1] %= Q;
	a[N2_3328 + n2 + 2] %= Q;
	a[N2_3328 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[1][0]);
	d1 = _mm256_mul_epu32(d, w_13[1][1]);
	e1 = _mm256_mul_epu32(e, w_13[1][2]);
	f1 = _mm256_mul_epu32(f, w_13[1][3]);
	g1 = _mm256_mul_epu32(g, w_13[1][4]);
	h1 = _mm256_mul_epu32(h, w_13[1][5]);
	i1 = _mm256_mul_epu32(i, w_13[1][6]);
	j1 = _mm256_mul_epu32(j, w_13[1][7]);
	k1 = _mm256_mul_epu32(k, w_13[1][8]);
	l1 = _mm256_mul_epu32(l, w_13[1][9]);
	m1 = _mm256_mul_epu32(m, w_13[1][10]);
	n1 = _mm256_mul_epu32(n, w_13[1][11]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	t = _mm256_add_epi64(t, n1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 2 + n2), t);
	a[N2_3328 * 2 + n2] %= Q;
	a[N2_3328 * 2 + n2 + 1] %= Q;
	a[N2_3328 * 2 + n2 + 2] %= Q;
	a[N2_3328 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[2][0]);
	d1 = _mm256_mul_epu32(d, w_13[2][1]);
	e1 = _mm256_mul_epu32(e, w_13[2][2]);
	f1 = _mm256_mul_epu32(f, w_13[2][3]);
	g1 = _mm256_mul_epu32(g, w_13[2][4]);
	h1 = _mm256_mul_epu32(h, w_13[2][5]);
	i1 = _mm256_mul_epu32(i, w_13[2][6]);
	j1 = _mm256_mul_epu32(j, w_13[2][7]);
	k1 = _mm256_mul_epu32(k, w_13[2][8]);
	l1 = _mm256_mul_epu32(l, w_13[2][9]);
	m1 = _mm256_mul_epu32(m, w_13[2][10]);
	n1 = _mm256_mul_epu32(n, w_13[2][11]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	t = _mm256_add_epi64(t, n1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 3 + n2), t);
	a[N2_3328 * 3 + n2] %= Q;
	a[N2_3328 * 3 + n2 + 1] %= Q;
	a[N2_3328 * 3 + n2 + 2] %= Q;
	a[N2_3328 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[3][0]);
	d1 = _mm256_mul_epu32(d, w_13[3][1]);
	e1 = _mm256_mul_epu32(e, w_13[3][2]);
	f1 = _mm256_mul_epu32(f, w_13[3][3]);
	g1 = _mm256_mul_epu32(g, w_13[3][4]);
	h1 = _mm256_mul_epu32(h, w_13[3][5]);
	i1 = _mm256_mul_epu32(i, w_13[3][6]);
	j1 = _mm256_mul_epu32(j, w_13[3][7]);
	k1 = _mm256_mul_epu32(k, w_13[3][8]);
	l1 = _mm256_mul_epu32(l, w_13[3][9]);
	m1 = _mm256_mul_epu32(m, w_13[3][10]);
	n1 = _mm256_mul_epu32(n, w_13[3][11]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	t = _mm256_add_epi64(t, n1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 4 + n2), t);
	a[N2_3328 * 4 + n2] %= Q;
	a[N2_3328 * 4 + n2 + 1] %= Q;
	a[N2_3328 * 4 + n2 + 2] %= Q;
	a[N2_3328 * 4 + n2 + 3] %= Q;
}

/* 1024 * 1 --> 1024 * 3 */
static void ntt_butterfly_1024_3072(uint64_t *a, uint32_t n2)
{
	__m256i t;
	
	t = _mm256_loadu_si256((__m256i *)(a + n2));
	_mm256_storeu_si256((__m256i *)(a + N2_3072 + n2), t);
	_mm256_storeu_si256((__m256i *)(a + N2_3072 * 2 + n2), t);
}

/* 1024 * 2 --> 1024 * 3 */
static void ntt_butterfly_2048_3072(uint64_t *a, uint32_t n2)
{
	__m256i b, c, c1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_3072 + n2));
	
	t = _mm256_add_epi64(b, c);
	t1 = _mm256_mul_epu32(t, V_B4Q_B4Q_B4Q_B4Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_4Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_3[0]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_3072 + n2), t);
	a[N2_3072 + n2] %= Q;
	a[N2_3072 + n2 + 1] %= Q;
	a[N2_3072 + n2 + 2] %= Q;
	a[N2_3072 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_3[1]);
	t = _mm256_add_epi64(b, c1);
	_mm256_storeu_si256((__m256i *)(a + N2_3072 * 2 + n2), t);
	a[N2_3072 * 2 + n2] %= Q;
	a[N2_3072 * 2 + n2 + 1] %= Q;
	a[N2_3072 * 2 + n2 + 2] %= Q;
	a[N2_3072 * 2 + n2 + 3] %= Q;
}

/* 1024 * 3 --> 1024 * 3 */
static void ntt_butterfly_3072_3072_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, c1, d1, t, t1;

	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_3072 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_3072 * 2 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_3_inv[0]);
	d1 = _mm256_mul_epu32(d, w_3_inv[1]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_3072 + n2), t);
	a[N2_3072 + n2] %= Q;
	a[N2_3072 + n2 + 1] %= Q;
	a[N2_3072 + n2 + 2] %= Q;
	a[N2_3072 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_3_inv[1]);
	d1 = _mm256_mul_epu32(d, w_3_inv[0]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	_mm256_storeu_si256((__m256i *)(a + N2_3072 * 2 + n2), t);
	a[N2_3072 * 2 + n2] %= Q;
	a[N2_3072 * 2 + n2 + 1] %= Q;
	a[N2_3072 * 2 + n2 + 2] %= Q;
	a[N2_3072 * 2 + n2 + 3] %= Q;
}

/* 256 * 5 --> 256 * 5 */
static void ntt_butterfly_1280_1280_inv(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, c1, d1, e1, f1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1280 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 4 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_5_inv[0][0]);
	d1 = _mm256_mul_epu32(d, w_5_inv[0][1]);
	e1 = _mm256_mul_epu32(e, w_5_inv[0][2]);
	f1 = _mm256_mul_epu32(f, w_5_inv[0][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 + n2), t);
	a[N2_1280 + n2] %= Q;
	a[N2_1280 + n2 + 1] %= Q;
	a[N2_1280 + n2 + 2] %= Q;
	a[N2_1280 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_5_inv[1][0]);
	d1 = _mm256_mul_epu32(d, w_5_inv[1][1]);
	e1 = _mm256_mul_epu32(e, w_5_inv[1][2]);
	f1 = _mm256_mul_epu32(f, w_5_inv[1][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 * 2 + n2), t);
	a[N2_1280 * 2 + n2] %= Q;
	a[N2_1280 * 2 + n2 + 1] %= Q;
	a[N2_1280 * 2 + n2 + 2] %= Q;
	a[N2_1280 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_5_inv[2][0]);
	d1 = _mm256_mul_epu32(d, w_5_inv[2][1]);
	e1 = _mm256_mul_epu32(e, w_5_inv[2][2]);
	f1 = _mm256_mul_epu32(f, w_5_inv[2][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 * 3 + n2), t);
	a[N2_1280 * 3 + n2] %= Q;
	a[N2_1280 * 3 + n2 + 1] %= Q;
	a[N2_1280 * 3 + n2 + 2] %= Q;
	a[N2_1280 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_5_inv[3][0]);
	d1 = _mm256_mul_epu32(d, w_5_inv[3][1]);
	e1 = _mm256_mul_epu32(e, w_5_inv[3][2]);
	f1 = _mm256_mul_epu32(f, w_5_inv[3][3]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 * 4 + n2), t);
	a[N2_1280 * 4 + n2] %= Q;
	a[N2_1280 * 4 + n2 + 1] %= Q;
	a[N2_1280 * 4 + n2 + 2] %= Q;
	a[N2_1280 * 4 + n2 + 3] %= Q;
}

/* 256 * 4 --> 256 * 5 */
static void ntt_butterfly_1024_1280(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, c1, d1, e1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1280 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 3 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t1 = _mm256_mul_epu32(t, V_B8Q_B8Q_B8Q_B8Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_8Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);

	c1 = _mm256_mul_epu32(c, w_5[0][0]);
	d1 = _mm256_mul_epu32(d, w_5[0][1]);
	e1 = _mm256_mul_epu32(e, w_5[0][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 + n2), t);
	a[N2_1280 + n2] %= Q;
	a[N2_1280 + n2 + 1] %= Q;
	a[N2_1280 + n2 + 2] %= Q;
	a[N2_1280 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_5[1][0]);
	d1 = _mm256_mul_epu32(d, w_5[1][1]);
	e1 = _mm256_mul_epu32(e, w_5[1][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 * 2 + n2), t);
	a[N2_1280 * 2 + n2] %= Q;
	a[N2_1280 * 2 + n2 + 1] %= Q;
	a[N2_1280 * 2 + n2 + 2] %= Q;
	a[N2_1280 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_5[2][0]);
	d1 = _mm256_mul_epu32(d, w_5[2][1]);
	e1 = _mm256_mul_epu32(e, w_5[2][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 * 3 + n2), t);
	a[N2_1280 * 3 + n2] %= Q;
	a[N2_1280 * 3 + n2 + 1] %= Q;
	a[N2_1280 * 3 + n2 + 2] %= Q;
	a[N2_1280 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_5[3][0]);
	d1 = _mm256_mul_epu32(d, w_5[3][1]);
	e1 = _mm256_mul_epu32(e, w_5[3][2]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	_mm256_storeu_si256((__m256i *)(a + N2_1280 * 4 + n2), t);
	a[N2_1280 * 4 + n2] %= Q;
	a[N2_1280 * 4 + n2 + 1] %= Q;
	a[N2_1280 * 4 + n2 + 2] %= Q;
	a[N2_1280 * 4 + n2 + 3] %= Q;
}

/* 256 * 5 --> 256 * 1 */
static void ntt_butterfly_1280_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_1280 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_1280 * 4 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t1 = _mm256_mul_epu32(t, V_B16Q_B16Q_B16Q_B16Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_16Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

/* 256 * 12 --> 256 * 13 */
static void ntt_butterfly_3072_3328(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, k, l, m, c1, d1, e1, f1, g1, h1, i1, j1, k1, l1, m1, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_3328 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 6 + n2));
	i = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 7 + n2));
	j = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 8 + n2));
	k = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 9 + n2));
	l = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 10 + n2));
	m = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 11 + n2));
	
	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t = _mm256_add_epi64(t, k);
	t = _mm256_add_epi64(t, l);
	t = _mm256_add_epi64(t, m);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
	
	c1 = _mm256_mul_epu32(c, w_13[0][0]);
	d1 = _mm256_mul_epu32(d, w_13[0][1]);
	e1 = _mm256_mul_epu32(e, w_13[0][2]);
	f1 = _mm256_mul_epu32(f, w_13[0][3]);
	g1 = _mm256_mul_epu32(g, w_13[0][4]);
	h1 = _mm256_mul_epu32(h, w_13[0][5]);
	i1 = _mm256_mul_epu32(i, w_13[0][6]);
	j1 = _mm256_mul_epu32(j, w_13[0][7]);
	k1 = _mm256_mul_epu32(k, w_13[0][8]);
	l1 = _mm256_mul_epu32(l, w_13[0][9]);
	m1 = _mm256_mul_epu32(m, w_13[0][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 + n2), t);
	a[N2_3328 + n2] %= Q;
	a[N2_3328 + n2 + 1] %= Q;
	a[N2_3328 + n2 + 2] %= Q;
	a[N2_3328 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[1][0]);
	d1 = _mm256_mul_epu32(d, w_13[1][1]);
	e1 = _mm256_mul_epu32(e, w_13[1][2]);
	f1 = _mm256_mul_epu32(f, w_13[1][3]);
	g1 = _mm256_mul_epu32(g, w_13[1][4]);
	h1 = _mm256_mul_epu32(h, w_13[1][5]);
	i1 = _mm256_mul_epu32(i, w_13[1][6]);
	j1 = _mm256_mul_epu32(j, w_13[1][7]);
	k1 = _mm256_mul_epu32(k, w_13[1][8]);
	l1 = _mm256_mul_epu32(l, w_13[1][9]);
	m1 = _mm256_mul_epu32(m, w_13[1][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 2 + n2), t);
	a[N2_3328 * 2 + n2] %= Q;
	a[N2_3328 * 2 + n2 + 1] %= Q;
	a[N2_3328 * 2 + n2 + 2] %= Q;
	a[N2_3328 * 2 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[2][0]);
	d1 = _mm256_mul_epu32(d, w_13[2][1]);
	e1 = _mm256_mul_epu32(e, w_13[2][2]);
	f1 = _mm256_mul_epu32(f, w_13[2][3]);
	g1 = _mm256_mul_epu32(g, w_13[2][4]);
	h1 = _mm256_mul_epu32(h, w_13[2][5]);
	i1 = _mm256_mul_epu32(i, w_13[2][6]);
	j1 = _mm256_mul_epu32(j, w_13[2][7]);
	k1 = _mm256_mul_epu32(k, w_13[2][8]);
	l1 = _mm256_mul_epu32(l, w_13[2][9]);
	m1 = _mm256_mul_epu32(m, w_13[2][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 3 + n2), t);
	a[N2_3328 * 3 + n2] %= Q;
	a[N2_3328 * 3 + n2 + 1] %= Q;
	a[N2_3328 * 3 + n2 + 2] %= Q;
	a[N2_3328 * 3 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[3][0]);
	d1 = _mm256_mul_epu32(d, w_13[3][1]);
	e1 = _mm256_mul_epu32(e, w_13[3][2]);
	f1 = _mm256_mul_epu32(f, w_13[3][3]);
	g1 = _mm256_mul_epu32(g, w_13[3][4]);
	h1 = _mm256_mul_epu32(h, w_13[3][5]);
	i1 = _mm256_mul_epu32(i, w_13[3][6]);
	j1 = _mm256_mul_epu32(j, w_13[3][7]);
	k1 = _mm256_mul_epu32(k, w_13[3][8]);
	l1 = _mm256_mul_epu32(l, w_13[3][9]);
	m1 = _mm256_mul_epu32(m, w_13[3][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 4 + n2), t);
	a[N2_3328 * 4 + n2] %= Q;
	a[N2_3328 * 4 + n2 + 1] %= Q;
	a[N2_3328 * 4 + n2 + 2] %= Q;
	a[N2_3328 * 4 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[4][0]);
	d1 = _mm256_mul_epu32(d, w_13[4][1]);
	e1 = _mm256_mul_epu32(e, w_13[4][2]);
	f1 = _mm256_mul_epu32(f, w_13[4][3]);
	g1 = _mm256_mul_epu32(g, w_13[4][4]);
	h1 = _mm256_mul_epu32(h, w_13[4][5]);
	i1 = _mm256_mul_epu32(i, w_13[4][6]);
	j1 = _mm256_mul_epu32(j, w_13[4][7]);
	k1 = _mm256_mul_epu32(k, w_13[4][8]);
	l1 = _mm256_mul_epu32(l, w_13[4][9]);
	m1 = _mm256_mul_epu32(m, w_13[4][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 5 + n2), t);
	a[N2_3328 * 5 + n2] %= Q;
	a[N2_3328 * 5 + n2 + 1] %= Q;
	a[N2_3328 * 5 + n2 + 2] %= Q;
	a[N2_3328 * 5 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[5][0]);
	d1 = _mm256_mul_epu32(d, w_13[5][1]);
	e1 = _mm256_mul_epu32(e, w_13[5][2]);
	f1 = _mm256_mul_epu32(f, w_13[5][3]);
	g1 = _mm256_mul_epu32(g, w_13[5][4]);
	h1 = _mm256_mul_epu32(h, w_13[5][5]);
	i1 = _mm256_mul_epu32(i, w_13[5][6]);
	j1 = _mm256_mul_epu32(j, w_13[5][7]);
	k1 = _mm256_mul_epu32(k, w_13[5][8]);
	l1 = _mm256_mul_epu32(l, w_13[5][9]);
	m1 = _mm256_mul_epu32(m, w_13[5][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 6 + n2), t);
	a[N2_3328 * 6 + n2] %= Q;
	a[N2_3328 * 6 + n2 + 1] %= Q;
	a[N2_3328 * 6 + n2 + 2] %= Q;
	a[N2_3328 * 6 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[6][0]);
	d1 = _mm256_mul_epu32(d, w_13[6][1]);
	e1 = _mm256_mul_epu32(e, w_13[6][2]);
	f1 = _mm256_mul_epu32(f, w_13[6][3]);
	g1 = _mm256_mul_epu32(g, w_13[6][4]);
	h1 = _mm256_mul_epu32(h, w_13[6][5]);
	i1 = _mm256_mul_epu32(i, w_13[6][6]);
	j1 = _mm256_mul_epu32(j, w_13[6][7]);
	k1 = _mm256_mul_epu32(k, w_13[6][8]);
	l1 = _mm256_mul_epu32(l, w_13[6][9]);
	m1 = _mm256_mul_epu32(m, w_13[6][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 7 + n2), t);
	a[N2_3328 * 7 + n2] %= Q;
	a[N2_3328 * 7 + n2 + 1] %= Q;
	a[N2_3328 * 7 + n2 + 2] %= Q;
	a[N2_3328 * 7 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[7][0]);
	d1 = _mm256_mul_epu32(d, w_13[7][1]);
	e1 = _mm256_mul_epu32(e, w_13[7][2]);
	f1 = _mm256_mul_epu32(f, w_13[7][3]);
	g1 = _mm256_mul_epu32(g, w_13[7][4]);
	h1 = _mm256_mul_epu32(h, w_13[7][5]);
	i1 = _mm256_mul_epu32(i, w_13[7][6]);
	j1 = _mm256_mul_epu32(j, w_13[7][7]);
	k1 = _mm256_mul_epu32(k, w_13[7][8]);
	l1 = _mm256_mul_epu32(l, w_13[7][9]);
	m1 = _mm256_mul_epu32(m, w_13[7][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 8 + n2), t);
	a[N2_3328 * 8 + n2] %= Q;
	a[N2_3328 * 8 + n2 + 1] %= Q;
	a[N2_3328 * 8 + n2 + 2] %= Q;
	a[N2_3328 * 8 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[8][0]);
	d1 = _mm256_mul_epu32(d, w_13[8][1]);
	e1 = _mm256_mul_epu32(e, w_13[8][2]);
	f1 = _mm256_mul_epu32(f, w_13[8][3]);
	g1 = _mm256_mul_epu32(g, w_13[8][4]);
	h1 = _mm256_mul_epu32(h, w_13[8][5]);
	i1 = _mm256_mul_epu32(i, w_13[8][6]);
	j1 = _mm256_mul_epu32(j, w_13[8][7]);
	k1 = _mm256_mul_epu32(k, w_13[8][8]);
	l1 = _mm256_mul_epu32(l, w_13[8][9]);
	m1 = _mm256_mul_epu32(m, w_13[8][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 9 + n2), t);
	a[N2_3328 * 9 + n2] %= Q;
	a[N2_3328 * 9 + n2 + 1] %= Q;
	a[N2_3328 * 9 + n2 + 2] %= Q;
	a[N2_3328 * 9 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[9][0]);
	d1 = _mm256_mul_epu32(d, w_13[9][1]);
	e1 = _mm256_mul_epu32(e, w_13[9][2]);
	f1 = _mm256_mul_epu32(f, w_13[9][3]);
	g1 = _mm256_mul_epu32(g, w_13[9][4]);
	h1 = _mm256_mul_epu32(h, w_13[9][5]);
	i1 = _mm256_mul_epu32(i, w_13[9][6]);
	j1 = _mm256_mul_epu32(j, w_13[9][7]);
	k1 = _mm256_mul_epu32(k, w_13[9][8]);
	l1 = _mm256_mul_epu32(l, w_13[9][9]);
	m1 = _mm256_mul_epu32(m, w_13[9][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 10 + n2), t);
	a[N2_3328 * 10 + n2] %= Q;
	a[N2_3328 * 10 + n2 + 1] %= Q;
	a[N2_3328 * 10 + n2 + 2] %= Q;
	a[N2_3328 * 10 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[10][0]);
	d1 = _mm256_mul_epu32(d, w_13[10][1]);
	e1 = _mm256_mul_epu32(e, w_13[10][2]);
	f1 = _mm256_mul_epu32(f, w_13[10][3]);
	g1 = _mm256_mul_epu32(g, w_13[10][4]);
	h1 = _mm256_mul_epu32(h, w_13[10][5]);
	i1 = _mm256_mul_epu32(i, w_13[10][6]);
	j1 = _mm256_mul_epu32(j, w_13[10][7]);
	k1 = _mm256_mul_epu32(k, w_13[10][8]);
	l1 = _mm256_mul_epu32(l, w_13[10][9]);
	m1 = _mm256_mul_epu32(m, w_13[10][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 11 + n2), t);
	a[N2_3328 * 11 + n2] %= Q;
	a[N2_3328 * 11 + n2 + 1] %= Q;
	a[N2_3328 * 11 + n2 + 2] %= Q;
	a[N2_3328 * 11 + n2 + 3] %= Q;

	c1 = _mm256_mul_epu32(c, w_13[11][0]);
	d1 = _mm256_mul_epu32(d, w_13[11][1]);
	e1 = _mm256_mul_epu32(e, w_13[11][2]);
	f1 = _mm256_mul_epu32(f, w_13[11][3]);
	g1 = _mm256_mul_epu32(g, w_13[11][4]);
	h1 = _mm256_mul_epu32(h, w_13[11][5]);
	i1 = _mm256_mul_epu32(i, w_13[11][6]);
	j1 = _mm256_mul_epu32(j, w_13[11][7]);
	k1 = _mm256_mul_epu32(k, w_13[11][8]);
	l1 = _mm256_mul_epu32(l, w_13[11][9]);
	m1 = _mm256_mul_epu32(m, w_13[11][10]);
	t = _mm256_add_epi64(b, c1);
	t = _mm256_add_epi64(t, d1);
	t = _mm256_add_epi64(t, e1);
	t = _mm256_add_epi64(t, f1);
	t = _mm256_add_epi64(t, g1);
	t = _mm256_add_epi64(t, h1);
	t = _mm256_add_epi64(t, i1);
	t = _mm256_add_epi64(t, j1);
	t = _mm256_add_epi64(t, k1);
	t = _mm256_add_epi64(t, l1);
	t = _mm256_add_epi64(t, m1);
	_mm256_storeu_si256((__m256i *)(a + N2_3328 * 12 + n2), t);
	a[N2_3328 * 12 + n2] %= Q;
	a[N2_3328 * 12 + n2 + 1] %= Q;
	a[N2_3328 * 12 + n2 + 2] %= Q;
	a[N2_3328 * 12 + n2 + 3] %= Q;
}

/* 256 * 13 --> 256 * 1 */
static void ntt_butterfly_3328_256(uint64_t *a, uint32_t n2)
{
	__m256i b, c, d, e, f, g, h, i, j, k, l, m, n, t, t1;
	
	b = _mm256_loadu_si256((__m256i *)(a + n2));
	c = _mm256_loadu_si256((__m256i *)(a + N2_3328 + n2));
	d = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 2 + n2));
	e = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 3 + n2));
	f = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 4 + n2));
	g = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 5 + n2));
	h = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 6 + n2));
	i = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 7 + n2));
	j = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 8 + n2));
	k = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 9 + n2));
	l = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 10 + n2));
	m = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 11 + n2));
	n = _mm256_loadu_si256((__m256i *)(a + N2_3328 * 12 + n2));

	t = _mm256_add_epi64(b, c);
	t = _mm256_add_epi64(t, d);
	t = _mm256_add_epi64(t, e);
	t = _mm256_add_epi64(t, f);
	t = _mm256_add_epi64(t, g);
	t = _mm256_add_epi64(t, h);
	t = _mm256_add_epi64(t, i);
	t = _mm256_add_epi64(t, j);
	t = _mm256_add_epi64(t, k);
	t = _mm256_add_epi64(t, l);
	t = _mm256_add_epi64(t, m);
	t = _mm256_add_epi64(t, n);
	t1 = _mm256_mul_epu32(t, V_B32Q_B32Q_B32Q_B32Q);
	t1 = _mm256_srli_epi64(t1, BARRETT_BITSHIFT_32Q);
	t1 = _mm256_mul_epu32(t1, V_Q_Q_Q_Q);
	t = _mm256_sub_epi64(t, t1);
	_mm256_storeu_si256((__m256i *)(a + n2), t);
}

void ntt_2048_3328(uint64_t *a)
{
	ntt_core(a, N1_3328, N2_3328, omega_256, omega_3328, ntt_butterfly_2048_3328, bit_reverse_256);
}

void intt_3328_1280(uint64_t *a)
{
	intt_core(a, N1_3328, N2_3328, 1280, omega_256, omega_3328, ntt_butterfly_3328_1280, INV_3328, bit_reverse_256);
}

void ntt_1024_3072(uint64_t *a)
{
	ntt_core(a, N1_3072, N2_3072, omega_1024, omega_3072, ntt_butterfly_1024_3072, bit_reverse_1024);
}

void ntt_2048_3072(uint64_t *a)
{
	ntt_core(a, N1_3072, N2_3072, omega_1024, omega_3072, ntt_butterfly_2048_3072, bit_reverse_1024);
}

void intt_3072_3072_inv(uint64_t *a)
{
	intt_core(a, N1_3072, N2_3072, 3072, omega_1024_inv, omega_3072_inv, ntt_butterfly_3072_3072_inv, INV_3072, bit_reverse_1024);
}

void ntt_1280_1280_inv(uint64_t *a)
{
	ntt_core(a, N1_1280, N2_1280, omega_256_inv, omega_1280_inv, ntt_butterfly_1280_1280_inv, bit_reverse_256);
}

void ntt_1024_1280(uint64_t *a)
{
	ntt_core(a, N1_1280, N2_1280, omega_256, omega_1280, ntt_butterfly_1024_1280, bit_reverse_256);
}

void intt_1280_256(uint64_t *a)
{
	intt_core(a, N1_1280, N2_1280, 256, omega_256, omega_1280, ntt_butterfly_1280_256, INV_1280, bit_reverse_256);
}

void ntt_3072_3328(uint64_t *a)
{
	ntt_core(a, N1_3328, N2_3328, omega_256, omega_3328, ntt_butterfly_3072_3328, bit_reverse_256);
}

void intt_3328_256(uint64_t *a)
{
	intt_core(a, N1_3328, N2_3328, 256, omega_256, omega_3328, ntt_butterfly_3328_256, INV_3328, bit_reverse_256);
}
