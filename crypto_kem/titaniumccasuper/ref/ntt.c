/* ****************************** *
 * Titanium_CCA_super             *
 * Implemented by Raymond K. ZHAO *
 *                                *
 * NTT functions                  *
 * ****************************** */
 
#include "param.h"
#include "ntt.h"
#include <stdint.h>

/* 1280=5*256 */
#define N1_1280 5
#define N2_1280 256

/* 3072=3*1024 */
#define N1_3072 3
#define N2_3072 1024

/* 3328=13*256 */
#define N1_3328 13
#define N2_3328 256

/* multiplication inverses of 1280, 3072, 3328 */
#define INV_1280 1197145
#define INV_3072 1197691
#define INV_3328 1197721

/* omega_n: n-th root of unity mod Q */

/* omega_1280,3072,3328 respectively */
static const uint32_t omega_1280[1280]={1,1061167,268070,675455,626520,844158,627577,1093861,32370,993520,923298,698181,535313,761093,6054,194696,694106,154117,1025715,717067,236307,440807,680777,403460,598227,1156087,1173878,1035577,708486,975961,447657,917300,24787,476155,93864,519191,25318,857762,1065476,959577,839001,1023366,44264,730483,56256,228765,300373,59484,362262,615851,1118885,408094,1121681,982470,646695,180913,802193,227111,318820,1159755,969265,691836,645918,1131963,977897,158054,1131747,599296,960903,201268,654129,731087,27789,402110,927653,1082049,1049269,1078763,470217,790278,969180,348716,623507,28095,439261,289484,503266,1071429,605615,815819,49064,91671,53262,405579,413063,107942,756228,1157709,744355,941714,52381,20632,265350,478344,1107449,264731,164359,507297,288355,526723,336811,1194517,342529,667158,821190,305704,1000360,132799,34970,847177,622156,494435,97153,687501,1118013,1187083,990436,243481,646191,894952,1078066,52795,846124,1022878,963841,503152,1104572,1195741,491133,510644,902220,394344,305849,317126,664357,931384,638421,820804,438944,560306,588827,210612,880221,389796,1186682,781224,574701,555042,59361,429550,1189509,705509,23318,325213,467683,286864,991727,803495,479152,704389,12630,805144,1145275,659930,820676,1190802,991695,392419,287479,655287,331367,149870,232107,400727,982917,548268,200103,814166,1128678,261931,137639,1108084,784254,261307,508224,365663,1024846,1085314,909272,530102,163671,55730,360669,669111,600211,285017,1076794,485658,116088,868195,754266,214752,748574,776590,51247,728659,586544,86133,1095802,256278,152155,82758,721286,71183,439673,190723,724654,206016,1144440,1165425,1023373,283947,210811,1190198,1020162,219074,858280,830803,842441,885039,880775,18543,1135418,1182022,223291,966984,293529,199558,1151274,1196410,1147904,137324,1105078,207874,751400,837789,429875,1021456,368346,297370,270443,458484,575619,666495,541016,1089363,57908,484146,1060124,497733,231318,598583,337943,760318,683276,906540,777878,1022003,955491,765778,735380,513758,1068860,101867,1040564,824538,782655,1136051,777292,982180,815082,315878,207446,644623,1119605,72656,42959,889184,64558,547606,981096,667814,861681,41717,808870,188136,289196,397825,544453,163697,90209,142003,259726,116597,667667,620662,172100,957708,341933,798394,396243,289740,197631,208651,998431,662085,498932,208529,928805,305732,761011,450273,976495,418522,296960,95376,773236,395780,182629,681645,172127,855273,391337,1064464,539149,318467,369076,988954,674340,1129343,268277,1088201,1005284,487866,924469,914741,548061,985438,435402,286889,1163120,316759,592393,792336,749203,919516,935937,271099,498975,311632,475005,596353,145508,806637,406443,729386,490789,883901,938377,465538,437549,1060457,432449,840634,285870,503009,315897,2242,945629,774359,1193807,506908,832337,480540,1162636,688680,239261,948229,628016,892665,303162,394177,406948,1076514,482986,535591,1037593,248492,1070550,1144921,6165,572295,497851,848600,1080737,968287,408656,853197,679604,460728,49339,778913,689571,453149,182399,1021759,816239,53072,61457,997246,1164240,327447,112462,114744,376137,1090567,548630,956637,810945,36783,624862,212180,655568,197125,1196518,738164,334940,971277,779498,866308,325488,1154925,923173,1039297,572831,194888,764400,106074,122246,2726,573708,1127491,1037914,628095,859188,1113315,1039558,780707,672460,940248,688778,580,861307,928151,1189494,363057,794592,976117,654531,803385,1162720,1168714,1191683,178561,540132,1115158,304066,26264,729866,666524,164753,476826,476807,682011,381005,726251,803181,339232,396079,1178178,563148,855564,86036,1197569,611270,527475,412449,307468,298345,964365,645076,199694,502185,513419,757547,280293,894790,494595,954452,447785,165442,791479,672563,16997,744125,83747,696493,416512,1133551,411126,534459,273711,1105826,831168,1188233,487947,617164,1062953,148190,216075,521583,801224,1107867,542567,796086,100371,992057,1148953,284258,761473,694298,224411,977672,1011679,720047,778208,169380,760597,822862,218967,1131106,901257,453616,939935,411944,1158421,306148,114594,545860,416740,1067265,428955,1183831,548632,682809,149004,189612,679821,702415,712641,1186766,63177,329042,983455,1169558,652043,1190413,337596,346236,1113304,149450,228099,430941,38933,987688,285719,809646,572081,1043503,989508,303087,1078079,669075,736791,219145,722034,694477,876506,1038962,911943,247513,924284,1084130,76432,626687,743059,1066270,77151,428163,594348,297529,66575,1148779,145674,842452,577066,235302,260062,838652,883112,1136233,1018645,649599,345549,524823,489834,1045942,122780,1171672,1151449,1198080,136914,930011,522626,571561,353923,570504,104220,1165711,204561,274783,499900,662768,436988,1192027,1003385,503975,1043964,172366,481014,961774,757274,517304,794621,599854,41994,24203,162504,489595,222120,750424,280781,1173294,721926,1104217,678890,1172763,340319,132605,238504,359080,174715,1153817,467598,1141825,969316,897708,1138597,835819,582230,79196,789987,76400,215611,551386,1017168,395888,970970,879261,38326,228816,506245,552163,66118,220184,1040027,66334,598785,237178,996813,543952,466994,1170292,795971,270428,116032,148812,119318,727864,407803,228901,849365,574574,1169986,758820,908597,694815,126652,592466,382262,1149017,1106410,1144819,792502,785018,1090139,441853,40372,453726,256367,1145700,1177449,932731,719737,90632,933350,1033722,690784,909726,671358,861270,3564,855552,530923,376891,892377,197721,1065282,1163111,350904,575925,703646,1100928,510580,80068,10998,207645,954600,551890,303129,120015,1145286,351957,175203,234240,694929,93509,2340,706948,687437,295861,803737,892232,880955,533724,266697,559660,377277,759137,637775,609254,987469,317860,808285,11399,416857,623380,643039,1138720,768531,8572,492572,1174763,872868,730398,911217,206354,394586,718929,493692,1185451,392937,52806,538151,377405,7279,206386,805662,910602,542794,866714,1048211,965974,797354,215164,649813,997978,383915,69403,936150,1060442,89997,413827,936774,689857,832418,173235,112767,288809,667979,1034410,1142351,837412,528970,597870,913064,121287,712423,1081993,329886,443815,983329,449507,421491,1146834,469422,611537,1111948,102279,941803,1045926,1115323,476795,1126898,758408,1007358,473427,992065,53641,32656,174708,914134,987270,7883,177919,979007,339801,367278,355640,313042,317306,1179538,62663,16059,974790,231097,904552,998523,46807,1671,50177,1060757,93003,990207,446681,360292,768206,176625,829735,900711,927638,739597,622462,531586,657065,108718,1140173,713935,137957,700348,966763,599498,860138,437763,514805,291541,420203,176078,242590,432303,462701,684323,129221,1096214,157517,373543,415426,62030,420789,215901,382999,882203,990635,553458,78476,1125425,1155122,308897,1133523,650475,216985,530267,336400,1156364,389211,1009945,908885,800256,653628,1034384,1107872,1056078,938355,1081484,530414,577419,1025981,240373,856148,399687,801838,908341,1000450,989430,199650,535996,699149,989552,269276,892349,437070,747808,221586,779559,901121,1102705,424845,802301,1015452,516436,1025954,342808,806744,133617,658932,879614,829005,209127,523741,68738,929804,109880,192797,710215,273612,283340,650020,212643,762679,911192,34961,881322,605688,405745,448878,278565,262144,926982,699106,886449,723076,601728,1052573,391444,791638,468695,707292,314180,259704,732543,760532,137624,765632,357447,912211,695072,882184,1195839,252452,423722,4274,691173,365744,717541,35445,509401,958820,249852,570065,305416,894919,803904,791133,121567,715095,662490,160488,949589,127531,53160,1191916,625786,700230,349481,117344,229794,789425,344884,518477,737353,1148742,419168,508510,744932,1015682,176322,381842,1145009,1136624,200835,33841,870634,1085619,1083337,821944,107514,649451,241444,387136,1161298,573219,985901,542513,1000956,1563,459917,863141,226804,418583,331773,872593,43156,274908,158784,625250,1003193,433681,1092007,1075835,1195355,624373,70590,160167,569986,338893,84766,158523,417374,525621,257833,509303,1197501,336774,269930,8587,835024,403489,221964,543550,394696,35361,29367,6398,1019520,657949,82923,894015,1171817,468215,531557,1033328,721255,721274,516070,817076,471830,394900,858849,802002,19903,634933,342517,1112045,512,586811,670606,785632,890613,899736,233716,553005,998387,695896,684662,440534,917788,303291,703486,243629,750296,1032639,406602,525518,1181084,453956,1114334,501588,781569,64530,786955,663622,924370,92255,366913,9848,710134,580917,135128,1049891,982006,676498,396857,90214,655514,401995,1097710,206024,49128,913823,436608,503783,973670,220409,186402,478034,419873,1028701,437484,375219,979114,66975,296824,744465,258146,786137,39660,891933,1083487,652221,781341,130816,769126,14250,649449,515272,1049077,1008469,518260,495666,485440,11315,1134904,869039,214626,28523,546038,7668,860485,851845,84777,1048631,969982,767140,1159148,210393,912362,388435,626000,154578,208573,894994,120002,529006,461290,978936,476047,503604,321575,159119,286138,950568,273797,113951,1121649,571394,455022,131811,1120930,769918,603733,900552,1131506,49302,1052407,355629,621015,962779,938019,359429,314969,61848,179436,548482,852532,673258,708247,152139,1075301,26409,46632};
static const uint32_t omega_3072[3072]={1,186516,738340,976,1129385,573159,952576,45240,1097438,3320,1023324,15074,844158,762751,335252,816561,436675,129839,239671,876045,924359,293101,788167,19391,923298,82990,954401,181936,726813,586439,253548,105536,879827,658162,1166251,885156,194696,84026,95855,726498,539868,104162,996177,953609,1023308,625061,1011528,747135,236307,32584,770512,604080,651878,822925,126228,51917,460530,994266,351590,196905,1156087,500674,486320,946691,1038857,208244,249965,347906,770455,755397,499333,767293,447657,928122,77343,811748,97836,7665,334507,839537,292554,600800,1098789,389426,519191,135569,288099,1140234,526434,833670,1049216,1020916,164921,873642,808705,420042,839001,958782,217290,575653,69971,14703,1135420,1079,1171237,1143076,1053104,158038,228765,1074087,890720,431574,1186118,733995,689793,304922,1124763,1114527,479784,326492,1118885,1017594,1164727,579969,1160676,992764,555512,633231,888216,647100,1021741,686253,180913,415824,55649,453181,892846,399779,212767,412809,807979,392579,346368,250206,969265,196326,990613,716731,1119297,1185002,1048233,982081,413787,1112315,46256,102815,158054,816859,906717,906336,530519,772014,400158,215552,1090796,1177883,714577,720968,654129,144010,391221,1050812,378283,841938,35176,195260,1046003,785508,78881,133916,1082049,310672,111187,570463,101379,691222,862304,703262,113069,555842,1081380,131892,969180,1115600,531925,633771,968052,389727,350700,730924,581875,830115,523629,19606,289484,679398,1164241,987349,553655,518428,395500,32749,395546,225918,812918,270814,49064,278346,736644,1161305,899390,115944,49054,809348,541730,1151545,388269,374759,107942,356948,350079,1118345,937758,224019,52929,1116005,591802,141221,165251,123710,52381,742122,932860,804454,670148,1127881,404049,1110303,973498,183175,590504,55815,264731,54943,561795,790041,908804,788903,713933,412764,801326,713547,302448,945364,336811,461322,152894,453342,969897,662500,369903,135482,834341,402947,441522,819817,305704,814393,1021365,44935,519865,48848,725644,599977,950489,162673,914024,362570,622156,715160,434425,995270,713018,1076207,937910,1018588,859076,66276,932739,999557,1187083,1009785,329698,48681,727578,699540,787497,852176,1042951,627151,255562,749407,1078066,227664,591822,277298,555079,143230,1074623,224492,815084,511173,1053450,1194281,503152,213702,1083524,1061223,107058,811982,611664,255561,562891,339726,226688,660518,902220,800584,97990,1175266,221172,989841,496099,209292,431530,167900,595222,646849,931384,1065468,1134018,885386,1160541,972805,320335,501471,577528,1145900,618648,569258,588827,1165705,884305,814353,749211,463360,480825,400526,562823,835529,338970,594150,781224,164364,19196,495108,1074491,764081,398765,382341,536674,1016396,561625,232427,1189509,622983,411443,20295,604341,211233,638624,380964,93476,294904,415754,178420,286864,824526,416175,826391,825025,37341,249103,113968,502386,1112166,1009316,313607,12630,269834,569777,346070,978245,192768,1103559,1094644,42851,1196846,882373,1087822,1190802,973890,214506,84182,438407,891762,692124,170315,552906,993421,892262,499806,331367,1040906,191689,1130403,1149649,187828,1038808,653608,13735,300082,542316,226469,548268,946695,586840,765442,253869,73122,666929,971458,680293,364721,460937,229094,137639,594137,752678,150592,6508,190075,811910,361403,1008726,492619,493514,892075,365663,41102,858394,1057031,578879,333925,114515,689753,32768,345107,1075487,831462,163671,156356,406075,398123,447169,962470,389804,335460,75216,657027,332847,327875,285017,178721,118373,221800,709951,516272,822220,421358,687452,970531,303625,27792,754266,411993,767210,541882,748033,1194416,523111,448879,17203,173830,806339,16994,728659,1045728,1011091,709151,1063597,804153,838639,532526,110273,222341,976303,997239,152155,397333,463492,1139317,816845,691655,154224,516855,535677,762499,58379,457436,190723,668097,771404,443093,306608,495436,1149608,927239,718893,613592,434109,762183,1023373,767791,1080388,810575,563391,147408,387740,1148518,100488,1038725,747833,1031727,219074,253679,577512,557806,786018,553642,489882,381728,20061,90513,1161418,410240,880775,159342,235186,612323,965343,708065,982910,483102,976784,855360,661719,866789,966984,72085,140878,886637,866262,915694,343230,824607,1146999,727881,904081,463370,1147904,595440,572583,148569,80155,535262,35543,356015,52396,1143700,27150,819094,837789,140618,315717,590822,661934,232975,365311,281925,946291,713479,798251,1057646,270443,340326,714755,374548,289739,317738,144143,38148,1007390,508091,91937,786220,1089363,1072518,578880,520441,852855,690729,1162153,918266,829982,876702,63028,159676,231318,413197,93246,527140,725056,1152021,511891,786866,572518,5839,11295,471822,906540,241191,435168,599262,578540,603294,216184,358889,557173,133328,436012,1070155,735380,228957,942729,80361,618966,1175377,557071,277992,604435,970603,553886,472708,824538,258205,101823,836737,411070,1136606,762151,1045266,1102531,1049156,612685,193518,815082,138141,774851,1192329,640544,265465,376453,970743,308344,805342,961178,225413,72656,12305,754265,225477,28870,540906,816729,621257,768616,403639,117846,170510,981096,1920,1082582,282977,675839,1090671,626922,674314,598968,854562,383995,1127321,188136,977848,426938,314343,707172,957381,90032,105216,1098757,411319,853931,104337,90209,770361,1194108,584071,675549,914676,964821,391274,153431,1171711,893666,1186612,620662,15048,787066,735207,309876,206495,1109594,522564,261512,1096601,838039,44459,396243,834822,261068,951086,91192,809196,945242,345398,239917,33822,447687,533197,662085,841028,433118,429301,157843,998656,867507,700400,648403,841646,684230,254560,761011,477363,447793,1134597,1050860,944484,339828,82024,492095,1001772,982078,1052320,95376,43328,308903,834739,355293,770997,10184,520559,98204,354936,79240,624,172127,661056,609024,264612,623078,159248,673897,697061,873599,1175084,1019609,797033,318467,731154,349639,520813,748109,992660,327144,523055,786712,602998,119174,1059072,268277,99967,908450,656694,523231,67260,1158090,290950,949386,505457,22003,484123,914741,1107551,460134,216871,300714,1008490,803840,1165100,661739,1002866,158731,91605,1163120,369007,748486,622413,726532,891007,48021,1029361,1014107,143337,664458,153526,919516,349187,81251,84947,551508,227630,240683,333439,521895,82732,756513,185095,475005,338792,940570,1145614,1188717,266274,309691,445384,1097928,342004,989462,493314,729386,61626,1043983,220622,242926,558558,870573,1073819,25753,239819,924550,1173308,437549,205807,981253,530988,788105,436209,673296,22478,421229,588508,373070,177721,503009,1097777,932032,921655,345938,319753,974530,974727,577868,1063047,57238,901098,1193807,752562,80194,620900,76859,394079,967495,733362,37103,187292,506955,270098,688680,1178708,37828,28239,261248,977698,5401,984876,560772,479052,378014,988536,303162,1130797,355931,1158186,225271,1143247,599153,615673,395661,109800,658267,383054,535591,297176,59432,373500,108174,497744,319376,146696,575339,209916,603657,828956,6165,911461,356381,26635,609834,384366,836059,949808,141863,100423,895995,678973,968287,1090071,138855,960284,13368,139327,337842,1066358,599999,261517,831100,935496,49339,52763,106374,231624,1177286,786058,825796,71457,420768,866464,253334,925866,1021759,449298,292142,433392,17202,1185395,67999,16018,797355,472569,58515,663911,1164240,800833,1013396,517452,464196,657671,641051,180678,913561,267494,223821,263272,1090567,398554,564138,497464,810460,679509,302059,275500,661991,81658,517856,337557,624862,1035355,1181438,42083,524197,529566,338254,35685,483505,663629,84211,1055047,738164,720428,574293,401383,1062262,1006141,1175402,427647,765277,628835,451284,505889,325488,757457,138292,184823,62055,787920,675098,661630,1039999,1149179,1183302,264417,194888,1150749,483577,913890,529127,1125319,584376,55041,869148,64420,1004452,47100,573708,314894,442522,435181,627808,592312,615982,521217,621470,959851,721448,325734,1113315,859701,424919,1134054,411476,184918,1007941,243441,767818,125915,378378,589743,688778,287980,510288,123887,717526,837473,1105612,626072,282406,804412,24962,69626,363057,401292,862440,909737,1086586,688578,125291,206251,1126768,79754,23368,1085291,1162720,43629,140412,232013,649069,460878,7379,904576,536553,13418,1078560,114331,1115158,759442,165523,536660,801334,1007594,218763,953172,985324,254270,585016,815262,164753,689060,169928,256074,399119,514550,727376,163819,204861,655024,542571,1062890,726251,1195575,1040575,755105,1148387,826593,162665,619977,446255,614348,66647,641477,563148,351098,683270,911350,20482,738484,501498,821136,713703,645000,1110628,489067,527475,907704,493154,838851,537245,887823,429253,789723,302685,820659,403565,692634,645076,908872,293100,601651,479132,922322,151686,381242,427441,681573,687082,250228,280293,864753,1012085,403500,549904,576216,845432,1164097,486827,861904,377884,703076,165442,1003917,899844,928538,990815,54371,503852,184073,350532,546342,1141179,666147,83747,773455,799570,267564,101050,429589,1158887,382158,1148595,85248,383017,822985,534459,23320,519090,466749,1194862,1041658,276244,452499,685520,45919,745216,538322,487947,95649,642794,598115,1101187,770581,294793,79855,890269,178528,63215,293819,521583,595709,425985,1078664,342699,27253,860946,209625,241146,428515,920230,534620,100371,781811,623885,917535,1068020,286612,547653,57050,580439,165202,569074,1014232,694298,704721,275526,719083,109202,543232,947623,1150024,642630,1159597,1019608,610517,778208,730178,418335,1145735,993614,947420,427787,519735,961469,587924,473097,296321,1131106,481487,471775,526855,283560,389296,233731,1195930,161219,486066,296786,401133,1158421,925615,931402,828513,47166,902954,1122094,506938,693569,117710,1162116,7579,1067265,840590,208618,518251,928436,1135479,222794,404300,2579,594283,428151,120942,149004,943188,627454,460103,425280,175713,978234,537254,170305,1083908,798507,882502,1186766,590182,1099794,937370,938752,1116449,737317,888068,598595,772792,541805,763273,652043,447959,946147,212957,1106500,917102,578019,473019,125045,1048474,405359,1037739,149450,263654,454819,895399,936970,613374,508375,346917,810605,168466,732150,417020,285719,522124,862061,906952,408599,318674,1001374,1029732,722845,905009,1026554,1025092,303087,320988,92157,1084986,585147,89157,1040813,816916,755400,1058881,586151,450585,722034,598739,75233,233556,903817,344467,315266,337776,737112,990880,197101,572712,247513,677616,661166,758407,12504,730438,989255,223094,49293,1057675,887083,186728,743059,778526,138216,386579,258022,713744,1103670,232462,529083,107101,445603,12097,297529,5125,1023943,452702,209676,168814,943344,970006,625367,577536,241866,534963,577066,39259,958653,118346,1176273,1142148,489920,280850,521118,127601,947132,624824,1136233,680381,4995,738483,314982,82796,712727,713696,537469,734572,482235,1008347,489834,1013608,522171,43665,864583,454471,684205,383984,273726,452963,967112,1182594,1198080,1011565,459741,1197105,68696,624922,245505,1152841,100643,1194761,174757,1183007,353923,435330,862829,381520,761406,1068242,958410,322036,273722,904980,409914,1178690,274783,1115091,243680,1016145,471268,611642,944533,1092545,318254,539919,31830,312925,1003385,1114055,1102226,471583,658213,1093919,201904,244472,174773,573020,186553,450946,961774,1165497,427569,594001,546203,375156,1071853,1146164,737551,203815,846491,1001176,41994,697407,711761,251390,159224,989837,948116,850175,427626,442684,698748,430788,750424,269959,1120738,386333,1100245,1190416,863574,358544,905527,597281,99292,808655,678890,1062512,909982,57847,671647,364411,148865,177165,1033160,324439,389376,778039,359080,239299,980791,622428,1128110,1183378,62661,1197002,26844,55005,144977,1040043,969316,123994,307361,766507,11963,464086,508288,893159,73318,83554,718297,871589,79196,180487,33354,618112,37405,205317,642569,564850,309865,550981,176340,511828,1017168,782257,1142432,744900,305235,798302,985314,785272,390102,805502,851713,947875,228816,1001755,207468,481350,78784,13079,149848,216000,784294,85766,1151825,1095266,1040027,381222,291364,291745,667562,426067,797923,982529,107285,20198,483504,477113,543952,1054071,806860,147269,819798,356143,1162905,1002821,152078,412573,1119200,1064165,116032,887409,1086894,627618,1096702,506859,335777,494819,1085012,642239,116701,1066189,228901,82481,666156,564310,230029,808354,847381,467157,616206,367966,674452,1178475,908597,518683,33840,210732,644426,679653,802581,1165332,802535,972163,385163,927267,1149017,919735,461437,36776,298691,1082137,1149027,388733,656351,46536,809812,823322,1090139,841133,848002,79736,260323,974062,1145152,82076,606279,1056860,1032830,1074371,1145700,455959,265221,393627,527933,70200,794032,87778,224583,1014906,607577,1142266,933350,1143138,636286,408040,289277,409178,484148,785317,396755,484534,895633,252717,861270,736759,1045187,744739,228184,535581,828178,1062599,363740,795134,756559,378264,892377,383688,176716,1153146,678216,1149233,472437,598104,247592,1035408,284057,835511,575925,482921,763656,202811,485063,121874,260171,179493,339005,1131805,265342,198524,10998,188296,868383,1149400,470503,498541,410584,345905,155130,570930,942519,448674,120015,970417,606259,920783,643002,1054851,123458,973589,382997,686908,144631,3800,694929,984379,114557,136858,1091023,386099,586417,942520,635190,858355,971393,537563,295861,397497,1100091,22815,976909,208240,701982,988789,766551,1030181,602859,551232,266697,132613,64063,312695,37540,225276,877746,696610,620553,52181,579433,628823,609254,32376,313776,383728,448870,734721,717256,797555,635258,362552,859111,603931,416857,1033717,1178885,702973,123590,434000,799316,815740,661407,181685,636456,965654,8572,575098,786638,1177786,593740,986848,559457,817117,1104605,903177,782327,1019661,911217,373555,781906,371690,373056,1160740,948978,1084113,695695,85915,188765,884474,1185451,928247,628304,852011,219836,1005313,94522,103437,1155230,1235,315708,110259,7279,224191,983575,1113899,759674,306319,505957,1027766,645175,204660,305819,698275,866714,157175,1006392,67678,48432,1010253,159273,544473,1184346,897999,655765,971612,649813,251386,611241,432639,944212,1124959,531152,226623,517788,833360,737144,968987,1060442,603944,445403,1047489,1191573,1008006,386171,836678,189355,705462,704567,306006,832418,1156979,339687,141050,619202,864156,1083566,508328,1165313,852974,122594,366619,1034410,1041725,792006,799958,750912,235611,808277,862621,1122865,541054,865234,870206,913064,1019360,1079708,976281,488130,681809,375861,776723,510629,227550,894456,1170289,443815,786088,430871,656199,450048,3665,674970,749202,1180878,1024251,391742,1181087,469422,152353,186990,488930,134484,393928,359442,665555,1087808,975740,221778,200842,1045926,800748,734589,58764,381236,506426,1043857,681226,662404,435582,1139702,740645,1007358,529984,426677,754988,891473,702645,48473,270842,479188,584489,763972,435898,174708,430290,117693,387506,634690,1050673,810341,49563,1097593,159356,450248,166354,979007,944402,620569,640275,412063,644439,708199,816353,1178020,1107568,36663,787841,317306,1038739,962895,585758,232738,490016,215171,714979,221297,342721,536362,331292,231097,1125996,1057203,311444,331819,282387,854851,373474,51082,470200,294000,734711,50177,602641,625498,1049512,1117926,662819,1162538,842066,1145685,54381,1170931,378987,360292,1057463,882364,607259,536147,965106,832770,916156,251790,484602,399830,140435,927638,857755,483326,823533,908342,880343,1053938,1159933,190691,689990,1106144,411861,108718,125563,619201,677640,345226,507352,35928,279815,368099,321379,1135053,1038405,966763,784884,1104835,670941,473025,46060,686190,411215,625563,1192242,1186786,726259,291541,956890,762913,598819,619541,594787,981897,839192,640908,1064753,762069,127926,462701,969124,255352,1117720,579115,22704,641010,920089,593646,227478,644195,725373,373543,939876,1096258,361344,787011,61475,435930,152815,95550,148925,585396,1004563,382999,1059940,423230,5752,557537,932616,821628,227338,889737,392739,236903,972668,1125425,1185776,443816,972604,1169211,657175,381352,576824,429465,794442,1080235,1027571,216985,1196161,115499,915104,522242,107410,571159,523767,599113,343519,814086,70760,1009945,220233,771143,883738,490909,240700,1108049,1092865,99324,786762,344150,1093744,1107872,427720,3973,614010,522532,283405,233260,806807,1044650,26370,304415,11469,577419,1183033,411015,462874,888205,991586,88487,675517,936569,101480,360042,1153622,801838,363259,937013,246995,1106889,388885,252839,852683,958164,1164259,750394,664884,535996,357053,764963,768780,1040238,199425,330574,497681,549678,356435,513851,943521,437070,720718,750288,63484,147221,253597,858253,1116057,705986,196309,216003,145761,1102705,1154753,889178,363342,842788,427084,1187897,677522,1099877,843145,1118841,1197457,1025954,537025,589057,933469,575003,1038833,524184,501020,324482,22997,178472,401048,879614,466927,848442,677268,449972,205421,870937,675026,411369,595083,1078907,139009,929804,1098114,289631,541387,674850,1130821,39991,907131,248695,692624,1176078,713958,283340,90530,737947,981210,897367,189591,394241,32981,536342,195215,1039350,1106476,34961,829074,449595,575668,471549,307074,1150060,168720,183974,1054744,533623,1044555,278565,848894,1116830,1113134,646573,970451,957398,864642,676186,1115349,441568,1012986,723076,859289,257511,52467,9364,931807,888390,752697,100153,856077,208619,704767,468695,1136455,154098,977459,955155,639523,327508,124262,1172328,958262,273531,24773,760532,992274,216828,667093,409976,761872,524785,1175603,776852,609573,825011,1020360,695072,100304,266049,276426,852143,878328,223551,223354,620213,135034,1140843,296983,4274,445519,1117887,577181,1121222,804002,230586,464719,1160978,1010789,691126,927983,509401,19373,1160253,1169842,936833,220383,1192680,213205,637309,719029,820067,209545,894919,67284,842150,39895,972810,54834,598928,582408,802420,1088281,539814,815027,662490,900905,1138649,824581,1089907,700337,878705,1051385,622742,988165,594424,369125,1191916,286620,841700,1171446,588247,813715,362022,248273,1056218,1097658,302086,519108,229794,108010,1059226,237797,1184713,1058754,860239,131723,598082,936564,366981,262585,1148742,1145318,1091707,966457,20795,412023,372285,1126624,777313,331617,944747,272215,176322,748783,905939,764689,1180879,12686,1130082,1182063,400726,725512,1139566,534170,33841,397248,184685,680629,733885,540410,557030,1017403,284520,930587,974260,934809,107514,799527,633943,700617,387621,518572,896022,922581,536090,1116423,680225,860524,573219,162726,16643,1155998,673884,668515,859827,1162396,714576,534452,1113870,143034,459917,477653,623788,796698,135819,191940,22679,770434,432804,569246,746797,692192,872593,440624,1059789,1013258,1136026,410161,522983,536451,158082,48902,14779,933664,1003193,47332,714504,284191,668954,72762,613705,1143040,328933,1133661,193629,1150981,624373,883187,755559,762900,570273,605769,582099,676864,576611,238230,476633,872347,84766,338380,773162,64027,786605,1013163,190140,954640,430263,1072166,819703,608338,509303,910101,687793,1074194,480555,360608,92469,572009,915675,393669,1173119,1128455,835024,796789,335641,288344,111495,509503,1072790,991830,71313,1118327,1174713,112790,35361,1154452,1057669,966068,549012,737203,1190702,293505,661528,1184663,119521,1083750,82923,438639,1032558,661421,396747,190487,979318,244909,212757,943811,613065,382819,1033328,509021,1028153,942007,798962,683531,470705,1034262,993220,543057,655510,135191,471830,2506,157506,442976,49694,371488,1035416,578104,751826,583733,1131434,556604,634933,846983,514811,286731,1177599,459597,696583,376945,484378,553081,87453,709014,670606,290377,704927,359230,660836,310258,768828,408358,895396,377422,794516,505447,553005,289209,904981,596430,718949,275759,1046395,816839,770640,516508,510999,947853,917788,333328,185996,794581,648177,621865,352649,33984,711254,336177,820197,495005,1032639,194164,298237,269543,207266,1143710,694229,1014008,847549,651739,56902,531934,1114334,424626,398511,930517,1097031,768492,39194,815923,49486,1112833,815064,375096,663622,1174761,678991,731332,3219,156423,921837,745582,512561,1152162,452865,659759,710134,1102432,555287,599966,96894,427500,903288,1118226,307812,1019553,1134866,904262,676498,602372,772096,119417,855382,1170828,337135,988456,956935,769566,277851,663461,1097710,416270,574196,280546,130061,911469,650428,1141031,617642,1032879,629007,183849,503783,493360,922555,478998,1088879,654849,250458,48057,555451,38484,178473,587564,419873,467903,779746,52346,204467,250661,770294,678346,236612,610157,724984,901760,66975,716594,726306,671226,914521,808785,964350,2151,1036862,712015,901295,796948,39660,272466,266679,369568,1150915,295127,75987,691143,504512,1080371,35965,1190502,130816,357491,989463,679830,269645,62602,975287,793781,1195502,603798,769930,1077139,1049077,254893,570627,737978,772801,1022368,219847,660827,1027776,114173,399574,315579,11315,607899,98287,260711,259329,81632,460764,310013,599486,425289,656276,434808,546038,750122,251934,985124,91581,280979,620062,725062,1073036,149607,792722,160342,1048631,934427,743262,302682,261111,584707,689706,851164,387476,1029615,465931,781061,912362,675957,336020,291129,789482,879407,196707,168349,475236,293072,171527,172989,894994,877093,1105924,113095,612934,1108924,157268,381165,442681,139200,611930,747496,476047,599342,1122848,964525,294264,853614,882815,860305,460969,207201,1000980,625369,950568,520465,536915,439674,1185577,467643,208826,974987,1148788,140406,310998,1011353,455022,419555,1059865,811502,940059,484337,94411,965619,668998,1090980,752478,1185984,900552,1192956,174138,745379,988405,1029267,254737,228075,572714,620545,956215,663118,621015,1158822,239428,1079735,21808,55933,708161,917231,676963,1070480,250949,573257,61848,517700,1193086,459598,883099,1115285,485354,484385,660612,463509,715846,189734,708247,184473,675910,1154416,333498,743610,513876,814097,924355,745118,230969,15487};
static const uint32_t omega_3328[3328]={1,1169874,109065,275553,626057,524141,1072434,201331,1158504,935028,220338,570262,55272,844158,695169,359744,447062,722772,514573,190704,195962,445600,28571,406316,1085515,234512,923298,418092,788320,241120,233997,1072931,559424,252083,105554,1067688,1084762,1107006,266861,194696,213232,929677,197789,428894,408880,647627,724299,573400,199700,438962,366001,73770,236307,611135,902564,598502,213457,573507,775794,128107,1096228,1167414,9587,345797,879523,1156087,820730,188053,691697,51806,366978,71394,163603,258191,340862,1103672,858681,788610,447657,712741,711874,7642,96686,808435,747709,390161,300739,666588,235498,667059,128892,519191,521607,664112,587332,190344,765834,718873,270214,265024,493472,1138435,328998,288840,839001,1190867,1009609,344307,975118,390172,1188543,668222,870419,365200,1102119,335155,340086,228765,89911,217900,1048311,128784,1169385,723397,856413,65712,1091004,1156819,540583,950287,1118885,658588,652270,350027,173932,41771,677107,650153,160196,512960,161517,392024,466662,180913,812069,80356,167560,64625,601907,15102,534722,936336,466093,655643,1054296,239310,969265,150565,210190,473539,290496,853368,892276,856516,754634,343889,784834,328080,1023165,158054,1028304,170082,811431,105207,72788,379718,138514,1075824,426081,681825,556518,752117,654129,628778,450078,714211,1180419,988419,208218,986017,868896,193545,331302,1194367,527751,1082049,955413,299523,221951,599449,1057291,823096,542827,1152072,254140,789724,175165,6889,969180,151998,524313,1013154,989296,630380,789542,516515,524436,1137936,27319,977131,1117369,289484,644908,741948,1149753,969799,663080,943012,254878,340335,393708,889314,539980,1185974,49064,1033388,535414,586388,459970,843440,580418,1124420,283373,494221,378769,549175,608105,107942,801908,350324,183020,85889,1046840,886527,79543,336312,52774,618465,215186,924925,52381,921087,483557,459886,816666,1003606,741507,410149,795374,150388,410505,338330,638936,264731,371556,332496,1061477,160532,620056,864927,725595,1157639,174382,527512,635036,48579,336811,354453,1128255,1134899,628227,417082,523446,308922,1078340,144048,728816,158967,435014,305704,794310,210611,579202,679783,647324,884453,1072973,572811,40489,896051,1004300,335145,622156,336196,928624,1145816,599225,187173,354156,1119167,1090781,258494,180708,604099,485570,1187083,1115688,980292,613036,1194702,663054,478313,1013431,364443,889360,440539,212559,743692,1078066,684280,797031,136548,220979,460790,477239,157643,640571,871445,178762,383195,305417,503152,59062,568837,713574,1177063,1002712,798864,1148681,57597,1157338,278122,47134,361172,902220,717062,1033689,431674,1066766,733834,1187880,200167,445184,979954,562354,273162,976458,931384,1169761,900294,1130099,638674,466479,550470,22470,1171640,614905,1191383,831769,312040,588827,1151795,878993,530744,524168,310845,749924,211868,1065433,1193254,772036,698885,973660,781224,318465,269083,1017035,543300,989052,324402,535464,374119,1120896,244118,733162,973688,1189509,976123,796081,575416,842276,1065179,1169346,625389,197121,101874,636401,1082697,648492,286864,266226,134926,445655,873348,414486,665877,1121379,997109,695993,1078796,460547,143054,12630,773728,895881,1007166,963391,503305,535715,482648,940348,1117304,924858,744169,802218,1190802,446902,443568,1035388,431221,665646,448710,962795,541543,229349,390157,413567,230328,331367,558993,428490,1021779,914364,822420,441463,507073,880948,497785,487825,1078591,252577,548268,1032153,626710,76185,407019,425290,230023,547935,840436,250495,569273,396132,806163,137639,597248,840686,387231,279660,993765,371802,582060,335604,854034,77629,410865,966539,365663,23088,512848,924539,157554,754832,749308,814246,973929,382027,903006,111818,496947,163671,736277,568796,671980,299641,487768,290228,26277,416800,91253,702698,49578,911962,285017,847072,1167560,683689,694234,375507,308172,668132,1012887,133998,263969,299832,1090636,754266,1139417,185587,761461,665741,165207,541241,361296,998795,1062231,457912,187477,165795,728659,993223,84943,174799,746003,588063,1136485,220922,870508,250939,26175,897752,947433,152155,888138,165144,1120201,678687,412090,1157313,983297,914752,660833,825848,792428,580621,190723,858110,121673,471754,320589,261465,243381,1154344,864210,582637,833299,286246,925018,1023373,281403,950285,1175299,440458,101164,295994,323731,293065,274445,729307,686302,72284,219074,281480,1174508,1186737,92581,384313,1118178,233560,220499,821259,841603,879194,851542,880775,585272,788876,133081,970087,926031,5545,540796,932601,388110,645408,1015420,570527,966984,992439,633773,929671,367031,972585,1151724,485528,1173696,129201,189795,676424,746238,1147904,408978,279503,629940,21731,451155,287297,33405,634912,1150085,1189723,930230,174371,837789,633402,611739,638670,579307,114210,118339,1063574,914503,495890,26445,470348,442958,270443,994107,309656,741779,1124412,509029,819782,570507,333043,9220,1113118,389341,666940,1089363,719347,78987,444351,514765,765365,769065,636212,423415,402584,922911,551472,513000,231318,1160381,706053,63492,212251,1044881,1032314,877707,862516,442055,581663,751054,686145,906540,1067084,150575,1126201,366108,649864,1123533,143281,798127,371782,1146200,550466,135298,735380,710774,1083317,1131367,814628,981584,112022,733124,847473,639282,89757,967535,1025435,824538,603087,277110,1036755,210844,1195457,932227,154799,589852,993564,51004,225453,61177,815082,156416,506211,35681,1132154,181177,553907,119572,1028692,8495,1195816,390562,970542,72656,508799,118906,645258,454146,983911,368788,534207,1085969,607425,119406,918730,1073001,981096,698147,224968,562681,634121,698283,1181140,1018549,968818,778284,579456,703691,793971,188136,746678,717634,474338,516642,536390,612219,278201,214943,590740,1105449,1054244,507993,90209,198781,3413,774070,833735,1166885,554118,158300,79787,642290,306852,760861,816807,620662,544619,924530,411417,971328,665493,1170138,1048984,314769,289108,468011,468262,576791,396243,71348,263044,33525,844315,1058994,709815,577967,771079,137121,831502,654823,222416,662085,255033,760574,525649,469113,534254,958321,941156,1089587,391384,547927,1066092,576056,761011,180000,207278,1142815,184681,1157302,95493,913118,25912,1127707,1017282,764657,372244,95376,619094,444198,38112,851554,542291,695971,501269,457279,71293,616348,25355,65872,172127,636004,300066,480603,1115775,922445,517043,8112,18287,551502,864871,1107106,1040404,318467,212669,37084,1094406,1043085,174603,284170,776781,1041742,916093,1173838,916131,101972,268277,988338,96823,538319,114561,1000411,1006797,589045,993074,693543,697248,423360,755888,914741,971110,824214,157507,882480,415577,1042146,303194,907101,818010,233909,1158985,546352,1163120,124264,470358,160888,163012,155394,579821,1190865,1066023,126177,424012,336139,140261,919516,467757,444354,430144,1092560,397643,118221,797757,25643,328823,432741,921922,892332,475005,871869,199804,1099677,926032,1175419,649861,10073,1014167,1169549,889773,771858,927407,729386,854111,301852,422303,618662,648812,845272,422677,851973,704368,867128,942200,395423,437549,685819,517374,256243,176372,705389,821725,876032,186001,1064573,291573,426454,943343,503009,498420,547595,846168,308906,331571,795170,1112292,924784,435325,1117975,1167257,843843,1193807,748618,1107780,101,745336,232836,274990,931545,222677,488544,1165135,795047,987510,688680,88574,790148,196207,723371,391714,824265,1115112,454390,91808,622866,676603,489509,303162,611644,922173,1000861,294457,546974,391500,870158,538741,192017,300682,1076306,9198,535591,386073,595179,495000,1169055,447059,807393,187378,562126,713953,71258,405512,1000404,6165,1023671,262284,1103468,622504,104808,544652,1191780,416319,479929,957997,495576,496876,968287,181148,173829,550930,226141,1022138,372699,440082,1122348,22308,948850,917590,880794,49339,464949,576264,884360,101981,14414,771842,180638,182427,39506,1067669,422614,232852,1021759,280423,1037282,920808,1164824,1180857,614563,55448,672050,721313,933832,409642,719351,1164240,880611,418896,873431,469467,133624,30658,244276,1068780,234743,397886,452406,942770,1090567,304387,802418,341726,694444,442442,448283,1026374,695947,1178237,235881,646507,1166033,624862,685238,132507,387771,622933,1182896,608378,793998,624628,97190,969079,604743,291477,738164,57751,407703,300998,549461,927470,150426,536720,888557,327221,93277,1119618,350234,325488,1052768,208690,851204,830093,861813,1102280,586152,1126417,263801,246284,738931,1186521,194888,787893,304699,388401,823738,405148,485023,1041259,163102,12926,811023,830934,1101346,573708,1096592,484714,172574,8285,1128881,250451,612300,389596,662641,146994,298583,378749,1113315,822967,587287,261578,650233,299798,851593,640299,157182,465107,911882,145415,508439,688778,918531,695789,842619,974826,240049,491669,478173,170087,670396,650532,252472,1113841,363057,447589,234655,483940,439334,655726,1109277,905138,1076625,595813,582977,827567,227835,1162720,624335,1173355,163140,139141,163169,519219,929892,123689,1114330,946806,1064810,795000,1115158,354949,316474,119413,721281,638375,513805,288222,299712,881233,845357,421244,537850,164753,168328,1165188,498157,777550,916017,921408,1013758,725402,611185,690295,61347,812216,726251,625062,1034243,380049,386645,35828,579968,638679,325444,1095795,202154,707682,839448,563148,640343,114155,471643,1055404,136060,807104,1150715,192447,152482,51016,1085050,171876,527475,480614,805498,924079,1151964,904334,991514,367466,683350,671759,542983,346023,495146,645076,795496,303377,537544,409528,340706,711640,617675,933258,1025407,416253,1143510,948193,280293,1109949,1119330,87283,64874,766850,814505,856802,1073999,386373,519646,866313,1167366,165442,1101082,831870,1057376,821663,228704,612457,753421,1012712,277899,346890,1297,556032,83747,364103,895092,498950,1172938,1142730,186114,273344,635108,413837,1001005,1024973,677281,534459,1166291,535942,70064,538402,169542,468158,1114157,1034293,167780,1047571,634587,732712,487947,33499,379616,619466,733923,1073619,322304,1007781,389220,485744,1071389,923702,1003274,521583,142999,365934,765558,117438,120299,889580,225404,245239,263221,1031291,979524,710554,100371,1098687,97018,1028359,1014859,819601,883650,959655,453529,416415,168219,645508,590882,694298,966421,99846,332309,345781,132754,609128,6125,953870,692008,864077,739925,704626,778208,327026,801318,219320,531044,448635,682158,748235,1128332,161041,639665,69205,806595,1131106,988169,71482,77549,271263,627906,1084962,257930,514403,193570,824208,326749,228090,1158421,880047,752591,462902,808105,471371,341141,422405,137710,990713,197734,782198,400710,1067265,1035513,499589,1119880,148486,146574,164713,98527,396831,258766,894971,317754,1154964,149004,1110401,350576,263342,14406,997498,506199,374165,1021455,468784,229709,1018366,140294,1186766,472659,1151036,722648,417998,1043616,771739,689797,929542,411491,82091,349736,1193683,652043,762611,575878,989533,1133807,280165,1126202,337901,758929,201005,769338,124187,246135,149450,510889,1070326,955718,82955,1138589,777444,311716,143247,559084,257815,163965,829986,285719,215054,1054006,32773,490521,511622,761972,628936,785696,1173347,388796,464702,354907,303087,331007,1128865,701763,65341,773072,230377,147305,1110854,751696,548466,239491,656122,722034,963962,1170242,511618,874800,192676,881565,1065281,688394,967290,747664,461395,185138,247513,816877,1042334,990683,1043944,1104491,520687,256770,886336,674756,1070355,137715,849678,743059,961882,1134833,93727,407278,308163,921995,31302,50183,619861,374887,1023378,140368,297529,156902,1174581,325707,865840,132305,95180,157261,632916,1141450,348644,845621,163082,577066,1025885,112198,561016,873617,15289,52337,964114,477021,316364,826021,704941,279570,1136233,140600,941991,300281,406503,603130,262290,934226,78813,560045,706751,742383,860518,489834,720535,115339,620823,795616,512780,446453,1127701,1186524,110267,1115088,1131358,1068491,1198080,28207,1089016,922528,572024,673940,125647,996750,39577,263053,977743,627819,1142809,353923,502912,838337,751019,475309,683508,1007377,1002119,752481,1169510,791765,112566,963569,274783,779989,409761,956961,964084,125150,638657,945998,1092527,130393,113319,91075,931220,1003385,984849,268404,1000292,769187,789201,550454,473782,624681,998381,759119,832080,1124311,961774,586946,295517,599579,984624,624574,422287,1069974,101853,30667,1188494,852284,318558,41994,377351,1010028,506384,1146275,831103,1126687,1034478,939890,857219,94409,339400,409471,750424,485340,486207,1190439,1101395,389646,450372,807920,897342,531493,962583,531022,1069189,678890,676474,533969,610749,1007737,432247,479208,927867,933057,704609,59646,869083,909241,359080,7214,188472,853774,222963,807909,9538,529859,327662,832881,95962,862926,857995,969316,1108170,980181,149770,1069297,28696,474684,341668,1132369,107077,41262,657498,247794,79196,539493,545811,848054,1024149,1156310,520974,547928,1037885,685121,1036564,806057,731419,1017168,386012,1117725,1030521,1133456,596174,1182979,663359,261745,731988,542438,143785,958771,228816,1047516,987891,724542,907585,344713,305805,341565,443447,854192,413247,870001,174916,1040027,169777,1027999,386650,1092874,1125293,818363,1059567,122257,772000,516256,641563,445964,543952,569303,748003,483870,17662,209662,989863,212064,329185,1004536,866779,3714,670330,116032,242668,898558,976130,598632,140790,374985,655254,46009,943941,408357,1022916,1191192,228901,1046083,673768,184927,208785,567701,408539,681566,673645,60145,1170762,220950,80712,908597,553173,456133,48328,228282,535001,255069,943203,857746,804373,308767,658101,12107,1149017,164693,662667,611693,738111,354641,617663,73661,914708,703860,819312,648906,589976,1090139,396173,847757,1015061,1112192,151241,311554,1118538,861769,1145307,579616,982895,273156,1145700,276994,714524,738195,381415,194475,456574,787932,402707,1047693,787576,859751,559145,933350,826525,865585,136604,1037549,578025,333154,472486,40442,1023699,670569,563045,1149502,861270,843628,69826,63182,569854,780999,674635,889159,119741,1054033,469265,1039114,763067,892377,403771,987470,618879,518298,550757,313628,125108,625270,1157592,302030,193781,862936,575925,861885,269457,52265,598856,1010908,843925,78914,107300,939587,1017373,593982,712511,10998,82393,217789,585045,3379,535027,719768,184650,833638,308721,757542,985522,454389,120015,513801,401050,1061533,977102,737291,720842,1040438,557510,326636,1019319,814886,892664,694929,1139019,629244,484507,21018,195369,399217,49400,1140484,40743,919959,1150947,836909,295861,481019,164392,766407,131315,464247,10201,997914,752897,218127,635727,924919,221623,266697,28320,297787,67982,559407,731602,647611,1175611,26441,583176,6698,366312,886041,609254,46286,319088,667337,673913,887236,448157,986213,132648,4827,426045,499196,224421,416857,879616,928998,181046,654781,209029,873679,662617,823962,77185,953963,464919,224393,8572,221958,402000,622665,355805,132902,28735,572692,1000960,1096207,561680,115384,549589,911217,931855,1063155,752426,324733,783595,532204,76702,200972,502088,119285,737534,1055027,1185451,424353,302200,190915,234690,694776,662366,715433,257733,80777,273223,453912,395863,7279,751179,754513,162693,766860,532435,749371,235286,656538,968732,807924,784514,967753,866714,639088,769591,176302,283717,375661,756618,691008,317133,700296,710256,119490,945504,649813,165928,571371,1121896,791062,772791,968058,650146,357645,947586,628808,801949,391918,1060442,600833,357395,810850,918421,204316,826279,616021,862477,344047,1120452,787216,231542,832418,1174993,685233,273542,1040527,443249,448773,383835,224152,816054,295075,1086263,701134,1034410,461804,629285,526101,898440,710313,907853,1171804,781281,1106828,495383,1148503,286119,913064,351009,30521,514392,503847,822574,889909,529949,185194,1064083,934112,898249,107445,443815,58664,1012494,436620,532340,1032874,656840,836785,199286,135850,740169,1010604,1032286,469422,204858,1113138,1023282,452078,610018,61596,977159,327573,947142,1171906,300329,250648,1045926,309943,1032937,77880,519394,785991,40768,214784,283329,537248,372233,405653,617460,1007358,339971,1076408,726327,877492,936616,954700,43737,333871,615444,364782,911835,273063,174708,916678,247796,22782,757623,1096917,902087,874350,905016,923636,468774,511779,1125797,979007,916601,23573,11344,1105500,813768,79903,964521,977582,376822,356478,318887,346539,317306,612809,409205,1065000,227994,272050,1192536,657285,265480,809971,552673,182661,627554,231097,205642,564308,268410,831050,225496,46357,712553,24385,1068880,1008286,521657,451843,50177,789103,918578,568141,1176350,746926,910784,1164676,563169,47996,8358,267851,1023710,360292,564679,586342,559411,618774,1083871,1079742,134507,283578,702191,1171636,727733,755123,927638,203974,888425,456302,73669,689052,378299,627574,865038,1188861,84963,808740,531141,108718,478734,1119094,753730,683316,432716,429016,561869,774666,795497,275170,646609,685081,966763,37700,492028,1134589,985830,153200,165767,320374,335565,756026,616418,447027,511936,291541,130997,1047506,71880,831973,548217,74548,1054800,399954,826299,51881,647615,1062783,462701,487307,114764,66714,383453,216497,1086059,464957,350608,558799,1108324,230546,172646,373543,594994,920971,161326,987237,2624,265854,1043282,608229,204517,1147077,972628,1136904,382999,1041665,691870,1162400,65927,1016904,644174,1078509,169389,1189586,2265,807519,227539,1125425,689282,1079175,552823,743935,214170,829293,663874,112112,590656,1078675,279351,125080,216985,499934,973113,635400,563960,499798,16941,179532,229263,419797,618625,494390,404110,1009945,451403,480447,723743,681439,661691,585862,919880,983138,607341,92632,143837,690088,1107872,999300,1194668,424011,364346,31196,643963,1039781,1118294,555791,891229,437220,381274,577419,653462,273551,786664,226753,532588,27943,149097,883312,908973,730070,729819,621290,801838,1126733,935037,1164556,353766,139087,488266,620114,427002,1060960,366579,543258,975665,535996,943048,437507,672432,728968,663827,239760,256925,108494,806697,650154,131989,622025,437070,1018081,990803,55266,1013400,40779,1102588,284963,1172169,70374,180799,433424,825837,1102705,578987,753883,1159969,346527,655790,502110,696812,740802,1126788,581733,1172726,1132209,1025954,562077,898015,717478,82306,275636,681038,1189969,1179794,646579,333210,90975,157677,879614,985412,1160997,103675,154996,1023478,913911,421300,156339,281988,24243,281950,1096109,929804,209743,1101258,659762,1083520,197670,191284,609036,205007,504538,500833,774721,442193,283340,226971,373867,1040574,315601,782504,155935,894887,290980,380071,964172,39096,651729,34961,1073817,727723,1037193,1035069,1042687,618260,7216,132058,1071904,774069,861942,1057820,278565,730324,753727,767937,105521,800438,1079860,400324,1172438,869258,765340,276159,305749,723076,326212,998277,98404,272049,22662,548220,1188008,183914,28532,308308,426223,270674,468695,343970,896229,775778,579419,549269,352809,775404,346108,493713,330953,255881,802658,760532,512262,680707,941838,1021709,492692,376356,322049,1012080,133508,906508,771627,254738,695072,699661,650486,351913,889175,866510,402911,85789,273297,762756,80106,30824,354238,4274,449463,90301,1197980,452745,965245,923091,266536,975404,709537,32946,403034,210571,509401,1109507,407933,1001874,474710,806367,373816,82969,743691,1106273,575215,521478,708572,894919,586437,275908,197220,903624,651107,806581,327923,659340,1006064,897399,121775,1188883,662490,812008,602902,703081,29026,751022,390688,1010703,635955,484128,1126823,792569,197677,1191916,174410,935797,94613,575577,1093273,653429,6301,781762,718152,240084,702505,701205,229794,1016933,1024252,647151,971940,175943,825382,757999,75733,1175773,249231,280491,317287,1148742,733132,621817,313721,1096100,1183667,426239,1017443,1015654,1158575,130412,775467,965229,176322,917658,160799,277273,33257,17224,583518,1142633,526031,476768,264249,788439,478730,33841,317470,779185,324650,728614,1064457,1167423,953805,129301,963338,800195,745675,255311,107514,893694,395663,856355,503637,755639,749798,171707,502134,19844,962200,551574,32048,573219,512843,1065574,810310,575148,15185,589703,404083,573453,1100891,229002,593338,906604,459917,1140330,790378,897083,648620,270611,1047655,661361,309524,870860,1104804,78463,847847,872593,145313,989391,346877,367988,336268,95801,611929,71664,934280,951797,459150,11560,1003193,410188,893382,809680,374343,792933,713058,156822,1034979,1185155,387058,367147,96735,624373,101489,713367,1025507,1189796,69200,947630,585781,808485,535440,1051087,899498,819332,84766,375114,610794,936503,547848,898283,346488,557782,1040899,732974,286199,1052666,689642,509303,279550,502292,355462,223255,958032,706412,719908,1027994,527685,547549,945609,84240,835024,750492,963426,714141,758747,542355,88804,292943,121456,602268,615104,370514,970246,35361,573746,24726,1034941,1058940,1034912,678862,268189,1074392,83751,251275,133271,403081,82923,843132,881607,1078668,476800,559706,684276,909859,898369,316848,352724,776837,660231,1033328,1029753,32893,699924,420531,282064,276673,184323,472679,586896,507786,1136734,385865,471830,573019,163838,818032,811436,1162253,618113,559402,872637,102286,995927,490399,358633,634933,557738,1083926,726438,142677,1062021,390977,47366,1005634,1045599,1147065,113031,1026205,670606,717467,392583,274002,46117,293747,206567,830615,514731,526322,655098,852058,702935,553005,402585,894704,660537,788553,857375,486441,580406,264823,172674,781828,54571,249888,917788,88132,78751,1110798,1133207,431231,383576,341279,124082,811708,678435,331768,30715,1032639,96999,366211,140705,376418,969377,585624,444660,185369,920182,851191,1196784,642049,1114334,833978,302989,699131,25143,55351,1011967,924737,562973,784244,197076,173108,520800,663622,31790,662139,1128017,659679,1028539,729923,83924,163788,1030301,150510,563494,465369,710134,1164582,818465,578615,464158,124462,875777,190300,808861,712337,126692,274379,194807,676498,1055082,832147,432523,1080643,1077782,308501,972677,952842,934860,166790,218557,487527,1097710,99394,1101063,169722,183222,378480,314431,238426,744552,781666,1029862,552573,607199,503783,231660,1098235,865772,852300,1065327,588953,1191956,244211,506073,334004,458156,493455,419873,871055,396763,978761,667037,749446,515923,449846,69749,1037040,558416,1128876,391486,66975,209912,1126599,1120532,926818,570175,113119,940151,683678,1004511,373873,871332,969991,39660,318034,445490,735179,389976,726710,856940,775676,1060371,207368,1000347,415883,797371,130816,162568,698492,78201,1049595,1051507,1033368,1099554,801250,939315,303110,880327,43117,1049077,87680,847505,934739,1183675,200583,691882,823916,176626,729297,968372,179715,1057787,11315,725422,47045,475433,780083,154465,426342,508284,268539,786590,1115990,848345,4398,546038,435470,622203,208548,64274,917916,71879,860180,439152,997076,428743,1073894,951946,1048631,687192,127755,242363,1115126,59492,420637,886365,1054834,638997,940266,1034116,368095,912362,983027,144075,1165308,707560,686459,436109,569145,412385,24734,809285,733379,843174,894994,867074,69216,496318,1132740,425009,967704,1050776,87227,446385,649615,958590,541959,476047,234119,27839,686463,323281,1005405,316516,132800,509687,230791,450417,736686,1012943,950568,381204,155747,207398,154137,93590,677394,941311,311745,523325,127726,1060366,348403,455022,236199,63248,1104354,790803,889918,276086,1166779,1147898,578220,823194,174703,1057713,900552,1041179,23500,872374,332241,1065776,1102901,1040820,565165,56631,849437,352460,1034999,621015,172196,1085883,637065,324464,1182792,1145744,233967,721060,881717,372060,493140,918511,61848,1057481,256090,897800,791578,594951,935791,263855,1119268,638036,491330,455698,337563,708247,477546,1082742,577258,402465,685301,751628,70380,11557,1087814,82993,66723,129590};

/* multiplication inverses of omega */
static const uint32_t omega_1280_inv[1280]={1,46632,26409,1075301,152139,708247,673258,852532,548482,179436,61848,314969,359429,938019,962779,621015,355629,1052407,49302,1131506,900552,603733,769918,1120930,131811,455022,571394,1121649,113951,273797,950568,286138,159119,321575,503604,476047,978936,461290,529006,120002,894994,208573,154578,626000,388435,912362,210393,1159148,767140,969982,1048631,84777,851845,860485,7668,546038,28523,214626,869039,1134904,11315,485440,495666,518260,1008469,1049077,515272,649449,14250,769126,130816,781341,652221,1083487,891933,39660,786137,258146,744465,296824,66975,979114,375219,437484,1028701,419873,478034,186402,220409,973670,503783,436608,913823,49128,206024,1097710,401995,655514,90214,396857,676498,982006,1049891,135128,580917,710134,9848,366913,92255,924370,663622,786955,64530,781569,501588,1114334,453956,1181084,525518,406602,1032639,750296,243629,703486,303291,917788,440534,684662,695896,998387,553005,233716,899736,890613,785632,670606,586811,512,1112045,342517,634933,19903,802002,858849,394900,471830,817076,516070,721274,721255,1033328,531557,468215,1171817,894015,82923,657949,1019520,6398,29367,35361,394696,543550,221964,403489,835024,8587,269930,336774,1197501,509303,257833,525621,417374,158523,84766,338893,569986,160167,70590,624373,1195355,1075835,1092007,433681,1003193,625250,158784,274908,43156,872593,331773,418583,226804,863141,459917,1563,1000956,542513,985901,573219,1161298,387136,241444,649451,107514,821944,1083337,1085619,870634,33841,200835,1136624,1145009,381842,176322,1015682,744932,508510,419168,1148742,737353,518477,344884,789425,229794,117344,349481,700230,625786,1191916,53160,127531,949589,160488,662490,715095,121567,791133,803904,894919,305416,570065,249852,958820,509401,35445,717541,365744,691173,4274,423722,252452,1195839,882184,695072,912211,357447,765632,137624,760532,732543,259704,314180,707292,468695,791638,391444,1052573,601728,723076,886449,699106,926982,262144,278565,448878,405745,605688,881322,34961,911192,762679,212643,650020,283340,273612,710215,192797,109880,929804,68738,523741,209127,829005,879614,658932,133617,806744,342808,1025954,516436,1015452,802301,424845,1102705,901121,779559,221586,747808,437070,892349,269276,989552,699149,535996,199650,989430,1000450,908341,801838,399687,856148,240373,1025981,577419,530414,1081484,938355,1056078,1107872,1034384,653628,800256,908885,1009945,389211,1156364,336400,530267,216985,650475,1133523,308897,1155122,1125425,78476,553458,990635,882203,382999,215901,420789,62030,415426,373543,157517,1096214,129221,684323,462701,432303,242590,176078,420203,291541,514805,437763,860138,599498,966763,700348,137957,713935,1140173,108718,657065,531586,622462,739597,927638,900711,829735,176625,768206,360292,446681,990207,93003,1060757,50177,1671,46807,998523,904552,231097,974790,16059,62663,1179538,317306,313042,355640,367278,339801,979007,177919,7883,987270,914134,174708,32656,53641,992065,473427,1007358,758408,1126898,476795,1115323,1045926,941803,102279,1111948,611537,469422,1146834,421491,449507,983329,443815,329886,1081993,712423,121287,913064,597870,528970,837412,1142351,1034410,667979,288809,112767,173235,832418,689857,936774,413827,89997,1060442,936150,69403,383915,997978,649813,215164,797354,965974,1048211,866714,542794,910602,805662,206386,7279,377405,538151,52806,392937,1185451,493692,718929,394586,206354,911217,730398,872868,1174763,492572,8572,768531,1138720,643039,623380,416857,11399,808285,317860,987469,609254,637775,759137,377277,559660,266697,533724,880955,892232,803737,295861,687437,706948,2340,93509,694929,234240,175203,351957,1145286,120015,303129,551890,954600,207645,10998,80068,510580,1100928,703646,575925,350904,1163111,1065282,197721,892377,376891,530923,855552,3564,861270,671358,909726,690784,1033722,933350,90632,719737,932731,1177449,1145700,256367,453726,40372,441853,1090139,785018,792502,1144819,1106410,1149017,382262,592466,126652,694815,908597,758820,1169986,574574,849365,228901,407803,727864,119318,148812,116032,270428,795971,1170292,466994,543952,996813,237178,598785,66334,1040027,220184,66118,552163,506245,228816,38326,879261,970970,395888,1017168,551386,215611,76400,789987,79196,582230,835819,1138597,897708,969316,1141825,467598,1153817,174715,359080,238504,132605,340319,1172763,678890,1104217,721926,1173294,280781,750424,222120,489595,162504,24203,41994,599854,794621,517304,757274,961774,481014,172366,1043964,503975,1003385,1192027,436988,662768,499900,274783,204561,1165711,104220,570504,353923,571561,522626,930011,136914,1198080,1151449,1171672,122780,1045942,489834,524823,345549,649599,1018645,1136233,883112,838652,260062,235302,577066,842452,145674,1148779,66575,297529,594348,428163,77151,1066270,743059,626687,76432,1084130,924284,247513,911943,1038962,876506,694477,722034,219145,736791,669075,1078079,303087,989508,1043503,572081,809646,285719,987688,38933,430941,228099,149450,1113304,346236,337596,1190413,652043,1169558,983455,329042,63177,1186766,712641,702415,679821,189612,149004,682809,548632,1183831,428955,1067265,416740,545860,114594,306148,1158421,411944,939935,453616,901257,1131106,218967,822862,760597,169380,778208,720047,1011679,977672,224411,694298,761473,284258,1148953,992057,100371,796086,542567,1107867,801224,521583,216075,148190,1062953,617164,487947,1188233,831168,1105826,273711,534459,411126,1133551,416512,696493,83747,744125,16997,672563,791479,165442,447785,954452,494595,894790,280293,757547,513419,502185,199694,645076,964365,298345,307468,412449,527475,611270,1197569,86036,855564,563148,1178178,396079,339232,803181,726251,381005,682011,476807,476826,164753,666524,729866,26264,304066,1115158,540132,178561,1191683,1168714,1162720,803385,654531,976117,794592,363057,1189494,928151,861307,580,688778,940248,672460,780707,1039558,1113315,859188,628095,1037914,1127491,573708,2726,122246,106074,764400,194888,572831,1039297,923173,1154925,325488,866308,779498,971277,334940,738164,1196518,197125,655568,212180,624862,36783,810945,956637,548630,1090567,376137,114744,112462,327447,1164240,997246,61457,53072,816239,1021759,182399,453149,689571,778913,49339,460728,679604,853197,408656,968287,1080737,848600,497851,572295,6165,1144921,1070550,248492,1037593,535591,482986,1076514,406948,394177,303162,892665,628016,948229,239261,688680,1162636,480540,832337,506908,1193807,774359,945629,2242,315897,503009,285870,840634,432449,1060457,437549,465538,938377,883901,490789,729386,406443,806637,145508,596353,475005,311632,498975,271099,935937,919516,749203,792336,592393,316759,1163120,286889,435402,985438,548061,914741,924469,487866,1005284,1088201,268277,1129343,674340,988954,369076,318467,539149,1064464,391337,855273,172127,681645,182629,395780,773236,95376,296960,418522,976495,450273,761011,305732,928805,208529,498932,662085,998431,208651,197631,289740,396243,798394,341933,957708,172100,620662,667667,116597,259726,142003,90209,163697,544453,397825,289196,188136,808870,41717,861681,667814,981096,547606,64558,889184,42959,72656,1119605,644623,207446,315878,815082,982180,777292,1136051,782655,824538,1040564,101867,1068860,513758,735380,765778,955491,1022003,777878,906540,683276,760318,337943,598583,231318,497733,1060124,484146,57908,1089363,541016,666495,575619,458484,270443,297370,368346,1021456,429875,837789,751400,207874,1105078,137324,1147904,1196410,1151274,199558,293529,966984,223291,1182022,1135418,18543,880775,885039,842441,830803,858280,219074,1020162,1190198,210811,283947,1023373,1165425,1144440,206016,724654,190723,439673,71183,721286,82758,152155,256278,1095802,86133,586544,728659,51247,776590,748574,214752,754266,868195,116088,485658,1076794,285017,600211,669111,360669,55730,163671,530102,909272,1085314,1024846,365663,508224,261307,784254,1108084,137639,261931,1128678,814166,200103,548268,982917,400727,232107,149870,331367,655287,287479,392419,991695,1190802,820676,659930,1145275,805144,12630,704389,479152,803495,991727,286864,467683,325213,23318,705509,1189509,429550,59361,555042,574701,781224,1186682,389796,880221,210612,588827,560306,438944,820804,638421,931384,664357,317126,305849,394344,902220,510644,491133,1195741,1104572,503152,963841,1022878,846124,52795,1078066,894952,646191,243481,990436,1187083,1118013,687501,97153,494435,622156,847177,34970,132799,1000360,305704,821190,667158,342529,1194517,336811,526723,288355,507297,164359,264731,1107449,478344,265350,20632,52381,941714,744355,1157709,756228,107942,413063,405579,53262,91671,49064,815819,605615,1071429,503266,289484,439261,28095,623507,348716,969180,790278,470217,1078763,1049269,1082049,927653,402110,27789,731087,654129,201268,960903,599296,1131747,158054,977897,1131963,645918,691836,969265,1159755,318820,227111,802193,180913,646695,982470,1121681,408094,1118885,615851,362262,59484,300373,228765,56256,730483,44264,1023366,839001,959577,1065476,857762,25318,519191,93864,476155,24787,917300,447657,975961,708486,1035577,1173878,1156087,598227,403460,680777,440807,236307,717067,1025715,154117,694106,194696,6054,761093,535313,698181,923298,993520,32370,1093861,627577,844158,626520,675455,268070,1061167};
static const uint32_t omega_3072_inv[3072]={1,15487,230969,745118,924355,814097,513876,743610,333498,1154416,675910,184473,708247,189734,715846,463509,660612,484385,485354,1115285,883099,459598,1193086,517700,61848,573257,250949,1070480,676963,917231,708161,55933,21808,1079735,239428,1158822,621015,663118,956215,620545,572714,228075,254737,1029267,988405,745379,174138,1192956,900552,1185984,752478,1090980,668998,965619,94411,484337,940059,811502,1059865,419555,455022,1011353,310998,140406,1148788,974987,208826,467643,1185577,439674,536915,520465,950568,625369,1000980,207201,460969,860305,882815,853614,294264,964525,1122848,599342,476047,747496,611930,139200,442681,381165,157268,1108924,612934,113095,1105924,877093,894994,172989,171527,293072,475236,168349,196707,879407,789482,291129,336020,675957,912362,781061,465931,1029615,387476,851164,689706,584707,261111,302682,743262,934427,1048631,160342,792722,149607,1073036,725062,620062,280979,91581,985124,251934,750122,546038,434808,656276,425289,599486,310013,460764,81632,259329,260711,98287,607899,11315,315579,399574,114173,1027776,660827,219847,1022368,772801,737978,570627,254893,1049077,1077139,769930,603798,1195502,793781,975287,62602,269645,679830,989463,357491,130816,1190502,35965,1080371,504512,691143,75987,295127,1150915,369568,266679,272466,39660,796948,901295,712015,1036862,2151,964350,808785,914521,671226,726306,716594,66975,901760,724984,610157,236612,678346,770294,250661,204467,52346,779746,467903,419873,587564,178473,38484,555451,48057,250458,654849,1088879,478998,922555,493360,503783,183849,629007,1032879,617642,1141031,650428,911469,130061,280546,574196,416270,1097710,663461,277851,769566,956935,988456,337135,1170828,855382,119417,772096,602372,676498,904262,1134866,1019553,307812,1118226,903288,427500,96894,599966,555287,1102432,710134,659759,452865,1152162,512561,745582,921837,156423,3219,731332,678991,1174761,663622,375096,815064,1112833,49486,815923,39194,768492,1097031,930517,398511,424626,1114334,531934,56902,651739,847549,1014008,694229,1143710,207266,269543,298237,194164,1032639,495005,820197,336177,711254,33984,352649,621865,648177,794581,185996,333328,917788,947853,510999,516508,770640,816839,1046395,275759,718949,596430,904981,289209,553005,505447,794516,377422,895396,408358,768828,310258,660836,359230,704927,290377,670606,709014,87453,553081,484378,376945,696583,459597,1177599,286731,514811,846983,634933,556604,1131434,583733,751826,578104,1035416,371488,49694,442976,157506,2506,471830,135191,655510,543057,993220,1034262,470705,683531,798962,942007,1028153,509021,1033328,382819,613065,943811,212757,244909,979318,190487,396747,661421,1032558,438639,82923,1083750,119521,1184663,661528,293505,1190702,737203,549012,966068,1057669,1154452,35361,112790,1174713,1118327,71313,991830,1072790,509503,111495,288344,335641,796789,835024,1128455,1173119,393669,915675,572009,92469,360608,480555,1074194,687793,910101,509303,608338,819703,1072166,430263,954640,190140,1013163,786605,64027,773162,338380,84766,872347,476633,238230,576611,676864,582099,605769,570273,762900,755559,883187,624373,1150981,193629,1133661,328933,1143040,613705,72762,668954,284191,714504,47332,1003193,933664,14779,48902,158082,536451,522983,410161,1136026,1013258,1059789,440624,872593,692192,746797,569246,432804,770434,22679,191940,135819,796698,623788,477653,459917,143034,1113870,534452,714576,1162396,859827,668515,673884,1155998,16643,162726,573219,860524,680225,1116423,536090,922581,896022,518572,387621,700617,633943,799527,107514,934809,974260,930587,284520,1017403,557030,540410,733885,680629,184685,397248,33841,534170,1139566,725512,400726,1182063,1130082,12686,1180879,764689,905939,748783,176322,272215,944747,331617,777313,1126624,372285,412023,20795,966457,1091707,1145318,1148742,262585,366981,936564,598082,131723,860239,1058754,1184713,237797,1059226,108010,229794,519108,302086,1097658,1056218,248273,362022,813715,588247,1171446,841700,286620,1191916,369125,594424,988165,622742,1051385,878705,700337,1089907,824581,1138649,900905,662490,815027,539814,1088281,802420,582408,598928,54834,972810,39895,842150,67284,894919,209545,820067,719029,637309,213205,1192680,220383,936833,1169842,1160253,19373,509401,927983,691126,1010789,1160978,464719,230586,804002,1121222,577181,1117887,445519,4274,296983,1140843,135034,620213,223354,223551,878328,852143,276426,266049,100304,695072,1020360,825011,609573,776852,1175603,524785,761872,409976,667093,216828,992274,760532,24773,273531,958262,1172328,124262,327508,639523,955155,977459,154098,1136455,468695,704767,208619,856077,100153,752697,888390,931807,9364,52467,257511,859289,723076,1012986,441568,1115349,676186,864642,957398,970451,646573,1113134,1116830,848894,278565,1044555,533623,1054744,183974,168720,1150060,307074,471549,575668,449595,829074,34961,1106476,1039350,195215,536342,32981,394241,189591,897367,981210,737947,90530,283340,713958,1176078,692624,248695,907131,39991,1130821,674850,541387,289631,1098114,929804,139009,1078907,595083,411369,675026,870937,205421,449972,677268,848442,466927,879614,401048,178472,22997,324482,501020,524184,1038833,575003,933469,589057,537025,1025954,1197457,1118841,843145,1099877,677522,1187897,427084,842788,363342,889178,1154753,1102705,145761,216003,196309,705986,1116057,858253,253597,147221,63484,750288,720718,437070,943521,513851,356435,549678,497681,330574,199425,1040238,768780,764963,357053,535996,664884,750394,1164259,958164,852683,252839,388885,1106889,246995,937013,363259,801838,1153622,360042,101480,936569,675517,88487,991586,888205,462874,411015,1183033,577419,11469,304415,26370,1044650,806807,233260,283405,522532,614010,3973,427720,1107872,1093744,344150,786762,99324,1092865,1108049,240700,490909,883738,771143,220233,1009945,70760,814086,343519,599113,523767,571159,107410,522242,915104,115499,1196161,216985,1027571,1080235,794442,429465,576824,381352,657175,1169211,972604,443816,1185776,1125425,972668,236903,392739,889737,227338,821628,932616,557537,5752,423230,1059940,382999,1004563,585396,148925,95550,152815,435930,61475,787011,361344,1096258,939876,373543,725373,644195,227478,593646,920089,641010,22704,579115,1117720,255352,969124,462701,127926,762069,1064753,640908,839192,981897,594787,619541,598819,762913,956890,291541,726259,1186786,1192242,625563,411215,686190,46060,473025,670941,1104835,784884,966763,1038405,1135053,321379,368099,279815,35928,507352,345226,677640,619201,125563,108718,411861,1106144,689990,190691,1159933,1053938,880343,908342,823533,483326,857755,927638,140435,399830,484602,251790,916156,832770,965106,536147,607259,882364,1057463,360292,378987,1170931,54381,1145685,842066,1162538,662819,1117926,1049512,625498,602641,50177,734711,294000,470200,51082,373474,854851,282387,331819,311444,1057203,1125996,231097,331292,536362,342721,221297,714979,215171,490016,232738,585758,962895,1038739,317306,787841,36663,1107568,1178020,816353,708199,644439,412063,640275,620569,944402,979007,166354,450248,159356,1097593,49563,810341,1050673,634690,387506,117693,430290,174708,435898,763972,584489,479188,270842,48473,702645,891473,754988,426677,529984,1007358,740645,1139702,435582,662404,681226,1043857,506426,381236,58764,734589,800748,1045926,200842,221778,975740,1087808,665555,359442,393928,134484,488930,186990,152353,469422,1181087,391742,1024251,1180878,749202,674970,3665,450048,656199,430871,786088,443815,1170289,894456,227550,510629,776723,375861,681809,488130,976281,1079708,1019360,913064,870206,865234,541054,1122865,862621,808277,235611,750912,799958,792006,1041725,1034410,366619,122594,852974,1165313,508328,1083566,864156,619202,141050,339687,1156979,832418,306006,704567,705462,189355,836678,386171,1008006,1191573,1047489,445403,603944,1060442,968987,737144,833360,517788,226623,531152,1124959,944212,432639,611241,251386,649813,971612,655765,897999,1184346,544473,159273,1010253,48432,67678,1006392,157175,866714,698275,305819,204660,645175,1027766,505957,306319,759674,1113899,983575,224191,7279,110259,315708,1235,1155230,103437,94522,1005313,219836,852011,628304,928247,1185451,884474,188765,85915,695695,1084113,948978,1160740,373056,371690,781906,373555,911217,1019661,782327,903177,1104605,817117,559457,986848,593740,1177786,786638,575098,8572,965654,636456,181685,661407,815740,799316,434000,123590,702973,1178885,1033717,416857,603931,859111,362552,635258,797555,717256,734721,448870,383728,313776,32376,609254,628823,579433,52181,620553,696610,877746,225276,37540,312695,64063,132613,266697,551232,602859,1030181,766551,988789,701982,208240,976909,22815,1100091,397497,295861,537563,971393,858355,635190,942520,586417,386099,1091023,136858,114557,984379,694929,3800,144631,686908,382997,973589,123458,1054851,643002,920783,606259,970417,120015,448674,942519,570930,155130,345905,410584,498541,470503,1149400,868383,188296,10998,198524,265342,1131805,339005,179493,260171,121874,485063,202811,763656,482921,575925,835511,284057,1035408,247592,598104,472437,1149233,678216,1153146,176716,383688,892377,378264,756559,795134,363740,1062599,828178,535581,228184,744739,1045187,736759,861270,252717,895633,484534,396755,785317,484148,409178,289277,408040,636286,1143138,933350,1142266,607577,1014906,224583,87778,794032,70200,527933,393627,265221,455959,1145700,1074371,1032830,1056860,606279,82076,1145152,974062,260323,79736,848002,841133,1090139,823322,809812,46536,656351,388733,1149027,1082137,298691,36776,461437,919735,1149017,927267,385163,972163,802535,1165332,802581,679653,644426,210732,33840,518683,908597,1178475,674452,367966,616206,467157,847381,808354,230029,564310,666156,82481,228901,1066189,116701,642239,1085012,494819,335777,506859,1096702,627618,1086894,887409,116032,1064165,1119200,412573,152078,1002821,1162905,356143,819798,147269,806860,1054071,543952,477113,483504,20198,107285,982529,797923,426067,667562,291745,291364,381222,1040027,1095266,1151825,85766,784294,216000,149848,13079,78784,481350,207468,1001755,228816,947875,851713,805502,390102,785272,985314,798302,305235,744900,1142432,782257,1017168,511828,176340,550981,309865,564850,642569,205317,37405,618112,33354,180487,79196,871589,718297,83554,73318,893159,508288,464086,11963,766507,307361,123994,969316,1040043,144977,55005,26844,1197002,62661,1183378,1128110,622428,980791,239299,359080,778039,389376,324439,1033160,177165,148865,364411,671647,57847,909982,1062512,678890,808655,99292,597281,905527,358544,863574,1190416,1100245,386333,1120738,269959,750424,430788,698748,442684,427626,850175,948116,989837,159224,251390,711761,697407,41994,1001176,846491,203815,737551,1146164,1071853,375156,546203,594001,427569,1165497,961774,450946,186553,573020,174773,244472,201904,1093919,658213,471583,1102226,1114055,1003385,312925,31830,539919,318254,1092545,944533,611642,471268,1016145,243680,1115091,274783,1178690,409914,904980,273722,322036,958410,1068242,761406,381520,862829,435330,353923,1183007,174757,1194761,100643,1152841,245505,624922,68696,1197105,459741,1011565,1198080,1182594,967112,452963,273726,383984,684205,454471,864583,43665,522171,1013608,489834,1008347,482235,734572,537469,713696,712727,82796,314982,738483,4995,680381,1136233,624824,947132,127601,521118,280850,489920,1142148,1176273,118346,958653,39259,577066,534963,241866,577536,625367,970006,943344,168814,209676,452702,1023943,5125,297529,12097,445603,107101,529083,232462,1103670,713744,258022,386579,138216,778526,743059,186728,887083,1057675,49293,223094,989255,730438,12504,758407,661166,677616,247513,572712,197101,990880,737112,337776,315266,344467,903817,233556,75233,598739,722034,450585,586151,1058881,755400,816916,1040813,89157,585147,1084986,92157,320988,303087,1025092,1026554,905009,722845,1029732,1001374,318674,408599,906952,862061,522124,285719,417020,732150,168466,810605,346917,508375,613374,936970,895399,454819,263654,149450,1037739,405359,1048474,125045,473019,578019,917102,1106500,212957,946147,447959,652043,763273,541805,772792,598595,888068,737317,1116449,938752,937370,1099794,590182,1186766,882502,798507,1083908,170305,537254,978234,175713,425280,460103,627454,943188,149004,120942,428151,594283,2579,404300,222794,1135479,928436,518251,208618,840590,1067265,7579,1162116,117710,693569,506938,1122094,902954,47166,828513,931402,925615,1158421,401133,296786,486066,161219,1195930,233731,389296,283560,526855,471775,481487,1131106,296321,473097,587924,961469,519735,427787,947420,993614,1145735,418335,730178,778208,610517,1019608,1159597,642630,1150024,947623,543232,109202,719083,275526,704721,694298,1014232,569074,165202,580439,57050,547653,286612,1068020,917535,623885,781811,100371,534620,920230,428515,241146,209625,860946,27253,342699,1078664,425985,595709,521583,293819,63215,178528,890269,79855,294793,770581,1101187,598115,642794,95649,487947,538322,745216,45919,685520,452499,276244,1041658,1194862,466749,519090,23320,534459,822985,383017,85248,1148595,382158,1158887,429589,101050,267564,799570,773455,83747,666147,1141179,546342,350532,184073,503852,54371,990815,928538,899844,1003917,165442,703076,377884,861904,486827,1164097,845432,576216,549904,403500,1012085,864753,280293,250228,687082,681573,427441,381242,151686,922322,479132,601651,293100,908872,645076,692634,403565,820659,302685,789723,429253,887823,537245,838851,493154,907704,527475,489067,1110628,645000,713703,821136,501498,738484,20482,911350,683270,351098,563148,641477,66647,614348,446255,619977,162665,826593,1148387,755105,1040575,1195575,726251,1062890,542571,655024,204861,163819,727376,514550,399119,256074,169928,689060,164753,815262,585016,254270,985324,953172,218763,1007594,801334,536660,165523,759442,1115158,114331,1078560,13418,536553,904576,7379,460878,649069,232013,140412,43629,1162720,1085291,23368,79754,1126768,206251,125291,688578,1086586,909737,862440,401292,363057,69626,24962,804412,282406,626072,1105612,837473,717526,123887,510288,287980,688778,589743,378378,125915,767818,243441,1007941,184918,411476,1134054,424919,859701,1113315,325734,721448,959851,621470,521217,615982,592312,627808,435181,442522,314894,573708,47100,1004452,64420,869148,55041,584376,1125319,529127,913890,483577,1150749,194888,264417,1183302,1149179,1039999,661630,675098,787920,62055,184823,138292,757457,325488,505889,451284,628835,765277,427647,1175402,1006141,1062262,401383,574293,720428,738164,1055047,84211,663629,483505,35685,338254,529566,524197,42083,1181438,1035355,624862,337557,517856,81658,661991,275500,302059,679509,810460,497464,564138,398554,1090567,263272,223821,267494,913561,180678,641051,657671,464196,517452,1013396,800833,1164240,663911,58515,472569,797355,16018,67999,1185395,17202,433392,292142,449298,1021759,925866,253334,866464,420768,71457,825796,786058,1177286,231624,106374,52763,49339,935496,831100,261517,599999,1066358,337842,139327,13368,960284,138855,1090071,968287,678973,895995,100423,141863,949808,836059,384366,609834,26635,356381,911461,6165,828956,603657,209916,575339,146696,319376,497744,108174,373500,59432,297176,535591,383054,658267,109800,395661,615673,599153,1143247,225271,1158186,355931,1130797,303162,988536,378014,479052,560772,984876,5401,977698,261248,28239,37828,1178708,688680,270098,506955,187292,37103,733362,967495,394079,76859,620900,80194,752562,1193807,901098,57238,1063047,577868,974727,974530,319753,345938,921655,932032,1097777,503009,177721,373070,588508,421229,22478,673296,436209,788105,530988,981253,205807,437549,1173308,924550,239819,25753,1073819,870573,558558,242926,220622,1043983,61626,729386,493314,989462,342004,1097928,445384,309691,266274,1188717,1145614,940570,338792,475005,185095,756513,82732,521895,333439,240683,227630,551508,84947,81251,349187,919516,153526,664458,143337,1014107,1029361,48021,891007,726532,622413,748486,369007,1163120,91605,158731,1002866,661739,1165100,803840,1008490,300714,216871,460134,1107551,914741,484123,22003,505457,949386,290950,1158090,67260,523231,656694,908450,99967,268277,1059072,119174,602998,786712,523055,327144,992660,748109,520813,349639,731154,318467,797033,1019609,1175084,873599,697061,673897,159248,623078,264612,609024,661056,172127,624,79240,354936,98204,520559,10184,770997,355293,834739,308903,43328,95376,1052320,982078,1001772,492095,82024,339828,944484,1050860,1134597,447793,477363,761011,254560,684230,841646,648403,700400,867507,998656,157843,429301,433118,841028,662085,533197,447687,33822,239917,345398,945242,809196,91192,951086,261068,834822,396243,44459,838039,1096601,261512,522564,1109594,206495,309876,735207,787066,15048,620662,1186612,893666,1171711,153431,391274,964821,914676,675549,584071,1194108,770361,90209,104337,853931,411319,1098757,105216,90032,957381,707172,314343,426938,977848,188136,1127321,383995,854562,598968,674314,626922,1090671,675839,282977,1082582,1920,981096,170510,117846,403639,768616,621257,816729,540906,28870,225477,754265,12305,72656,225413,961178,805342,308344,970743,376453,265465,640544,1192329,774851,138141,815082,193518,612685,1049156,1102531,1045266,762151,1136606,411070,836737,101823,258205,824538,472708,553886,970603,604435,277992,557071,1175377,618966,80361,942729,228957,735380,1070155,436012,133328,557173,358889,216184,603294,578540,599262,435168,241191,906540,471822,11295,5839,572518,786866,511891,1152021,725056,527140,93246,413197,231318,159676,63028,876702,829982,918266,1162153,690729,852855,520441,578880,1072518,1089363,786220,91937,508091,1007390,38148,144143,317738,289739,374548,714755,340326,270443,1057646,798251,713479,946291,281925,365311,232975,661934,590822,315717,140618,837789,819094,27150,1143700,52396,356015,35543,535262,80155,148569,572583,595440,1147904,463370,904081,727881,1146999,824607,343230,915694,866262,886637,140878,72085,966984,866789,661719,855360,976784,483102,982910,708065,965343,612323,235186,159342,880775,410240,1161418,90513,20061,381728,489882,553642,786018,557806,577512,253679,219074,1031727,747833,1038725,100488,1148518,387740,147408,563391,810575,1080388,767791,1023373,762183,434109,613592,718893,927239,1149608,495436,306608,443093,771404,668097,190723,457436,58379,762499,535677,516855,154224,691655,816845,1139317,463492,397333,152155,997239,976303,222341,110273,532526,838639,804153,1063597,709151,1011091,1045728,728659,16994,806339,173830,17203,448879,523111,1194416,748033,541882,767210,411993,754266,27792,303625,970531,687452,421358,822220,516272,709951,221800,118373,178721,285017,327875,332847,657027,75216,335460,389804,962470,447169,398123,406075,156356,163671,831462,1075487,345107,32768,689753,114515,333925,578879,1057031,858394,41102,365663,892075,493514,492619,1008726,361403,811910,190075,6508,150592,752678,594137,137639,229094,460937,364721,680293,971458,666929,73122,253869,765442,586840,946695,548268,226469,542316,300082,13735,653608,1038808,187828,1149649,1130403,191689,1040906,331367,499806,892262,993421,552906,170315,692124,891762,438407,84182,214506,973890,1190802,1087822,882373,1196846,42851,1094644,1103559,192768,978245,346070,569777,269834,12630,313607,1009316,1112166,502386,113968,249103,37341,825025,826391,416175,824526,286864,178420,415754,294904,93476,380964,638624,211233,604341,20295,411443,622983,1189509,232427,561625,1016396,536674,382341,398765,764081,1074491,495108,19196,164364,781224,594150,338970,835529,562823,400526,480825,463360,749211,814353,884305,1165705,588827,569258,618648,1145900,577528,501471,320335,972805,1160541,885386,1134018,1065468,931384,646849,595222,167900,431530,209292,496099,989841,221172,1175266,97990,800584,902220,660518,226688,339726,562891,255561,611664,811982,107058,1061223,1083524,213702,503152,1194281,1053450,511173,815084,224492,1074623,143230,555079,277298,591822,227664,1078066,749407,255562,627151,1042951,852176,787497,699540,727578,48681,329698,1009785,1187083,999557,932739,66276,859076,1018588,937910,1076207,713018,995270,434425,715160,622156,362570,914024,162673,950489,599977,725644,48848,519865,44935,1021365,814393,305704,819817,441522,402947,834341,135482,369903,662500,969897,453342,152894,461322,336811,945364,302448,713547,801326,412764,713933,788903,908804,790041,561795,54943,264731,55815,590504,183175,973498,1110303,404049,1127881,670148,804454,932860,742122,52381,123710,165251,141221,591802,1116005,52929,224019,937758,1118345,350079,356948,107942,374759,388269,1151545,541730,809348,49054,115944,899390,1161305,736644,278346,49064,270814,812918,225918,395546,32749,395500,518428,553655,987349,1164241,679398,289484,19606,523629,830115,581875,730924,350700,389727,968052,633771,531925,1115600,969180,131892,1081380,555842,113069,703262,862304,691222,101379,570463,111187,310672,1082049,133916,78881,785508,1046003,195260,35176,841938,378283,1050812,391221,144010,654129,720968,714577,1177883,1090796,215552,400158,772014,530519,906336,906717,816859,158054,102815,46256,1112315,413787,982081,1048233,1185002,1119297,716731,990613,196326,969265,250206,346368,392579,807979,412809,212767,399779,892846,453181,55649,415824,180913,686253,1021741,647100,888216,633231,555512,992764,1160676,579969,1164727,1017594,1118885,326492,479784,1114527,1124763,304922,689793,733995,1186118,431574,890720,1074087,228765,158038,1053104,1143076,1171237,1079,1135420,14703,69971,575653,217290,958782,839001,420042,808705,873642,164921,1020916,1049216,833670,526434,1140234,288099,135569,519191,389426,1098789,600800,292554,839537,334507,7665,97836,811748,77343,928122,447657,767293,499333,755397,770455,347906,249965,208244,1038857,946691,486320,500674,1156087,196905,351590,994266,460530,51917,126228,822925,651878,604080,770512,32584,236307,747135,1011528,625061,1023308,953609,996177,104162,539868,726498,95855,84026,194696,885156,1166251,658162,879827,105536,253548,586439,726813,181936,954401,82990,923298,19391,788167,293101,924359,876045,239671,129839,436675,816561,335252,762751,844158,15074,1023324,3320,1097438,45240,952576,573159,1129385,976,738340,186516};

/* Partial NTT (naive O(n^2) method with Hornor's rule) */
static void ntt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_n)
{
	uint32_t DIM_NTT = N1 * N2;
	uint32_t b[N + D + K + 1];
	int i, j;
	
	b[0] = 0;
	for (i = DIM - 1; i >= 0; i--)
	{
		b[0] = (b[0] + a[i]) % Q;
	}
	
	for (i = 1; i < DIM_NTT; i++)
	{
		b[i] = 0;
		/* Hornor's rule */
		for (j = DIM - 1; j >= 0; j--)
		{
			b[i] = (((uint64_t)b[i] * (uint64_t)omega_n[i]) % Q) + a[j];
		}
		b[i] %= Q;
	}
	
	/* change the order to match the optimized NTT */
	for (i = 0; i < DIM_NTT; i++)
	{
		a[i] = b[(i % N2) * N1 + i / N2];
	}
}

/* Partial INTT (naive O(n^2) method with Hornor's rule) */
static void intt_core(uint32_t *a, uint32_t N1, uint32_t N2, uint32_t DIM, const uint32_t *omega_n, uint32_t inv_n)
{
	uint32_t DIM_NTT = N1 * N2;
	uint32_t b[N + D + K + 1];
	int i, j;
	
	/* change the order to match the optimized NTT */
	for (i = 0; i < DIM_NTT; i++)
	{
		b[i] = a[(i % N1) * N2 + i / N1];
	}
	
	a[0] = 0;
	for (i = DIM_NTT - 1; i >= 0; i--)
	{
		a[0] = (a[0] + b[i]) % Q;
	}
	a[0] = ((uint64_t)a[0] * (uint64_t)inv_n) % Q;
	
	for (i = 1; i < DIM; i++)
	{
		a[i] = 0;
		/* Hornor's rule */
		for (j = DIM_NTT - 1; j >= 0; j--)
		{
			a[i] = (((uint64_t)a[i] * (uint64_t)omega_n[i]) % Q) + b[j];
		}
		a[i] = ((uint64_t)a[i] * (uint64_t)inv_n) % Q;
	}	
}

void intt_3328_3328(uint32_t *a)
{
	intt_core(a, N1_3328, N2_3328, 3328, omega_3328, INV_3328);	
}

void intt_1280_1280(uint32_t *a)
{
	intt_core(a, N1_1280, N2_1280, 1280, omega_1280, INV_1280);	
}

void ntt_3072_3072(uint32_t *a)
{
	ntt_core(a, N1_3072, N2_3072, 3072, omega_3072);
}

void intt_3072_3072_inv(uint32_t *a)
{
	intt_core(a, N1_3072, N2_3072, 3072, omega_3072_inv, INV_3072);
}

void ntt_1280_1280_inv(uint32_t *a)
{
	ntt_core(a, N1_1280, N2_1280, 1280, omega_1280_inv);
}
